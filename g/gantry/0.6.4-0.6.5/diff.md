# Comparing `tmp/gantry-0.6.4.tar.gz` & `tmp/gantry-0.6.5.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "gantry-0.6.4.tar", last modified: Wed May 17 00:34:14 2023, max compression
+gzip compressed data, was "gantry-0.6.5.tar", last modified: Wed May 24 20:58:09 2023, max compression
```

## Comparing `gantry-0.6.4.tar` & `gantry-0.6.5.tar`

### file list

```diff
@@ -1,174 +1,174 @@
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.092836 gantry-0.6.4/
--rw-r--r--   0 runner    (1001) docker     (123)    10947 2023-05-17 00:33:59.000000 gantry-0.6.4/LICENSE
--rw-r--r--   0 runner    (1001) docker     (123)       61 2023-05-17 00:33:59.000000 gantry-0.6.4/MANIFEST.in
--rw-r--r--   0 runner    (1001) docker     (123)      613 2023-05-17 00:34:14.092836 gantry-0.6.4/PKG-INFO
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.068836 gantry-0.6.4/gantry/
--rw-r--r--   0 runner    (1001) docker     (123)     3988 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.068836 gantry-0.6.4/gantry/alerts/
--rw-r--r--   0 runner    (1001) docker     (123)      508 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/alerts/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    18599 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/alerts/client.py
--rw-r--r--   0 runner    (1001) docker     (123)     1088 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/alerts/globals.py
--rw-r--r--   0 runner    (1001) docker     (123)     2374 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/alerts/main.py
--rw-r--r--   0 runner    (1001) docker     (123)     3464 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/api_client.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.068836 gantry-0.6.4/gantry/applications/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/applications/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     4748 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/applications/client.py
--rw-r--r--   0 runner    (1001) docker     (123)    28655 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/applications/core.py
--rw-r--r--   0 runner    (1001) docker     (123)    16390 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/applications/llm.py
--rw-r--r--   0 runner    (1001) docker     (123)     1783 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/applications/llm_utils.py
--rw-r--r--   0 runner    (1001) docker     (123)     1865 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/applications/main.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.068836 gantry-0.6.4/gantry/automations/
--rw-r--r--   0 runner    (1001) docker     (123)       87 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/automations/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.072836 gantry-0.6.4/gantry/automations/actions/
--rw-r--r--   0 runner    (1001) docker     (123)      125 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/automations/actions/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1842 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/automations/actions/actions.py
--rw-r--r--   0 runner    (1001) docker     (123)     6886 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/automations/automations.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.072836 gantry-0.6.4/gantry/automations/curators/
--rw-r--r--   0 runner    (1001) docker     (123)      866 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/automations/curators/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    23267 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/automations/curators/curators.py
--rw-r--r--   0 runner    (1001) docker     (123)      296 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/automations/curators/globals.py
--rw-r--r--   0 runner    (1001) docker     (123)     2982 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/automations/curators/main.py
--rw-r--r--   0 runner    (1001) docker     (123)     1435 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/automations/curators/models.py
--rw-r--r--   0 runner    (1001) docker     (123)     7418 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/automations/curators/selectors.py
--rw-r--r--   0 runner    (1001) docker     (123)    26072 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/automations/curators/stock_curators.py
--rw-r--r--   0 runner    (1001) docker     (123)       19 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/automations/globals.py
--rw-r--r--   0 runner    (1001) docker     (123)      716 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/automations/main.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.072836 gantry-0.6.4/gantry/automations/triggers/
--rw-r--r--   0 runner    (1001) docker     (123)      190 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/automations/triggers/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     3952 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/automations/triggers/triggers.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.072836 gantry-0.6.4/gantry/cli/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/cli/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1281 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/cli/application.py
--rw-r--r--   0 runner    (1001) docker     (123)     3012 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/cli/bucket.py
--rw-r--r--   0 runner    (1001) docker     (123)     6749 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/cli/data_connector.py
--rw-r--r--   0 runner    (1001) docker     (123)    18425 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/cli/labeling.py
--rw-r--r--   0 runner    (1001) docker     (123)     1254 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/cli/main.py
--rw-r--r--   0 runner    (1001) docker     (123)    12740 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/cli/projection.py
--rw-r--r--   0 runner    (1001) docker     (123)     2236 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/cli/secret.py
--rw-r--r--   0 runner    (1001) docker     (123)      158 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/const.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.072836 gantry-0.6.4/gantry/data_generator/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/data_generator/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     4757 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/data_generator/data_generator.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.076836 gantry-0.6.4/gantry/dataset/
--rw-r--r--   0 runner    (1001) docker     (123)      426 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/dataset/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    11112 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/dataset/client.py
--rw-r--r--   0 runner    (1001) docker     (123)     2476 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/dataset/constants.py
--rw-r--r--   0 runner    (1001) docker     (123)    64518 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/dataset/gantry_dataset.py
--rw-r--r--   0 runner    (1001) docker     (123)     3907 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/dataset/main.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.076836 gantry-0.6.4/gantry/dataset/templates/
--rw-r--r--   0 runner    (1001) docker     (123)     2802 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/dataset/templates/load_script_template.py.jinja
--rw-r--r--   0 runner    (1001) docker     (123)     4706 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/exceptions.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.076836 gantry-0.6.4/gantry/logger/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/logger/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    93878 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/logger/client.py
--rw-r--r--   0 runner    (1001) docker     (123)      669 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/logger/constants.py
--rw-r--r--   0 runner    (1001) docker     (123)     5151 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/logger/consumer.py
--rw-r--r--   0 runner    (1001) docker     (123)     6574 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/logger/event_builder.py
--rw-r--r--   0 runner    (1001) docker     (123)     6587 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/logger/main.py
--rw-r--r--   0 runner    (1001) docker     (123)     7908 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/logger/stores.py
--rw-r--r--   0 runner    (1001) docker     (123)     3797 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/logger/types.py
--rw-r--r--   0 runner    (1001) docker     (123)    11640 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/logger/utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.080836 gantry-0.6.4/gantry/query/
--rw-r--r--   0 runner    (1001) docker     (123)      655 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    17533 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/client.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.080836 gantry-0.6.4/gantry/query/core/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/core/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)      217 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/core/constants.py
--rw-r--r--   0 runner    (1001) docker     (123)    35580 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/core/dataframe.py
--rw-r--r--   0 runner    (1001) docker     (123)     3369 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/core/distance.py
--rw-r--r--   0 runner    (1001) docker     (123)    18559 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/core/metric.py
--rw-r--r--   0 runner    (1001) docker     (123)    10330 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/core/queryframe.py
--rw-r--r--   0 runner    (1001) docker     (123)     6211 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/core/utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.080836 gantry-0.6.4/gantry/query/distance/
--rw-r--r--   0 runner    (1001) docker     (123)      129 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/distance/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)      948 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/distance/main.py
--rw-r--r--   0 runner    (1001) docker     (123)     1510 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/globals.py
--rw-r--r--   0 runner    (1001) docker     (123)     3098 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/main.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.080836 gantry-0.6.4/gantry/query/metric/
--rw-r--r--   0 runner    (1001) docker     (123)      508 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/metric/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2521 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/metric/main.py
--rw-r--r--   0 runner    (1001) docker     (123)      851 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/query/time_window.py
--rw-r--r--   0 runner    (1001) docker     (123)     3313 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/serializers.py
--rw-r--r--   0 runner    (1001) docker     (123)     9704 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/utils.py
--rw-r--r--   0 runner    (1001) docker     (123)     2687 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/validators.py
--rw-r--r--   0 runner    (1001) docker     (123)       22 2023-05-17 00:33:59.000000 gantry-0.6.4/gantry/version.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.068836 gantry-0.6.4/gantry.egg-info/
--rw-r--r--   0 runner    (1001) docker     (123)      613 2023-05-17 00:34:14.000000 gantry-0.6.4/gantry.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)     4018 2023-05-17 00:34:14.000000 gantry-0.6.4/gantry.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-05-17 00:34:14.000000 gantry-0.6.4/gantry.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (123)       51 2023-05-17 00:34:14.000000 gantry-0.6.4/gantry.egg-info/entry_points.txt
--rw-r--r--   0 runner    (1001) docker     (123)      465 2023-05-17 00:34:14.000000 gantry-0.6.4/gantry.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (123)       13 2023-05-17 00:34:14.000000 gantry-0.6.4/gantry.egg-info/top_level.txt
--rw-r--r--   0 runner    (1001) docker     (123)       38 2023-05-17 00:34:14.092836 gantry-0.6.4/setup.cfg
--rw-r--r--   0 runner    (1001) docker     (123)     1959 2023-05-17 00:33:59.000000 gantry-0.6.4/setup.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.080836 gantry-0.6.4/tests/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.084836 gantry-0.6.4/tests/alerts/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/alerts/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)       36 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/alerts/conftest.py
--rw-r--r--   0 runner    (1001) docker     (123)    13052 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/alerts/test_client.py
--rw-r--r--   0 runner    (1001) docker     (123)     5201 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/alerts/test_main.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.084836 gantry-0.6.4/tests/applications/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/applications/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)      323 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/applications/conftest.py
--rw-r--r--   0 runner    (1001) docker     (123)     2258 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/applications/test_client.py
--rw-r--r--   0 runner    (1001) docker     (123)    12414 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/applications/test_core.py
--rw-r--r--   0 runner    (1001) docker     (123)    12594 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/applications/test_llm.py
--rw-r--r--   0 runner    (1001) docker     (123)     2630 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/applications/test_llm_utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.084836 gantry-0.6.4/tests/cli/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/cli/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     4275 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/cli/test_bucket.py
--rw-r--r--   0 runner    (1001) docker     (123)    14561 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/cli/test_data_connector.py
--rw-r--r--   0 runner    (1001) docker     (123)    21081 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/cli/test_labeling.py
--rw-r--r--   0 runner    (1001) docker     (123)      178 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/cli/test_main.py
--rw-r--r--   0 runner    (1001) docker     (123)     5094 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/cli/test_projection.py
--rw-r--r--   0 runner    (1001) docker     (123)     3580 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/cli/test_secrets.py
--rw-r--r--   0 runner    (1001) docker     (123)     4657 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/conftest.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.088836 gantry-0.6.4/tests/curator/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/curator/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1720 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/curator/conftest.py
--rw-r--r--   0 runner    (1001) docker     (123)     7926 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/curator/test_curator.py
--rw-r--r--   0 runner    (1001) docker     (123)     3113 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/curator/test_main.py
--rw-r--r--   0 runner    (1001) docker     (123)     6400 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/curator/test_selectors.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.088836 gantry-0.6.4/tests/data_generator/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/data_generator/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1509 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/data_generator/test_data_generator.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.088836 gantry-0.6.4/tests/dataset/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/dataset/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2035 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/dataset/conftest.py
--rw-r--r--   0 runner    (1001) docker     (123)     6657 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/dataset/test_client.py
--rw-r--r--   0 runner    (1001) docker     (123)    49536 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/dataset/test_gantry_dataset.py
--rw-r--r--   0 runner    (1001) docker     (123)     2646 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/dataset/test_main.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.088836 gantry-0.6.4/tests/logger/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/logger/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)      416 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/logger/conftest.py
--rw-r--r--   0 runner    (1001) docker     (123)   136361 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/logger/test_client.py
--rw-r--r--   0 runner    (1001) docker     (123)     6395 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/logger/test_consumer.py
--rw-r--r--   0 runner    (1001) docker     (123)     3919 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/logger/test_event_builder.py
--rw-r--r--   0 runner    (1001) docker     (123)     7689 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/logger/test_main.py
--rw-r--r--   0 runner    (1001) docker     (123)     9427 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/logger/test_stores.py
--rw-r--r--   0 runner    (1001) docker     (123)    20087 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/logger/test_utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.092836 gantry-0.6.4/tests/query/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     6538 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/conftest.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.092836 gantry-0.6.4/tests/query/core/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/core/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    11716 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/core/test_dataframe.py
--rw-r--r--   0 runner    (1001) docker     (123)     4610 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/core/test_distance.py
--rw-r--r--   0 runner    (1001) docker     (123)      660 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/core/test_filters.py
--rw-r--r--   0 runner    (1001) docker     (123)    12594 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/core/test_metric.py
--rw-r--r--   0 runner    (1001) docker     (123)    23434 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/core/test_queryframe.py
--rw-r--r--   0 runner    (1001) docker     (123)    35405 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/core/test_series.py
--rw-r--r--   0 runner    (1001) docker     (123)    12002 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/core/test_utils.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.092836 gantry-0.6.4/tests/query/distance/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/distance/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)      626 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/distance/test_main.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-17 00:34:14.092836 gantry-0.6.4/tests/query/metric/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/metric/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2687 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/metric/test_main.py
--rw-r--r--   0 runner    (1001) docker     (123)    15575 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/test_client.py
--rw-r--r--   0 runner    (1001) docker     (123)     3628 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/query/test_main.py
--rw-r--r--   0 runner    (1001) docker     (123)     3840 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/test_api_client.py
--rw-r--r--   0 runner    (1001) docker     (123)      665 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/test_init.py
--rw-r--r--   0 runner    (1001) docker     (123)     2068 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/test_utils.py
--rw-r--r--   0 runner    (1001) docker     (123)     1641 2023-05-17 00:33:59.000000 gantry-0.6.4/tests/test_validator.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.618367 gantry-0.6.5/
+-rw-r--r--   0 runner    (1001) docker     (123)    10947 2023-05-24 20:57:58.000000 gantry-0.6.5/LICENSE
+-rw-r--r--   0 runner    (1001) docker     (123)       61 2023-05-24 20:57:58.000000 gantry-0.6.5/MANIFEST.in
+-rw-r--r--   0 runner    (1001) docker     (123)      613 2023-05-24 20:58:09.618367 gantry-0.6.5/PKG-INFO
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.582364 gantry-0.6.5/gantry/
+-rw-r--r--   0 runner    (1001) docker     (123)     3988 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.582364 gantry-0.6.5/gantry/alerts/
+-rw-r--r--   0 runner    (1001) docker     (123)      508 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/alerts/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18599 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/alerts/client.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1088 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/alerts/globals.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2374 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/alerts/main.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3464 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/api_client.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.586365 gantry-0.6.5/gantry/applications/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/applications/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4748 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/applications/client.py
+-rw-r--r--   0 runner    (1001) docker     (123)    28655 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/applications/core.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17741 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/applications/llm.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1783 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/applications/llm_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1865 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/applications/main.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.586365 gantry-0.6.5/gantry/automations/
+-rw-r--r--   0 runner    (1001) docker     (123)       87 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/automations/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.586365 gantry-0.6.5/gantry/automations/actions/
+-rw-r--r--   0 runner    (1001) docker     (123)      125 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/automations/actions/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1842 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/automations/actions/actions.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6886 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/automations/automations.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.590365 gantry-0.6.5/gantry/automations/curators/
+-rw-r--r--   0 runner    (1001) docker     (123)      866 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/automations/curators/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    23267 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/automations/curators/curators.py
+-rw-r--r--   0 runner    (1001) docker     (123)      296 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/automations/curators/globals.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2982 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/automations/curators/main.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1435 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/automations/curators/models.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7418 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/automations/curators/selectors.py
+-rw-r--r--   0 runner    (1001) docker     (123)    26072 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/automations/curators/stock_curators.py
+-rw-r--r--   0 runner    (1001) docker     (123)       19 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/automations/globals.py
+-rw-r--r--   0 runner    (1001) docker     (123)      716 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/automations/main.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.590365 gantry-0.6.5/gantry/automations/triggers/
+-rw-r--r--   0 runner    (1001) docker     (123)      190 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/automations/triggers/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3952 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/automations/triggers/triggers.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.590365 gantry-0.6.5/gantry/cli/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/cli/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1281 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/cli/application.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3012 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/cli/bucket.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6749 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/cli/data_connector.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18425 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/cli/labeling.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1254 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/cli/main.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12816 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/cli/projection.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2236 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/cli/secret.py
+-rw-r--r--   0 runner    (1001) docker     (123)      158 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/const.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.594365 gantry-0.6.5/gantry/data_generator/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/data_generator/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4757 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/data_generator/data_generator.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.594365 gantry-0.6.5/gantry/dataset/
+-rw-r--r--   0 runner    (1001) docker     (123)      426 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/dataset/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11112 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/dataset/client.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2476 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/dataset/constants.py
+-rw-r--r--   0 runner    (1001) docker     (123)    64518 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/dataset/gantry_dataset.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3907 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/dataset/main.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.594365 gantry-0.6.5/gantry/dataset/templates/
+-rw-r--r--   0 runner    (1001) docker     (123)     2802 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/dataset/templates/load_script_template.py.jinja
+-rw-r--r--   0 runner    (1001) docker     (123)     4706 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/exceptions.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.598365 gantry-0.6.5/gantry/logger/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/logger/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    93878 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/logger/client.py
+-rw-r--r--   0 runner    (1001) docker     (123)      669 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/logger/constants.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5151 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/logger/consumer.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6574 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/logger/event_builder.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6587 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/logger/main.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7908 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/logger/stores.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3797 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/logger/types.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11640 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/logger/utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.598365 gantry-0.6.5/gantry/query/
+-rw-r--r--   0 runner    (1001) docker     (123)      655 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17533 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/client.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.602366 gantry-0.6.5/gantry/query/core/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/core/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)      217 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/core/constants.py
+-rw-r--r--   0 runner    (1001) docker     (123)    35580 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/core/dataframe.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3369 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/core/distance.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18559 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/core/metric.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10330 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/core/queryframe.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6211 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/core/utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.602366 gantry-0.6.5/gantry/query/distance/
+-rw-r--r--   0 runner    (1001) docker     (123)      129 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/distance/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)      948 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/distance/main.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1510 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/globals.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3098 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/main.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.602366 gantry-0.6.5/gantry/query/metric/
+-rw-r--r--   0 runner    (1001) docker     (123)      508 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/metric/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2521 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/metric/main.py
+-rw-r--r--   0 runner    (1001) docker     (123)      851 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/query/time_window.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3313 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/serializers.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9704 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2687 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/validators.py
+-rw-r--r--   0 runner    (1001) docker     (123)       22 2023-05-24 20:57:58.000000 gantry-0.6.5/gantry/version.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.582364 gantry-0.6.5/gantry.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (123)      613 2023-05-24 20:58:09.000000 gantry-0.6.5/gantry.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)     4018 2023-05-24 20:58:09.000000 gantry-0.6.5/gantry.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-05-24 20:58:09.000000 gantry-0.6.5/gantry.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       51 2023-05-24 20:58:09.000000 gantry-0.6.5/gantry.egg-info/entry_points.txt
+-rw-r--r--   0 runner    (1001) docker     (123)      470 2023-05-24 20:58:09.000000 gantry-0.6.5/gantry.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       13 2023-05-24 20:58:09.000000 gantry-0.6.5/gantry.egg-info/top_level.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       38 2023-05-24 20:58:09.618367 gantry-0.6.5/setup.cfg
+-rw-r--r--   0 runner    (1001) docker     (123)     1964 2023-05-24 20:57:58.000000 gantry-0.6.5/setup.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.602366 gantry-0.6.5/tests/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.606366 gantry-0.6.5/tests/alerts/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/alerts/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)       36 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/alerts/conftest.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13052 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/alerts/test_client.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5201 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/alerts/test_main.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.606366 gantry-0.6.5/tests/applications/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/applications/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)      323 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/applications/conftest.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2258 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/applications/test_client.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12414 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/applications/test_core.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13514 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/applications/test_llm.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2630 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/applications/test_llm_utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.610366 gantry-0.6.5/tests/cli/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/cli/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4275 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/cli/test_bucket.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14561 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/cli/test_data_connector.py
+-rw-r--r--   0 runner    (1001) docker     (123)    21081 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/cli/test_labeling.py
+-rw-r--r--   0 runner    (1001) docker     (123)      178 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/cli/test_main.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5114 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/cli/test_projection.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3580 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/cli/test_secrets.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4657 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/conftest.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.610366 gantry-0.6.5/tests/curator/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/curator/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1720 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/curator/conftest.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7926 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/curator/test_curator.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3113 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/curator/test_main.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6400 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/curator/test_selectors.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.610366 gantry-0.6.5/tests/data_generator/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/data_generator/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1509 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/data_generator/test_data_generator.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.610366 gantry-0.6.5/tests/dataset/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/dataset/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2035 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/dataset/conftest.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6657 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/dataset/test_client.py
+-rw-r--r--   0 runner    (1001) docker     (123)    49536 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/dataset/test_gantry_dataset.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2646 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/dataset/test_main.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.614367 gantry-0.6.5/tests/logger/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/logger/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)      416 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/logger/conftest.py
+-rw-r--r--   0 runner    (1001) docker     (123)   110078 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/logger/test_client.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6395 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/logger/test_consumer.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3919 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/logger/test_event_builder.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7689 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/logger/test_main.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9427 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/logger/test_stores.py
+-rw-r--r--   0 runner    (1001) docker     (123)    20087 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/logger/test_utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.614367 gantry-0.6.5/tests/query/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6538 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/conftest.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.618367 gantry-0.6.5/tests/query/core/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/core/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11716 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/core/test_dataframe.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4610 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/core/test_distance.py
+-rw-r--r--   0 runner    (1001) docker     (123)      660 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/core/test_filters.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12594 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/core/test_metric.py
+-rw-r--r--   0 runner    (1001) docker     (123)    23434 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/core/test_queryframe.py
+-rw-r--r--   0 runner    (1001) docker     (123)    35405 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/core/test_series.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12002 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/core/test_utils.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.618367 gantry-0.6.5/tests/query/distance/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/distance/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)      626 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/distance/test_main.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-24 20:58:09.618367 gantry-0.6.5/tests/query/metric/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/metric/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2687 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/metric/test_main.py
+-rw-r--r--   0 runner    (1001) docker     (123)    15575 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/test_client.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3628 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/query/test_main.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3840 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/test_api_client.py
+-rw-r--r--   0 runner    (1001) docker     (123)      665 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/test_init.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2068 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/test_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1641 2023-05-24 20:57:58.000000 gantry-0.6.5/tests/test_validator.py
```

### Comparing `gantry-0.6.4/LICENSE` & `gantry-0.6.5/LICENSE`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/PKG-INFO` & `gantry-0.6.5/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: gantry
-Version: 0.6.4
+Version: 0.6.5
 Summary: Gantry Python Library
 Author: Gantry Systems, Inc.
 Author-email: oss@gantry.io
 License: Apache Software License v2
 Classifier: Development Status :: 4 - Beta
 Classifier: Programming Language :: Python :: 3.7
 Classifier: Programming Language :: Python :: 3.8
```

### Comparing `gantry-0.6.4/gantry/__init__.py` & `gantry-0.6.5/gantry/__init__.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/alerts/client.py` & `gantry-0.6.5/gantry/alerts/client.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/alerts/globals.py` & `gantry-0.6.5/gantry/alerts/globals.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/alerts/main.py` & `gantry-0.6.5/gantry/alerts/main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/api_client.py` & `gantry-0.6.5/gantry/api_client.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/applications/client.py` & `gantry-0.6.5/gantry/applications/client.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/applications/core.py` & `gantry-0.6.5/gantry/applications/core.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/applications/llm.py` & `gantry-0.6.5/gantry/applications/llm.py`

 * *Files 3% similar despite different names*

```diff
@@ -389,14 +389,15 @@
 
     def log_completion(
         self,
         open_ai_api_request: Dict,
         open_ai_api_response: Dict,
         request_attributes: Optional[Dict] = None,
         response_attributes: Optional[Dict] = None,
+        feedback: Optional[Dict] = None,
         selected_choice_index: int = 0,
         session_id: Optional[Union[str, uuid.UUID]] = None,
         tags: Optional[Dict] = None,
         version: Optional[int] = None,
     ):
         """
         Log request/response OpenAI pair into Gantry.
@@ -440,17 +441,20 @@
         Args:
             open_ai_api_request (dict): The OpenAI request.
                 For more details on content, see `OpenAI API Reference for Completion
                 <https://platform.openai.com/docs/api-reference/completions/create>`_.
             open_ai_api_response (dict): The OpenAI response.
                 For more details on content, see `OpenAI API Reference for Completion
                 <https://platform.openai.com/docs/api-reference/completions/create>`_.
-            request_attributes (dict): Additional inputs
-            response_attributes (dict): Additional outputs
-            selected_choice_index (int): The selected choice index. Defaults to 1.
+            request_attributes (Optional[dict]): Additional inputs
+            response_attributes (Optional[dict]): Additional outputs
+            feedback (Optional[dict]): Optional feedback data. See
+                https://docs.gantry.io/docs/logging-feedback-actuals for more information
+                about logging feedback in Gantry.
+            selected_choice_index (Optional[int]): The selected choice index. Defaults to 1.
             session_id (Optional[str or uuid.UUID]): Optional session
                 to group data together.
             tags (Optional[dict]): Optional tags to add to the record.
             version (Optional[int]): The version number used.
         """
         tags = tags or {}
         if version:
@@ -458,13 +462,45 @@
 
         event = {
             "application": self._name,
             "open_ai_api_request": open_ai_api_request,
             "open_ai_api_response": open_ai_api_response,
             "request_attributes": request_attributes or {},
             "response_attributes": response_attributes or {},
+            "feedback": feedback or {},
             "selected_choice_index": selected_choice_index,
             "session_id": session_id,
             "tags": tags,
         }
 
         self._log_store.log(self._name, event)
+
+    def deploy_version(self, version_id: uuid.UUID, env: Literal["prod", "test"]) -> None:
+        """
+        Deploys a version in a specific environment.
+
+        Example usage:
+
+        .. code-block:: python
+
+            import gantry
+
+            my_llm_app = gantry.get_application("my_llm_app")
+            version = my_llm_app.get_version("latest")
+            my_llm_app.deploy_version(version.version_id, "prod")
+
+        Args:
+            version_id (uuid): The version id.
+            env (str, 'prod' or 'test'): The target environment, can be 'prod' or 'test'.
+
+        """
+        _ = self._api_client.request(
+            "PATCH",
+            (f"/api/v1/cms/{self._name}/configurations/{self._configuration_name}" "/releases"),
+            json={
+                "version_id": str(version_id),
+                "env": env,
+                "description": "Deployment from SDK",
+            },
+            raise_for_status=True,
+        )
+        logger.info(f"Version {version_id} was successfully deployed in {env}")
```

### Comparing `gantry-0.6.4/gantry/applications/llm_utils.py` & `gantry-0.6.5/gantry/applications/llm_utils.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/applications/main.py` & `gantry-0.6.5/gantry/applications/main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/automations/actions/actions.py` & `gantry-0.6.5/gantry/automations/actions/actions.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/automations/automations.py` & `gantry-0.6.5/gantry/automations/automations.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/automations/curators/__init__.py` & `gantry-0.6.5/gantry/automations/curators/__init__.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/automations/curators/curators.py` & `gantry-0.6.5/gantry/automations/curators/curators.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/automations/curators/main.py` & `gantry-0.6.5/gantry/automations/curators/main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/automations/curators/models.py` & `gantry-0.6.5/gantry/automations/curators/models.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/automations/curators/selectors.py` & `gantry-0.6.5/gantry/automations/curators/selectors.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/automations/curators/stock_curators.py` & `gantry-0.6.5/gantry/automations/curators/stock_curators.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/automations/main.py` & `gantry-0.6.5/gantry/automations/main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/automations/triggers/triggers.py` & `gantry-0.6.5/gantry/automations/triggers/triggers.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/cli/application.py` & `gantry-0.6.5/gantry/cli/application.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/cli/bucket.py` & `gantry-0.6.5/gantry/cli/bucket.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/cli/data_connector.py` & `gantry-0.6.5/gantry/cli/data_connector.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/cli/labeling.py` & `gantry-0.6.5/gantry/cli/labeling.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/cli/main.py` & `gantry-0.6.5/gantry/cli/main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/cli/projection.py` & `gantry-0.6.5/gantry/cli/projection.py`

 * *Files 2% similar despite different names*

```diff
@@ -50,22 +50,17 @@
         2. function.zip: source code with all required dependencies to get invoked as a lambda
     """
     click.secho("Parsing custom projection configs...", nl=False, fg="cyan")
     projection = _get_custom_projection_configs(projection_dir)
     click.secho("SUCCESS", fg="cyan")
 
     click.secho("Validate custom projection definition...", nl=False, fg="cyan")
-    valid_config, err_msgs = _validate_custom_projection_configs(api_client, projection)
+    valid_config = _validate_custom_projection_configs(api_client, projection)
     if not valid_config:
         click.secho("FAILED.", fg="red")
-        if err_msgs:
-            click.secho("Please fix the following issue(s):", fg="red")
-            for err in err_msgs:
-                click.secho(f"\t{err}")
-
         raise click.ClickException("Invalid projection definition")
     click.secho("SUCCESS", fg="cyan")
 
     if dry_run:
         click.secho("Dry run complete.", fg="cyan")
         return True
 
@@ -112,22 +107,17 @@
         _update_dev_projection(api_client, projection, projection_dir, dry_run)
     else:
         _update_projection(api_client, projection, projection_dir, dry_run)
 
 
 def _update_projection(api_client: APIClient, projection: Dict, projection_dir: str, dry_run: bool):
     click.secho("Validate custom projection definition...", nl=False, fg="cyan")
-    valid_config, err_msgs = _validate_custom_projection_configs(api_client, projection)
+    valid_config = _validate_custom_projection_configs(api_client, projection)
     if not valid_config:
         click.secho("FAILED.", fg="red")
-        if err_msgs:
-            click.secho("Please fix the following issue(s):", fg="red")
-            for err in err_msgs:
-                click.secho(f"\t{err}")
-
         raise click.ClickException("Invalid projection definition")
     click.secho("SUCCESS", fg="cyan")
 
     if dry_run:
         click.secho("Dry run complete.", fg="cyan")
         return True
 
@@ -305,26 +295,37 @@
             projection = yaml.safe_load(stream)
     except FileNotFoundError:
         raise ValueError(f"{config_file} not found under projection directory.")
 
     return projection
 
 
-def _validate_custom_projection_configs(
-    api_client: APIClient, projection: Dict
-) -> Tuple[bool, List[str]]:
+def _validate_custom_projection_configs(api_client: APIClient, projection: Dict) -> bool:
     response = api_client.request(
         "POST",
         "/api/v1/custom_projections/validate",
         data={"projection": json.dumps(projection)},
     )
 
     if response.get("response") == "ok":
-        return True, []
-    return False, response.get("errors", [])
+        return True
+    if "errors" in response:
+        # print each error on a new line
+        for err in response["errors"]:
+            click.secho(err)
+    else:
+        if "error" in response:
+            error_dict = response["error"]
+            if error_dict.get("message", ""):
+                click.secho(error_dict.get("message"))
+            if error_dict.get("validation_errors", []):
+                for err in error_dict["validation_errors"]:
+                    click.secho(f"-->{err}")
+
+    return False
 
 
 def _get_s3_destination(api_client: APIClient, projection: Dict) -> Tuple[bool, Dict]:
     response = api_client.request(
         "GET",
         "/api/v1/custom_projections/pre-upload",
         params={
```

### Comparing `gantry-0.6.4/gantry/cli/secret.py` & `gantry-0.6.5/gantry/cli/secret.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/data_generator/data_generator.py` & `gantry-0.6.5/gantry/data_generator/data_generator.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/dataset/client.py` & `gantry-0.6.5/gantry/dataset/client.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/dataset/constants.py` & `gantry-0.6.5/gantry/dataset/constants.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/dataset/gantry_dataset.py` & `gantry-0.6.5/gantry/dataset/gantry_dataset.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/dataset/main.py` & `gantry-0.6.5/gantry/dataset/main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/dataset/templates/load_script_template.py.jinja` & `gantry-0.6.5/gantry/dataset/templates/load_script_template.py.jinja`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/exceptions.py` & `gantry-0.6.5/gantry/exceptions.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/logger/client.py` & `gantry-0.6.5/gantry/logger/client.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/logger/constants.py` & `gantry-0.6.5/gantry/logger/constants.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/logger/consumer.py` & `gantry-0.6.5/gantry/logger/consumer.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/logger/event_builder.py` & `gantry-0.6.5/gantry/logger/event_builder.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/logger/main.py` & `gantry-0.6.5/gantry/logger/main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/logger/stores.py` & `gantry-0.6.5/gantry/logger/stores.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/logger/types.py` & `gantry-0.6.5/gantry/logger/types.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/logger/utils.py` & `gantry-0.6.5/gantry/logger/utils.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/query/__init__.py` & `gantry-0.6.5/gantry/query/__init__.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/query/client.py` & `gantry-0.6.5/gantry/query/client.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/query/core/dataframe.py` & `gantry-0.6.5/gantry/query/core/dataframe.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/query/core/distance.py` & `gantry-0.6.5/gantry/query/core/distance.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/query/core/metric.py` & `gantry-0.6.5/gantry/query/core/metric.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/query/core/queryframe.py` & `gantry-0.6.5/gantry/query/core/queryframe.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/query/core/utils.py` & `gantry-0.6.5/gantry/query/core/utils.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/query/distance/main.py` & `gantry-0.6.5/gantry/query/distance/main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/query/globals.py` & `gantry-0.6.5/gantry/query/globals.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/query/main.py` & `gantry-0.6.5/gantry/query/main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/query/metric/main.py` & `gantry-0.6.5/gantry/query/metric/main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/query/time_window.py` & `gantry-0.6.5/gantry/query/time_window.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/serializers.py` & `gantry-0.6.5/gantry/serializers.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/utils.py` & `gantry-0.6.5/gantry/utils.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry/validators.py` & `gantry-0.6.5/gantry/validators.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/gantry.egg-info/PKG-INFO` & `gantry-0.6.5/gantry.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: gantry
-Version: 0.6.4
+Version: 0.6.5
 Summary: Gantry Python Library
 Author: Gantry Systems, Inc.
 Author-email: oss@gantry.io
 License: Apache Software License v2
 Classifier: Development Status :: 4 - Beta
 Classifier: Programming Language :: Python :: 3.7
 Classifier: Programming Language :: Python :: 3.8
```

### Comparing `gantry-0.6.4/gantry.egg-info/SOURCES.txt` & `gantry-0.6.5/gantry.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/setup.py` & `gantry-0.6.5/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -25,15 +25,15 @@
     "pyyaml>=5.3.1",
     "colorama>=0.4.0",
     "label-studio-sdk>=0.0.19,<0.0.22",
     "marshmallow>=3.11.1",
     "marshmallow-oneofschema>=3.0.1",
     "monotonic>=1.4",
     "tabulate~=0.8",
-    "typing-extensions~=4.0",
+    "typing-extensions>=4.0,<4.6",
     "tqdm~=4.64",
     "halo~=0.0.31",
     "isodate~=0.6",
     "pydantic==1.9.0",
     "python-dateutil>=2.8.1",
     "pandas",
     "numpy",
```

### Comparing `gantry-0.6.4/tests/alerts/test_client.py` & `gantry-0.6.5/tests/alerts/test_client.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/alerts/test_main.py` & `gantry-0.6.5/tests/alerts/test_main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/applications/test_client.py` & `gantry-0.6.5/tests/applications/test_client.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/applications/test_core.py` & `gantry-0.6.5/tests/applications/test_core.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/applications/test_llm.py` & `gantry-0.6.5/tests/applications/test_llm.py`

 * *Files 1% similar despite different names*

```diff
@@ -286,14 +286,15 @@
 
 def test_log_completion(test_llm_application: CompletionApplication, caplog):
     test_llm_application.log_completion(
         open_ai_api_request={"request": "foo"},
         open_ai_api_response={"response": "bar"},
         request_attributes={"foo": "bar"},
         response_attributes={"bar": "baz"},
+        feedback={"foo": "baz"},
         selected_choice_index=1,
         session_id="12345",
         tags={"a": "b"},
         version=100,
     )
 
     assert test_llm_application._log_store._store == [
@@ -301,14 +302,15 @@
             "test_llm_application",
             {
                 "application": "test_llm_application",
                 "open_ai_api_request": {"request": "foo"},
                 "open_ai_api_response": {"response": "bar"},
                 "request_attributes": {"foo": "bar"},
                 "response_attributes": {"bar": "baz"},
+                "feedback": {"foo": "baz"},
                 "selected_choice_index": 1,
                 "session_id": "12345",
                 "tags": {"a": "b", "version_number": 100},
             },
         ),
     ]
 
@@ -361,7 +363,34 @@
             f"{HOST}/api/v1/logging/completions",
             json={"response": "ok"},
             headers={"Content-Type": "application/json"},
             match=[matchers.json_params_matcher({"foo": "bar"})],
         )
 
         log_store.send_completion_event(event)
+
+
+def test_deploy_version(test_llm_application: CompletionApplication):
+    version_id = uuid.uuid4()
+    env = "foobar"
+
+    with responses.RequestsMock() as resp:
+        resp.add(
+            resp.PATCH,
+            (
+                f"{HOST}/api/v1/cms/test_llm_application/configurations/"
+                "default_test_llm_application_configuration/releases"
+            ),
+            json={"response": "ok"},
+            headers={"Content-Type": "application/json"},
+            match=[
+                matchers.json_params_matcher(
+                    {
+                        "version_id": str(version_id),
+                        "env": env,
+                        "description": "Deployment from SDK",
+                    }
+                )
+            ],
+        )
+
+        test_llm_application.deploy_version(version_id, env)
```

### Comparing `gantry-0.6.4/tests/applications/test_llm_utils.py` & `gantry-0.6.5/tests/applications/test_llm_utils.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/cli/test_bucket.py` & `gantry-0.6.5/tests/cli/test_bucket.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/cli/test_data_connector.py` & `gantry-0.6.5/tests/cli/test_data_connector.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/cli/test_labeling.py` & `gantry-0.6.5/tests/cli/test_labeling.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/cli/test_projection.py` & `gantry-0.6.5/tests/cli/test_projection.py`

 * *Files 1% similar despite different names*

```diff
@@ -13,23 +13,26 @@
     valid_projection_dir = "tests/cli/custom-projections/valid_projection_dir/"
     projection = _get_custom_projection_configs(valid_projection_dir)
     assert projection is not None
 
 
 @mock.patch(
     "gantry.cli.projection._validate_custom_projection_configs",
-    return_value=(False, ["error 1", "error 2"]),
+    return_value=False,
 )
 @mock.patch("gantry.logger.main.get_client")
 def test_update_fail_validate_configs(mock_api_client, mock_validate_configs):
     runner = CliRunner()
     cli_args = ["--projection-dir", "tests/cli/custom-projections/invalid_projection_dir/"]
     result = runner.invoke(update, cli_args, env={"GANTRY_API_KEY": "test"})
     assert result.exit_code == 1
-    assert "FAILED.\nPlease fix the following issue(s):\n\terror 1\n\terror 2" in result.output
+    assert (
+        "Validate custom projection definition...FAILED.\nError: Invalid projection definition\n"
+        in result.output
+    )
 
 
 @mock.patch(
     "gantry.cli.projection._validate_custom_projection_configs",
     return_value=(True, []),
 )
 @mock.patch("gantry.logger.main.get_client")
```

### Comparing `gantry-0.6.4/tests/cli/test_secrets.py` & `gantry-0.6.5/tests/cli/test_secrets.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/conftest.py` & `gantry-0.6.5/tests/conftest.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/curator/conftest.py` & `gantry-0.6.5/tests/curator/conftest.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/curator/test_curator.py` & `gantry-0.6.5/tests/curator/test_curator.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/curator/test_main.py` & `gantry-0.6.5/tests/curator/test_main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/curator/test_selectors.py` & `gantry-0.6.5/tests/curator/test_selectors.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/data_generator/test_data_generator.py` & `gantry-0.6.5/tests/data_generator/test_data_generator.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/dataset/conftest.py` & `gantry-0.6.5/tests/dataset/conftest.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/dataset/test_client.py` & `gantry-0.6.5/tests/dataset/test_client.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/dataset/test_gantry_dataset.py` & `gantry-0.6.5/tests/dataset/test_gantry_dataset.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/dataset/test_main.py` & `gantry-0.6.5/tests/dataset/test_main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/logger/test_client.py` & `gantry-0.6.5/tests/logger/test_client.py`

 * *Files 13% similar despite different names*

```diff
@@ -38,8486 +38,6843 @@
 00000250: 5448 4552 5f54 494d 452c 0a20 2020 2041  THER_TIME,.    A
 00000260: 4e4f 5448 4552 5f54 494d 455f 5354 522c  NOTHER_TIME_STR,
 00000270: 0a20 2020 2043 5552 5245 4e54 5f54 494d  .    CURRENT_TIM
 00000280: 452c 0a20 2020 2043 5552 5245 4e54 5f54  E,.    CURRENT_T
 00000290: 494d 455f 5354 522c 0a20 2020 204f 4e45  IME_STR,.    ONE
 000002a0: 5f54 4f5f 5445 4e2c 0a20 2020 2053 4f4d  _TO_TEN,.    SOM
 000002b0: 455f 5449 4d45 2c0a 2020 2020 534f 4d45  E_TIME,.    SOME
-000002c0: 5f54 494d 455f 5354 522c 0a29 0a0a 0a63  _TIME_STR,.)...c
-000002d0: 6c61 7373 2054 6573 744c 6f67 5374 6f72  lass TestLogStor
-000002e0: 6528 4261 7365 4c6f 6753 746f 7265 293a  e(BaseLogStore):
-000002f0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-00000300: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00000310: 2073 656c 662e 6c6f 6773 203d 205b 5d0a   self.logs = [].
-00000320: 2020 2020 2020 2020 7365 6c66 2e73 7461          self.sta
-00000330: 7475 7320 3d20 4661 6c73 650a 0a20 2020  tus = False..   
-00000340: 2064 6566 206c 6f67 5f62 6174 6368 2873   def log_batch(s
-00000350: 656c 662c 2061 7070 6c69 6361 7469 6f6e  elf, application
-00000360: 2c20 6576 656e 7473 2920 2d3e 204e 6f6e  , events) -> Non
-00000370: 653a 0a20 2020 2020 2020 2073 656c 662e  e:.        self.
-00000380: 6c6f 6773 2e61 7070 656e 6428 7b22 6170  logs.append({"ap
-00000390: 706c 6963 6174 696f 6e22 3a20 6170 706c  plication": appl
-000003a0: 6963 6174 696f 6e2c 2022 6576 656e 7473  ication, "events
-000003b0: 223a 2065 7665 6e74 737d 290a 0a20 2020  ": events})..   
-000003c0: 2064 6566 2070 696e 6728 7365 6c66 2920   def ping(self) 
-000003d0: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
-000003e0: 2072 6574 7572 6e20 7365 6c66 2e73 7461   return self.sta
-000003f0: 7475 730a 0a0a 4070 7974 6573 742e 6669  tus...@pytest.fi
-00000400: 7874 7572 6528 7363 6f70 653d 2266 756e  xture(scope="fun
-00000410: 6374 696f 6e22 290a 6465 6620 6c6f 675f  ction").def log_
-00000420: 7374 6f72 6528 293a 0a20 2020 2072 6574  store():.    ret
-00000430: 7572 6e20 5465 7374 4c6f 6753 746f 7265  urn TestLogStore
-00000440: 2829 0a0a 0a40 7079 7465 7374 2e66 6978  ()...@pytest.fix
-00000450: 7475 7265 2873 636f 7065 3d22 6675 6e63  ture(scope="func
-00000460: 7469 6f6e 2229 0a64 6566 2063 6c69 5f6f  tion").def cli_o
-00000470: 626a 286c 6f67 5f73 746f 7265 293a 0a20  bj(log_store):. 
-00000480: 2020 2072 6574 7572 6e20 636c 6965 6e74     return client
-00000490: 2e47 616e 7472 7928 6c6f 675f 7374 6f72  .Gantry(log_stor
-000004a0: 653d 6c6f 675f 7374 6f72 652c 2065 6e76  e=log_store, env
-000004b0: 6972 6f6e 6d65 6e74 3d22 7465 7374 222c  ironment="test",
-000004c0: 206c 6f67 6769 6e67 5f6c 6576 656c 3d22   logging_level="
-000004d0: 4445 4255 4722 290a 0a0a 4070 7974 6573  DEBUG")...@pytes
-000004e0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
-000004f0: 7a65 280a 2020 2020 2265 6e76 2c20 7461  ze(.    "env, ta
-00000500: 6773 2c20 6578 7065 6374 6564 222c 0a20  gs, expected",. 
-00000510: 2020 205b 0a20 2020 2020 2020 2028 2274     [.        ("t
-00000520: 6573 7422 2c20 7b7d 2c20 7b22 656e 7622  est", {}, {"env"
-00000530: 3a20 2274 6573 7422 7d29 2c0a 2020 2020  : "test"}),.    
-00000540: 2020 2020 2822 7465 7374 222c 207b 2266      ("test", {"f
-00000550: 6f6f 223a 2022 6261 7222 7d2c 207b 2266  oo": "bar"}, {"f
-00000560: 6f6f 223a 2022 6261 7222 2c20 2265 6e76  oo": "bar", "env
-00000570: 223a 2022 7465 7374 227d 292c 0a20 2020  ": "test"}),.   
-00000580: 2020 2020 2028 2274 6573 7422 2c20 7b22       ("test", {"
-00000590: 656e 7622 3a20 226c 6f63 616c 227d 2c20  env": "local"}, 
-000005a0: 7b22 656e 7622 3a20 226c 6f63 616c 227d  {"env": "local"}
-000005b0: 292c 0a20 2020 2020 2020 2028 2274 6573  ),.        ("tes
-000005c0: 7422 2c20 7b22 666f 6f22 3a20 2262 6172  t", {"foo": "bar
-000005d0: 222c 2022 656e 7622 3a20 226c 6f63 616c  ", "env": "local
-000005e0: 227d 2c20 7b22 666f 6f22 3a20 2262 6172  "}, {"foo": "bar
-000005f0: 222c 2022 656e 7622 3a20 226c 6f63 616c  ", "env": "local
-00000600: 227d 292c 0a20 2020 205d 2c0a 290a 6465  "}),.    ],.).de
-00000610: 6620 7465 7374 5f75 7064 6174 655f 7461  f test_update_ta
-00000620: 6773 5f77 6974 685f 656e 7628 656e 762c  gs_with_env(env,
-00000630: 2074 6167 732c 2065 7870 6563 7465 6429   tags, expected)
-00000640: 3a0a 2020 2020 636c 6965 6e74 2e5f 7570  :.    client._up
-00000650: 6461 7465 5f74 6167 735f 7769 7468 5f65  date_tags_with_e
-00000660: 6e76 2865 6e76 2c20 7461 6773 290a 2020  nv(env, tags).  
-00000670: 2020 6173 7365 7274 2074 6167 7320 3d3d    assert tags ==
-00000680: 2065 7870 6563 7465 640a 0a0a 406d 6f63   expected...@moc
-00000690: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
-000006a0: 6c6f 6767 6572 2e63 6c69 656e 742e 7575  logger.client.uu
-000006b0: 6964 2e75 7569 6434 2229 0a64 6566 2074  id.uuid4").def t
-000006c0: 6573 745f 6465 6661 756c 745f 6a6f 696e  est_default_join
-000006d0: 5f6b 6579 5f67 656e 286d 6f63 6b5f 7575  _key_gen(mock_uu
-000006e0: 6964 293a 0a20 2020 206d 6f63 6b5f 7575  id):.    mock_uu
-000006f0: 6964 2e72 6574 7572 6e5f 7661 6c75 6520  id.return_value 
-00000700: 3d20 2231 3233 3435 220a 2020 2020 6173  = "12345".    as
-00000710: 7365 7274 2063 6c69 656e 742e 5f64 6566  sert client._def
-00000720: 6175 6c74 5f6a 6f69 6e5f 6b65 795f 6765  ault_join_key_ge
-00000730: 6e28 2920 3d3d 2022 3132 3334 3522 0a0a  n() == "12345"..
-00000740: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
-00000750: 7261 6d65 7472 697a 6528 2273 616d 706c  rametrize("sampl
-00000760: 655f 7261 7465 222c 205b 2d31 2c20 3130  e_rate", [-1, 10
-00000770: 2c20 312e 315d 290a 6465 6620 7465 7374  , 1.1]).def test
-00000780: 5f73 616d 706c 655f 7265 636f 7264 735f  _sample_records_
-00000790: 6572 726f 7228 7361 6d70 6c65 5f72 6174  error(sample_rat
-000007a0: 6529 3a0a 2020 2020 7769 7468 2070 7974  e):.    with pyt
-000007b0: 6573 742e 7261 6973 6573 2841 7373 6572  est.raises(Asser
-000007c0: 7469 6f6e 4572 726f 7229 3a0a 2020 2020  tionError):.    
-000007d0: 2020 2020 636c 6965 6e74 2e5f 7361 6d70      client._samp
-000007e0: 6c65 5f72 6563 6f72 6473 2831 302c 2073  le_records(10, s
-000007f0: 616d 706c 655f 7261 7465 2c20 4e6f 6e65  ample_rate, None
-00000800: 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f  , None, None, No
-00000810: 6e65 2c20 4e6f 6e65 2c20 4e6f 6e65 290a  ne, None, None).
-00000820: 0a0a 4070 7974 6573 742e 6d61 726b 2e70  ..@pytest.mark.p
-00000830: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
-00000840: 5b22 7361 6d70 6c65 222c 2022 6b77 6172  ["sample", "kwar
-00000850: 6773 222c 2022 6578 7065 6374 6564 225d  gs", "expected"]
-00000860: 2c0a 2020 2020 5b0a 2020 2020 2020 2020  ,.    [.        
-00000870: 280a 2020 2020 2020 2020 2020 2020 5b32  (.            [2
-00000880: 2c20 332c 2034 2c20 355d 2c0a 2020 2020  , 3, 4, 5],.    
-00000890: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-000008a0: 2020 2020 2020 2020 2020 2269 6e70 7574            "input
-000008b0: 7322 3a20 4f4e 455f 544f 5f54 454e 2c0a  s": ONE_TO_TEN,.
-000008c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000008d0: 226f 7574 7075 7473 223a 204f 4e45 5f54  "outputs": ONE_T
-000008e0: 4f5f 5445 4e2c 0a20 2020 2020 2020 2020  O_TEN,.         
-000008f0: 2020 2020 2020 2022 6665 6564 6261 636b         "feedback
-00000900: 7322 3a20 4f4e 455f 544f 5f54 454e 2c0a  s": ONE_TO_TEN,.
-00000910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000920: 226a 6f69 6e5f 6b65 7973 223a 204f 4e45  "join_keys": ONE
-00000930: 5f54 4f5f 5445 4e2c 0a20 2020 2020 2020  _TO_TEN,.       
-00000940: 2020 2020 2020 2020 2022 7469 6d65 7374           "timest
-00000950: 616d 7073 223a 204f 4e45 5f54 4f5f 5445  amps": ONE_TO_TE
-00000960: 4e2c 0a20 2020 2020 2020 2020 2020 2020  N,.             
-00000970: 2020 2022 7461 6773 223a 204f 4e45 5f54     "tags": ONE_T
-00000980: 4f5f 5445 4e2c 0a20 2020 2020 2020 2020  O_TEN,.         
-00000990: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-000009a0: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-000009b0: 2020 2020 5b33 2c20 342c 2035 2c20 365d      [3, 4, 5, 6]
-000009c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000009d0: 2020 5b33 2c20 342c 2035 2c20 365d 2c0a    [3, 4, 5, 6],.
-000009e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000009f0: 5b33 2c20 342c 2035 2c20 365d 2c0a 2020  [3, 4, 5, 6],.  
-00000a00: 2020 2020 2020 2020 2020 2020 2020 5b33                [3
-00000a10: 2c20 342c 2035 2c20 365d 2c0a 2020 2020  , 4, 5, 6],.    
-00000a20: 2020 2020 2020 2020 2020 2020 5b33 2c20              [3, 
-00000a30: 342c 2035 2c20 365d 2c0a 2020 2020 2020  4, 5, 6],.      
-00000a40: 2020 2020 2020 2020 2020 5b33 2c20 342c            [3, 4,
-00000a50: 2035 2c20 365d 2c0a 2020 2020 2020 2020   5, 6],.        
-00000a60: 2020 2020 292c 0a20 2020 2020 2020 2029      ),.        )
-00000a70: 2c0a 2020 2020 2020 2020 280a 2020 2020  ,.        (.    
-00000a80: 2020 2020 2020 2020 5b37 5d2c 0a20 2020          [7],.   
-00000a90: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
-00000aa0: 2020 2020 2020 2020 2020 2022 696e 7075             "inpu
-00000ab0: 7473 223a 204f 4e45 5f54 4f5f 5445 4e2c  ts": ONE_TO_TEN,
-00000ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000ad0: 2022 6f75 7470 7574 7322 3a20 4f4e 455f   "outputs": ONE_
-00000ae0: 544f 5f54 454e 2c0a 2020 2020 2020 2020  TO_TEN,.        
-00000af0: 2020 2020 2020 2020 2266 6565 6462 6163          "feedbac
-00000b00: 6b73 223a 204e 6f6e 652c 0a20 2020 2020  ks": None,.     
-00000b10: 2020 2020 2020 2020 2020 2022 6a6f 696e             "join
-00000b20: 5f6b 6579 7322 3a20 4f4e 455f 544f 5f54  _keys": ONE_TO_T
-00000b30: 454e 2c0a 2020 2020 2020 2020 2020 2020  EN,.            
-00000b40: 2020 2020 2274 696d 6573 7461 6d70 7322      "timestamps"
-00000b50: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-00000b60: 2020 2020 2020 2020 2274 6167 7322 3a20          "tags": 
-00000b70: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-00000b80: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
-00000b90: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00000ba0: 2020 205b 385d 2c0a 2020 2020 2020 2020     [8],.        
-00000bb0: 2020 2020 2020 2020 5b38 5d2c 0a20 2020          [8],.   
-00000bc0: 2020 2020 2020 2020 2020 2020 204e 6f6e               Non
-00000bd0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00000be0: 2020 205b 385d 2c0a 2020 2020 2020 2020     [8],.        
-00000bf0: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
-00000c00: 2020 2020 2020 2020 2020 2020 2020 4e6f                No
-00000c10: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00000c20: 292c 0a20 2020 2020 2020 2029 2c0a 2020  ),.        ),.  
-00000c30: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-00000c40: 2020 2020 5b36 2c20 325d 2c0a 2020 2020      [6, 2],.    
-00000c50: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00000c60: 2020 2020 2020 2020 2020 2269 6e70 7574            "input
-00000c70: 7322 3a20 4e6f 6e65 2c0a 2020 2020 2020  s": None,.      
-00000c80: 2020 2020 2020 2020 2020 226f 7574 7075            "outpu
-00000c90: 7473 223a 204e 6f6e 652c 0a20 2020 2020  ts": None,.     
-00000ca0: 2020 2020 2020 2020 2020 2022 6665 6564             "feed
-00000cb0: 6261 636b 7322 3a20 4e6f 6e65 2c0a 2020  backs": None,.  
-00000cc0: 2020 2020 2020 2020 2020 2020 2020 226a                "j
-00000cd0: 6f69 6e5f 6b65 7973 223a 204f 4e45 5f54  oin_keys": ONE_T
-00000ce0: 4f5f 5445 4e2c 0a20 2020 2020 2020 2020  O_TEN,.         
-00000cf0: 2020 2020 2020 2022 7469 6d65 7374 616d         "timestam
-00000d00: 7073 223a 204e 6f6e 652c 0a20 2020 2020  ps": None,.     
-00000d10: 2020 2020 2020 2020 2020 2022 7461 6773             "tags
-00000d20: 223a 204f 4e45 5f54 4f5f 5445 4e2c 0a20  ": ONE_TO_TEN,. 
-00000d30: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
-00000d40: 2020 2020 2020 2020 2020 280a 2020 2020            (.    
-00000d50: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-00000d60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00000d70: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
-00000d80: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
-00000d90: 2020 2020 2020 2020 2020 2020 2020 5b33                [3
-00000da0: 2c20 375d 2c0a 2020 2020 2020 2020 2020  , 7],.          
-00000db0: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-00000dc0: 2020 2020 2020 2020 2020 2020 5b33 2c20              [3, 
-00000dd0: 375d 2c0a 2020 2020 2020 2020 2020 2020  7],.            
-00000de0: 292c 0a20 2020 2020 2020 2029 2c0a 2020  ),.        ),.  
-00000df0: 2020 5d2c 0a29 0a40 6d6f 636b 2e70 6174    ],.).@mock.pat
-00000e00: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
-00000e10: 722e 636c 6965 6e74 2e72 616e 646f 6d2e  r.client.random.
-00000e20: 7361 6d70 6c65 2229 0a64 6566 2074 6573  sample").def tes
-00000e30: 745f 7361 6d70 6c65 5f72 6563 6f72 6473  t_sample_records
-00000e40: 286d 6f63 6b5f 7361 6d70 6c65 2c20 7361  (mock_sample, sa
-00000e50: 6d70 6c65 2c20 6b77 6172 6773 2c20 6578  mple, kwargs, ex
-00000e60: 7065 6374 6564 293a 0a20 2020 206d 6f63  pected):.    moc
-00000e70: 6b5f 7361 6d70 6c65 2e72 6574 7572 6e5f  k_sample.return_
-00000e80: 7661 6c75 6520 3d20 7361 6d70 6c65 0a20  value = sample. 
-00000e90: 2020 2061 7373 6572 7420 636c 6965 6e74     assert client
-00000ea0: 2e5f 7361 6d70 6c65 5f72 6563 6f72 6473  ._sample_records
-00000eb0: 2831 302c 2030 2e35 2c20 2a2a 6b77 6172  (10, 0.5, **kwar
-00000ec0: 6773 2920 3d3d 2065 7870 6563 7465 640a  gs) == expected.
-00000ed0: 2020 2020 6d6f 636b 5f73 616d 706c 652e      mock_sample.
-00000ee0: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-00000ef0: 6365 5f77 6974 6828 7261 6e67 6528 302c  ce_with(range(0,
-00000f00: 2031 3029 2c20 3529 0a0a 0a40 7079 7465   10), 5)...@pyte
-00000f10: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
-00000f20: 697a 6528 0a20 2020 205b 2269 6e70 7574  ize(.    ["input
-00000f30: 7322 2c20 2266 6565 6462 6163 6b5f 6964  s", "feedback_id
-00000f40: 222c 2022 6665 6564 6261 636b 5f6b 6579  ", "feedback_key
-00000f50: 7322 2c20 226a 6f69 6e5f 6b65 7922 2c20  s", "join_key", 
-00000f60: 2265 7870 6563 7465 6422 5d2c 0a20 2020  "expected"],.   
-00000f70: 205b 0a20 2020 2020 2020 2028 7b22 666f   [.        ({"fo
-00000f80: 6f22 3a20 2262 6172 227d 2c20 7b22 6964  o": "bar"}, {"id
-00000f90: 223a 2022 3132 3334 3522 7d2c 204e 6f6e  ": "12345"}, Non
-00000fa0: 652c 204e 6f6e 652c 2022 3830 6566 3636  e, None, "80ef66
-00000fb0: 6265 3831 6462 6162 6133 3064 6232 3564  be81dbaba30db25d
-00000fc0: 3133 3336 3231 3764 3064 2229 2c0a 2020  1336217d0d"),.  
-00000fd0: 2020 2020 2020 287b 2266 6f6f 223a 2022        ({"foo": "
-00000fe0: 6261 7222 7d2c 204e 6f6e 652c 205b 2266  bar"}, None, ["f
-00000ff0: 6f6f 225d 2c20 4e6f 6e65 2c20 2234 3261  oo"], None, "42a
-00001000: 3562 3762 3939 6233 3731 3764 3165 6165  5b7b99b3717d1eae
-00001010: 6237 3261 3639 3438 6461 6263 3922 292c  b72a6948dabc9"),
-00001020: 0a20 2020 2020 2020 2028 7b22 666f 6f22  .        ({"foo"
-00001030: 3a20 2262 6172 227d 2c20 4e6f 6e65 2c20  : "bar"}, None, 
-00001040: 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f 6e65  None, None, None
-00001050: 292c 0a20 2020 2020 2020 2028 7b22 666f  ),.        ({"fo
-00001060: 6f22 3a20 2262 6172 227d 2c20 4e6f 6e65  o": "bar"}, None
-00001070: 2c20 4e6f 6e65 2c20 2262 6172 6261 7a22  , None, "barbaz"
-00001080: 2c20 2262 6172 6261 7a22 292c 0a20 2020  , "barbaz"),.   
-00001090: 205d 2c0a 290a 6465 6620 7465 7374 5f72   ],.).def test_r
-000010a0: 6573 6f6c 7665 5f6a 6f69 6e5f 6b65 7928  esolve_join_key(
-000010b0: 696e 7075 7473 2c20 6665 6564 6261 636b  inputs, feedback
-000010c0: 5f69 642c 2066 6565 6462 6163 6b5f 6b65  _id, feedback_ke
-000010d0: 7973 2c20 6a6f 696e 5f6b 6579 2c20 6578  ys, join_key, ex
-000010e0: 7065 6374 6564 293a 0a20 2020 2061 7373  pected):.    ass
-000010f0: 6572 7420 280a 2020 2020 2020 2020 636c  ert (.        cl
-00001100: 6965 6e74 2e5f 7265 736f 6c76 655f 6a6f  ient._resolve_jo
-00001110: 696e 5f6b 6579 280a 2020 2020 2020 2020  in_key(.        
-00001120: 2020 2020 696e 7075 7473 2c0a 2020 2020      inputs,.    
-00001130: 2020 2020 2020 2020 6665 6564 6261 636b          feedback
-00001140: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
-00001150: 2066 6565 6462 6163 6b5f 6b65 7973 2c0a   feedback_keys,.
-00001160: 2020 2020 2020 2020 2020 2020 6a6f 696e              join
-00001170: 5f6b 6579 2c0a 2020 2020 2020 2020 290a  _key,.        ).
-00001180: 2020 2020 2020 2020 3d3d 2065 7870 6563          == expec
-00001190: 7465 640a 2020 2020 290a 0a0a 4070 7974  ted.    )...@pyt
-000011a0: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-000011b0: 7269 7a65 280a 2020 2020 5b22 696e 7075  rize(.    ["inpu
-000011c0: 7473 222c 2022 6665 6564 6261 636b 5f69  ts", "feedback_i
-000011d0: 6422 2c20 2266 6565 6462 6163 6b5f 6b65  d", "feedback_ke
-000011e0: 7973 222c 2022 6a6f 696e 5f6b 6579 222c  ys", "join_key",
-000011f0: 2022 6572 726f 725f 7422 5d2c 0a20 2020   "error_t"],.   
-00001200: 205b 0a20 2020 2020 2020 2028 7b22 666f   [.        ({"fo
-00001210: 6f22 3a20 2262 6172 227d 2c20 7b22 6964  o": "bar"}, {"id
-00001220: 223a 2022 3132 3334 3522 7d2c 205b 2266  ": "12345"}, ["f
-00001230: 6f6f 225d 2c20 4e6f 6e65 2c20 4761 6e74  oo"], None, Gant
-00001240: 7279 4c6f 6767 696e 6745 7863 6570 7469  ryLoggingExcepti
-00001250: 6f6e 292c 0a20 2020 2020 2020 2028 7b22  on),.        ({"
-00001260: 666f 6f22 3a20 2262 6172 227d 2c20 4e6f  foo": "bar"}, No
-00001270: 6e65 2c20 5b22 666f 6f22 5d2c 2022 6261  ne, ["foo"], "ba
-00001280: 7262 617a 222c 2056 616c 7565 4572 726f  rbaz", ValueErro
-00001290: 7229 2c0a 2020 2020 2020 2020 287b 2266  r),.        ({"f
-000012a0: 6f6f 223a 2022 6261 7222 7d2c 207b 2269  oo": "bar"}, {"i
-000012b0: 6422 3a20 2231 3233 3435 227d 2c20 4e6f  d": "12345"}, No
-000012c0: 6e65 2c20 2262 6172 6261 7a22 2c20 5661  ne, "barbaz", Va
-000012d0: 6c75 6545 7272 6f72 292c 0a20 2020 2020  lueError),.     
-000012e0: 2020 2028 7b22 666f 6f22 3a20 2262 6172     ({"foo": "bar
-000012f0: 227d 2c20 7b22 6964 223a 2022 3132 3334  "}, {"id": "1234
-00001300: 3522 7d2c 205b 2266 6f6f 225d 2c20 2262  5"}, ["foo"], "b
-00001310: 6172 6261 7a22 2c20 5661 6c75 6545 7272  arbaz", ValueErr
-00001320: 6f72 292c 0a20 2020 205d 2c0a 290a 6465  or),.    ],.).de
-00001330: 6620 7465 7374 5f72 6573 6f6c 7665 5f6a  f test_resolve_j
-00001340: 6f69 6e5f 6b65 795f 6572 726f 7228 696e  oin_key_error(in
-00001350: 7075 7473 2c20 6665 6564 6261 636b 5f69  puts, feedback_i
-00001360: 642c 2066 6565 6462 6163 6b5f 6b65 7973  d, feedback_keys
-00001370: 2c20 6a6f 696e 5f6b 6579 2c20 6572 726f  , join_key, erro
-00001380: 725f 7429 3a0a 2020 2020 7769 7468 2070  r_t):.    with p
-00001390: 7974 6573 742e 7261 6973 6573 2865 7272  ytest.raises(err
-000013a0: 6f72 5f74 293a 0a20 2020 2020 2020 205f  or_t):.        _
-000013b0: 203d 2063 6c69 656e 742e 5f72 6573 6f6c   = client._resol
-000013c0: 7665 5f6a 6f69 6e5f 6b65 7928 0a20 2020  ve_join_key(.   
-000013d0: 2020 2020 2020 2020 2069 6e70 7574 732c           inputs,
-000013e0: 0a20 2020 2020 2020 2020 2020 2066 6565  .            fee
-000013f0: 6462 6163 6b5f 6964 2c0a 2020 2020 2020  dback_id,.      
-00001400: 2020 2020 2020 6665 6564 6261 636b 5f6b        feedback_k
-00001410: 6579 732c 0a20 2020 2020 2020 2020 2020  eys,.           
-00001420: 206a 6f69 6e5f 6b65 792c 0a20 2020 2020   join_key,.     
-00001430: 2020 2029 0a0a 0a40 7079 7465 7374 2e6d     )...@pytest.m
-00001440: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
-00001450: 0a20 2020 205b 2273 697a 6522 2c20 2269  .    ["size", "i
-00001460: 6e70 7574 7322 2c20 2266 6565 6462 6163  nputs", "feedbac
-00001470: 6b5f 6964 222c 2022 6665 6564 6261 636b  k_id", "feedback
-00001480: 5f6b 6579 7322 2c20 226a 6f69 6e5f 6b65  _keys", "join_ke
-00001490: 7922 2c20 2265 7870 6563 7465 6422 5d2c  y", "expected"],
-000014a0: 0a20 2020 205b 0a20 2020 2020 2020 2028  .    [.        (
-000014b0: 0a20 2020 2020 2020 2020 2020 2032 2c0a  .            2,.
-000014c0: 2020 2020 2020 2020 2020 2020 5b7b 2266              [{"f
-000014d0: 6f6f 223a 2022 6261 7222 7d2c 207b 2266  oo": "bar"}, {"f
-000014e0: 6f6f 223a 2022 6261 7a22 7d5d 2c0a 2020  oo": "baz"}],.  
-000014f0: 2020 2020 2020 2020 2020 5b7b 2269 6422            [{"id"
-00001500: 3a20 2231 3233 3435 227d 2c20 7b22 6964  : "12345"}, {"id
-00001510: 223a 2022 3637 3839 3022 7d5d 2c0a 2020  ": "67890"}],.  
-00001520: 2020 2020 2020 2020 2020 4e6f 6e65 2c0a            None,.
-00001530: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-00001540: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
-00001550: 3830 6566 3636 6265 3831 6462 6162 6133  80ef66be81dbaba3
-00001560: 3064 6232 3564 3133 3336 3231 3764 3064  0db25d1336217d0d
-00001570: 222c 2022 3463 6535 3865 3138 3562 6538  ", "4ce58e185be8
-00001580: 3739 3437 3337 3565 3239 3630 3731 6235  7947375e296071b5
-00001590: 3961 3933 225d 2c0a 2020 2020 2020 2020  9a93"],.        
-000015a0: 292c 0a20 2020 2020 2020 2028 0a20 2020  ),.        (.   
-000015b0: 2020 2020 2020 2020 2032 2c0a 2020 2020           2,.    
-000015c0: 2020 2020 2020 2020 5b7b 2266 6f6f 223a          [{"foo":
-000015d0: 2022 6261 7222 7d2c 207b 2266 6f6f 223a   "bar"}, {"foo":
-000015e0: 2022 6261 7a22 7d5d 2c0a 2020 2020 2020   "baz"}],.      
-000015f0: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-00001600: 2020 2020 2020 2020 5b22 666f 6f22 5d2c          ["foo"],
-00001610: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-00001620: 652c 0a20 2020 2020 2020 2020 2020 205b  e,.            [
-00001630: 2234 3261 3562 3762 3939 6233 3731 3764  "42a5b7b99b3717d
-00001640: 3165 6165 6237 3261 3639 3438 6461 6263  1eaeb72a6948dabc
-00001650: 3922 2c20 2231 3433 3635 3461 3566 3061  9", "143654a5f0a
-00001660: 3035 3961 3137 3839 3234 6261 6639 6238  059a178924baf9b8
-00001670: 3135 6561 3622 5d2c 0a20 2020 2020 2020  15ea6"],.       
-00001680: 2029 2c0a 2020 2020 2020 2020 2832 2c20   ),.        (2, 
-00001690: 5b7b 2266 6f6f 223a 2022 6261 7222 7d2c  [{"foo": "bar"},
-000016a0: 207b 2266 6f6f 223a 2022 6261 7a22 7d5d   {"foo": "baz"}]
-000016b0: 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f  , None, None, No
-000016c0: 6e65 2c20 4e6f 6e65 292c 0a20 2020 2020  ne, None),.     
-000016d0: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
-000016e0: 2032 2c0a 2020 2020 2020 2020 2020 2020   2,.            
-000016f0: 5b7b 2266 6f6f 223a 2022 6261 7222 7d2c  [{"foo": "bar"},
-00001700: 207b 2266 6f6f 223a 2022 6261 7a22 7d5d   {"foo": "baz"}]
-00001710: 2c0a 2020 2020 2020 2020 2020 2020 4e6f  ,.            No
-00001720: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00001730: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-00001740: 2020 5b22 666f 6f62 6172 222c 2022 6261    ["foobar", "ba
-00001750: 7262 617a 225d 2c0a 2020 2020 2020 2020  rbaz"],.        
-00001760: 2020 2020 5b22 666f 6f62 6172 222c 2022      ["foobar", "
-00001770: 6261 7262 617a 225d 2c0a 2020 2020 2020  barbaz"],.      
-00001780: 2020 292c 0a20 2020 205d 2c0a 290a 6465    ),.    ],.).de
-00001790: 6620 7465 7374 5f72 6573 6f6c 7665 5f6a  f test_resolve_j
-000017a0: 6f69 6e5f 6b65 7973 2873 697a 652c 2069  oin_keys(size, i
-000017b0: 6e70 7574 732c 2066 6565 6462 6163 6b5f  nputs, feedback_
-000017c0: 6964 2c20 6665 6564 6261 636b 5f6b 6579  id, feedback_key
-000017d0: 732c 206a 6f69 6e5f 6b65 792c 2065 7870  s, join_key, exp
-000017e0: 6563 7465 6429 3a0a 2020 2020 6173 7365  ected):.    asse
-000017f0: 7274 2028 0a20 2020 2020 2020 2063 6c69  rt (.        cli
-00001800: 656e 742e 5f72 6573 6f6c 7665 5f6a 6f69  ent._resolve_joi
-00001810: 6e5f 6b65 7973 280a 2020 2020 2020 2020  n_keys(.        
-00001820: 2020 2020 7369 7a65 2c0a 2020 2020 2020      size,.      
-00001830: 2020 2020 2020 696e 7075 7473 2c0a 2020        inputs,.  
-00001840: 2020 2020 2020 2020 2020 6665 6564 6261            feedba
-00001850: 636b 5f69 642c 0a20 2020 2020 2020 2020  ck_id,.         
-00001860: 2020 2066 6565 6462 6163 6b5f 6b65 7973     feedback_keys
-00001870: 2c0a 2020 2020 2020 2020 2020 2020 6a6f  ,.            jo
-00001880: 696e 5f6b 6579 2c0a 2020 2020 2020 2020  in_key,.        
-00001890: 290a 2020 2020 2020 2020 3d3d 2065 7870  ).        == exp
-000018a0: 6563 7465 640a 2020 2020 290a 0a0a 4070  ected.    )...@p
-000018b0: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
-000018c0: 6574 7269 7a65 280a 2020 2020 5b22 696e  etrize(.    ["in
-000018d0: 7075 7473 222c 2022 6665 6564 6261 636b  puts", "feedback
-000018e0: 5f69 6473 222c 2022 6665 6564 6261 636b  _ids", "feedback
-000018f0: 5f6b 6579 7322 2c20 226a 6f69 6e5f 6b65  _keys", "join_ke
-00001900: 7973 222c 2022 6572 726f 725f 7422 5d2c  ys", "error_t"],
-00001910: 0a20 2020 205b 0a20 2020 2020 2020 2028  .    [.        (
-00001920: 5b7b 2266 6f6f 223a 2022 6261 7222 7d5d  [{"foo": "bar"}]
-00001930: 2c20 5b7b 2269 6422 3a20 2231 3233 3435  , [{"id": "12345
-00001940: 227d 5d2c 205b 2266 6f6f 225d 2c20 4e6f  "}], ["foo"], No
-00001950: 6e65 2c20 4761 6e74 7279 4c6f 6767 696e  ne, GantryLoggin
-00001960: 6745 7863 6570 7469 6f6e 292c 0a20 2020  gException),.   
-00001970: 2020 2020 2028 5b7b 2266 6f6f 223a 2022       ([{"foo": "
-00001980: 6261 7222 7d5d 2c20 4e6f 6e65 2c20 5b22  bar"}], None, ["
-00001990: 666f 6f22 5d2c 205b 2262 6172 6261 7a22  foo"], ["barbaz"
-000019a0: 5d2c 2056 616c 7565 4572 726f 7229 2c0a  ], ValueError),.
-000019b0: 2020 2020 2020 2020 285b 7b22 666f 6f22          ([{"foo"
-000019c0: 3a20 2262 6172 227d 5d2c 205b 7b22 6964  : "bar"}], [{"id
-000019d0: 223a 2022 3132 3334 3522 7d5d 2c20 4e6f  ": "12345"}], No
-000019e0: 6e65 2c20 5b22 6261 7262 617a 225d 2c20  ne, ["barbaz"], 
-000019f0: 5661 6c75 6545 7272 6f72 292c 0a20 2020  ValueError),.   
-00001a00: 2020 2020 2028 5b7b 2266 6f6f 223a 2022       ([{"foo": "
-00001a10: 6261 7222 7d5d 2c20 5b7b 2269 6422 3a20  bar"}], [{"id": 
-00001a20: 2231 3233 3435 227d 5d2c 205b 2266 6f6f  "12345"}], ["foo
-00001a30: 225d 2c20 5b22 6261 7262 617a 225d 2c20  "], ["barbaz"], 
-00001a40: 5661 6c75 6545 7272 6f72 292c 0a20 2020  ValueError),.   
-00001a50: 205d 2c0a 290a 6465 6620 7465 7374 5f72   ],.).def test_r
-00001a60: 6573 6f6c 7665 5f6a 6f69 6e5f 6b65 7973  esolve_join_keys
-00001a70: 5f65 7272 6f72 2869 6e70 7574 732c 2066  _error(inputs, f
-00001a80: 6565 6462 6163 6b5f 6964 732c 2066 6565  eedback_ids, fee
-00001a90: 6462 6163 6b5f 6b65 7973 2c20 6a6f 696e  dback_keys, join
-00001aa0: 5f6b 6579 732c 2065 7272 6f72 5f74 293a  _keys, error_t):
-00001ab0: 0a20 2020 2077 6974 6820 7079 7465 7374  .    with pytest
-00001ac0: 2e72 6169 7365 7328 6572 726f 725f 7429  .raises(error_t)
-00001ad0: 3a0a 2020 2020 2020 2020 5f20 3d20 636c  :.        _ = cl
-00001ae0: 6965 6e74 2e5f 7265 736f 6c76 655f 6a6f  ient._resolve_jo
-00001af0: 696e 5f6b 6579 7328 0a20 2020 2020 2020  in_keys(.       
-00001b00: 2020 2020 2031 302c 0a20 2020 2020 2020       10,.       
-00001b10: 2020 2020 2069 6e70 7574 732c 0a20 2020       inputs,.   
-00001b20: 2020 2020 2020 2020 2066 6565 6462 6163           feedbac
-00001b30: 6b5f 6964 732c 0a20 2020 2020 2020 2020  k_ids,.         
-00001b40: 2020 2066 6565 6462 6163 6b5f 6b65 7973     feedback_keys
-00001b50: 2c0a 2020 2020 2020 2020 2020 2020 6a6f  ,.            jo
-00001b60: 696e 5f6b 6579 732c 0a20 2020 2020 2020  in_keys,.       
-00001b70: 2029 0a0a 0a64 6566 2074 6573 745f 7069   )...def test_pi
-00001b80: 6e67 5f66 6169 6c28 636c 695f 6f62 6a29  ng_fail(cli_obj)
-00001b90: 3a0a 2020 2020 636c 695f 6f62 6a2e 6c6f  :.    cli_obj.lo
-00001ba0: 675f 7374 6f72 652e 7374 6174 7573 203d  g_store.status =
-00001bb0: 2046 616c 7365 0a20 2020 2061 7373 6572   False.    asser
-00001bc0: 7420 6e6f 7420 636c 695f 6f62 6a2e 7069  t not cli_obj.pi
-00001bd0: 6e67 2829 0a0a 0a64 6566 2074 6573 745f  ng()...def test_
-00001be0: 7069 6e67 5f73 7563 6365 7373 2863 6c69  ping_success(cli
-00001bf0: 5f6f 626a 293a 0a20 2020 2063 6c69 5f6f  _obj):.    cli_o
-00001c00: 626a 2e6c 6f67 5f73 746f 7265 2e73 7461  bj.log_store.sta
-00001c10: 7475 7320 3d20 5472 7565 0a20 2020 2061  tus = True.    a
-00001c20: 7373 6572 7420 636c 695f 6f62 6a2e 7069  ssert cli_obj.pi
-00001c30: 6e67 2829 0a0a 0a40 6672 6565 7a65 5f74  ng()...@freeze_t
-00001c40: 696d 6528 4355 5252 454e 545f 5449 4d45  ime(CURRENT_TIME
-00001c50: 290a 4070 7974 6573 742e 6d61 726b 2e70  ).@pytest.mark.p
-00001c60: 6172 616d 6574 7269 7a65 2822 7461 6773  arametrize("tags
-00001c70: 222c 205b 7b22 656e 7622 3a20 226f 7665  ", [{"env": "ove
-00001c80: 7277 7269 7465 5f65 6e76 227d 2c20 7b7d  rwrite_env"}, {}
-00001c90: 2c20 4e6f 6e65 5d29 0a40 7079 7465 7374  , None]).@pytest
-00001ca0: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
-00001cb0: 6528 2274 696d 6573 7461 6d70 222c 205b  e("timestamp", [
-00001cc0: 4e6f 6e65 2c20 534f 4d45 5f54 494d 455d  None, SOME_TIME]
-00001cd0: 290a 4070 7974 6573 742e 6d61 726b 2e70  ).@pytest.mark.p
-00001ce0: 6172 616d 6574 7269 7a65 2822 6665 6564  arametrize("feed
-00001cf0: 6261 636b 5f76 6572 7369 6f6e 222c 205b  back_version", [
-00001d00: 4e6f 6e65 2c20 2231 2e32 2e33 222c 2031  None, "1.2.3", 1
-00001d10: 305d 290a 406d 6f63 6b2e 7061 7463 6828  0]).@mock.patch(
-00001d20: 2267 616e 7472 792e 6c6f 6767 6572 2e65  "gantry.logger.e
-00001d30: 7665 6e74 5f62 7569 6c64 6572 2e75 7569  vent_builder.uui
-00001d40: 642e 7575 6964 3422 290a 6465 6620 7465  d.uuid4").def te
-00001d50: 7374 5f6c 6f67 5f66 6565 6462 6163 6b5f  st_log_feedback_
-00001d60: 6576 656e 7428 6d6f 636b 5f75 7569 642c  event(mock_uuid,
-00001d70: 2066 6565 6462 6163 6b5f 7665 7273 696f   feedback_versio
-00001d80: 6e2c 2074 696d 6573 7461 6d70 2c20 7461  n, timestamp, ta
-00001d90: 6773 2c20 636c 695f 6f62 6a29 3a0a 2020  gs, cli_obj):.  
-00001da0: 2020 6d6f 636b 5f75 7569 642e 7265 7475    mock_uuid.retu
-00001db0: 726e 5f76 616c 7565 203d 2022 3132 3334  rn_value = "1234
-00001dc0: 3522 0a20 2020 2061 7373 6572 7420 280a  5".    assert (.
-00001dd0: 2020 2020 2020 2020 636c 695f 6f62 6a2e          cli_obj.
-00001de0: 5f6c 6f67 5f66 6565 6462 6163 6b5f 6576  _log_feedback_ev
-00001df0: 656e 7428 0a20 2020 2020 2020 2020 2020  ent(.           
-00001e00: 2061 7070 6c69 6361 7469 6f6e 3d22 666f   application="fo
-00001e10: 6f62 6172 222c 0a20 2020 2020 2020 2020  obar",.         
-00001e20: 2020 206a 6f69 6e5f 6b65 793d 2231 3233     join_key="123
-00001e30: 3435 3637 3839 3022 2c0a 2020 2020 2020  4567890",.      
-00001e40: 2020 2020 2020 6665 6564 6261 636b 3d7b        feedback={
-00001e50: 2276 616c 7565 223a 2022 6261 7222 7d2c  "value": "bar"},
+000002c0: 5f54 494d 455f 5354 522c 0a29 0a0a 5445  _TIME_STR,.)..TE
+000002d0: 5354 5f49 4e50 5554 5320 3d20 5b0a 2020  ST_INPUTS = [.  
+000002e0: 2020 5b7b 2241 223a 2031 3030 7d2c 207b    [{"A": 100}, {
+000002f0: 2241 223a 2031 3031 7d5d 2c0a 2020 2020  "A": 101}],.    
+00000300: 7064 2e44 6174 6146 7261 6d65 2e66 726f  pd.DataFrame.fro
+00000310: 6d5f 6469 6374 287b 2241 223a 205b 3130  m_dict({"A": [10
+00000320: 302c 2031 3031 5d7d 292c 0a20 2020 2070  0, 101]}),.    p
+00000330: 642e 5365 7269 6573 286e 616d 653d 2241  d.Series(name="A
+00000340: 222c 2064 6174 613d 5b31 3030 2c20 3130  ", data=[100, 10
+00000350: 315d 292c 0a20 2020 206e 702e 6172 7261  1]),.    np.arra
+00000360: 7928 5b7b 2241 223a 2031 3030 7d2c 207b  y([{"A": 100}, {
+00000370: 2241 223a 2031 3031 7d5d 292c 0a5d 0a54  "A": 101}]),.].T
+00000380: 4553 545f 4f55 5450 5554 5320 3d20 5b0a  EST_OUTPUTS = [.
+00000390: 2020 2020 5b7b 2242 223a 2033 3030 7d2c      [{"B": 300},
+000003a0: 207b 2242 223a 2033 3031 7d5d 2c0a 2020   {"B": 301}],.  
+000003b0: 2020 7064 2e44 6174 6146 7261 6d65 2e66    pd.DataFrame.f
+000003c0: 726f 6d5f 6469 6374 287b 2242 223a 205b  rom_dict({"B": [
+000003d0: 3330 302c 2033 3031 5d7d 292c 0a20 2020  300, 301]}),.   
+000003e0: 2070 642e 5365 7269 6573 286e 616d 653d   pd.Series(name=
+000003f0: 2242 222c 2064 6174 613d 5b33 3030 2c20  "B", data=[300, 
+00000400: 3330 315d 292c 0a20 2020 206e 702e 6172  301]),.    np.ar
+00000410: 7261 7928 5b7b 2242 223a 2033 3030 7d2c  ray([{"B": 300},
+00000420: 207b 2242 223a 2033 3031 7d5d 292c 0a5d   {"B": 301}]),.]
+00000430: 0a54 4553 545f 4645 4544 4241 434b 5320  .TEST_FEEDBACKS 
+00000440: 3d20 5b0a 2020 2020 5b7b 2241 223a 2032  = [.    [{"A": 2
+00000450: 3030 7d2c 207b 2241 223a 2032 3031 7d5d  00}, {"A": 201}]
+00000460: 2c0a 2020 2020 7064 2e44 6174 6146 7261  ,.    pd.DataFra
+00000470: 6d65 2e66 726f 6d5f 6469 6374 287b 2241  me.from_dict({"A
+00000480: 223a 205b 3230 302c 2032 3031 5d7d 292c  ": [200, 201]}),
+00000490: 0a20 2020 2070 642e 5365 7269 6573 286e  .    pd.Series(n
+000004a0: 616d 653d 2241 222c 2064 6174 613d 5b32  ame="A", data=[2
+000004b0: 3030 2c20 3230 315d 292c 0a20 2020 206e  00, 201]),.    n
+000004c0: 702e 6172 7261 7928 5b7b 2241 223a 2032  p.array([{"A": 2
+000004d0: 3030 7d2c 207b 2241 223a 2032 3031 7d5d  00}, {"A": 201}]
+000004e0: 292c 0a5d 0a23 2057 6520 7573 6520 636f  ),.].# We use co
+000004f0: 6d62 696e 6564 2069 6e70 7574 732c 206f  mbined inputs, o
+00000500: 7574 7075 7473 2c20 616e 6420 6665 6564  utputs, and feed
+00000510: 6261 636b 2074 6f20 6176 6f69 6420 616e  back to avoid an
+00000520: 2065 7870 6f6e 656e 7469 616c 206e 756d   exponential num
+00000530: 6265 7220 6f66 2074 6573 7420 6361 7365  ber of test case
+00000540: 730a 5445 5354 5f49 4e50 5554 535f 4f55  s.TEST_INPUTS_OU
+00000550: 5450 5554 535f 4645 4544 4241 434b 5320  TPUTS_FEEDBACKS 
+00000560: 3d20 6c69 7374 287a 6970 2854 4553 545f  = list(zip(TEST_
+00000570: 494e 5055 5453 2c20 5445 5354 5f4f 5554  INPUTS, TEST_OUT
+00000580: 5055 5453 2c20 5445 5354 5f46 4545 4442  PUTS, TEST_FEEDB
+00000590: 4143 4b53 2929 0a0a 5445 5354 5f54 4147  ACKS))..TEST_TAG
+000005a0: 5320 3d20 5b20 2023 2022 7461 6773 2c20  S = [  # "tags, 
+000005b0: 726f 775f 7461 6773 2c20 676c 6f62 616c  row_tags, global
+000005c0: 5f74 6167 732c 2065 7870 6563 7465 645f  _tags, expected_
+000005d0: 7461 6773 5f70 6172 616d 220a 2020 2020  tags_param".    
+000005e0: 284e 6f6e 652c 204e 6f6e 652c 204e 6f6e  (None, None, Non
+000005f0: 652c 205b 7b22 656e 7622 3a20 2274 6573  e, [{"env": "tes
+00000600: 7422 7d2c 207b 2265 6e76 223a 2022 7465  t"}, {"env": "te
+00000610: 7374 227d 5d29 2c0a 2020 2020 280a 2020  st"}]),.    (.  
+00000620: 2020 2020 2020 7b22 6261 7222 3a20 2262        {"bar": "b
+00000630: 6172 227d 2c0a 2020 2020 2020 2020 4e6f  ar"},.        No
+00000640: 6e65 2c0a 2020 2020 2020 2020 4e6f 6e65  ne,.        None
+00000650: 2c0a 2020 2020 2020 2020 5b7b 2262 6172  ,.        [{"bar
+00000660: 223a 2022 6261 7222 2c20 2265 6e76 223a  ": "bar", "env":
+00000670: 2022 7465 7374 227d 2c20 7b22 6261 7222   "test"}, {"bar"
+00000680: 3a20 2262 6172 222c 2022 656e 7622 3a20  : "bar", "env": 
+00000690: 2274 6573 7422 7d5d 2c0a 2020 2020 292c  "test"}],.    ),
+000006a0: 0a20 2020 2028 0a20 2020 2020 2020 207b  .    (.        {
+000006b0: 2262 6172 223a 2022 6261 7222 7d2c 0a20  "bar": "bar"},. 
+000006c0: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
+000006d0: 2020 2020 207b 2266 6f6f 223a 2022 666f       {"foo": "fo
+000006e0: 6f22 7d2c 0a20 2020 2020 2020 205b 0a20  o"},.        [. 
+000006f0: 2020 2020 2020 2020 2020 207b 2262 6172             {"bar
+00000700: 223a 2022 6261 7222 2c20 2265 6e76 223a  ": "bar", "env":
+00000710: 2022 7465 7374 222c 2022 666f 6f22 3a20   "test", "foo": 
+00000720: 2266 6f6f 227d 2c0a 2020 2020 2020 2020  "foo"},.        
+00000730: 2020 2020 7b22 6261 7222 3a20 2262 6172      {"bar": "bar
+00000740: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
+00000750: 2c20 2266 6f6f 223a 2022 666f 6f22 7d2c  , "foo": "foo"},
+00000760: 0a20 2020 2020 2020 205d 2c0a 2020 2020  .        ],.    
+00000770: 292c 0a20 2020 2028 0a20 2020 2020 2020  ),.    (.       
+00000780: 205b 7b22 6261 7222 3a20 2262 6172 227d   [{"bar": "bar"}
+00000790: 2c20 7b22 6261 7222 3a20 2262 617a 227d  , {"bar": "baz"}
+000007a0: 5d2c 0a20 2020 2020 2020 204e 6f6e 652c  ],.        None,
+000007b0: 0a20 2020 2020 2020 204e 6f6e 652c 0a20  .        None,. 
+000007c0: 2020 2020 2020 205b 7b22 6261 7222 3a20         [{"bar": 
+000007d0: 2262 6172 222c 2022 656e 7622 3a20 2274  "bar", "env": "t
+000007e0: 6573 7422 7d2c 207b 2262 6172 223a 2022  est"}, {"bar": "
+000007f0: 6261 7a22 2c20 2265 6e76 223a 2022 7465  baz", "env": "te
+00000800: 7374 227d 5d2c 0a20 2020 2029 2c0a 2020  st"}],.    ),.  
+00000810: 2020 280a 2020 2020 2020 2020 4e6f 6e65    (.        None
+00000820: 2c0a 2020 2020 2020 2020 5b7b 2262 6172  ,.        [{"bar
+00000830: 223a 2022 6261 7222 7d2c 207b 2262 6172  ": "bar"}, {"bar
+00000840: 223a 2022 6261 7a22 7d5d 2c0a 2020 2020  ": "baz"}],.    
+00000850: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
+00000860: 2020 5b7b 2262 6172 223a 2022 6261 7222    [{"bar": "bar"
+00000870: 2c20 2265 6e76 223a 2022 7465 7374 227d  , "env": "test"}
+00000880: 2c20 7b22 6261 7222 3a20 2262 617a 222c  , {"bar": "baz",
+00000890: 2022 656e 7622 3a20 2274 6573 7422 7d5d   "env": "test"}]
+000008a0: 2c0a 2020 2020 292c 0a20 2020 2028 0a20  ,.    ),.    (. 
+000008b0: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
+000008c0: 2020 2020 205b 7b22 6261 7222 3a20 2262       [{"bar": "b
+000008d0: 6172 227d 2c20 7b22 6261 7222 3a20 2262  ar"}, {"bar": "b
+000008e0: 617a 227d 5d2c 0a20 2020 2020 2020 207b  az"}],.        {
+000008f0: 2266 6f6f 223a 2022 666f 6f22 7d2c 0a20  "foo": "foo"},. 
+00000900: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+00000910: 2020 2020 207b 2262 6172 223a 2022 6261       {"bar": "ba
+00000920: 7222 2c20 2265 6e76 223a 2022 7465 7374  r", "env": "test
+00000930: 222c 2022 666f 6f22 3a20 2266 6f6f 227d  ", "foo": "foo"}
+00000940: 2c0a 2020 2020 2020 2020 2020 2020 7b22  ,.            {"
+00000950: 6261 7222 3a20 2262 617a 222c 2022 656e  bar": "baz", "en
+00000960: 7622 3a20 2274 6573 7422 2c20 2266 6f6f  v": "test", "foo
+00000970: 223a 2022 666f 6f22 7d2c 0a20 2020 2020  ": "foo"},.     
+00000980: 2020 205d 2c0a 2020 2020 292c 0a20 2020     ],.    ),.   
+00000990: 2028 0a20 2020 2020 2020 207b 2266 6f6f   (.        {"foo
+000009a0: 223a 2022 666f 6f22 7d2c 0a20 2020 2020  ": "foo"},.     
+000009b0: 2020 205b 7b22 6261 7222 3a20 2262 6172     [{"bar": "bar
+000009c0: 227d 2c20 7b22 6261 7222 3a20 2262 617a  "}, {"bar": "baz
+000009d0: 227d 5d2c 0a20 2020 2020 2020 204e 6f6e  "}],.        Non
+000009e0: 652c 0a20 2020 2020 2020 205b 0a20 2020  e,.        [.   
+000009f0: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
+00000a00: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
+00000a10: 7465 7374 222c 2022 666f 6f22 3a20 2266  test", "foo": "f
+00000a20: 6f6f 227d 2c0a 2020 2020 2020 2020 2020  oo"},.          
+00000a30: 2020 7b22 6261 7222 3a20 2262 617a 222c    {"bar": "baz",
+00000a40: 2022 656e 7622 3a20 2274 6573 7422 2c20   "env": "test", 
+00000a50: 2266 6f6f 223a 2022 666f 6f22 7d2c 0a20  "foo": "foo"},. 
+00000a60: 2020 2020 2020 205d 2c0a 2020 2020 292c         ],.    ),
+00000a70: 0a20 2020 2028 0a20 2020 2020 2020 207b  .    (.        {
+00000a80: 2262 6172 223a 2022 6261 7222 7d2c 0a20  "bar": "bar"},. 
+00000a90: 2020 2020 2020 205b 7b22 666f 6f22 3a20         [{"foo": 
+00000aa0: 2266 6f6f 227d 2c20 7b22 6261 7a22 3a20  "foo"}, {"baz": 
+00000ab0: 2262 617a 227d 5d2c 0a20 2020 2020 2020  "baz"}],.       
+00000ac0: 207b 2265 6e76 223a 2022 666f 6f62 6172   {"env": "foobar
+00000ad0: 227d 2c0a 2020 2020 2020 2020 5b0a 2020  "},.        [.  
+00000ae0: 2020 2020 2020 2020 2020 7b22 6261 7222            {"bar"
+00000af0: 3a20 2262 6172 222c 2022 656e 7622 3a20  : "bar", "env": 
+00000b00: 2266 6f6f 6261 7222 2c20 2266 6f6f 223a  "foobar", "foo":
+00000b10: 2022 666f 6f22 7d2c 0a20 2020 2020 2020   "foo"},.       
+00000b20: 2020 2020 207b 2262 6172 223a 2022 6261       {"bar": "ba
+00000b30: 7222 2c20 2265 6e76 223a 2022 666f 6f62  r", "env": "foob
+00000b40: 6172 222c 2022 6261 7a22 3a20 2262 617a  ar", "baz": "baz
+00000b50: 227d 2c0a 2020 2020 2020 2020 5d2c 0a20  "},.        ],. 
+00000b60: 2020 2029 2c0a 2020 2020 280a 2020 2020     ),.    (.    
+00000b70: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
+00000b80: 2020 6e70 2e61 7272 6179 285b 7b22 6261    np.array([{"ba
+00000b90: 7222 3a20 2262 6172 227d 2c20 7b22 6261  r": "bar"}, {"ba
+00000ba0: 7222 3a20 2262 617a 227d 5d29 2c0a 2020  r": "baz"}]),.  
+00000bb0: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
+00000bc0: 2020 2020 5b7b 2262 6172 223a 2022 6261      [{"bar": "ba
+00000bd0: 7222 2c20 2265 6e76 223a 2022 7465 7374  r", "env": "test
+00000be0: 227d 2c20 7b22 6261 7222 3a20 2262 617a  "}, {"bar": "baz
+00000bf0: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
+00000c00: 7d5d 2c0a 2020 2020 292c 0a20 2020 2028  }],.    ),.    (
+00000c10: 0a20 2020 2020 2020 204e 6f6e 652c 0a20  .        None,. 
+00000c20: 2020 2020 2020 2070 642e 5365 7269 6573         pd.Series
+00000c30: 285b 2262 6172 222c 2022 6261 7a22 5d2c  (["bar", "baz"],
+00000c40: 206e 616d 653d 2262 6172 2229 2c0a 2020   name="bar"),.  
+00000c50: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
+00000c60: 2020 2020 5b7b 2262 6172 223a 2022 6261      [{"bar": "ba
+00000c70: 7222 2c20 2265 6e76 223a 2022 7465 7374  r", "env": "test
+00000c80: 227d 2c20 7b22 6261 7222 3a20 2262 617a  "}, {"bar": "baz
+00000c90: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
+00000ca0: 7d5d 2c0a 2020 2020 292c 0a20 2020 2028  }],.    ),.    (
+00000cb0: 0a20 2020 2020 2020 204e 6f6e 652c 0a20  .        None,. 
+00000cc0: 2020 2020 2020 2070 642e 4461 7461 4672         pd.DataFr
+00000cd0: 616d 6528 7b22 6261 7222 3a20 5b22 6261  ame({"bar": ["ba
+00000ce0: 7222 2c20 2262 617a 225d 7d29 2c0a 2020  r", "baz"]}),.  
+00000cf0: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
+00000d00: 2020 2020 5b7b 2262 6172 223a 2022 6261      [{"bar": "ba
+00000d10: 7222 2c20 2265 6e76 223a 2022 7465 7374  r", "env": "test
+00000d20: 227d 2c20 7b22 6261 7222 3a20 2262 617a  "}, {"bar": "baz
+00000d30: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
+00000d40: 7d5d 2c0a 2020 2020 292c 0a5d 0a0a 0a63  }],.    ),.]...c
+00000d50: 6c61 7373 2054 6573 744c 6f67 5374 6f72  lass TestLogStor
+00000d60: 6528 4261 7365 4c6f 6753 746f 7265 293a  e(BaseLogStore):
+00000d70: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00000d80: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00000d90: 2073 656c 662e 6c6f 6773 203d 205b 5d0a   self.logs = [].
+00000da0: 2020 2020 2020 2020 7365 6c66 2e73 7461          self.sta
+00000db0: 7475 7320 3d20 4661 6c73 650a 0a20 2020  tus = False..   
+00000dc0: 2064 6566 206c 6f67 5f62 6174 6368 2873   def log_batch(s
+00000dd0: 656c 662c 2061 7070 6c69 6361 7469 6f6e  elf, application
+00000de0: 2c20 6576 656e 7473 2920 2d3e 204e 6f6e  , events) -> Non
+00000df0: 653a 0a20 2020 2020 2020 2073 656c 662e  e:.        self.
+00000e00: 6c6f 6773 2e61 7070 656e 6428 7b22 6170  logs.append({"ap
+00000e10: 706c 6963 6174 696f 6e22 3a20 6170 706c  plication": appl
+00000e20: 6963 6174 696f 6e2c 2022 6576 656e 7473  ication, "events
+00000e30: 223a 2065 7665 6e74 737d 290a 0a20 2020  ": events})..   
+00000e40: 2064 6566 2070 696e 6728 7365 6c66 2920   def ping(self) 
+00000e50: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
+00000e60: 2072 6574 7572 6e20 7365 6c66 2e73 7461   return self.sta
+00000e70: 7475 730a 0a0a 4070 7974 6573 742e 6669  tus...@pytest.fi
+00000e80: 7874 7572 6528 7363 6f70 653d 2266 756e  xture(scope="fun
+00000e90: 6374 696f 6e22 290a 6465 6620 6c6f 675f  ction").def log_
+00000ea0: 7374 6f72 6528 293a 0a20 2020 2072 6574  store():.    ret
+00000eb0: 7572 6e20 5465 7374 4c6f 6753 746f 7265  urn TestLogStore
+00000ec0: 2829 0a0a 0a40 7079 7465 7374 2e66 6978  ()...@pytest.fix
+00000ed0: 7475 7265 2873 636f 7065 3d22 6675 6e63  ture(scope="func
+00000ee0: 7469 6f6e 2229 0a64 6566 2063 6c69 5f6f  tion").def cli_o
+00000ef0: 626a 286c 6f67 5f73 746f 7265 293a 0a20  bj(log_store):. 
+00000f00: 2020 2072 6574 7572 6e20 636c 6965 6e74     return client
+00000f10: 2e47 616e 7472 7928 6c6f 675f 7374 6f72  .Gantry(log_stor
+00000f20: 653d 6c6f 675f 7374 6f72 652c 2065 6e76  e=log_store, env
+00000f30: 6972 6f6e 6d65 6e74 3d22 7465 7374 222c  ironment="test",
+00000f40: 206c 6f67 6769 6e67 5f6c 6576 656c 3d22   logging_level="
+00000f50: 4445 4255 4722 290a 0a0a 4070 7974 6573  DEBUG")...@pytes
+00000f60: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+00000f70: 7a65 280a 2020 2020 2265 6e76 2c20 7461  ze(.    "env, ta
+00000f80: 6773 2c20 6578 7065 6374 6564 222c 0a20  gs, expected",. 
+00000f90: 2020 205b 0a20 2020 2020 2020 2028 2274     [.        ("t
+00000fa0: 6573 7422 2c20 7b7d 2c20 7b22 656e 7622  est", {}, {"env"
+00000fb0: 3a20 2274 6573 7422 7d29 2c0a 2020 2020  : "test"}),.    
+00000fc0: 2020 2020 2822 7465 7374 222c 207b 2266      ("test", {"f
+00000fd0: 6f6f 223a 2022 6261 7222 7d2c 207b 2266  oo": "bar"}, {"f
+00000fe0: 6f6f 223a 2022 6261 7222 2c20 2265 6e76  oo": "bar", "env
+00000ff0: 223a 2022 7465 7374 227d 292c 0a20 2020  ": "test"}),.   
+00001000: 2020 2020 2028 2274 6573 7422 2c20 7b22       ("test", {"
+00001010: 656e 7622 3a20 226c 6f63 616c 227d 2c20  env": "local"}, 
+00001020: 7b22 656e 7622 3a20 226c 6f63 616c 227d  {"env": "local"}
+00001030: 292c 0a20 2020 2020 2020 2028 2274 6573  ),.        ("tes
+00001040: 7422 2c20 7b22 666f 6f22 3a20 2262 6172  t", {"foo": "bar
+00001050: 222c 2022 656e 7622 3a20 226c 6f63 616c  ", "env": "local
+00001060: 227d 2c20 7b22 666f 6f22 3a20 2262 6172  "}, {"foo": "bar
+00001070: 222c 2022 656e 7622 3a20 226c 6f63 616c  ", "env": "local
+00001080: 227d 292c 0a20 2020 205d 2c0a 290a 6465  "}),.    ],.).de
+00001090: 6620 7465 7374 5f75 7064 6174 655f 7461  f test_update_ta
+000010a0: 6773 5f77 6974 685f 656e 7628 656e 762c  gs_with_env(env,
+000010b0: 2074 6167 732c 2065 7870 6563 7465 6429   tags, expected)
+000010c0: 3a0a 2020 2020 636c 6965 6e74 2e5f 7570  :.    client._up
+000010d0: 6461 7465 5f74 6167 735f 7769 7468 5f65  date_tags_with_e
+000010e0: 6e76 2865 6e76 2c20 7461 6773 290a 2020  nv(env, tags).  
+000010f0: 2020 6173 7365 7274 2074 6167 7320 3d3d    assert tags ==
+00001100: 2065 7870 6563 7465 640a 0a0a 406d 6f63   expected...@moc
+00001110: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
+00001120: 6c6f 6767 6572 2e63 6c69 656e 742e 7575  logger.client.uu
+00001130: 6964 2e75 7569 6434 2229 0a64 6566 2074  id.uuid4").def t
+00001140: 6573 745f 6465 6661 756c 745f 6a6f 696e  est_default_join
+00001150: 5f6b 6579 5f67 656e 286d 6f63 6b5f 7575  _key_gen(mock_uu
+00001160: 6964 293a 0a20 2020 206d 6f63 6b5f 7575  id):.    mock_uu
+00001170: 6964 2e72 6574 7572 6e5f 7661 6c75 6520  id.return_value 
+00001180: 3d20 2231 3233 3435 220a 2020 2020 6173  = "12345".    as
+00001190: 7365 7274 2063 6c69 656e 742e 5f64 6566  sert client._def
+000011a0: 6175 6c74 5f6a 6f69 6e5f 6b65 795f 6765  ault_join_key_ge
+000011b0: 6e28 2920 3d3d 2022 3132 3334 3522 0a0a  n() == "12345"..
+000011c0: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
+000011d0: 7261 6d65 7472 697a 6528 2273 616d 706c  rametrize("sampl
+000011e0: 655f 7261 7465 222c 205b 2d31 2c20 3130  e_rate", [-1, 10
+000011f0: 2c20 312e 315d 290a 6465 6620 7465 7374  , 1.1]).def test
+00001200: 5f73 616d 706c 655f 7265 636f 7264 735f  _sample_records_
+00001210: 6572 726f 7228 7361 6d70 6c65 5f72 6174  error(sample_rat
+00001220: 6529 3a0a 2020 2020 7769 7468 2070 7974  e):.    with pyt
+00001230: 6573 742e 7261 6973 6573 2841 7373 6572  est.raises(Asser
+00001240: 7469 6f6e 4572 726f 7229 3a0a 2020 2020  tionError):.    
+00001250: 2020 2020 636c 6965 6e74 2e5f 7361 6d70      client._samp
+00001260: 6c65 5f72 6563 6f72 6473 2831 302c 2073  le_records(10, s
+00001270: 616d 706c 655f 7261 7465 2c20 4e6f 6e65  ample_rate, None
+00001280: 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f  , None, None, No
+00001290: 6e65 2c20 4e6f 6e65 2c20 4e6f 6e65 290a  ne, None, None).
+000012a0: 0a0a 4070 7974 6573 742e 6d61 726b 2e70  ..@pytest.mark.p
+000012b0: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
+000012c0: 5b22 7361 6d70 6c65 222c 2022 6b77 6172  ["sample", "kwar
+000012d0: 6773 222c 2022 6578 7065 6374 6564 225d  gs", "expected"]
+000012e0: 2c0a 2020 2020 5b0a 2020 2020 2020 2020  ,.    [.        
+000012f0: 280a 2020 2020 2020 2020 2020 2020 5b32  (.            [2
+00001300: 2c20 332c 2034 2c20 355d 2c0a 2020 2020  , 3, 4, 5],.    
+00001310: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+00001320: 2020 2020 2020 2020 2020 2269 6e70 7574            "input
+00001330: 7322 3a20 4f4e 455f 544f 5f54 454e 2c0a  s": ONE_TO_TEN,.
+00001340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001350: 226f 7574 7075 7473 223a 204f 4e45 5f54  "outputs": ONE_T
+00001360: 4f5f 5445 4e2c 0a20 2020 2020 2020 2020  O_TEN,.         
+00001370: 2020 2020 2020 2022 6665 6564 6261 636b         "feedback
+00001380: 7322 3a20 4f4e 455f 544f 5f54 454e 2c0a  s": ONE_TO_TEN,.
+00001390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000013a0: 226a 6f69 6e5f 6b65 7973 223a 204f 4e45  "join_keys": ONE
+000013b0: 5f54 4f5f 5445 4e2c 0a20 2020 2020 2020  _TO_TEN,.       
+000013c0: 2020 2020 2020 2020 2022 7469 6d65 7374           "timest
+000013d0: 616d 7073 223a 204f 4e45 5f54 4f5f 5445  amps": ONE_TO_TE
+000013e0: 4e2c 0a20 2020 2020 2020 2020 2020 2020  N,.             
+000013f0: 2020 2022 7461 6773 223a 204f 4e45 5f54     "tags": ONE_T
+00001400: 4f5f 5445 4e2c 0a20 2020 2020 2020 2020  O_TEN,.         
+00001410: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+00001420: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
+00001430: 2020 2020 5b33 2c20 342c 2035 2c20 365d      [3, 4, 5, 6]
+00001440: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00001450: 2020 5b33 2c20 342c 2035 2c20 365d 2c0a    [3, 4, 5, 6],.
+00001460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001470: 5b33 2c20 342c 2035 2c20 365d 2c0a 2020  [3, 4, 5, 6],.  
+00001480: 2020 2020 2020 2020 2020 2020 2020 5b33                [3
+00001490: 2c20 342c 2035 2c20 365d 2c0a 2020 2020  , 4, 5, 6],.    
+000014a0: 2020 2020 2020 2020 2020 2020 5b33 2c20              [3, 
+000014b0: 342c 2035 2c20 365d 2c0a 2020 2020 2020  4, 5, 6],.      
+000014c0: 2020 2020 2020 2020 2020 5b33 2c20 342c            [3, 4,
+000014d0: 2035 2c20 365d 2c0a 2020 2020 2020 2020   5, 6],.        
+000014e0: 2020 2020 292c 0a20 2020 2020 2020 2029      ),.        )
+000014f0: 2c0a 2020 2020 2020 2020 280a 2020 2020  ,.        (.    
+00001500: 2020 2020 2020 2020 5b37 5d2c 0a20 2020          [7],.   
+00001510: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+00001520: 2020 2020 2020 2020 2020 2022 696e 7075             "inpu
+00001530: 7473 223a 204f 4e45 5f54 4f5f 5445 4e2c  ts": ONE_TO_TEN,
+00001540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001550: 2022 6f75 7470 7574 7322 3a20 4f4e 455f   "outputs": ONE_
+00001560: 544f 5f54 454e 2c0a 2020 2020 2020 2020  TO_TEN,.        
+00001570: 2020 2020 2020 2020 2266 6565 6462 6163          "feedbac
+00001580: 6b73 223a 204e 6f6e 652c 0a20 2020 2020  ks": None,.     
+00001590: 2020 2020 2020 2020 2020 2022 6a6f 696e             "join
+000015a0: 5f6b 6579 7322 3a20 4f4e 455f 544f 5f54  _keys": ONE_TO_T
+000015b0: 454e 2c0a 2020 2020 2020 2020 2020 2020  EN,.            
+000015c0: 2020 2020 2274 696d 6573 7461 6d70 7322      "timestamps"
+000015d0: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
+000015e0: 2020 2020 2020 2020 2274 6167 7322 3a20          "tags": 
+000015f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+00001600: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
+00001610: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00001620: 2020 205b 385d 2c0a 2020 2020 2020 2020     [8],.        
+00001630: 2020 2020 2020 2020 5b38 5d2c 0a20 2020          [8],.   
+00001640: 2020 2020 2020 2020 2020 2020 204e 6f6e               Non
+00001650: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00001660: 2020 205b 385d 2c0a 2020 2020 2020 2020     [8],.        
+00001670: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
+00001680: 2020 2020 2020 2020 2020 2020 2020 4e6f                No
+00001690: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+000016a0: 292c 0a20 2020 2020 2020 2029 2c0a 2020  ),.        ),.  
+000016b0: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
+000016c0: 2020 2020 5b36 2c20 325d 2c0a 2020 2020      [6, 2],.    
+000016d0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+000016e0: 2020 2020 2020 2020 2020 2269 6e70 7574            "input
+000016f0: 7322 3a20 4e6f 6e65 2c0a 2020 2020 2020  s": None,.      
+00001700: 2020 2020 2020 2020 2020 226f 7574 7075            "outpu
+00001710: 7473 223a 204e 6f6e 652c 0a20 2020 2020  ts": None,.     
+00001720: 2020 2020 2020 2020 2020 2022 6665 6564             "feed
+00001730: 6261 636b 7322 3a20 4e6f 6e65 2c0a 2020  backs": None,.  
+00001740: 2020 2020 2020 2020 2020 2020 2020 226a                "j
+00001750: 6f69 6e5f 6b65 7973 223a 204f 4e45 5f54  oin_keys": ONE_T
+00001760: 4f5f 5445 4e2c 0a20 2020 2020 2020 2020  O_TEN,.         
+00001770: 2020 2020 2020 2022 7469 6d65 7374 616d         "timestam
+00001780: 7073 223a 204e 6f6e 652c 0a20 2020 2020  ps": None,.     
+00001790: 2020 2020 2020 2020 2020 2022 7461 6773             "tags
+000017a0: 223a 204f 4e45 5f54 4f5f 5445 4e2c 0a20  ": ONE_TO_TEN,. 
+000017b0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+000017c0: 2020 2020 2020 2020 2020 280a 2020 2020            (.    
+000017d0: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
+000017e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000017f0: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
+00001800: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
+00001810: 2020 2020 2020 2020 2020 2020 2020 5b33                [3
+00001820: 2c20 375d 2c0a 2020 2020 2020 2020 2020  , 7],.          
+00001830: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
+00001840: 2020 2020 2020 2020 2020 2020 5b33 2c20              [3, 
+00001850: 375d 2c0a 2020 2020 2020 2020 2020 2020  7],.            
+00001860: 292c 0a20 2020 2020 2020 2029 2c0a 2020  ),.        ),.  
+00001870: 2020 5d2c 0a29 0a40 6d6f 636b 2e70 6174    ],.).@mock.pat
+00001880: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
+00001890: 722e 636c 6965 6e74 2e72 616e 646f 6d2e  r.client.random.
+000018a0: 7361 6d70 6c65 2229 0a64 6566 2074 6573  sample").def tes
+000018b0: 745f 7361 6d70 6c65 5f72 6563 6f72 6473  t_sample_records
+000018c0: 286d 6f63 6b5f 7361 6d70 6c65 2c20 7361  (mock_sample, sa
+000018d0: 6d70 6c65 2c20 6b77 6172 6773 2c20 6578  mple, kwargs, ex
+000018e0: 7065 6374 6564 293a 0a20 2020 206d 6f63  pected):.    moc
+000018f0: 6b5f 7361 6d70 6c65 2e72 6574 7572 6e5f  k_sample.return_
+00001900: 7661 6c75 6520 3d20 7361 6d70 6c65 0a20  value = sample. 
+00001910: 2020 2061 7373 6572 7420 636c 6965 6e74     assert client
+00001920: 2e5f 7361 6d70 6c65 5f72 6563 6f72 6473  ._sample_records
+00001930: 2831 302c 2030 2e35 2c20 2a2a 6b77 6172  (10, 0.5, **kwar
+00001940: 6773 2920 3d3d 2065 7870 6563 7465 640a  gs) == expected.
+00001950: 2020 2020 6d6f 636b 5f73 616d 706c 652e      mock_sample.
+00001960: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
+00001970: 6365 5f77 6974 6828 7261 6e67 6528 302c  ce_with(range(0,
+00001980: 2031 3029 2c20 3529 0a0a 0a40 7079 7465   10), 5)...@pyte
+00001990: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
+000019a0: 697a 6528 0a20 2020 205b 2269 6e70 7574  ize(.    ["input
+000019b0: 7322 2c20 2266 6565 6462 6163 6b5f 6964  s", "feedback_id
+000019c0: 222c 2022 6665 6564 6261 636b 5f6b 6579  ", "feedback_key
+000019d0: 7322 2c20 226a 6f69 6e5f 6b65 7922 2c20  s", "join_key", 
+000019e0: 2265 7870 6563 7465 6422 5d2c 0a20 2020  "expected"],.   
+000019f0: 205b 0a20 2020 2020 2020 2028 7b22 666f   [.        ({"fo
+00001a00: 6f22 3a20 2262 6172 227d 2c20 7b22 6964  o": "bar"}, {"id
+00001a10: 223a 2022 3132 3334 3522 7d2c 204e 6f6e  ": "12345"}, Non
+00001a20: 652c 204e 6f6e 652c 2022 3830 6566 3636  e, None, "80ef66
+00001a30: 6265 3831 6462 6162 6133 3064 6232 3564  be81dbaba30db25d
+00001a40: 3133 3336 3231 3764 3064 2229 2c0a 2020  1336217d0d"),.  
+00001a50: 2020 2020 2020 287b 2266 6f6f 223a 2022        ({"foo": "
+00001a60: 6261 7222 7d2c 204e 6f6e 652c 205b 2266  bar"}, None, ["f
+00001a70: 6f6f 225d 2c20 4e6f 6e65 2c20 2234 3261  oo"], None, "42a
+00001a80: 3562 3762 3939 6233 3731 3764 3165 6165  5b7b99b3717d1eae
+00001a90: 6237 3261 3639 3438 6461 6263 3922 292c  b72a6948dabc9"),
+00001aa0: 0a20 2020 2020 2020 2028 7b22 666f 6f22  .        ({"foo"
+00001ab0: 3a20 2262 6172 227d 2c20 4e6f 6e65 2c20  : "bar"}, None, 
+00001ac0: 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f 6e65  None, None, None
+00001ad0: 292c 0a20 2020 2020 2020 2028 7b22 666f  ),.        ({"fo
+00001ae0: 6f22 3a20 2262 6172 227d 2c20 4e6f 6e65  o": "bar"}, None
+00001af0: 2c20 4e6f 6e65 2c20 2262 6172 6261 7a22  , None, "barbaz"
+00001b00: 2c20 2262 6172 6261 7a22 292c 0a20 2020  , "barbaz"),.   
+00001b10: 205d 2c0a 290a 6465 6620 7465 7374 5f72   ],.).def test_r
+00001b20: 6573 6f6c 7665 5f6a 6f69 6e5f 6b65 7928  esolve_join_key(
+00001b30: 696e 7075 7473 2c20 6665 6564 6261 636b  inputs, feedback
+00001b40: 5f69 642c 2066 6565 6462 6163 6b5f 6b65  _id, feedback_ke
+00001b50: 7973 2c20 6a6f 696e 5f6b 6579 2c20 6578  ys, join_key, ex
+00001b60: 7065 6374 6564 293a 0a20 2020 2061 7373  pected):.    ass
+00001b70: 6572 7420 280a 2020 2020 2020 2020 636c  ert (.        cl
+00001b80: 6965 6e74 2e5f 7265 736f 6c76 655f 6a6f  ient._resolve_jo
+00001b90: 696e 5f6b 6579 280a 2020 2020 2020 2020  in_key(.        
+00001ba0: 2020 2020 696e 7075 7473 2c0a 2020 2020      inputs,.    
+00001bb0: 2020 2020 2020 2020 6665 6564 6261 636b          feedback
+00001bc0: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
+00001bd0: 2066 6565 6462 6163 6b5f 6b65 7973 2c0a   feedback_keys,.
+00001be0: 2020 2020 2020 2020 2020 2020 6a6f 696e              join
+00001bf0: 5f6b 6579 2c0a 2020 2020 2020 2020 290a  _key,.        ).
+00001c00: 2020 2020 2020 2020 3d3d 2065 7870 6563          == expec
+00001c10: 7465 640a 2020 2020 290a 0a0a 4070 7974  ted.    )...@pyt
+00001c20: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
+00001c30: 7269 7a65 280a 2020 2020 5b22 696e 7075  rize(.    ["inpu
+00001c40: 7473 222c 2022 6665 6564 6261 636b 5f69  ts", "feedback_i
+00001c50: 6422 2c20 2266 6565 6462 6163 6b5f 6b65  d", "feedback_ke
+00001c60: 7973 222c 2022 6a6f 696e 5f6b 6579 222c  ys", "join_key",
+00001c70: 2022 6572 726f 725f 7422 5d2c 0a20 2020   "error_t"],.   
+00001c80: 205b 0a20 2020 2020 2020 2028 7b22 666f   [.        ({"fo
+00001c90: 6f22 3a20 2262 6172 227d 2c20 7b22 6964  o": "bar"}, {"id
+00001ca0: 223a 2022 3132 3334 3522 7d2c 205b 2266  ": "12345"}, ["f
+00001cb0: 6f6f 225d 2c20 4e6f 6e65 2c20 4761 6e74  oo"], None, Gant
+00001cc0: 7279 4c6f 6767 696e 6745 7863 6570 7469  ryLoggingExcepti
+00001cd0: 6f6e 292c 0a20 2020 2020 2020 2028 7b22  on),.        ({"
+00001ce0: 666f 6f22 3a20 2262 6172 227d 2c20 4e6f  foo": "bar"}, No
+00001cf0: 6e65 2c20 5b22 666f 6f22 5d2c 2022 6261  ne, ["foo"], "ba
+00001d00: 7262 617a 222c 2056 616c 7565 4572 726f  rbaz", ValueErro
+00001d10: 7229 2c0a 2020 2020 2020 2020 287b 2266  r),.        ({"f
+00001d20: 6f6f 223a 2022 6261 7222 7d2c 207b 2269  oo": "bar"}, {"i
+00001d30: 6422 3a20 2231 3233 3435 227d 2c20 4e6f  d": "12345"}, No
+00001d40: 6e65 2c20 2262 6172 6261 7a22 2c20 5661  ne, "barbaz", Va
+00001d50: 6c75 6545 7272 6f72 292c 0a20 2020 2020  lueError),.     
+00001d60: 2020 2028 7b22 666f 6f22 3a20 2262 6172     ({"foo": "bar
+00001d70: 227d 2c20 7b22 6964 223a 2022 3132 3334  "}, {"id": "1234
+00001d80: 3522 7d2c 205b 2266 6f6f 225d 2c20 2262  5"}, ["foo"], "b
+00001d90: 6172 6261 7a22 2c20 5661 6c75 6545 7272  arbaz", ValueErr
+00001da0: 6f72 292c 0a20 2020 205d 2c0a 290a 6465  or),.    ],.).de
+00001db0: 6620 7465 7374 5f72 6573 6f6c 7665 5f6a  f test_resolve_j
+00001dc0: 6f69 6e5f 6b65 795f 6572 726f 7228 696e  oin_key_error(in
+00001dd0: 7075 7473 2c20 6665 6564 6261 636b 5f69  puts, feedback_i
+00001de0: 642c 2066 6565 6462 6163 6b5f 6b65 7973  d, feedback_keys
+00001df0: 2c20 6a6f 696e 5f6b 6579 2c20 6572 726f  , join_key, erro
+00001e00: 725f 7429 3a0a 2020 2020 7769 7468 2070  r_t):.    with p
+00001e10: 7974 6573 742e 7261 6973 6573 2865 7272  ytest.raises(err
+00001e20: 6f72 5f74 293a 0a20 2020 2020 2020 205f  or_t):.        _
+00001e30: 203d 2063 6c69 656e 742e 5f72 6573 6f6c   = client._resol
+00001e40: 7665 5f6a 6f69 6e5f 6b65 7928 0a20 2020  ve_join_key(.   
+00001e50: 2020 2020 2020 2020 2069 6e70 7574 732c           inputs,
 00001e60: 0a20 2020 2020 2020 2020 2020 2066 6565  .            fee
-00001e70: 6462 6163 6b5f 7665 7273 696f 6e3d 6665  dback_version=fe
-00001e80: 6564 6261 636b 5f76 6572 7369 6f6e 2c0a  edback_version,.
-00001e90: 2020 2020 2020 2020 2020 2020 7469 6d65              time
-00001ea0: 7374 616d 703d 7469 6d65 7374 616d 702c  stamp=timestamp,
-00001eb0: 0a20 2020 2020 2020 2020 2020 2074 6167  .            tag
-00001ec0: 733d 7461 6773 2c0a 2020 2020 2020 2020  s=tags,.        
-00001ed0: 290a 2020 2020 2020 2020 3d3d 2022 3132  ).        == "12
-00001ee0: 3334 3536 3738 3930 220a 2020 2020 290a  34567890".    ).
-00001ef0: 2020 2020 6173 7365 7274 2063 6c69 5f6f      assert cli_o
-00001f00: 626a 2e6c 6f67 5f73 746f 7265 2e6c 6f67  bj.log_store.log
-00001f10: 7320 3d3d 205b 0a20 2020 2020 2020 207b  s == [.        {
-00001f20: 0a20 2020 2020 2020 2020 2020 2022 6576  .            "ev
-00001f30: 656e 7473 223a 205b 0a20 2020 2020 2020  ents": [.       
-00001f40: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
-00001f50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00001f60: 6261 7463 685f 6964 223a 204e 6f6e 652c  batch_id": None,
-00001f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001f80: 2020 2020 2022 6576 656e 745f 6964 223a       "event_id":
-00001f90: 2022 3132 3334 3522 2c0a 2020 2020 2020   "12345",.      
-00001fa0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-00001fb0: 6565 6462 6163 6b22 3a20 7b22 7661 6c75  eedback": {"valu
-00001fc0: 6522 3a20 2262 6172 227d 2c0a 2020 2020  e": "bar"},.    
-00001fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001fe0: 2266 6565 6462 6163 6b5f 6964 223a 2022  "feedback_id": "
-00001ff0: 3132 3334 3536 3738 3930 222c 0a20 2020  1234567890",.   
-00002000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002010: 2022 6c6f 675f 7469 6d65 7374 616d 7022   "log_timestamp"
-00002020: 3a20 4355 5252 454e 545f 5449 4d45 5f53  : CURRENT_TIME_S
-00002030: 5452 2c0a 2020 2020 2020 2020 2020 2020  TR,.            
-00002040: 2020 2020 2020 2020 226d 6574 6164 6174          "metadat
-00002050: 6122 3a20 7b0a 2020 2020 2020 2020 2020  a": {.          
-00002060: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-00002070: 6565 6462 6163 6b5f 7665 7273 696f 6e22  eedback_version"
-00002080: 3a20 6665 6564 6261 636b 5f76 6572 7369  : feedback_versi
-00002090: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-000020a0: 2020 2020 2020 2020 2020 2020 2266 756e              "fun
-000020b0: 635f 6e61 6d65 223a 2022 666f 6f62 6172  c_name": "foobar
-000020c0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000020d0: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-000020e0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
-000020f0: 696d 6573 7461 6d70 223a 2053 4f4d 455f  imestamp": SOME_
-00002100: 5449 4d45 5f53 5452 2069 6620 7469 6d65  TIME_STR if time
-00002110: 7374 616d 7020 656c 7365 2043 5552 5245  stamp else CURRE
-00002120: 4e54 5f54 494d 455f 5354 522c 0a20 2020  NT_TIME_STR,.   
-00002130: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
-00002140: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
-00002150: 2020 2020 2020 2020 2020 2261 7070 6c69            "appli
-00002160: 6361 7469 6f6e 223a 2022 666f 6f62 6172  cation": "foobar
-00002170: 222c 0a20 2020 2020 2020 207d 2c0a 2020  ",.        },.  
-00002180: 2020 5d0a 0a0a 4066 7265 657a 655f 7469    ]...@freeze_ti
-00002190: 6d65 2843 5552 5245 4e54 5f54 494d 4529  me(CURRENT_TIME)
-000021a0: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
-000021b0: 7261 6d65 7472 697a 6528 2274 6167 7322  rametrize("tags"
-000021c0: 2c20 5b7b 2265 6e76 223a 2022 6f76 6572  , [{"env": "over
-000021d0: 7772 6974 655f 656e 7622 7d2c 207b 7d2c  write_env"}, {},
-000021e0: 204e 6f6e 655d 290a 4070 7974 6573 742e   None]).@pytest.
-000021f0: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-00002200: 2822 7469 6d65 7374 616d 7022 2c20 5b4e  ("timestamp", [N
-00002210: 6f6e 652c 2053 4f4d 455f 5449 4d45 5d29  one, SOME_TIME])
-00002220: 0a40 6d6f 636b 2e70 6174 6368 2822 6761  .@mock.patch("ga
-00002230: 6e74 7279 2e6c 6f67 6765 722e 6576 656e  ntry.logger.even
-00002240: 745f 6275 696c 6465 722e 7575 6964 2e75  t_builder.uuid.u
-00002250: 7569 6434 2229 0a64 6566 2074 6573 745f  uid4").def test_
-00002260: 6c6f 675f 7072 6564 6963 7469 6f6e 5f65  log_prediction_e
-00002270: 7665 6e74 286d 6f63 6b5f 7575 6964 2c20  vent(mock_uuid, 
-00002280: 7469 6d65 7374 616d 702c 2074 6167 732c  timestamp, tags,
-00002290: 2063 6c69 5f6f 626a 293a 0a20 2020 206d   cli_obj):.    m
-000022a0: 6f63 6b5f 7575 6964 2e72 6574 7572 6e5f  ock_uuid.return_
-000022b0: 7661 6c75 6520 3d20 2231 3233 3435 220a  value = "12345".
-000022c0: 2020 2020 6173 7365 7274 2028 0a20 2020      assert (.   
-000022d0: 2020 2020 2063 6c69 5f6f 626a 2e5f 6c6f       cli_obj._lo
-000022e0: 675f 7072 6564 6963 7469 6f6e 5f65 7665  g_prediction_eve
-000022f0: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
-00002300: 6170 706c 6963 6174 696f 6e3d 2266 6f6f  application="foo
-00002310: 6261 7222 2c0a 2020 2020 2020 2020 2020  bar",.          
-00002320: 2020 696e 7075 7473 3d7b 2241 223a 2031    inputs={"A": 1
-00002330: 3030 7d2c 0a20 2020 2020 2020 2020 2020  00},.           
-00002340: 206f 7574 7075 7473 3d7b 2276 616c 7565   outputs={"value
-00002350: 223a 2022 6261 7222 7d2c 0a20 2020 2020  ": "bar"},.     
-00002360: 2020 2020 2020 206a 6f69 6e5f 6b65 793d         join_key=
-00002370: 2231 3233 3435 3637 3839 3022 2c0a 2020  "1234567890",.  
-00002380: 2020 2020 2020 2020 2020 7665 7273 696f            versio
-00002390: 6e3d 2261 2e62 2e63 222c 0a20 2020 2020  n="a.b.c",.     
-000023a0: 2020 2020 2020 2069 676e 6f72 655f 696e         ignore_in
-000023b0: 7075 7473 3d5b 2241 225d 2c0a 2020 2020  puts=["A"],.    
-000023c0: 2020 2020 2020 2020 7469 6d65 7374 616d          timestam
-000023d0: 703d 7469 6d65 7374 616d 702c 0a20 2020  p=timestamp,.   
-000023e0: 2020 2020 2020 2020 2074 6167 733d 7461           tags=ta
-000023f0: 6773 2c0a 2020 2020 2020 2020 290a 2020  gs,.        ).  
-00002400: 2020 2020 2020 3d3d 2022 3132 3334 3536        == "123456
-00002410: 3738 3930 220a 2020 2020 290a 2020 2020  7890".    ).    
-00002420: 6173 7365 7274 2063 6c69 5f6f 626a 2e6c  assert cli_obj.l
-00002430: 6f67 5f73 746f 7265 2e6c 6f67 7320 3d3d  og_store.logs ==
-00002440: 205b 0a20 2020 2020 2020 207b 0a20 2020   [.        {.   
-00002450: 2020 2020 2020 2020 2022 6576 656e 7473           "events
-00002460: 223a 205b 0a20 2020 2020 2020 2020 2020  ": [.           
-00002470: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-00002480: 2020 2020 2020 2020 2020 2022 6261 7463             "batc
-00002490: 685f 6964 223a 204e 6f6e 652c 0a20 2020  h_id": None,.   
-000024a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000024b0: 2022 6576 656e 745f 6964 223a 2022 3132   "event_id": "12
-000024c0: 3334 3522 2c0a 2020 2020 2020 2020 2020  345",.          
-000024d0: 2020 2020 2020 2020 2020 2266 6565 6462            "feedb
-000024e0: 6163 6b5f 6964 223a 2022 3132 3334 3536  ack_id": "123456
-000024f0: 3738 3930 222c 0a20 2020 2020 2020 2020  7890",.         
-00002500: 2020 2020 2020 2020 2020 2022 696e 7075             "inpu
-00002510: 7473 223a 207b 7d2c 0a20 2020 2020 2020  ts": {},.       
-00002520: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
-00002530: 675f 7469 6d65 7374 616d 7022 3a20 4355  g_timestamp": CU
-00002540: 5252 454e 545f 5449 4d45 5f53 5452 2c0a  RRENT_TIME_STR,.
-00002550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002560: 2020 2020 226d 6574 6164 6174 6122 3a20      "metadata": 
-00002570: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00002580: 2020 2020 2020 2020 2020 2266 6565 6462            "feedb
-00002590: 6163 6b5f 6b65 7973 223a 204e 6f6e 652c  ack_keys": None,
-000025a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000025b0: 2020 2020 2020 2020 2022 6675 6e63 5f6e           "func_n
-000025c0: 616d 6522 3a20 2266 6f6f 6261 7222 2c0a  ame": "foobar",.
-000025d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000025e0: 2020 2020 2020 2020 2269 676e 6f72 655f          "ignore_
-000025f0: 696e 7075 7473 223a 205b 2241 225d 2c0a  inputs": ["A"],.
-00002600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002610: 2020 2020 2020 2020 2276 6572 7369 6f6e          "version
-00002620: 223a 2022 612e 622e 6322 2c0a 2020 2020  ": "a.b.c",.    
-00002630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002640: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-00002650: 2020 2020 2020 2022 6f75 7470 7574 7322         "outputs"
-00002660: 3a20 7b22 7661 6c75 6522 3a20 2262 6172  : {"value": "bar
-00002670: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-00002680: 2020 2020 2020 2020 2274 6167 7322 3a20          "tags": 
-00002690: 7461 6773 2069 6620 7461 6773 2069 7320  tags if tags is 
-000026a0: 6e6f 7420 4e6f 6e65 2065 6c73 6520 4e6f  not None else No
-000026b0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-000026c0: 2020 2020 2020 2020 2274 696d 6573 7461          "timesta
-000026d0: 6d70 223a 2043 5552 5245 4e54 5f54 494d  mp": CURRENT_TIM
-000026e0: 455f 5354 5220 6966 206e 6f74 2074 696d  E_STR if not tim
-000026f0: 6573 7461 6d70 2065 6c73 6520 534f 4d45  estamp else SOME
-00002700: 5f54 494d 455f 5354 522c 0a20 2020 2020  _TIME_STR,.     
-00002710: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-00002720: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-00002730: 2020 2020 2020 2020 2261 7070 6c69 6361          "applica
-00002740: 7469 6f6e 223a 2022 666f 6f62 6172 222c  tion": "foobar",
-00002750: 0a20 2020 2020 2020 207d 2c0a 2020 2020  .        },.    
-00002760: 5d0a 0a0a 4070 7974 6573 742e 6d61 726b  ]...@pytest.mark
-00002770: 2e70 6172 616d 6574 7269 7a65 2822 6170  .parametrize("ap
-00002780: 706c 6963 6174 696f 6e22 2c20 5b31 302c  plication", [10,
-00002790: 204e 6f6e 652c 2031 302e 352c 2062 2273   None, 10.5, b"s
-000027a0: 6f6d 6520 6269 6e61 7279 2073 7472 696e  ome binary strin
-000027b0: 6722 5d29 0a64 6566 2074 6573 745f 6c6f  g"]).def test_lo
-000027c0: 675f 7265 636f 7264 5f69 6e76 616c 6964  g_record_invalid
-000027d0: 5f6e 616d 6528 6170 706c 6963 6174 696f  _name(applicatio
-000027e0: 6e2c 2063 6c69 5f6f 626a 2c20 6361 706c  n, cli_obj, capl
-000027f0: 6f67 293a 0a20 2020 2063 6170 6c6f 672e  og):.    caplog.
-00002800: 7365 745f 6c65 7665 6c28 6c6f 6767 696e  set_level(loggin
-00002810: 672e 4552 524f 522c 206c 6f67 6765 723d  g.ERROR, logger=
-00002820: 2267 616e 7472 792e 636c 6965 6e74 2229  "gantry.client")
-00002830: 0a20 2020 2063 6c69 5f6f 626a 2e6c 6f67  .    cli_obj.log
-00002840: 5f72 6563 6f72 6428 0a20 2020 2020 2020  _record(.       
-00002850: 2061 7070 6c69 6361 7469 6f6e 3d61 7070   application=app
-00002860: 6c69 6361 7469 6f6e 2c0a 2020 2020 2020  lication,.      
-00002870: 2020 6665 6564 6261 636b 5f69 643d 7b22    feedback_id={"
-00002880: 4122 3a20 3130 307d 2c0a 2020 2020 2020  A": 100},.      
-00002890: 2020 6665 6564 6261 636b 3d7b 2276 616c    feedback={"val
-000028a0: 7565 223a 2022 6261 7222 7d2c 0a20 2020  ue": "bar"},.   
-000028b0: 2020 2020 2066 6565 6462 6163 6b5f 7665       feedback_ve
-000028c0: 7273 696f 6e3d 3130 2c0a 2020 2020 2020  rsion=10,.      
-000028d0: 2020 7469 6d65 7374 616d 703d 534f 4d45    timestamp=SOME
-000028e0: 5f54 494d 452c 0a20 2020 2029 0a20 2020  _TIME,.    ).   
-000028f0: 2061 7373 6572 7420 2249 6e74 6572 6e61   assert "Interna
-00002900: 6c20 6578 6365 7074 696f 6e20 696e 2047  l exception in G
-00002910: 616e 7472 7920 636c 6965 6e74 2220 696e  antry client" in
-00002920: 2063 6170 6c6f 672e 7465 7874 0a20 2020   caplog.text.   
-00002930: 2061 7373 6572 7420 2254 7970 6545 7272   assert "TypeErr
-00002940: 6f72 3a22 2069 6e20 6361 706c 6f67 2e74  or:" in caplog.t
-00002950: 6578 740a 0a0a 4070 7974 6573 742e 6d61  ext...@pytest.ma
-00002960: 726b 2e70 6172 616d 6574 7269 7a65 2822  rk.parametrize("
-00002970: 6170 706c 6963 6174 696f 6e22 2c20 5b31  application", [1
-00002980: 302c 204e 6f6e 652c 2031 302e 352c 2062  0, None, 10.5, b
-00002990: 2273 6f6d 6520 6269 6e61 7279 2073 7472  "some binary str
-000029a0: 696e 6722 5d29 0a64 6566 2074 6573 745f  ing"]).def test_
-000029b0: 7369 6e67 6c65 5f6c 6f67 5f72 6563 6f72  single_log_recor
-000029c0: 645f 696e 7661 6c69 645f 6e61 6d65 2861  d_invalid_name(a
-000029d0: 7070 6c69 6361 7469 6f6e 2c20 636c 695f  pplication, cli_
-000029e0: 6f62 6a2c 2063 6170 6c6f 6729 3a0a 2020  obj, caplog):.  
-000029f0: 2020 6361 706c 6f67 2e73 6574 5f6c 6576    caplog.set_lev
-00002a00: 656c 286c 6f67 6769 6e67 2e45 5252 4f52  el(logging.ERROR
-00002a10: 2c20 6c6f 6767 6572 3d22 6761 6e74 7279  , logger="gantry
-00002a20: 2e63 6c69 656e 7422 290a 2020 2020 636c  .client").    cl
-00002a30: 695f 6f62 6a2e 7369 6e67 6c65 5f6c 6f67  i_obj.single_log
-00002a40: 5f72 6563 6f72 6428 0a20 2020 2020 2020  _record(.       
-00002a50: 2061 7070 6c69 6361 7469 6f6e 3d61 7070   application=app
-00002a60: 6c69 6361 7469 6f6e 2c0a 2020 2020 2020  lication,.      
-00002a70: 2020 6665 6564 6261 636b 5f69 643d 7b22    feedback_id={"
-00002a80: 4122 3a20 3130 307d 2c0a 2020 2020 2020  A": 100},.      
-00002a90: 2020 6665 6564 6261 636b 3d7b 2276 616c    feedback={"val
-00002aa0: 7565 223a 2022 6261 7222 7d2c 0a20 2020  ue": "bar"},.   
-00002ab0: 2020 2020 2066 6565 6462 6163 6b5f 7665       feedback_ve
-00002ac0: 7273 696f 6e3d 3130 2c0a 2020 2020 2020  rsion=10,.      
-00002ad0: 2020 7469 6d65 7374 616d 703d 534f 4d45    timestamp=SOME
-00002ae0: 5f54 494d 452c 0a20 2020 2029 0a20 2020  _TIME,.    ).   
-00002af0: 2061 7373 6572 7420 2249 6e74 6572 6e61   assert "Interna
-00002b00: 6c20 6578 6365 7074 696f 6e20 696e 2047  l exception in G
-00002b10: 616e 7472 7920 636c 6965 6e74 2220 696e  antry client" in
-00002b20: 2063 6170 6c6f 672e 7465 7874 0a20 2020   caplog.text.   
-00002b30: 2061 7373 6572 7420 2254 7970 6545 7272   assert "TypeErr
-00002b40: 6f72 3a22 2069 6e20 6361 706c 6f67 2e74  or:" in caplog.t
-00002b50: 6578 740a 0a0a 4070 7974 6573 742e 6d61  ext...@pytest.ma
-00002b60: 726b 2e70 6172 616d 6574 7269 7a65 2822  rk.parametrize("
-00002b70: 6665 6564 6261 636b 5f69 6422 2c20 5b31  feedback_id", [1
-00002b80: 302c 204e 6f6e 652c 2031 302e 352c 205b  0, None, 10.5, [
-00002b90: 2261 222c 2022 6c69 7374 225d 2c20 6222  "a", "list"], b"
-00002ba0: 736f 6d65 7468 696e 6722 5d29 0a64 6566  something"]).def
-00002bb0: 2074 6573 745f 6c6f 675f 7265 636f 7264   test_log_record
-00002bc0: 5f69 6e76 616c 6964 5f66 6565 6462 6163  _invalid_feedbac
-00002bd0: 6b5f 6964 2866 6565 6462 6163 6b5f 6964  k_id(feedback_id
-00002be0: 2c20 636c 695f 6f62 6a2c 2063 6170 6c6f  , cli_obj, caplo
-00002bf0: 6729 3a0a 2020 2020 6361 706c 6f67 2e73  g):.    caplog.s
-00002c00: 6574 5f6c 6576 656c 286c 6f67 6769 6e67  et_level(logging
-00002c10: 2e45 5252 4f52 2c20 6c6f 6767 6572 3d22  .ERROR, logger="
-00002c20: 6761 6e74 7279 2e63 6c69 656e 7422 290a  gantry.client").
-00002c30: 2020 2020 636c 695f 6f62 6a2e 6c6f 675f      cli_obj.log_
-00002c40: 7265 636f 7264 280a 2020 2020 2020 2020  record(.        
-00002c50: 6170 706c 6963 6174 696f 6e3d 2266 6f6f  application="foo
-00002c60: 6261 7222 2c0a 2020 2020 2020 2020 6665  bar",.        fe
-00002c70: 6564 6261 636b 5f69 643d 6665 6564 6261  edback_id=feedba
-00002c80: 636b 5f69 642c 0a20 2020 2020 2020 2066  ck_id,.        f
-00002c90: 6565 6462 6163 6b3d 7b22 7661 6c75 6522  eedback={"value"
-00002ca0: 3a20 2262 6172 227d 2c0a 2020 2020 2020  : "bar"},.      
-00002cb0: 2020 6665 6564 6261 636b 5f76 6572 7369    feedback_versi
-00002cc0: 6f6e 3d31 302c 0a20 2020 2020 2020 2074  on=10,.        t
-00002cd0: 696d 6573 7461 6d70 3d53 4f4d 455f 5449  imestamp=SOME_TI
-00002ce0: 4d45 2c0a 2020 2020 290a 2020 2020 6173  ME,.    ).    as
-00002cf0: 7365 7274 2022 496e 7465 726e 616c 2065  sert "Internal e
-00002d00: 7863 6570 7469 6f6e 2069 6e20 4761 6e74  xception in Gant
-00002d10: 7279 2063 6c69 656e 7422 2069 6e20 6361  ry client" in ca
-00002d20: 706c 6f67 2e74 6578 740a 2020 2020 6173  plog.text.    as
-00002d30: 7365 7274 2022 5479 7065 4572 726f 723a  sert "TypeError:
-00002d40: 2220 696e 2063 6170 6c6f 672e 7465 7874  " in caplog.text
-00002d50: 0a0a 0a40 7079 7465 7374 2e6d 6172 6b2e  ...@pytest.mark.
-00002d60: 7061 7261 6d65 7472 697a 6528 2266 6565  parametrize("fee
-00002d70: 6462 6163 6b5f 6964 222c 205b 3130 2c20  dback_id", [10, 
-00002d80: 4e6f 6e65 2c20 3130 2e35 2c20 5b22 6122  None, 10.5, ["a"
-00002d90: 2c20 226c 6973 7422 5d2c 2062 2273 6f6d  , "list"], b"som
-00002da0: 6574 6869 6e67 225d 290a 6465 6620 7465  ething"]).def te
-00002db0: 7374 5f73 696e 676c 655f 6c6f 675f 7265  st_single_log_re
-00002dc0: 636f 7264 5f69 6e76 616c 6964 5f66 6565  cord_invalid_fee
-00002dd0: 6462 6163 6b5f 6964 2866 6565 6462 6163  dback_id(feedbac
-00002de0: 6b5f 6964 2c20 636c 695f 6f62 6a2c 2063  k_id, cli_obj, c
-00002df0: 6170 6c6f 6729 3a0a 2020 2020 6361 706c  aplog):.    capl
-00002e00: 6f67 2e73 6574 5f6c 6576 656c 286c 6f67  og.set_level(log
-00002e10: 6769 6e67 2e45 5252 4f52 2c20 6c6f 6767  ging.ERROR, logg
-00002e20: 6572 3d22 6761 6e74 7279 2e63 6c69 656e  er="gantry.clien
-00002e30: 7422 290a 2020 2020 636c 695f 6f62 6a2e  t").    cli_obj.
-00002e40: 7369 6e67 6c65 5f6c 6f67 5f72 6563 6f72  single_log_recor
-00002e50: 6428 0a20 2020 2020 2020 2061 7070 6c69  d(.        appli
-00002e60: 6361 7469 6f6e 3d22 666f 6f62 6172 222c  cation="foobar",
-00002e70: 0a20 2020 2020 2020 2066 6565 6462 6163  .        feedbac
-00002e80: 6b5f 6964 3d66 6565 6462 6163 6b5f 6964  k_id=feedback_id
-00002e90: 2c0a 2020 2020 2020 2020 6665 6564 6261  ,.        feedba
-00002ea0: 636b 3d7b 2276 616c 7565 223a 2022 6261  ck={"value": "ba
-00002eb0: 7222 7d2c 0a20 2020 2020 2020 2066 6565  r"},.        fee
-00002ec0: 6462 6163 6b5f 7665 7273 696f 6e3d 3130  dback_version=10
-00002ed0: 2c0a 2020 2020 2020 2020 7469 6d65 7374  ,.        timest
-00002ee0: 616d 703d 534f 4d45 5f54 494d 452c 0a20  amp=SOME_TIME,. 
-00002ef0: 2020 2029 0a20 2020 2061 7373 6572 7420     ).    assert 
-00002f00: 2249 6e74 6572 6e61 6c20 6578 6365 7074  "Internal except
-00002f10: 696f 6e20 696e 2047 616e 7472 7920 636c  ion in Gantry cl
-00002f20: 6965 6e74 2220 696e 2063 6170 6c6f 672e  ient" in caplog.
-00002f30: 7465 7874 0a20 2020 2061 7373 6572 7420  text.    assert 
-00002f40: 2254 7970 6545 7272 6f72 3a22 2069 6e20  "TypeError:" in 
-00002f50: 6361 706c 6f67 2e74 6578 740a 0a0a 4070  caplog.text...@p
-00002f60: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
-00002f70: 6574 7269 7a65 2822 6665 6564 6261 636b  etrize("feedback
-00002f80: 222c 205b 3130 2c20 4e6f 6e65 2c20 3130  ", [10, None, 10
-00002f90: 2e35 2c20 5b22 6122 2c20 226c 6973 7422  .5, ["a", "list"
-00002fa0: 5d2c 2062 2273 6f6d 6574 6869 6e67 225d  ], b"something"]
-00002fb0: 290a 6465 6620 7465 7374 5f6c 6f67 5f72  ).def test_log_r
-00002fc0: 6563 6f72 645f 696e 7661 6c69 645f 6665  ecord_invalid_fe
-00002fd0: 6564 6261 636b 2866 6565 6462 6163 6b2c  edback(feedback,
-00002fe0: 2063 6c69 5f6f 626a 2c20 6361 706c 6f67   cli_obj, caplog
-00002ff0: 293a 0a20 2020 2063 6170 6c6f 672e 7365  ):.    caplog.se
-00003000: 745f 6c65 7665 6c28 6c6f 6767 696e 672e  t_level(logging.
-00003010: 4552 524f 522c 206c 6f67 6765 723d 2267  ERROR, logger="g
-00003020: 616e 7472 792e 636c 6965 6e74 2229 0a20  antry.client"). 
-00003030: 2020 2063 6c69 5f6f 626a 2e6c 6f67 5f72     cli_obj.log_r
-00003040: 6563 6f72 6428 0a20 2020 2020 2020 2061  ecord(.        a
-00003050: 7070 6c69 6361 7469 6f6e 3d22 666f 6f62  pplication="foob
-00003060: 6172 222c 0a20 2020 2020 2020 2066 6565  ar",.        fee
-00003070: 6462 6163 6b5f 6964 3d7b 2276 616c 7565  dback_id={"value
-00003080: 223a 2022 6261 7222 7d2c 0a20 2020 2020  ": "bar"},.     
-00003090: 2020 2066 6565 6462 6163 6b3d 6665 6564     feedback=feed
-000030a0: 6261 636b 2c0a 2020 2020 2020 2020 6665  back,.        fe
-000030b0: 6564 6261 636b 5f76 6572 7369 6f6e 3d31  edback_version=1
-000030c0: 302c 0a20 2020 2020 2020 2074 696d 6573  0,.        times
-000030d0: 7461 6d70 3d53 4f4d 455f 5449 4d45 2c0a  tamp=SOME_TIME,.
-000030e0: 2020 2020 290a 2020 2020 6173 7365 7274      ).    assert
-000030f0: 2022 496e 7465 726e 616c 2065 7863 6570   "Internal excep
-00003100: 7469 6f6e 2069 6e20 4761 6e74 7279 2063  tion in Gantry c
-00003110: 6c69 656e 7422 2069 6e20 6361 706c 6f67  lient" in caplog
-00003120: 2e74 6578 740a 2020 2020 6173 7365 7274  .text.    assert
-00003130: 2022 5479 7065 4572 726f 723a 2220 696e   "TypeError:" in
-00003140: 2063 6170 6c6f 672e 7465 7874 0a0a 0a40   caplog.text...@
-00003150: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
-00003160: 6d65 7472 697a 6528 2266 6565 6462 6163  metrize("feedbac
-00003170: 6b22 2c20 5b31 302c 204e 6f6e 652c 2031  k", [10, None, 1
-00003180: 302e 352c 205b 2261 222c 2022 6c69 7374  0.5, ["a", "list
-00003190: 225d 2c20 6222 736f 6d65 7468 696e 6722  "], b"something"
-000031a0: 5d29 0a64 6566 2074 6573 745f 7369 6e67  ]).def test_sing
-000031b0: 6c65 5f6c 6f67 5f72 6563 6f72 645f 696e  le_log_record_in
-000031c0: 7661 6c69 645f 6665 6564 6261 636b 2866  valid_feedback(f
-000031d0: 6565 6462 6163 6b2c 2063 6c69 5f6f 626a  eedback, cli_obj
-000031e0: 2c20 6361 706c 6f67 293a 0a20 2020 2063  , caplog):.    c
-000031f0: 6170 6c6f 672e 7365 745f 6c65 7665 6c28  aplog.set_level(
-00003200: 6c6f 6767 696e 672e 4552 524f 522c 206c  logging.ERROR, l
-00003210: 6f67 6765 723d 2267 616e 7472 792e 636c  ogger="gantry.cl
-00003220: 6965 6e74 2229 0a20 2020 2063 6c69 5f6f  ient").    cli_o
-00003230: 626a 2e73 696e 676c 655f 6c6f 675f 7265  bj.single_log_re
-00003240: 636f 7264 280a 2020 2020 2020 2020 6170  cord(.        ap
-00003250: 706c 6963 6174 696f 6e3d 2266 6f6f 6261  plication="fooba
-00003260: 7222 2c0a 2020 2020 2020 2020 6665 6564  r",.        feed
-00003270: 6261 636b 5f69 643d 7b22 7661 6c75 6522  back_id={"value"
-00003280: 3a20 2262 6172 227d 2c0a 2020 2020 2020  : "bar"},.      
-00003290: 2020 6665 6564 6261 636b 3d66 6565 6462    feedback=feedb
-000032a0: 6163 6b2c 0a20 2020 2020 2020 2066 6565  ack,.        fee
-000032b0: 6462 6163 6b5f 7665 7273 696f 6e3d 3130  dback_version=10
-000032c0: 2c0a 2020 2020 2020 2020 7469 6d65 7374  ,.        timest
-000032d0: 616d 703d 534f 4d45 5f54 494d 452c 0a20  amp=SOME_TIME,. 
-000032e0: 2020 2029 0a20 2020 2061 7373 6572 7420     ).    assert 
-000032f0: 2249 6e74 6572 6e61 6c20 6578 6365 7074  "Internal except
-00003300: 696f 6e20 696e 2047 616e 7472 7920 636c  ion in Gantry cl
-00003310: 6965 6e74 2220 696e 2063 6170 6c6f 672e  ient" in caplog.
-00003320: 7465 7874 0a20 2020 2061 7373 6572 7420  text.    assert 
-00003330: 2254 7970 6545 7272 6f72 3a22 2069 6e20  "TypeError:" in 
-00003340: 6361 706c 6f67 2e74 6578 740a 0a0a 4070  caplog.text...@p
-00003350: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
-00003360: 6574 7269 7a65 280a 2020 2020 2266 6565  etrize(.    "fee
-00003370: 6462 6163 6b5f 7665 7273 696f 6e22 2c20  dback_version", 
-00003380: 5b22 736f 6d65 2d76 6572 7369 6f6e 222c  ["some-version",
-00003390: 2062 2261 2d76 6572 7369 6f6e 222c 2031   b"a-version", 1
-000033a0: 302e 352c 207b 2276 6572 7369 6f6e 223a  0.5, {"version":
-000033b0: 2022 7965 7322 7d2c 205b 3130 5d5d 0a29   "yes"}, [10]].)
-000033c0: 0a64 6566 2074 6573 745f 6c6f 675f 7265  .def test_log_re
-000033d0: 636f 7264 5f69 6e76 616c 6964 5f66 6565  cord_invalid_fee
-000033e0: 6462 6163 6b5f 7665 7273 696f 6e28 6665  dback_version(fe
-000033f0: 6564 6261 636b 5f76 6572 7369 6f6e 2c20  edback_version, 
-00003400: 636c 695f 6f62 6a2c 2063 6170 6c6f 6729  cli_obj, caplog)
-00003410: 3a0a 2020 2020 6361 706c 6f67 2e73 6574  :.    caplog.set
-00003420: 5f6c 6576 656c 286c 6f67 6769 6e67 2e45  _level(logging.E
-00003430: 5252 4f52 2c20 6c6f 6767 6572 3d22 6761  RROR, logger="ga
-00003440: 6e74 7279 2e63 6c69 656e 7422 290a 2020  ntry.client").  
-00003450: 2020 636c 695f 6f62 6a2e 6c6f 675f 7265    cli_obj.log_re
-00003460: 636f 7264 280a 2020 2020 2020 2020 6170  cord(.        ap
-00003470: 706c 6963 6174 696f 6e3d 2266 6f6f 6261  plication="fooba
-00003480: 7222 2c0a 2020 2020 2020 2020 6665 6564  r",.        feed
-00003490: 6261 636b 5f69 643d 7b22 7661 6c75 6522  back_id={"value"
-000034a0: 3a20 2262 6172 227d 2c0a 2020 2020 2020  : "bar"},.      
-000034b0: 2020 6665 6564 6261 636b 3d7b 2276 616c    feedback={"val
-000034c0: 7565 223a 2022 666f 6f22 7d2c 0a20 2020  ue": "foo"},.   
-000034d0: 2020 2020 2066 6565 6462 6163 6b5f 7665       feedback_ve
-000034e0: 7273 696f 6e3d 6665 6564 6261 636b 5f76  rsion=feedback_v
-000034f0: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
-00003500: 7469 6d65 7374 616d 703d 534f 4d45 5f54  timestamp=SOME_T
-00003510: 494d 452c 0a20 2020 2029 0a20 2020 2061  IME,.    ).    a
-00003520: 7373 6572 7420 2249 6e74 6572 6e61 6c20  ssert "Internal 
-00003530: 6578 6365 7074 696f 6e20 696e 2047 616e  exception in Gan
-00003540: 7472 7920 636c 6965 6e74 2220 696e 2063  try client" in c
-00003550: 6170 6c6f 672e 7465 7874 0a20 2020 2061  aplog.text.    a
-00003560: 7373 6572 7420 2254 7970 6545 7272 6f72  ssert "TypeError
-00003570: 3a22 2069 6e20 6361 706c 6f67 2e74 6578  :" in caplog.tex
-00003580: 740a 0a0a 4070 7974 6573 742e 6d61 726b  t...@pytest.mark
-00003590: 2e70 6172 616d 6574 7269 7a65 2822 7469  .parametrize("ti
-000035a0: 6d65 7374 616d 7022 2c20 5b22 736f 6d65  mestamp", ["some
-000035b0: 2d74 696d 6573 7461 6d70 222c 2031 302c  -timestamp", 10,
-000035c0: 2022 3230 3230 2d31 302d 3130 225d 290a   "2020-10-10"]).
-000035d0: 6465 6620 7465 7374 5f6c 6f67 5f72 6563  def test_log_rec
-000035e0: 6f72 645f 696e 7661 6c69 645f 7469 6d65  ord_invalid_time
-000035f0: 7374 616d 7028 7469 6d65 7374 616d 702c  stamp(timestamp,
-00003600: 2063 6c69 5f6f 626a 2c20 6361 706c 6f67   cli_obj, caplog
-00003610: 293a 0a20 2020 2063 6170 6c6f 672e 7365  ):.    caplog.se
-00003620: 745f 6c65 7665 6c28 6c6f 6767 696e 672e  t_level(logging.
-00003630: 4552 524f 522c 206c 6f67 6765 723d 2267  ERROR, logger="g
-00003640: 616e 7472 792e 636c 6965 6e74 2229 0a20  antry.client"). 
-00003650: 2020 2063 6c69 5f6f 626a 2e6c 6f67 5f72     cli_obj.log_r
-00003660: 6563 6f72 6428 0a20 2020 2020 2020 2061  ecord(.        a
-00003670: 7070 6c69 6361 7469 6f6e 3d22 666f 6f62  pplication="foob
-00003680: 6172 222c 0a20 2020 2020 2020 2066 6565  ar",.        fee
-00003690: 6462 6163 6b5f 6964 3d7b 2276 616c 7565  dback_id={"value
-000036a0: 223a 2022 6261 7222 7d2c 0a20 2020 2020  ": "bar"},.     
-000036b0: 2020 2066 6565 6462 6163 6b3d 7b22 7661     feedback={"va
-000036c0: 6c75 6522 3a20 2266 6f6f 227d 2c0a 2020  lue": "foo"},.  
-000036d0: 2020 2020 2020 6665 6564 6261 636b 5f76        feedback_v
-000036e0: 6572 7369 6f6e 3d31 302c 0a20 2020 2020  ersion=10,.     
-000036f0: 2020 2074 696d 6573 7461 6d70 3d74 696d     timestamp=tim
-00003700: 6573 7461 6d70 2c0a 2020 2020 290a 2020  estamp,.    ).  
-00003710: 2020 6173 7365 7274 2022 496e 7465 726e    assert "Intern
-00003720: 616c 2065 7863 6570 7469 6f6e 2069 6e20  al exception in 
-00003730: 4761 6e74 7279 2063 6c69 656e 7422 2069  Gantry client" i
-00003740: 6e20 6361 706c 6f67 2e74 6578 740a 2020  n caplog.text.  
-00003750: 2020 6173 7365 7274 2022 5479 7065 4572    assert "TypeEr
-00003760: 726f 723a 2220 696e 2063 6170 6c6f 672e  ror:" in caplog.
-00003770: 7465 7874 0a0a 0a40 7079 7465 7374 2e6d  text...@pytest.m
-00003780: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
-00003790: 2269 6e70 7574 7322 2c20 5b5b 3130 2c20  "inputs", [[10, 
-000037a0: 3230 5d2c 2031 302c 2031 302e 352c 2028  20], 10, 10.5, (
-000037b0: 2241 222c 2031 3030 295d 290a 6465 6620  "A", 100)]).def 
-000037c0: 7465 7374 5f6c 6f67 5f72 6563 6f72 645f  test_log_record_
-000037d0: 696e 7661 6c69 645f 696e 7075 7473 2869  invalid_inputs(i
-000037e0: 6e70 7574 732c 2063 6c69 5f6f 626a 2c20  nputs, cli_obj, 
-000037f0: 6361 706c 6f67 293a 0a20 2020 2063 6170  caplog):.    cap
-00003800: 6c6f 672e 7365 745f 6c65 7665 6c28 6c6f  log.set_level(lo
-00003810: 6767 696e 672e 4552 524f 522c 206c 6f67  gging.ERROR, log
-00003820: 6765 723d 2267 616e 7472 792e 636c 6965  ger="gantry.clie
-00003830: 6e74 2229 0a20 2020 2063 6c69 5f6f 626a  nt").    cli_obj
-00003840: 2e6c 6f67 5f72 6563 6f72 6428 0a20 2020  .log_record(.   
-00003850: 2020 2020 2061 7070 6c69 6361 7469 6f6e       application
-00003860: 3d22 736f 6d65 2d6e 616d 6522 2c0a 2020  ="some-name",.  
-00003870: 2020 2020 2020 696e 7075 7473 3d69 6e70        inputs=inp
-00003880: 7574 732c 0a20 2020 2020 2020 206f 7574  uts,.        out
-00003890: 7075 7473 3d7b 2276 616c 7565 223a 2022  puts={"value": "
-000038a0: 6261 7222 7d2c 0a20 2020 2020 2020 2076  bar"},.        v
-000038b0: 6572 7369 6f6e 3d31 302c 0a20 2020 2020  ersion=10,.     
-000038c0: 2020 2069 676e 6f72 655f 696e 7075 7473     ignore_inputs
-000038d0: 3d5b 2241 225d 2c0a 2020 2020 2020 2020  =["A"],.        
-000038e0: 6665 6564 6261 636b 5f69 643d 7b22 4122  feedback_id={"A"
-000038f0: 3a20 3130 307d 2c0a 2020 2020 2020 2020  : 100},.        
-00003900: 7469 6d65 7374 616d 703d 534f 4d45 5f54  timestamp=SOME_T
-00003910: 494d 452c 0a20 2020 2029 0a20 2020 2061  IME,.    ).    a
-00003920: 7373 6572 7420 2249 6e74 6572 6e61 6c20  ssert "Internal 
-00003930: 6578 6365 7074 696f 6e20 696e 2047 616e  exception in Gan
-00003940: 7472 7920 636c 6965 6e74 2220 696e 2063  try client" in c
-00003950: 6170 6c6f 672e 7465 7874 0a20 2020 2061  aplog.text.    a
-00003960: 7373 6572 7420 2254 7970 6545 7272 6f72  ssert "TypeError
-00003970: 3a22 2069 6e20 6361 706c 6f67 2e74 6578  :" in caplog.tex
-00003980: 740a 0a0a 4070 7974 6573 742e 6d61 726b  t...@pytest.mark
-00003990: 2e70 6172 616d 6574 7269 7a65 2822 7665  .parametrize("ve
-000039a0: 7273 696f 6e22 2c20 5b5b 3130 2c20 3230  rsion", [[10, 20
-000039b0: 5d2c 2031 302e 352c 207b 2276 6572 7369  ], 10.5, {"versi
-000039c0: 6f6e 223a 2031 307d 5d29 0a64 6566 2074  on": 10}]).def t
-000039d0: 6573 745f 6c6f 675f 7265 636f 7264 5f69  est_log_record_i
-000039e0: 6e76 616c 6964 5f76 6572 7369 6f6e 2876  nvalid_version(v
-000039f0: 6572 7369 6f6e 2c20 636c 695f 6f62 6a2c  ersion, cli_obj,
-00003a00: 2063 6170 6c6f 6729 3a0a 2020 2020 6361   caplog):.    ca
-00003a10: 706c 6f67 2e73 6574 5f6c 6576 656c 286c  plog.set_level(l
-00003a20: 6f67 6769 6e67 2e45 5252 4f52 2c20 6c6f  ogging.ERROR, lo
-00003a30: 6767 6572 3d22 6761 6e74 7279 2e63 6c69  gger="gantry.cli
-00003a40: 656e 7422 290a 2020 2020 636c 695f 6f62  ent").    cli_ob
-00003a50: 6a2e 6c6f 675f 7265 636f 7264 280a 2020  j.log_record(.  
-00003a60: 2020 2020 2020 6170 706c 6963 6174 696f        applicatio
-00003a70: 6e3d 2273 6f6d 652d 6e61 6d65 222c 0a20  n="some-name",. 
-00003a80: 2020 2020 2020 2069 6e70 7574 733d 7b22         inputs={"
-00003a90: 4122 3a20 3130 307d 2c0a 2020 2020 2020  A": 100},.      
-00003aa0: 2020 6f75 7470 7574 733d 7b22 7661 6c75    outputs={"valu
-00003ab0: 6522 3a20 2262 6172 227d 2c0a 2020 2020  e": "bar"},.    
-00003ac0: 2020 2020 7665 7273 696f 6e3d 7665 7273      version=vers
-00003ad0: 696f 6e2c 0a20 2020 2020 2020 2069 676e  ion,.        ign
-00003ae0: 6f72 655f 696e 7075 7473 3d5b 2241 225d  ore_inputs=["A"]
-00003af0: 2c0a 2020 2020 2020 2020 6665 6564 6261  ,.        feedba
-00003b00: 636b 5f69 643d 7b22 4122 3a20 3130 307d  ck_id={"A": 100}
-00003b10: 2c0a 2020 2020 2020 2020 7469 6d65 7374  ,.        timest
-00003b20: 616d 703d 534f 4d45 5f54 494d 452c 0a20  amp=SOME_TIME,. 
-00003b30: 2020 2029 0a20 2020 2061 7373 6572 7420     ).    assert 
-00003b40: 2249 6e74 6572 6e61 6c20 6578 6365 7074  "Internal except
-00003b50: 696f 6e20 696e 2047 616e 7472 7920 636c  ion in Gantry cl
-00003b60: 6965 6e74 2220 696e 2063 6170 6c6f 672e  ient" in caplog.
-00003b70: 7465 7874 0a20 2020 2061 7373 6572 7420  text.    assert 
-00003b80: 2254 7970 6545 7272 6f72 3a22 2069 6e20  "TypeError:" in 
-00003b90: 6361 706c 6f67 2e74 6578 740a 0a0a 4070  caplog.text...@p
-00003ba0: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
-00003bb0: 6574 7269 7a65 2822 6665 6564 6261 636b  etrize("feedback
-00003bc0: 5f6b 6579 7322 2c20 5b5b 3130 2c20 3230  _keys", [[10, 20
-00003bd0: 5d2c 2031 302e 352c 2028 2261 222c 2022  ], 10.5, ("a", "
-00003be0: 6222 2c20 2263 2229 5d29 0a64 6566 2074  b", "c")]).def t
-00003bf0: 6573 745f 6c6f 675f 7265 636f 7264 5f69  est_log_record_i
-00003c00: 6e76 616c 6964 5f66 6565 6462 6163 6b5f  nvalid_feedback_
-00003c10: 6b65 7973 2866 6565 6462 6163 6b5f 6b65  keys(feedback_ke
-00003c20: 7973 2c20 636c 695f 6f62 6a2c 2063 6170  ys, cli_obj, cap
-00003c30: 6c6f 6729 3a0a 2020 2020 6361 706c 6f67  log):.    caplog
-00003c40: 2e73 6574 5f6c 6576 656c 286c 6f67 6769  .set_level(loggi
-00003c50: 6e67 2e45 5252 4f52 2c20 6c6f 6767 6572  ng.ERROR, logger
-00003c60: 3d22 6761 6e74 7279 2e63 6c69 656e 7422  ="gantry.client"
-00003c70: 290a 2020 2020 636c 695f 6f62 6a2e 6c6f  ).    cli_obj.lo
-00003c80: 675f 7265 636f 7264 280a 2020 2020 2020  g_record(.      
-00003c90: 2020 6170 706c 6963 6174 696f 6e3d 2273    application="s
-00003ca0: 6f6d 652d 6e61 6d65 222c 0a20 2020 2020  ome-name",.     
-00003cb0: 2020 2069 6e70 7574 733d 7b22 4122 3a20     inputs={"A": 
-00003cc0: 3130 307d 2c0a 2020 2020 2020 2020 6f75  100},.        ou
-00003cd0: 7470 7574 733d 7b22 7661 6c75 6522 3a20  tputs={"value": 
-00003ce0: 2262 6172 227d 2c0a 2020 2020 2020 2020  "bar"},.        
-00003cf0: 7665 7273 696f 6e3d 2261 2e62 2e63 222c  version="a.b.c",
-00003d00: 0a20 2020 2020 2020 2066 6565 6462 6163  .        feedbac
-00003d10: 6b5f 6b65 7973 3d66 6565 6462 6163 6b5f  k_keys=feedback_
-00003d20: 6b65 7973 2c0a 2020 2020 2020 2020 6967  keys,.        ig
-00003d30: 6e6f 7265 5f69 6e70 7574 733d 5b22 4122  nore_inputs=["A"
-00003d40: 5d2c 0a20 2020 2020 2020 2066 6565 6462  ],.        feedb
-00003d50: 6163 6b5f 6964 3d7b 2241 223a 2031 3030  ack_id={"A": 100
-00003d60: 7d2c 0a20 2020 2020 2020 2074 696d 6573  },.        times
-00003d70: 7461 6d70 3d53 4f4d 455f 5449 4d45 2c0a  tamp=SOME_TIME,.
-00003d80: 2020 2020 290a 2020 2020 6173 7365 7274      ).    assert
-00003d90: 2022 496e 7465 726e 616c 2065 7863 6570   "Internal excep
-00003da0: 7469 6f6e 2069 6e20 4761 6e74 7279 2063  tion in Gantry c
-00003db0: 6c69 656e 7422 2069 6e20 6361 706c 6f67  lient" in caplog
-00003dc0: 2e74 6578 740a 2020 2020 6173 7365 7274  .text.    assert
-00003dd0: 2022 5479 7065 4572 726f 723a 2220 696e   "TypeError:" in
-00003de0: 2063 6170 6c6f 672e 7465 7874 0a0a 0a40   caplog.text...@
-00003df0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
-00003e00: 6d65 7472 697a 6528 0a20 2020 2022 6967  metrize(.    "ig
-00003e10: 6e6f 7265 5f69 6e70 7574 7322 2c20 5b5b  nore_inputs", [[
-00003e20: 3130 2c20 3230 5d2c 205b 6222 736f 6d65  10, 20], [b"some
-00003e30: 7468 696e 6722 2c20 2262 696e 6172 7922  thing", "binary"
-00003e40: 5d2c 205b 2262 6172 222c 2031 302e 355d  ], ["bar", 10.5]
-00003e50: 2c20 5b31 302c 2022 666f 6f22 5d2c 2031  , [10, "foo"], 1
-00003e60: 302c 2031 302e 355d 0a29 0a64 6566 2074  0, 10.5].).def t
-00003e70: 6573 745f 6c6f 675f 7265 636f 7264 5f69  est_log_record_i
-00003e80: 6e76 616c 6964 5f69 676e 6f72 655f 696e  nvalid_ignore_in
-00003e90: 7075 7473 2869 676e 6f72 655f 696e 7075  puts(ignore_inpu
-00003ea0: 7473 2c20 636c 695f 6f62 6a2c 2063 6170  ts, cli_obj, cap
-00003eb0: 6c6f 6729 3a0a 2020 2020 6361 706c 6f67  log):.    caplog
-00003ec0: 2e73 6574 5f6c 6576 656c 286c 6f67 6769  .set_level(loggi
-00003ed0: 6e67 2e45 5252 4f52 2c20 6c6f 6767 6572  ng.ERROR, logger
-00003ee0: 3d22 6761 6e74 7279 2e63 6c69 656e 7422  ="gantry.client"
-00003ef0: 290a 2020 2020 636c 695f 6f62 6a2e 6c6f  ).    cli_obj.lo
-00003f00: 675f 7265 636f 7264 280a 2020 2020 2020  g_record(.      
-00003f10: 2020 6170 706c 6963 6174 696f 6e3d 2273    application="s
-00003f20: 6f6d 652d 6e61 6d65 222c 0a20 2020 2020  ome-name",.     
-00003f30: 2020 2069 6e70 7574 733d 7b22 4122 3a20     inputs={"A": 
-00003f40: 3130 307d 2c0a 2020 2020 2020 2020 6f75  100},.        ou
-00003f50: 7470 7574 733d 7b22 7661 6c75 6522 3a20  tputs={"value": 
-00003f60: 2262 6172 227d 2c0a 2020 2020 2020 2020  "bar"},.        
-00003f70: 7665 7273 696f 6e3d 2261 2e62 2e63 222c  version="a.b.c",
-00003f80: 0a20 2020 2020 2020 2069 676e 6f72 655f  .        ignore_
-00003f90: 696e 7075 7473 3d69 676e 6f72 655f 696e  inputs=ignore_in
-00003fa0: 7075 7473 2c0a 2020 2020 2020 2020 6665  puts,.        fe
-00003fb0: 6564 6261 636b 5f69 643d 7b22 4122 3a20  edback_id={"A": 
-00003fc0: 3130 307d 2c0a 2020 2020 2020 2020 7469  100},.        ti
-00003fd0: 6d65 7374 616d 703d 534f 4d45 5f54 494d  mestamp=SOME_TIM
-00003fe0: 452c 0a20 2020 2029 0a20 2020 2061 7373  E,.    ).    ass
-00003ff0: 6572 7420 2249 6e74 6572 6e61 6c20 6578  ert "Internal ex
-00004000: 6365 7074 696f 6e20 696e 2047 616e 7472  ception in Gantr
-00004010: 7920 636c 6965 6e74 2220 696e 2063 6170  y client" in cap
-00004020: 6c6f 672e 7465 7874 0a20 2020 2061 7373  log.text.    ass
-00004030: 6572 7420 2254 7970 6545 7272 6f72 3a22  ert "TypeError:"
-00004040: 2069 6e20 6361 706c 6f67 2e74 6578 740a   in caplog.text.
-00004050: 0a0a 4070 7974 6573 742e 6d61 726b 2e70  ..@pytest.mark.p
-00004060: 6172 616d 6574 7269 7a65 2822 6665 6564  arametrize("feed
-00004070: 6261 636b 5f69 6422 2c20 5b5b 3130 2c20  back_id", [[10, 
-00004080: 3230 5d2c 205b 2266 6f6f 225d 2c20 3130  20], ["foo"], 10
-00004090: 2c20 3130 2e35 5d29 0a64 6566 2074 6573  , 10.5]).def tes
-000040a0: 745f 6c6f 675f 7265 636f 7264 5f69 6e76  t_log_record_inv
-000040b0: 616c 6964 5f66 6565 6462 6163 6b5f 6964  alid_feedback_id
-000040c0: 5f66 6f72 5f70 7265 6469 6374 696f 6e28  _for_prediction(
-000040d0: 6665 6564 6261 636b 5f69 642c 2063 6c69  feedback_id, cli
-000040e0: 5f6f 626a 2c20 6361 706c 6f67 293a 0a20  _obj, caplog):. 
-000040f0: 2020 2063 6170 6c6f 672e 7365 745f 6c65     caplog.set_le
-00004100: 7665 6c28 6c6f 6767 696e 672e 4552 524f  vel(logging.ERRO
-00004110: 522c 206c 6f67 6765 723d 2267 616e 7472  R, logger="gantr
-00004120: 792e 636c 6965 6e74 2229 0a20 2020 2063  y.client").    c
-00004130: 6c69 5f6f 626a 2e6c 6f67 5f72 6563 6f72  li_obj.log_recor
-00004140: 6428 0a20 2020 2020 2020 2061 7070 6c69  d(.        appli
-00004150: 6361 7469 6f6e 3d22 736f 6d65 2d6e 616d  cation="some-nam
-00004160: 6522 2c0a 2020 2020 2020 2020 696e 7075  e",.        inpu
-00004170: 7473 3d7b 2241 223a 2031 3030 7d2c 0a20  ts={"A": 100},. 
-00004180: 2020 2020 2020 206f 7574 7075 7473 3d7b         outputs={
-00004190: 2276 616c 7565 223a 2022 6261 7222 7d2c  "value": "bar"},
-000041a0: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
-000041b0: 3d22 612e 622e 6322 2c0a 2020 2020 2020  ="a.b.c",.      
-000041c0: 2020 6665 6564 6261 636b 5f6b 6579 733d    feedback_keys=
-000041d0: 5b22 4122 5d2c 0a20 2020 2020 2020 2069  ["A"],.        i
-000041e0: 676e 6f72 655f 696e 7075 7473 3d5b 2241  gnore_inputs=["A
-000041f0: 225d 2c0a 2020 2020 2020 2020 6665 6564  "],.        feed
-00004200: 6261 636b 5f69 643d 6665 6564 6261 636b  back_id=feedback
-00004210: 5f69 642c 0a20 2020 2020 2020 2074 696d  _id,.        tim
-00004220: 6573 7461 6d70 3d53 4f4d 455f 5449 4d45  estamp=SOME_TIME
-00004230: 2c0a 2020 2020 290a 2020 2020 6173 7365  ,.    ).    asse
-00004240: 7274 2022 496e 7465 726e 616c 2065 7863  rt "Internal exc
-00004250: 6570 7469 6f6e 2069 6e20 4761 6e74 7279  eption in Gantry
-00004260: 2063 6c69 656e 7422 2069 6e20 6361 706c   client" in capl
-00004270: 6f67 2e74 6578 740a 2020 2020 6173 7365  og.text.    asse
-00004280: 7274 2022 5479 7065 4572 726f 723a 2220  rt "TypeError:" 
-00004290: 696e 2063 6170 6c6f 672e 7465 7874 0a0a  in caplog.text..
-000042a0: 0a40 6672 6565 7a65 5f74 696d 6528 4355  .@freeze_time(CU
-000042b0: 5252 454e 545f 5449 4d45 290a 4070 7974  RRENT_TIME).@pyt
-000042c0: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-000042d0: 7269 7a65 2822 6665 6564 6261 636b 5f69  rize("feedback_i
-000042e0: 6422 2c20 5b22 666f 6f22 2c20 7b22 666f  d", ["foo", {"fo
-000042f0: 6f22 3a20 2262 6172 227d 5d29 0a40 6d6f  o": "bar"}]).@mo
-00004300: 636b 2e70 6174 6368 2822 6761 6e74 7279  ck.patch("gantry
-00004310: 2e6c 6f67 6765 722e 6576 656e 745f 6275  .logger.event_bu
-00004320: 696c 6465 722e 7575 6964 2e75 7569 6434  ilder.uuid.uuid4
-00004330: 2229 0a64 6566 2074 6573 745f 6c6f 675f  ").def test_log_
-00004340: 7265 636f 7264 5f76 616c 6964 5f66 6565  record_valid_fee
-00004350: 6462 6163 6b5f 6964 5f66 6f72 5f70 7265  dback_id_for_pre
-00004360: 6469 6374 696f 6e28 6d6f 636b 5f75 7569  diction(mock_uui
-00004370: 642c 2066 6565 6462 6163 6b5f 6964 2c20  d, feedback_id, 
-00004380: 636c 695f 6f62 6a29 3a0a 2020 2020 6d6f  cli_obj):.    mo
-00004390: 636b 5f75 7569 642e 7265 7475 726e 5f76  ck_uuid.return_v
-000043a0: 616c 7565 203d 2022 3132 3334 3522 0a20  alue = "12345". 
-000043b0: 2020 2063 6c69 5f6f 626a 2e6c 6f67 5f72     cli_obj.log_r
-000043c0: 6563 6f72 6428 0a20 2020 2020 2020 2061  ecord(.        a
-000043d0: 7070 6c69 6361 7469 6f6e 3d22 736f 6d65  pplication="some
-000043e0: 2d6e 616d 6522 2c0a 2020 2020 2020 2020  -name",.        
-000043f0: 696e 7075 7473 3d7b 2241 223a 2031 3030  inputs={"A": 100
-00004400: 7d2c 0a20 2020 2020 2020 206f 7574 7075  },.        outpu
-00004410: 7473 3d7b 2276 616c 7565 223a 2022 6261  ts={"value": "ba
-00004420: 7222 7d2c 0a20 2020 2020 2020 2076 6572  r"},.        ver
-00004430: 7369 6f6e 3d22 612e 622e 6322 2c0a 2020  sion="a.b.c",.  
-00004440: 2020 2020 2020 6967 6e6f 7265 5f69 6e70        ignore_inp
-00004450: 7574 733d 5b22 4222 5d2c 0a20 2020 2020  uts=["B"],.     
-00004460: 2020 2066 6565 6462 6163 6b5f 6964 3d66     feedback_id=f
-00004470: 6565 6462 6163 6b5f 6964 2c0a 2020 2020  eedback_id,.    
-00004480: 2020 2020 7469 6d65 7374 616d 703d 534f      timestamp=SO
-00004490: 4d45 5f54 494d 452c 0a20 2020 2029 0a20  ME_TIME,.    ). 
-000044a0: 2020 2061 7373 6572 7420 636c 695f 6f62     assert cli_ob
-000044b0: 6a2e 6c6f 675f 7374 6f72 652e 6c6f 6773  j.log_store.logs
-000044c0: 203d 3d20 5b0a 2020 2020 2020 2020 7b0a   == [.        {.
-000044d0: 2020 2020 2020 2020 2020 2020 2265 7665              "eve
-000044e0: 6e74 7322 3a20 5b0a 2020 2020 2020 2020  nts": [.        
-000044f0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00004500: 2020 2020 2020 2020 2020 2020 2020 2262                "b
-00004510: 6174 6368 5f69 6422 3a20 4e6f 6e65 2c0a  atch_id": None,.
-00004520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004530: 2020 2020 2265 7665 6e74 5f69 6422 3a20      "event_id": 
-00004540: 2231 3233 3435 222c 0a20 2020 2020 2020  "12345",.       
-00004550: 2020 2020 2020 2020 2020 2020 2022 696e               "in
-00004560: 7075 7473 223a 207b 2241 223a 2031 3030  puts": {"A": 100
-00004570: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-00004580: 2020 2020 2020 2022 6f75 7470 7574 7322         "outputs"
-00004590: 3a20 7b22 7661 6c75 6522 3a20 2262 6172  : {"value": "bar
-000045a0: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-000045b0: 2020 2020 2020 2020 2274 6167 7322 3a20          "tags": 
-000045c0: 7b22 656e 7622 3a20 2274 6573 7422 7d2c  {"env": "test"},
-000045d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000045e0: 2020 2020 2022 6665 6564 6261 636b 5f69       "feedback_i
-000045f0: 6422 3a20 2234 3261 3562 3762 3939 6233  d": "42a5b7b99b3
-00004600: 3731 3764 3165 6165 6237 3261 3639 3438  717d1eaeb72a6948
-00004610: 6461 6263 3922 0a20 2020 2020 2020 2020  dabc9".         
-00004620: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-00004630: 696e 7374 616e 6365 2866 6565 6462 6163  instance(feedbac
-00004640: 6b5f 6964 2c20 6469 6374 290a 2020 2020  k_id, dict).    
-00004650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004660: 656c 7365 2066 6565 6462 6163 6b5f 6964  else feedback_id
-00004670: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00004680: 2020 2020 2020 226c 6f67 5f74 696d 6573        "log_times
-00004690: 7461 6d70 223a 2043 5552 5245 4e54 5f54  tamp": CURRENT_T
-000046a0: 494d 455f 5354 522c 0a20 2020 2020 2020  IME_STR,.       
-000046b0: 2020 2020 2020 2020 2020 2020 2022 6d65               "me
-000046c0: 7461 6461 7461 223a 207b 0a20 2020 2020  tadata": {.     
-000046d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000046e0: 2020 2022 6675 6e63 5f6e 616d 6522 3a20     "func_name": 
-000046f0: 2273 6f6d 652d 6e61 6d65 222c 0a20 2020  "some-name",.   
-00004700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004710: 2020 2020 2022 7665 7273 696f 6e22 3a20       "version": 
-00004720: 2261 2e62 2e63 222c 0a20 2020 2020 2020  "a.b.c",.       
-00004730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004740: 2022 6967 6e6f 7265 5f69 6e70 7574 7322   "ignore_inputs"
-00004750: 3a20 5b22 4222 5d2c 0a20 2020 2020 2020  : ["B"],.       
-00004760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004770: 2022 6665 6564 6261 636b 5f6b 6579 7322   "feedback_keys"
-00004780: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-00004790: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-000047a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000047b0: 2020 2022 7469 6d65 7374 616d 7022 3a20     "timestamp": 
-000047c0: 534f 4d45 5f54 494d 455f 5354 522c 0a20  SOME_TIME_STR,. 
-000047d0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-000047e0: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
-000047f0: 2020 2020 2020 2020 2020 2020 2261 7070              "app
-00004800: 6c69 6361 7469 6f6e 223a 2022 736f 6d65  lication": "some
-00004810: 2d6e 616d 6522 2c0a 2020 2020 2020 2020  -name",.        
-00004820: 7d2c 0a20 2020 205d 0a0a 0a40 6672 6565  },.    ]...@free
-00004830: 7a65 5f74 696d 6528 4355 5252 454e 545f  ze_time(CURRENT_
-00004840: 5449 4d45 290a 4070 7974 6573 742e 6d61  TIME).@pytest.ma
-00004850: 726b 2e70 6172 616d 6574 7269 7a65 2822  rk.parametrize("
-00004860: 6665 6564 6261 636b 5f69 6422 2c20 5b22  feedback_id", ["
-00004870: 666f 6f22 2c20 7b22 666f 6f22 3a20 2262  foo", {"foo": "b
-00004880: 6172 227d 5d29 0a40 6d6f 636b 2e70 6174  ar"}]).@mock.pat
-00004890: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
-000048a0: 722e 6576 656e 745f 6275 696c 6465 722e  r.event_builder.
-000048b0: 7575 6964 2e75 7569 6434 2229 0a64 6566  uuid.uuid4").def
-000048c0: 2074 6573 745f 7369 6e67 6c65 5f6c 6f67   test_single_log
-000048d0: 5f72 6563 6f72 645f 7661 6c69 645f 6665  _record_valid_fe
-000048e0: 6564 6261 636b 5f69 645f 666f 725f 7072  edback_id_for_pr
-000048f0: 6564 6963 7469 6f6e 286d 6f63 6b5f 7575  ediction(mock_uu
-00004900: 6964 2c20 6665 6564 6261 636b 5f69 642c  id, feedback_id,
-00004910: 2063 6c69 5f6f 626a 293a 0a20 2020 206d   cli_obj):.    m
-00004920: 6f63 6b5f 7575 6964 2e72 6574 7572 6e5f  ock_uuid.return_
-00004930: 7661 6c75 6520 3d20 2231 3233 3435 220a  value = "12345".
-00004940: 2020 2020 636c 695f 6f62 6a2e 7369 6e67      cli_obj.sing
-00004950: 6c65 5f6c 6f67 5f72 6563 6f72 6428 0a20  le_log_record(. 
-00004960: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
-00004970: 6f6e 3d22 736f 6d65 2d6e 616d 6522 2c0a  on="some-name",.
-00004980: 2020 2020 2020 2020 696e 7075 7473 3d7b          inputs={
-00004990: 2241 223a 2031 3030 7d2c 0a20 2020 2020  "A": 100},.     
-000049a0: 2020 206f 7574 7075 7473 3d7b 2276 616c     outputs={"val
-000049b0: 7565 223a 2022 6261 7222 7d2c 0a20 2020  ue": "bar"},.   
-000049c0: 2020 2020 2076 6572 7369 6f6e 3d22 612e       version="a.
-000049d0: 622e 6322 2c0a 2020 2020 2020 2020 6967  b.c",.        ig
-000049e0: 6e6f 7265 5f69 6e70 7574 733d 5b22 4222  nore_inputs=["B"
-000049f0: 5d2c 0a20 2020 2020 2020 2066 6565 6462  ],.        feedb
-00004a00: 6163 6b5f 6964 3d66 6565 6462 6163 6b5f  ack_id=feedback_
-00004a10: 6964 2c0a 2020 2020 2020 2020 7469 6d65  id,.        time
-00004a20: 7374 616d 703d 534f 4d45 5f54 494d 452c  stamp=SOME_TIME,
-00004a30: 0a20 2020 2029 0a20 2020 2061 7373 6572  .    ).    asser
-00004a40: 7420 636c 695f 6f62 6a2e 6c6f 675f 7374  t cli_obj.log_st
-00004a50: 6f72 652e 6c6f 6773 203d 3d20 5b0a 2020  ore.logs == [.  
-00004a60: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-00004a70: 2020 2020 2265 7665 6e74 7322 3a20 5b0a      "events": [.
-00004a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a90: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00004aa0: 2020 2020 2020 2262 6174 6368 5f69 6422        "batch_id"
-00004ab0: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-00004ac0: 2020 2020 2020 2020 2020 2020 2265 7665              "eve
-00004ad0: 6e74 5f69 6422 3a20 2231 3233 3435 222c  nt_id": "12345",
-00004ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004af0: 2020 2020 2022 696e 7075 7473 223a 207b       "inputs": {
-00004b00: 2241 223a 2031 3030 7d2c 0a20 2020 2020  "A": 100},.     
-00004b10: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00004b20: 6f75 7470 7574 7322 3a20 7b22 7661 6c75  outputs": {"valu
-00004b30: 6522 3a20 2262 6172 227d 2c0a 2020 2020  e": "bar"},.    
-00004b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004b50: 2274 6167 7322 3a20 7b22 656e 7622 3a20  "tags": {"env": 
-00004b60: 2274 6573 7422 7d2c 0a20 2020 2020 2020  "test"},.       
-00004b70: 2020 2020 2020 2020 2020 2020 2022 6665               "fe
-00004b80: 6564 6261 636b 5f69 6422 3a20 2234 3261  edback_id": "42a
-00004b90: 3562 3762 3939 6233 3731 3764 3165 6165  5b7b99b3717d1eae
-00004ba0: 6237 3261 3639 3438 6461 6263 3922 0a20  b72a6948dabc9". 
-00004bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004bc0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00004bd0: 2866 6565 6462 6163 6b5f 6964 2c20 6469  (feedback_id, di
-00004be0: 6374 290a 2020 2020 2020 2020 2020 2020  ct).            
-00004bf0: 2020 2020 2020 2020 656c 7365 2066 6565          else fee
-00004c00: 6462 6163 6b5f 6964 2c0a 2020 2020 2020  dback_id,.      
-00004c10: 2020 2020 2020 2020 2020 2020 2020 226c                "l
-00004c20: 6f67 5f74 696d 6573 7461 6d70 223a 2043  og_timestamp": C
-00004c30: 5552 5245 4e54 5f54 494d 455f 5354 522c  URRENT_TIME_STR,
-00004c40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004c50: 2020 2020 2022 6d65 7461 6461 7461 223a       "metadata":
-00004c60: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00004c70: 2020 2020 2020 2020 2020 2022 6675 6e63             "func
-00004c80: 5f6e 616d 6522 3a20 2273 6f6d 652d 6e61  _name": "some-na
-00004c90: 6d65 222c 0a20 2020 2020 2020 2020 2020  me",.           
-00004ca0: 2020 2020 2020 2020 2020 2020 2022 7665               "ve
-00004cb0: 7273 696f 6e22 3a20 2261 2e62 2e63 222c  rsion": "a.b.c",
-00004cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004cd0: 2020 2020 2020 2020 2022 6967 6e6f 7265           "ignore
-00004ce0: 5f69 6e70 7574 7322 3a20 5b22 4222 5d2c  _inputs": ["B"],
-00004cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004d00: 2020 2020 2020 2020 2022 6665 6564 6261           "feedba
-00004d10: 636b 5f6b 6579 7322 3a20 4e6f 6e65 2c0a  ck_keys": None,.
-00004d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004d30: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-00004d40: 2020 2020 2020 2020 2020 2022 7469 6d65             "time
-00004d50: 7374 616d 7022 3a20 534f 4d45 5f54 494d  stamp": SOME_TIM
-00004d60: 455f 5354 522c 0a20 2020 2020 2020 2020  E_STR,.         
-00004d70: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00004d80: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-00004d90: 2020 2020 2261 7070 6c69 6361 7469 6f6e      "application
-00004da0: 223a 2022 736f 6d65 2d6e 616d 6522 2c0a  ": "some-name",.
-00004db0: 2020 2020 2020 2020 7d2c 0a20 2020 205d          },.    ]
-00004dc0: 0a0a 0a40 6672 6565 7a65 5f74 696d 6528  ...@freeze_time(
-00004dd0: 4355 5252 454e 545f 5449 4d45 290a 4070  CURRENT_TIME).@p
-00004de0: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
-00004df0: 6574 7269 7a65 2822 6665 6564 6261 636b  etrize("feedback
-00004e00: 5f69 6422 2c20 5b22 666f 6f22 2c20 7b22  _id", ["foo", {"
-00004e10: 666f 6f22 3a20 2262 6172 227d 5d29 0a40  foo": "bar"}]).@
-00004e20: 6d6f 636b 2e70 6174 6368 2822 6761 6e74  mock.patch("gant
-00004e30: 7279 2e6c 6f67 6765 722e 6576 656e 745f  ry.logger.event_
-00004e40: 6275 696c 6465 722e 7575 6964 2e75 7569  builder.uuid.uui
-00004e50: 6434 2229 0a64 6566 2074 6573 745f 6c6f  d4").def test_lo
-00004e60: 675f 7265 636f 7264 5f76 616c 6964 5f66  g_record_valid_f
-00004e70: 6565 6462 6163 6b5f 6964 5f66 6f72 5f66  eedback_id_for_f
-00004e80: 6565 6462 6163 6b28 6d6f 636b 5f75 7569  eedback(mock_uui
-00004e90: 642c 2066 6565 6462 6163 6b5f 6964 2c20  d, feedback_id, 
-00004ea0: 636c 695f 6f62 6a29 3a0a 2020 2020 6d6f  cli_obj):.    mo
-00004eb0: 636b 5f75 7569 642e 7265 7475 726e 5f76  ck_uuid.return_v
-00004ec0: 616c 7565 203d 2022 3132 3334 3522 0a20  alue = "12345". 
-00004ed0: 2020 2063 6c69 5f6f 626a 2e6c 6f67 5f72     cli_obj.log_r
-00004ee0: 6563 6f72 6428 0a20 2020 2020 2020 2061  ecord(.        a
-00004ef0: 7070 6c69 6361 7469 6f6e 3d22 736f 6d65  pplication="some
-00004f00: 2d6e 616d 6522 2c0a 2020 2020 2020 2020  -name",.        
-00004f10: 6665 6564 6261 636b 3d7b 2241 223a 2031  feedback={"A": 1
-00004f20: 3030 7d2c 0a20 2020 2020 2020 2076 6572  00},.        ver
-00004f30: 7369 6f6e 3d22 612e 622e 6322 2c0a 2020  sion="a.b.c",.  
-00004f40: 2020 2020 2020 6665 6564 6261 636b 5f69        feedback_i
-00004f50: 643d 6665 6564 6261 636b 5f69 642c 0a20  d=feedback_id,. 
-00004f60: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
-00004f70: 3d53 4f4d 455f 5449 4d45 2c0a 2020 2020  =SOME_TIME,.    
-00004f80: 290a 2020 2020 6173 7365 7274 2063 6c69  ).    assert cli
-00004f90: 5f6f 626a 2e6c 6f67 5f73 746f 7265 2e6c  _obj.log_store.l
-00004fa0: 6f67 7320 3d3d 205b 0a20 2020 2020 2020  ogs == [.       
-00004fb0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-00004fc0: 6576 656e 7473 223a 205b 0a20 2020 2020  events": [.     
-00004fd0: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
-00004fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004ff0: 2022 6261 7463 685f 6964 223a 204e 6f6e   "batch_id": Non
-00005000: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00005010: 2020 2020 2020 2022 6576 656e 745f 6964         "event_id
-00005020: 223a 2022 3132 3334 3522 2c0a 2020 2020  ": "12345",.    
-00005030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005040: 2266 6565 6462 6163 6b22 3a20 7b22 4122  "feedback": {"A"
-00005050: 3a20 3130 307d 2c0a 2020 2020 2020 2020  : 100},.        
-00005060: 2020 2020 2020 2020 2020 2020 2266 6565              "fee
-00005070: 6462 6163 6b5f 6964 223a 2022 3432 6135  dback_id": "42a5
-00005080: 6237 6239 3962 3337 3137 6431 6561 6562  b7b99b3717d1eaeb
-00005090: 3732 6136 3934 3864 6162 6339 220a 2020  72a6948dabc9".  
-000050a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000050b0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000050c0: 6665 6564 6261 636b 5f69 642c 2064 6963  feedback_id, dic
-000050d0: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
-000050e0: 2020 2020 2020 2065 6c73 6520 6665 6564         else feed
-000050f0: 6261 636b 5f69 642c 0a20 2020 2020 2020  back_id,.       
-00005100: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
-00005110: 675f 7469 6d65 7374 616d 7022 3a20 4355  g_timestamp": CU
-00005120: 5252 454e 545f 5449 4d45 5f53 5452 2c0a  RRENT_TIME_STR,.
-00005130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005140: 2020 2020 226d 6574 6164 6174 6122 3a20      "metadata": 
-00005150: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00005160: 2020 2020 2020 2020 2020 2266 756e 635f            "func_
-00005170: 6e61 6d65 223a 2022 736f 6d65 2d6e 616d  name": "some-nam
-00005180: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-00005190: 2020 2020 2020 2020 2020 2020 2266 6565              "fee
-000051a0: 6462 6163 6b5f 7665 7273 696f 6e22 3a20  dback_version": 
-000051b0: 2261 2e62 2e63 222c 0a20 2020 2020 2020  "a.b.c",.       
-000051c0: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
-000051d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000051e0: 2020 2020 2274 696d 6573 7461 6d70 223a      "timestamp":
-000051f0: 2053 4f4d 455f 5449 4d45 5f53 5452 2c0a   SOME_TIME_STR,.
-00005200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005210: 7d0a 2020 2020 2020 2020 2020 2020 5d2c  }.            ],
-00005220: 0a20 2020 2020 2020 2020 2020 2022 6170  .            "ap
-00005230: 706c 6963 6174 696f 6e22 3a20 2273 6f6d  plication": "som
-00005240: 652d 6e61 6d65 222c 0a20 2020 2020 2020  e-name",.       
-00005250: 207d 2c0a 2020 2020 5d0a 0a0a 4066 7265   },.    ]...@fre
-00005260: 657a 655f 7469 6d65 2843 5552 5245 4e54  eze_time(CURRENT
-00005270: 5f54 494d 4529 0a40 7079 7465 7374 2e6d  _TIME).@pytest.m
-00005280: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
-00005290: 2266 6565 6462 6163 6b5f 6964 222c 205b  "feedback_id", [
-000052a0: 2266 6f6f 222c 207b 2266 6f6f 223a 2022  "foo", {"foo": "
-000052b0: 6261 7222 7d5d 290a 406d 6f63 6b2e 7061  bar"}]).@mock.pa
-000052c0: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
-000052d0: 6572 2e65 7665 6e74 5f62 7569 6c64 6572  er.event_builder
-000052e0: 2e75 7569 642e 7575 6964 3422 290a 6465  .uuid.uuid4").de
-000052f0: 6620 7465 7374 5f73 696e 676c 655f 6c6f  f test_single_lo
-00005300: 675f 7265 636f 7264 5f76 616c 6964 5f66  g_record_valid_f
-00005310: 6565 6462 6163 6b5f 6964 5f66 6f72 5f66  eedback_id_for_f
-00005320: 6565 6462 6163 6b28 6d6f 636b 5f75 7569  eedback(mock_uui
-00005330: 642c 2066 6565 6462 6163 6b5f 6964 2c20  d, feedback_id, 
-00005340: 636c 695f 6f62 6a29 3a0a 2020 2020 6d6f  cli_obj):.    mo
-00005350: 636b 5f75 7569 642e 7265 7475 726e 5f76  ck_uuid.return_v
-00005360: 616c 7565 203d 2022 3132 3334 3522 0a20  alue = "12345". 
-00005370: 2020 2063 6c69 5f6f 626a 2e73 696e 676c     cli_obj.singl
-00005380: 655f 6c6f 675f 7265 636f 7264 280a 2020  e_log_record(.  
-00005390: 2020 2020 2020 6170 706c 6963 6174 696f        applicatio
-000053a0: 6e3d 2273 6f6d 652d 6e61 6d65 222c 0a20  n="some-name",. 
-000053b0: 2020 2020 2020 2066 6565 6462 6163 6b3d         feedback=
-000053c0: 7b22 4122 3a20 3130 307d 2c0a 2020 2020  {"A": 100},.    
-000053d0: 2020 2020 7665 7273 696f 6e3d 2261 2e62      version="a.b
-000053e0: 2e63 222c 0a20 2020 2020 2020 2066 6565  .c",.        fee
-000053f0: 6462 6163 6b5f 6964 3d66 6565 6462 6163  dback_id=feedbac
-00005400: 6b5f 6964 2c0a 2020 2020 2020 2020 7469  k_id,.        ti
-00005410: 6d65 7374 616d 703d 534f 4d45 5f54 494d  mestamp=SOME_TIM
-00005420: 452c 0a20 2020 2029 0a20 2020 2061 7373  E,.    ).    ass
-00005430: 6572 7420 636c 695f 6f62 6a2e 6c6f 675f  ert cli_obj.log_
-00005440: 7374 6f72 652e 6c6f 6773 203d 3d20 5b0a  store.logs == [.
-00005450: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00005460: 2020 2020 2020 2265 7665 6e74 7322 3a20        "events": 
-00005470: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00005480: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-00005490: 2020 2020 2020 2020 2262 6174 6368 5f69          "batch_i
-000054a0: 6422 3a20 4e6f 6e65 2c0a 2020 2020 2020  d": None,.      
-000054b0: 2020 2020 2020 2020 2020 2020 2020 2265                "e
-000054c0: 7665 6e74 5f69 6422 3a20 2231 3233 3435  vent_id": "12345
-000054d0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000054e0: 2020 2020 2020 2022 6665 6564 6261 636b         "feedback
-000054f0: 223a 207b 2241 223a 2031 3030 7d2c 0a20  ": {"A": 100},. 
+00001e70: 6462 6163 6b5f 6964 2c0a 2020 2020 2020  dback_id,.      
+00001e80: 2020 2020 2020 6665 6564 6261 636b 5f6b        feedback_k
+00001e90: 6579 732c 0a20 2020 2020 2020 2020 2020  eys,.           
+00001ea0: 206a 6f69 6e5f 6b65 792c 0a20 2020 2020   join_key,.     
+00001eb0: 2020 2029 0a0a 0a40 7079 7465 7374 2e6d     )...@pytest.m
+00001ec0: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+00001ed0: 0a20 2020 205b 2273 697a 6522 2c20 2269  .    ["size", "i
+00001ee0: 6e70 7574 7322 2c20 2266 6565 6462 6163  nputs", "feedbac
+00001ef0: 6b5f 6964 222c 2022 6665 6564 6261 636b  k_id", "feedback
+00001f00: 5f6b 6579 7322 2c20 226a 6f69 6e5f 6b65  _keys", "join_ke
+00001f10: 7922 2c20 2265 7870 6563 7465 6422 5d2c  y", "expected"],
+00001f20: 0a20 2020 205b 0a20 2020 2020 2020 2028  .    [.        (
+00001f30: 0a20 2020 2020 2020 2020 2020 2032 2c0a  .            2,.
+00001f40: 2020 2020 2020 2020 2020 2020 5b7b 2266              [{"f
+00001f50: 6f6f 223a 2022 6261 7222 7d2c 207b 2266  oo": "bar"}, {"f
+00001f60: 6f6f 223a 2022 6261 7a22 7d5d 2c0a 2020  oo": "baz"}],.  
+00001f70: 2020 2020 2020 2020 2020 5b7b 2269 6422            [{"id"
+00001f80: 3a20 2231 3233 3435 227d 2c20 7b22 6964  : "12345"}, {"id
+00001f90: 223a 2022 3637 3839 3022 7d5d 2c0a 2020  ": "67890"}],.  
+00001fa0: 2020 2020 2020 2020 2020 4e6f 6e65 2c0a            None,.
+00001fb0: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
+00001fc0: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
+00001fd0: 3830 6566 3636 6265 3831 6462 6162 6133  80ef66be81dbaba3
+00001fe0: 3064 6232 3564 3133 3336 3231 3764 3064  0db25d1336217d0d
+00001ff0: 222c 2022 3463 6535 3865 3138 3562 6538  ", "4ce58e185be8
+00002000: 3739 3437 3337 3565 3239 3630 3731 6235  7947375e296071b5
+00002010: 3961 3933 225d 2c0a 2020 2020 2020 2020  9a93"],.        
+00002020: 292c 0a20 2020 2020 2020 2028 0a20 2020  ),.        (.   
+00002030: 2020 2020 2020 2020 2032 2c0a 2020 2020           2,.    
+00002040: 2020 2020 2020 2020 5b7b 2266 6f6f 223a          [{"foo":
+00002050: 2022 6261 7222 7d2c 207b 2266 6f6f 223a   "bar"}, {"foo":
+00002060: 2022 6261 7a22 7d5d 2c0a 2020 2020 2020   "baz"}],.      
+00002070: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
+00002080: 2020 2020 2020 2020 5b22 666f 6f22 5d2c          ["foo"],
+00002090: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
+000020a0: 652c 0a20 2020 2020 2020 2020 2020 205b  e,.            [
+000020b0: 2234 3261 3562 3762 3939 6233 3731 3764  "42a5b7b99b3717d
+000020c0: 3165 6165 6237 3261 3639 3438 6461 6263  1eaeb72a6948dabc
+000020d0: 3922 2c20 2231 3433 3635 3461 3566 3061  9", "143654a5f0a
+000020e0: 3035 3961 3137 3839 3234 6261 6639 6238  059a178924baf9b8
+000020f0: 3135 6561 3622 5d2c 0a20 2020 2020 2020  15ea6"],.       
+00002100: 2029 2c0a 2020 2020 2020 2020 2832 2c20   ),.        (2, 
+00002110: 5b7b 2266 6f6f 223a 2022 6261 7222 7d2c  [{"foo": "bar"},
+00002120: 207b 2266 6f6f 223a 2022 6261 7a22 7d5d   {"foo": "baz"}]
+00002130: 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f  , None, None, No
+00002140: 6e65 2c20 4e6f 6e65 292c 0a20 2020 2020  ne, None),.     
+00002150: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
+00002160: 2032 2c0a 2020 2020 2020 2020 2020 2020   2,.            
+00002170: 5b7b 2266 6f6f 223a 2022 6261 7222 7d2c  [{"foo": "bar"},
+00002180: 207b 2266 6f6f 223a 2022 6261 7a22 7d5d   {"foo": "baz"}]
+00002190: 2c0a 2020 2020 2020 2020 2020 2020 4e6f  ,.            No
+000021a0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+000021b0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+000021c0: 2020 5b22 666f 6f62 6172 222c 2022 6261    ["foobar", "ba
+000021d0: 7262 617a 225d 2c0a 2020 2020 2020 2020  rbaz"],.        
+000021e0: 2020 2020 5b22 666f 6f62 6172 222c 2022      ["foobar", "
+000021f0: 6261 7262 617a 225d 2c0a 2020 2020 2020  barbaz"],.      
+00002200: 2020 292c 0a20 2020 205d 2c0a 290a 6465    ),.    ],.).de
+00002210: 6620 7465 7374 5f72 6573 6f6c 7665 5f6a  f test_resolve_j
+00002220: 6f69 6e5f 6b65 7973 2873 697a 652c 2069  oin_keys(size, i
+00002230: 6e70 7574 732c 2066 6565 6462 6163 6b5f  nputs, feedback_
+00002240: 6964 2c20 6665 6564 6261 636b 5f6b 6579  id, feedback_key
+00002250: 732c 206a 6f69 6e5f 6b65 792c 2065 7870  s, join_key, exp
+00002260: 6563 7465 6429 3a0a 2020 2020 6173 7365  ected):.    asse
+00002270: 7274 2028 0a20 2020 2020 2020 2063 6c69  rt (.        cli
+00002280: 656e 742e 5f72 6573 6f6c 7665 5f6a 6f69  ent._resolve_joi
+00002290: 6e5f 6b65 7973 280a 2020 2020 2020 2020  n_keys(.        
+000022a0: 2020 2020 7369 7a65 2c0a 2020 2020 2020      size,.      
+000022b0: 2020 2020 2020 696e 7075 7473 2c0a 2020        inputs,.  
+000022c0: 2020 2020 2020 2020 2020 6665 6564 6261            feedba
+000022d0: 636b 5f69 642c 0a20 2020 2020 2020 2020  ck_id,.         
+000022e0: 2020 2066 6565 6462 6163 6b5f 6b65 7973     feedback_keys
+000022f0: 2c0a 2020 2020 2020 2020 2020 2020 6a6f  ,.            jo
+00002300: 696e 5f6b 6579 2c0a 2020 2020 2020 2020  in_key,.        
+00002310: 290a 2020 2020 2020 2020 3d3d 2065 7870  ).        == exp
+00002320: 6563 7465 640a 2020 2020 290a 0a0a 4070  ected.    )...@p
+00002330: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+00002340: 6574 7269 7a65 280a 2020 2020 5b22 696e  etrize(.    ["in
+00002350: 7075 7473 222c 2022 6665 6564 6261 636b  puts", "feedback
+00002360: 5f69 6473 222c 2022 6665 6564 6261 636b  _ids", "feedback
+00002370: 5f6b 6579 7322 2c20 226a 6f69 6e5f 6b65  _keys", "join_ke
+00002380: 7973 222c 2022 6572 726f 725f 7422 5d2c  ys", "error_t"],
+00002390: 0a20 2020 205b 0a20 2020 2020 2020 2028  .    [.        (
+000023a0: 5b7b 2266 6f6f 223a 2022 6261 7222 7d5d  [{"foo": "bar"}]
+000023b0: 2c20 5b7b 2269 6422 3a20 2231 3233 3435  , [{"id": "12345
+000023c0: 227d 5d2c 205b 2266 6f6f 225d 2c20 4e6f  "}], ["foo"], No
+000023d0: 6e65 2c20 4761 6e74 7279 4c6f 6767 696e  ne, GantryLoggin
+000023e0: 6745 7863 6570 7469 6f6e 292c 0a20 2020  gException),.   
+000023f0: 2020 2020 2028 5b7b 2266 6f6f 223a 2022       ([{"foo": "
+00002400: 6261 7222 7d5d 2c20 4e6f 6e65 2c20 5b22  bar"}], None, ["
+00002410: 666f 6f22 5d2c 205b 2262 6172 6261 7a22  foo"], ["barbaz"
+00002420: 5d2c 2056 616c 7565 4572 726f 7229 2c0a  ], ValueError),.
+00002430: 2020 2020 2020 2020 285b 7b22 666f 6f22          ([{"foo"
+00002440: 3a20 2262 6172 227d 5d2c 205b 7b22 6964  : "bar"}], [{"id
+00002450: 223a 2022 3132 3334 3522 7d5d 2c20 4e6f  ": "12345"}], No
+00002460: 6e65 2c20 5b22 6261 7262 617a 225d 2c20  ne, ["barbaz"], 
+00002470: 5661 6c75 6545 7272 6f72 292c 0a20 2020  ValueError),.   
+00002480: 2020 2020 2028 5b7b 2266 6f6f 223a 2022       ([{"foo": "
+00002490: 6261 7222 7d5d 2c20 5b7b 2269 6422 3a20  bar"}], [{"id": 
+000024a0: 2231 3233 3435 227d 5d2c 205b 2266 6f6f  "12345"}], ["foo
+000024b0: 225d 2c20 5b22 6261 7262 617a 225d 2c20  "], ["barbaz"], 
+000024c0: 5661 6c75 6545 7272 6f72 292c 0a20 2020  ValueError),.   
+000024d0: 205d 2c0a 290a 6465 6620 7465 7374 5f72   ],.).def test_r
+000024e0: 6573 6f6c 7665 5f6a 6f69 6e5f 6b65 7973  esolve_join_keys
+000024f0: 5f65 7272 6f72 2869 6e70 7574 732c 2066  _error(inputs, f
+00002500: 6565 6462 6163 6b5f 6964 732c 2066 6565  eedback_ids, fee
+00002510: 6462 6163 6b5f 6b65 7973 2c20 6a6f 696e  dback_keys, join
+00002520: 5f6b 6579 732c 2065 7272 6f72 5f74 293a  _keys, error_t):
+00002530: 0a20 2020 2077 6974 6820 7079 7465 7374  .    with pytest
+00002540: 2e72 6169 7365 7328 6572 726f 725f 7429  .raises(error_t)
+00002550: 3a0a 2020 2020 2020 2020 5f20 3d20 636c  :.        _ = cl
+00002560: 6965 6e74 2e5f 7265 736f 6c76 655f 6a6f  ient._resolve_jo
+00002570: 696e 5f6b 6579 7328 0a20 2020 2020 2020  in_keys(.       
+00002580: 2020 2020 2031 302c 0a20 2020 2020 2020       10,.       
+00002590: 2020 2020 2069 6e70 7574 732c 0a20 2020       inputs,.   
+000025a0: 2020 2020 2020 2020 2066 6565 6462 6163           feedbac
+000025b0: 6b5f 6964 732c 0a20 2020 2020 2020 2020  k_ids,.         
+000025c0: 2020 2066 6565 6462 6163 6b5f 6b65 7973     feedback_keys
+000025d0: 2c0a 2020 2020 2020 2020 2020 2020 6a6f  ,.            jo
+000025e0: 696e 5f6b 6579 732c 0a20 2020 2020 2020  in_keys,.       
+000025f0: 2029 0a0a 0a64 6566 2074 6573 745f 7069   )...def test_pi
+00002600: 6e67 5f66 6169 6c28 636c 695f 6f62 6a29  ng_fail(cli_obj)
+00002610: 3a0a 2020 2020 636c 695f 6f62 6a2e 6c6f  :.    cli_obj.lo
+00002620: 675f 7374 6f72 652e 7374 6174 7573 203d  g_store.status =
+00002630: 2046 616c 7365 0a20 2020 2061 7373 6572   False.    asser
+00002640: 7420 6e6f 7420 636c 695f 6f62 6a2e 7069  t not cli_obj.pi
+00002650: 6e67 2829 0a0a 0a64 6566 2074 6573 745f  ng()...def test_
+00002660: 7069 6e67 5f73 7563 6365 7373 2863 6c69  ping_success(cli
+00002670: 5f6f 626a 293a 0a20 2020 2063 6c69 5f6f  _obj):.    cli_o
+00002680: 626a 2e6c 6f67 5f73 746f 7265 2e73 7461  bj.log_store.sta
+00002690: 7475 7320 3d20 5472 7565 0a20 2020 2061  tus = True.    a
+000026a0: 7373 6572 7420 636c 695f 6f62 6a2e 7069  ssert cli_obj.pi
+000026b0: 6e67 2829 0a0a 0a40 6672 6565 7a65 5f74  ng()...@freeze_t
+000026c0: 696d 6528 4355 5252 454e 545f 5449 4d45  ime(CURRENT_TIME
+000026d0: 290a 4070 7974 6573 742e 6d61 726b 2e70  ).@pytest.mark.p
+000026e0: 6172 616d 6574 7269 7a65 2822 7461 6773  arametrize("tags
+000026f0: 222c 205b 7b22 656e 7622 3a20 226f 7665  ", [{"env": "ove
+00002700: 7277 7269 7465 5f65 6e76 227d 2c20 7b7d  rwrite_env"}, {}
+00002710: 2c20 4e6f 6e65 5d29 0a40 7079 7465 7374  , None]).@pytest
+00002720: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
+00002730: 6528 2274 696d 6573 7461 6d70 222c 205b  e("timestamp", [
+00002740: 4e6f 6e65 2c20 534f 4d45 5f54 494d 455d  None, SOME_TIME]
+00002750: 290a 4070 7974 6573 742e 6d61 726b 2e70  ).@pytest.mark.p
+00002760: 6172 616d 6574 7269 7a65 2822 6665 6564  arametrize("feed
+00002770: 6261 636b 5f76 6572 7369 6f6e 222c 205b  back_version", [
+00002780: 4e6f 6e65 2c20 2231 2e32 2e33 222c 2031  None, "1.2.3", 1
+00002790: 305d 290a 406d 6f63 6b2e 7061 7463 6828  0]).@mock.patch(
+000027a0: 2267 616e 7472 792e 6c6f 6767 6572 2e65  "gantry.logger.e
+000027b0: 7665 6e74 5f62 7569 6c64 6572 2e75 7569  vent_builder.uui
+000027c0: 642e 7575 6964 3422 290a 6465 6620 7465  d.uuid4").def te
+000027d0: 7374 5f6c 6f67 5f66 6565 6462 6163 6b5f  st_log_feedback_
+000027e0: 6576 656e 7428 6d6f 636b 5f75 7569 642c  event(mock_uuid,
+000027f0: 2066 6565 6462 6163 6b5f 7665 7273 696f   feedback_versio
+00002800: 6e2c 2074 696d 6573 7461 6d70 2c20 7461  n, timestamp, ta
+00002810: 6773 2c20 636c 695f 6f62 6a29 3a0a 2020  gs, cli_obj):.  
+00002820: 2020 6d6f 636b 5f75 7569 642e 7265 7475    mock_uuid.retu
+00002830: 726e 5f76 616c 7565 203d 2022 3132 3334  rn_value = "1234
+00002840: 3522 0a20 2020 2061 7373 6572 7420 280a  5".    assert (.
+00002850: 2020 2020 2020 2020 636c 695f 6f62 6a2e          cli_obj.
+00002860: 5f6c 6f67 5f66 6565 6462 6163 6b5f 6576  _log_feedback_ev
+00002870: 656e 7428 0a20 2020 2020 2020 2020 2020  ent(.           
+00002880: 2061 7070 6c69 6361 7469 6f6e 3d22 666f   application="fo
+00002890: 6f62 6172 222c 0a20 2020 2020 2020 2020  obar",.         
+000028a0: 2020 206a 6f69 6e5f 6b65 793d 2231 3233     join_key="123
+000028b0: 3435 3637 3839 3022 2c0a 2020 2020 2020  4567890",.      
+000028c0: 2020 2020 2020 6665 6564 6261 636b 3d7b        feedback={
+000028d0: 2276 616c 7565 223a 2022 6261 7222 7d2c  "value": "bar"},
+000028e0: 0a20 2020 2020 2020 2020 2020 2066 6565  .            fee
+000028f0: 6462 6163 6b5f 7665 7273 696f 6e3d 6665  dback_version=fe
+00002900: 6564 6261 636b 5f76 6572 7369 6f6e 2c0a  edback_version,.
+00002910: 2020 2020 2020 2020 2020 2020 7469 6d65              time
+00002920: 7374 616d 703d 7469 6d65 7374 616d 702c  stamp=timestamp,
+00002930: 0a20 2020 2020 2020 2020 2020 2074 6167  .            tag
+00002940: 733d 7461 6773 2c0a 2020 2020 2020 2020  s=tags,.        
+00002950: 290a 2020 2020 2020 2020 3d3d 2022 3132  ).        == "12
+00002960: 3334 3536 3738 3930 220a 2020 2020 290a  34567890".    ).
+00002970: 2020 2020 6173 7365 7274 2063 6c69 5f6f      assert cli_o
+00002980: 626a 2e6c 6f67 5f73 746f 7265 2e6c 6f67  bj.log_store.log
+00002990: 7320 3d3d 205b 0a20 2020 2020 2020 207b  s == [.        {
+000029a0: 0a20 2020 2020 2020 2020 2020 2022 6576  .            "ev
+000029b0: 656e 7473 223a 205b 0a20 2020 2020 2020  ents": [.       
+000029c0: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+000029d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000029e0: 6261 7463 685f 6964 223a 204e 6f6e 652c  batch_id": None,
+000029f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002a00: 2020 2020 2022 6576 656e 745f 6964 223a       "event_id":
+00002a10: 2022 3132 3334 3522 2c0a 2020 2020 2020   "12345",.      
+00002a20: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+00002a30: 6565 6462 6163 6b22 3a20 7b22 7661 6c75  eedback": {"valu
+00002a40: 6522 3a20 2262 6172 227d 2c0a 2020 2020  e": "bar"},.    
+00002a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002a60: 2266 6565 6462 6163 6b5f 6964 223a 2022  "feedback_id": "
+00002a70: 3132 3334 3536 3738 3930 222c 0a20 2020  1234567890",.   
+00002a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002a90: 2022 6c6f 675f 7469 6d65 7374 616d 7022   "log_timestamp"
+00002aa0: 3a20 4355 5252 454e 545f 5449 4d45 5f53  : CURRENT_TIME_S
+00002ab0: 5452 2c0a 2020 2020 2020 2020 2020 2020  TR,.            
+00002ac0: 2020 2020 2020 2020 226d 6574 6164 6174          "metadat
+00002ad0: 6122 3a20 7b0a 2020 2020 2020 2020 2020  a": {.          
+00002ae0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+00002af0: 6565 6462 6163 6b5f 7665 7273 696f 6e22  eedback_version"
+00002b00: 3a20 6665 6564 6261 636b 5f76 6572 7369  : feedback_versi
+00002b10: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00002b20: 2020 2020 2020 2020 2020 2020 2266 756e              "fun
+00002b30: 635f 6e61 6d65 223a 2022 666f 6f62 6172  c_name": "foobar
+00002b40: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00002b50: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+00002b60: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+00002b70: 696d 6573 7461 6d70 223a 2053 4f4d 455f  imestamp": SOME_
+00002b80: 5449 4d45 5f53 5452 2069 6620 7469 6d65  TIME_STR if time
+00002b90: 7374 616d 7020 656c 7365 2043 5552 5245  stamp else CURRE
+00002ba0: 4e54 5f54 494d 455f 5354 522c 0a20 2020  NT_TIME_STR,.   
+00002bb0: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
+00002bc0: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
+00002bd0: 2020 2020 2020 2020 2020 2261 7070 6c69            "appli
+00002be0: 6361 7469 6f6e 223a 2022 666f 6f62 6172  cation": "foobar
+00002bf0: 222c 0a20 2020 2020 2020 207d 2c0a 2020  ",.        },.  
+00002c00: 2020 5d0a 0a0a 4066 7265 657a 655f 7469    ]...@freeze_ti
+00002c10: 6d65 2843 5552 5245 4e54 5f54 494d 4529  me(CURRENT_TIME)
+00002c20: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
+00002c30: 7261 6d65 7472 697a 6528 2274 6167 7322  rametrize("tags"
+00002c40: 2c20 5b7b 2265 6e76 223a 2022 6f76 6572  , [{"env": "over
+00002c50: 7772 6974 655f 656e 7622 7d2c 207b 7d2c  write_env"}, {},
+00002c60: 204e 6f6e 655d 290a 4070 7974 6573 742e   None]).@pytest.
+00002c70: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
+00002c80: 2822 7469 6d65 7374 616d 7022 2c20 5b4e  ("timestamp", [N
+00002c90: 6f6e 652c 2053 4f4d 455f 5449 4d45 5d29  one, SOME_TIME])
+00002ca0: 0a40 6d6f 636b 2e70 6174 6368 2822 6761  .@mock.patch("ga
+00002cb0: 6e74 7279 2e6c 6f67 6765 722e 6576 656e  ntry.logger.even
+00002cc0: 745f 6275 696c 6465 722e 7575 6964 2e75  t_builder.uuid.u
+00002cd0: 7569 6434 2229 0a64 6566 2074 6573 745f  uid4").def test_
+00002ce0: 6c6f 675f 7072 6564 6963 7469 6f6e 5f65  log_prediction_e
+00002cf0: 7665 6e74 286d 6f63 6b5f 7575 6964 2c20  vent(mock_uuid, 
+00002d00: 7469 6d65 7374 616d 702c 2074 6167 732c  timestamp, tags,
+00002d10: 2063 6c69 5f6f 626a 293a 0a20 2020 206d   cli_obj):.    m
+00002d20: 6f63 6b5f 7575 6964 2e72 6574 7572 6e5f  ock_uuid.return_
+00002d30: 7661 6c75 6520 3d20 2231 3233 3435 220a  value = "12345".
+00002d40: 2020 2020 6173 7365 7274 2028 0a20 2020      assert (.   
+00002d50: 2020 2020 2063 6c69 5f6f 626a 2e5f 6c6f       cli_obj._lo
+00002d60: 675f 7072 6564 6963 7469 6f6e 5f65 7665  g_prediction_eve
+00002d70: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
+00002d80: 6170 706c 6963 6174 696f 6e3d 2266 6f6f  application="foo
+00002d90: 6261 7222 2c0a 2020 2020 2020 2020 2020  bar",.          
+00002da0: 2020 696e 7075 7473 3d7b 2241 223a 2031    inputs={"A": 1
+00002db0: 3030 7d2c 0a20 2020 2020 2020 2020 2020  00},.           
+00002dc0: 206f 7574 7075 7473 3d7b 2276 616c 7565   outputs={"value
+00002dd0: 223a 2022 6261 7222 7d2c 0a20 2020 2020  ": "bar"},.     
+00002de0: 2020 2020 2020 206a 6f69 6e5f 6b65 793d         join_key=
+00002df0: 2231 3233 3435 3637 3839 3022 2c0a 2020  "1234567890",.  
+00002e00: 2020 2020 2020 2020 2020 7665 7273 696f            versio
+00002e10: 6e3d 2261 2e62 2e63 222c 0a20 2020 2020  n="a.b.c",.     
+00002e20: 2020 2020 2020 2069 676e 6f72 655f 696e         ignore_in
+00002e30: 7075 7473 3d5b 2241 225d 2c0a 2020 2020  puts=["A"],.    
+00002e40: 2020 2020 2020 2020 7469 6d65 7374 616d          timestam
+00002e50: 703d 7469 6d65 7374 616d 702c 0a20 2020  p=timestamp,.   
+00002e60: 2020 2020 2020 2020 2074 6167 733d 7461           tags=ta
+00002e70: 6773 2c0a 2020 2020 2020 2020 290a 2020  gs,.        ).  
+00002e80: 2020 2020 2020 3d3d 2022 3132 3334 3536        == "123456
+00002e90: 3738 3930 220a 2020 2020 290a 2020 2020  7890".    ).    
+00002ea0: 6173 7365 7274 2063 6c69 5f6f 626a 2e6c  assert cli_obj.l
+00002eb0: 6f67 5f73 746f 7265 2e6c 6f67 7320 3d3d  og_store.logs ==
+00002ec0: 205b 0a20 2020 2020 2020 207b 0a20 2020   [.        {.   
+00002ed0: 2020 2020 2020 2020 2022 6576 656e 7473           "events
+00002ee0: 223a 205b 0a20 2020 2020 2020 2020 2020  ": [.           
+00002ef0: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+00002f00: 2020 2020 2020 2020 2020 2022 6261 7463             "batc
+00002f10: 685f 6964 223a 204e 6f6e 652c 0a20 2020  h_id": None,.   
+00002f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002f30: 2022 6576 656e 745f 6964 223a 2022 3132   "event_id": "12
+00002f40: 3334 3522 2c0a 2020 2020 2020 2020 2020  345",.          
+00002f50: 2020 2020 2020 2020 2020 2266 6565 6462            "feedb
+00002f60: 6163 6b5f 6964 223a 2022 3132 3334 3536  ack_id": "123456
+00002f70: 3738 3930 222c 0a20 2020 2020 2020 2020  7890",.         
+00002f80: 2020 2020 2020 2020 2020 2022 696e 7075             "inpu
+00002f90: 7473 223a 207b 7d2c 0a20 2020 2020 2020  ts": {},.       
+00002fa0: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
+00002fb0: 675f 7469 6d65 7374 616d 7022 3a20 4355  g_timestamp": CU
+00002fc0: 5252 454e 545f 5449 4d45 5f53 5452 2c0a  RRENT_TIME_STR,.
+00002fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002fe0: 2020 2020 226d 6574 6164 6174 6122 3a20      "metadata": 
+00002ff0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00003000: 2020 2020 2020 2020 2020 2266 6565 6462            "feedb
+00003010: 6163 6b5f 6b65 7973 223a 204e 6f6e 652c  ack_keys": None,
+00003020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003030: 2020 2020 2020 2020 2022 6675 6e63 5f6e           "func_n
+00003040: 616d 6522 3a20 2266 6f6f 6261 7222 2c0a  ame": "foobar",.
+00003050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003060: 2020 2020 2020 2020 2269 676e 6f72 655f          "ignore_
+00003070: 696e 7075 7473 223a 205b 2241 225d 2c0a  inputs": ["A"],.
+00003080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003090: 2020 2020 2020 2020 2276 6572 7369 6f6e          "version
+000030a0: 223a 2022 612e 622e 6322 2c0a 2020 2020  ": "a.b.c",.    
+000030b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000030c0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+000030d0: 2020 2020 2020 2022 6f75 7470 7574 7322         "outputs"
+000030e0: 3a20 7b22 7661 6c75 6522 3a20 2262 6172  : {"value": "bar
+000030f0: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
+00003100: 2020 2020 2020 2020 2274 6167 7322 3a20          "tags": 
+00003110: 7461 6773 2069 6620 7461 6773 2069 7320  tags if tags is 
+00003120: 6e6f 7420 4e6f 6e65 2065 6c73 6520 4e6f  not None else No
+00003130: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+00003140: 2020 2020 2020 2020 2274 696d 6573 7461          "timesta
+00003150: 6d70 223a 2043 5552 5245 4e54 5f54 494d  mp": CURRENT_TIM
+00003160: 455f 5354 5220 6966 206e 6f74 2074 696d  E_STR if not tim
+00003170: 6573 7461 6d70 2065 6c73 6520 534f 4d45  estamp else SOME
+00003180: 5f54 494d 455f 5354 522c 0a20 2020 2020  _TIME_STR,.     
+00003190: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+000031a0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+000031b0: 2020 2020 2020 2020 2261 7070 6c69 6361          "applica
+000031c0: 7469 6f6e 223a 2022 666f 6f62 6172 222c  tion": "foobar",
+000031d0: 0a20 2020 2020 2020 207d 2c0a 2020 2020  .        },.    
+000031e0: 5d0a 0a0a 4070 7974 6573 742e 6d61 726b  ]...@pytest.mark
+000031f0: 2e70 6172 616d 6574 7269 7a65 2822 6170  .parametrize("ap
+00003200: 706c 6963 6174 696f 6e22 2c20 5b31 302c  plication", [10,
+00003210: 204e 6f6e 652c 2031 302e 352c 2062 2273   None, 10.5, b"s
+00003220: 6f6d 6520 6269 6e61 7279 2073 7472 696e  ome binary strin
+00003230: 6722 5d29 0a64 6566 2074 6573 745f 6c6f  g"]).def test_lo
+00003240: 675f 7265 636f 7264 5f69 6e76 616c 6964  g_record_invalid
+00003250: 5f6e 616d 6528 6170 706c 6963 6174 696f  _name(applicatio
+00003260: 6e2c 2063 6c69 5f6f 626a 2c20 6361 706c  n, cli_obj, capl
+00003270: 6f67 293a 0a20 2020 2063 6170 6c6f 672e  og):.    caplog.
+00003280: 7365 745f 6c65 7665 6c28 6c6f 6767 696e  set_level(loggin
+00003290: 672e 4552 524f 522c 206c 6f67 6765 723d  g.ERROR, logger=
+000032a0: 2267 616e 7472 792e 636c 6965 6e74 2229  "gantry.client")
+000032b0: 0a20 2020 2063 6c69 5f6f 626a 2e6c 6f67  .    cli_obj.log
+000032c0: 5f72 6563 6f72 6428 0a20 2020 2020 2020  _record(.       
+000032d0: 2061 7070 6c69 6361 7469 6f6e 3d61 7070   application=app
+000032e0: 6c69 6361 7469 6f6e 2c0a 2020 2020 2020  lication,.      
+000032f0: 2020 6665 6564 6261 636b 5f69 643d 7b22    feedback_id={"
+00003300: 4122 3a20 3130 307d 2c0a 2020 2020 2020  A": 100},.      
+00003310: 2020 6665 6564 6261 636b 3d7b 2276 616c    feedback={"val
+00003320: 7565 223a 2022 6261 7222 7d2c 0a20 2020  ue": "bar"},.   
+00003330: 2020 2020 2066 6565 6462 6163 6b5f 7665       feedback_ve
+00003340: 7273 696f 6e3d 3130 2c0a 2020 2020 2020  rsion=10,.      
+00003350: 2020 7469 6d65 7374 616d 703d 534f 4d45    timestamp=SOME
+00003360: 5f54 494d 452c 0a20 2020 2029 0a20 2020  _TIME,.    ).   
+00003370: 2061 7373 6572 7420 2249 6e74 6572 6e61   assert "Interna
+00003380: 6c20 6578 6365 7074 696f 6e20 696e 2047  l exception in G
+00003390: 616e 7472 7920 636c 6965 6e74 2220 696e  antry client" in
+000033a0: 2063 6170 6c6f 672e 7465 7874 0a20 2020   caplog.text.   
+000033b0: 2061 7373 6572 7420 2254 7970 6545 7272   assert "TypeErr
+000033c0: 6f72 3a22 2069 6e20 6361 706c 6f67 2e74  or:" in caplog.t
+000033d0: 6578 740a 0a0a 4070 7974 6573 742e 6d61  ext...@pytest.ma
+000033e0: 726b 2e70 6172 616d 6574 7269 7a65 2822  rk.parametrize("
+000033f0: 6170 706c 6963 6174 696f 6e22 2c20 5b31  application", [1
+00003400: 302c 204e 6f6e 652c 2031 302e 352c 2062  0, None, 10.5, b
+00003410: 2273 6f6d 6520 6269 6e61 7279 2073 7472  "some binary str
+00003420: 696e 6722 5d29 0a64 6566 2074 6573 745f  ing"]).def test_
+00003430: 7369 6e67 6c65 5f6c 6f67 5f72 6563 6f72  single_log_recor
+00003440: 645f 696e 7661 6c69 645f 6e61 6d65 2861  d_invalid_name(a
+00003450: 7070 6c69 6361 7469 6f6e 2c20 636c 695f  pplication, cli_
+00003460: 6f62 6a2c 2063 6170 6c6f 6729 3a0a 2020  obj, caplog):.  
+00003470: 2020 6361 706c 6f67 2e73 6574 5f6c 6576    caplog.set_lev
+00003480: 656c 286c 6f67 6769 6e67 2e45 5252 4f52  el(logging.ERROR
+00003490: 2c20 6c6f 6767 6572 3d22 6761 6e74 7279  , logger="gantry
+000034a0: 2e63 6c69 656e 7422 290a 2020 2020 636c  .client").    cl
+000034b0: 695f 6f62 6a2e 7369 6e67 6c65 5f6c 6f67  i_obj.single_log
+000034c0: 5f72 6563 6f72 6428 0a20 2020 2020 2020  _record(.       
+000034d0: 2061 7070 6c69 6361 7469 6f6e 3d61 7070   application=app
+000034e0: 6c69 6361 7469 6f6e 2c0a 2020 2020 2020  lication,.      
+000034f0: 2020 6665 6564 6261 636b 5f69 643d 7b22    feedback_id={"
+00003500: 4122 3a20 3130 307d 2c0a 2020 2020 2020  A": 100},.      
+00003510: 2020 6665 6564 6261 636b 3d7b 2276 616c    feedback={"val
+00003520: 7565 223a 2022 6261 7222 7d2c 0a20 2020  ue": "bar"},.   
+00003530: 2020 2020 2066 6565 6462 6163 6b5f 7665       feedback_ve
+00003540: 7273 696f 6e3d 3130 2c0a 2020 2020 2020  rsion=10,.      
+00003550: 2020 7469 6d65 7374 616d 703d 534f 4d45    timestamp=SOME
+00003560: 5f54 494d 452c 0a20 2020 2029 0a20 2020  _TIME,.    ).   
+00003570: 2061 7373 6572 7420 2249 6e74 6572 6e61   assert "Interna
+00003580: 6c20 6578 6365 7074 696f 6e20 696e 2047  l exception in G
+00003590: 616e 7472 7920 636c 6965 6e74 2220 696e  antry client" in
+000035a0: 2063 6170 6c6f 672e 7465 7874 0a20 2020   caplog.text.   
+000035b0: 2061 7373 6572 7420 2254 7970 6545 7272   assert "TypeErr
+000035c0: 6f72 3a22 2069 6e20 6361 706c 6f67 2e74  or:" in caplog.t
+000035d0: 6578 740a 0a0a 4070 7974 6573 742e 6d61  ext...@pytest.ma
+000035e0: 726b 2e70 6172 616d 6574 7269 7a65 2822  rk.parametrize("
+000035f0: 6665 6564 6261 636b 5f69 6422 2c20 5b31  feedback_id", [1
+00003600: 302c 204e 6f6e 652c 2031 302e 352c 205b  0, None, 10.5, [
+00003610: 2261 222c 2022 6c69 7374 225d 2c20 6222  "a", "list"], b"
+00003620: 736f 6d65 7468 696e 6722 5d29 0a64 6566  something"]).def
+00003630: 2074 6573 745f 6c6f 675f 7265 636f 7264   test_log_record
+00003640: 5f69 6e76 616c 6964 5f66 6565 6462 6163  _invalid_feedbac
+00003650: 6b5f 6964 2866 6565 6462 6163 6b5f 6964  k_id(feedback_id
+00003660: 2c20 636c 695f 6f62 6a2c 2063 6170 6c6f  , cli_obj, caplo
+00003670: 6729 3a0a 2020 2020 6361 706c 6f67 2e73  g):.    caplog.s
+00003680: 6574 5f6c 6576 656c 286c 6f67 6769 6e67  et_level(logging
+00003690: 2e45 5252 4f52 2c20 6c6f 6767 6572 3d22  .ERROR, logger="
+000036a0: 6761 6e74 7279 2e63 6c69 656e 7422 290a  gantry.client").
+000036b0: 2020 2020 636c 695f 6f62 6a2e 6c6f 675f      cli_obj.log_
+000036c0: 7265 636f 7264 280a 2020 2020 2020 2020  record(.        
+000036d0: 6170 706c 6963 6174 696f 6e3d 2266 6f6f  application="foo
+000036e0: 6261 7222 2c0a 2020 2020 2020 2020 6665  bar",.        fe
+000036f0: 6564 6261 636b 5f69 643d 6665 6564 6261  edback_id=feedba
+00003700: 636b 5f69 642c 0a20 2020 2020 2020 2066  ck_id,.        f
+00003710: 6565 6462 6163 6b3d 7b22 7661 6c75 6522  eedback={"value"
+00003720: 3a20 2262 6172 227d 2c0a 2020 2020 2020  : "bar"},.      
+00003730: 2020 6665 6564 6261 636b 5f76 6572 7369    feedback_versi
+00003740: 6f6e 3d31 302c 0a20 2020 2020 2020 2074  on=10,.        t
+00003750: 696d 6573 7461 6d70 3d53 4f4d 455f 5449  imestamp=SOME_TI
+00003760: 4d45 2c0a 2020 2020 290a 2020 2020 6173  ME,.    ).    as
+00003770: 7365 7274 2022 496e 7465 726e 616c 2065  sert "Internal e
+00003780: 7863 6570 7469 6f6e 2069 6e20 4761 6e74  xception in Gant
+00003790: 7279 2063 6c69 656e 7422 2069 6e20 6361  ry client" in ca
+000037a0: 706c 6f67 2e74 6578 740a 2020 2020 6173  plog.text.    as
+000037b0: 7365 7274 2022 5479 7065 4572 726f 723a  sert "TypeError:
+000037c0: 2220 696e 2063 6170 6c6f 672e 7465 7874  " in caplog.text
+000037d0: 0a0a 0a40 7079 7465 7374 2e6d 6172 6b2e  ...@pytest.mark.
+000037e0: 7061 7261 6d65 7472 697a 6528 2266 6565  parametrize("fee
+000037f0: 6462 6163 6b5f 6964 222c 205b 3130 2c20  dback_id", [10, 
+00003800: 4e6f 6e65 2c20 3130 2e35 2c20 5b22 6122  None, 10.5, ["a"
+00003810: 2c20 226c 6973 7422 5d2c 2062 2273 6f6d  , "list"], b"som
+00003820: 6574 6869 6e67 225d 290a 6465 6620 7465  ething"]).def te
+00003830: 7374 5f73 696e 676c 655f 6c6f 675f 7265  st_single_log_re
+00003840: 636f 7264 5f69 6e76 616c 6964 5f66 6565  cord_invalid_fee
+00003850: 6462 6163 6b5f 6964 2866 6565 6462 6163  dback_id(feedbac
+00003860: 6b5f 6964 2c20 636c 695f 6f62 6a2c 2063  k_id, cli_obj, c
+00003870: 6170 6c6f 6729 3a0a 2020 2020 6361 706c  aplog):.    capl
+00003880: 6f67 2e73 6574 5f6c 6576 656c 286c 6f67  og.set_level(log
+00003890: 6769 6e67 2e45 5252 4f52 2c20 6c6f 6767  ging.ERROR, logg
+000038a0: 6572 3d22 6761 6e74 7279 2e63 6c69 656e  er="gantry.clien
+000038b0: 7422 290a 2020 2020 636c 695f 6f62 6a2e  t").    cli_obj.
+000038c0: 7369 6e67 6c65 5f6c 6f67 5f72 6563 6f72  single_log_recor
+000038d0: 6428 0a20 2020 2020 2020 2061 7070 6c69  d(.        appli
+000038e0: 6361 7469 6f6e 3d22 666f 6f62 6172 222c  cation="foobar",
+000038f0: 0a20 2020 2020 2020 2066 6565 6462 6163  .        feedbac
+00003900: 6b5f 6964 3d66 6565 6462 6163 6b5f 6964  k_id=feedback_id
+00003910: 2c0a 2020 2020 2020 2020 6665 6564 6261  ,.        feedba
+00003920: 636b 3d7b 2276 616c 7565 223a 2022 6261  ck={"value": "ba
+00003930: 7222 7d2c 0a20 2020 2020 2020 2066 6565  r"},.        fee
+00003940: 6462 6163 6b5f 7665 7273 696f 6e3d 3130  dback_version=10
+00003950: 2c0a 2020 2020 2020 2020 7469 6d65 7374  ,.        timest
+00003960: 616d 703d 534f 4d45 5f54 494d 452c 0a20  amp=SOME_TIME,. 
+00003970: 2020 2029 0a20 2020 2061 7373 6572 7420     ).    assert 
+00003980: 2249 6e74 6572 6e61 6c20 6578 6365 7074  "Internal except
+00003990: 696f 6e20 696e 2047 616e 7472 7920 636c  ion in Gantry cl
+000039a0: 6965 6e74 2220 696e 2063 6170 6c6f 672e  ient" in caplog.
+000039b0: 7465 7874 0a20 2020 2061 7373 6572 7420  text.    assert 
+000039c0: 2254 7970 6545 7272 6f72 3a22 2069 6e20  "TypeError:" in 
+000039d0: 6361 706c 6f67 2e74 6578 740a 0a0a 4070  caplog.text...@p
+000039e0: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+000039f0: 6574 7269 7a65 2822 6665 6564 6261 636b  etrize("feedback
+00003a00: 222c 205b 3130 2c20 4e6f 6e65 2c20 3130  ", [10, None, 10
+00003a10: 2e35 2c20 5b22 6122 2c20 226c 6973 7422  .5, ["a", "list"
+00003a20: 5d2c 2062 2273 6f6d 6574 6869 6e67 225d  ], b"something"]
+00003a30: 290a 6465 6620 7465 7374 5f6c 6f67 5f72  ).def test_log_r
+00003a40: 6563 6f72 645f 696e 7661 6c69 645f 6665  ecord_invalid_fe
+00003a50: 6564 6261 636b 2866 6565 6462 6163 6b2c  edback(feedback,
+00003a60: 2063 6c69 5f6f 626a 2c20 6361 706c 6f67   cli_obj, caplog
+00003a70: 293a 0a20 2020 2063 6170 6c6f 672e 7365  ):.    caplog.se
+00003a80: 745f 6c65 7665 6c28 6c6f 6767 696e 672e  t_level(logging.
+00003a90: 4552 524f 522c 206c 6f67 6765 723d 2267  ERROR, logger="g
+00003aa0: 616e 7472 792e 636c 6965 6e74 2229 0a20  antry.client"). 
+00003ab0: 2020 2063 6c69 5f6f 626a 2e6c 6f67 5f72     cli_obj.log_r
+00003ac0: 6563 6f72 6428 0a20 2020 2020 2020 2061  ecord(.        a
+00003ad0: 7070 6c69 6361 7469 6f6e 3d22 666f 6f62  pplication="foob
+00003ae0: 6172 222c 0a20 2020 2020 2020 2066 6565  ar",.        fee
+00003af0: 6462 6163 6b5f 6964 3d7b 2276 616c 7565  dback_id={"value
+00003b00: 223a 2022 6261 7222 7d2c 0a20 2020 2020  ": "bar"},.     
+00003b10: 2020 2066 6565 6462 6163 6b3d 6665 6564     feedback=feed
+00003b20: 6261 636b 2c0a 2020 2020 2020 2020 6665  back,.        fe
+00003b30: 6564 6261 636b 5f76 6572 7369 6f6e 3d31  edback_version=1
+00003b40: 302c 0a20 2020 2020 2020 2074 696d 6573  0,.        times
+00003b50: 7461 6d70 3d53 4f4d 455f 5449 4d45 2c0a  tamp=SOME_TIME,.
+00003b60: 2020 2020 290a 2020 2020 6173 7365 7274      ).    assert
+00003b70: 2022 496e 7465 726e 616c 2065 7863 6570   "Internal excep
+00003b80: 7469 6f6e 2069 6e20 4761 6e74 7279 2063  tion in Gantry c
+00003b90: 6c69 656e 7422 2069 6e20 6361 706c 6f67  lient" in caplog
+00003ba0: 2e74 6578 740a 2020 2020 6173 7365 7274  .text.    assert
+00003bb0: 2022 5479 7065 4572 726f 723a 2220 696e   "TypeError:" in
+00003bc0: 2063 6170 6c6f 672e 7465 7874 0a0a 0a40   caplog.text...@
+00003bd0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+00003be0: 6d65 7472 697a 6528 2266 6565 6462 6163  metrize("feedbac
+00003bf0: 6b22 2c20 5b31 302c 204e 6f6e 652c 2031  k", [10, None, 1
+00003c00: 302e 352c 205b 2261 222c 2022 6c69 7374  0.5, ["a", "list
+00003c10: 225d 2c20 6222 736f 6d65 7468 696e 6722  "], b"something"
+00003c20: 5d29 0a64 6566 2074 6573 745f 7369 6e67  ]).def test_sing
+00003c30: 6c65 5f6c 6f67 5f72 6563 6f72 645f 696e  le_log_record_in
+00003c40: 7661 6c69 645f 6665 6564 6261 636b 2866  valid_feedback(f
+00003c50: 6565 6462 6163 6b2c 2063 6c69 5f6f 626a  eedback, cli_obj
+00003c60: 2c20 6361 706c 6f67 293a 0a20 2020 2063  , caplog):.    c
+00003c70: 6170 6c6f 672e 7365 745f 6c65 7665 6c28  aplog.set_level(
+00003c80: 6c6f 6767 696e 672e 4552 524f 522c 206c  logging.ERROR, l
+00003c90: 6f67 6765 723d 2267 616e 7472 792e 636c  ogger="gantry.cl
+00003ca0: 6965 6e74 2229 0a20 2020 2063 6c69 5f6f  ient").    cli_o
+00003cb0: 626a 2e73 696e 676c 655f 6c6f 675f 7265  bj.single_log_re
+00003cc0: 636f 7264 280a 2020 2020 2020 2020 6170  cord(.        ap
+00003cd0: 706c 6963 6174 696f 6e3d 2266 6f6f 6261  plication="fooba
+00003ce0: 7222 2c0a 2020 2020 2020 2020 6665 6564  r",.        feed
+00003cf0: 6261 636b 5f69 643d 7b22 7661 6c75 6522  back_id={"value"
+00003d00: 3a20 2262 6172 227d 2c0a 2020 2020 2020  : "bar"},.      
+00003d10: 2020 6665 6564 6261 636b 3d66 6565 6462    feedback=feedb
+00003d20: 6163 6b2c 0a20 2020 2020 2020 2066 6565  ack,.        fee
+00003d30: 6462 6163 6b5f 7665 7273 696f 6e3d 3130  dback_version=10
+00003d40: 2c0a 2020 2020 2020 2020 7469 6d65 7374  ,.        timest
+00003d50: 616d 703d 534f 4d45 5f54 494d 452c 0a20  amp=SOME_TIME,. 
+00003d60: 2020 2029 0a20 2020 2061 7373 6572 7420     ).    assert 
+00003d70: 2249 6e74 6572 6e61 6c20 6578 6365 7074  "Internal except
+00003d80: 696f 6e20 696e 2047 616e 7472 7920 636c  ion in Gantry cl
+00003d90: 6965 6e74 2220 696e 2063 6170 6c6f 672e  ient" in caplog.
+00003da0: 7465 7874 0a20 2020 2061 7373 6572 7420  text.    assert 
+00003db0: 2254 7970 6545 7272 6f72 3a22 2069 6e20  "TypeError:" in 
+00003dc0: 6361 706c 6f67 2e74 6578 740a 0a0a 4070  caplog.text...@p
+00003dd0: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+00003de0: 6574 7269 7a65 280a 2020 2020 2266 6565  etrize(.    "fee
+00003df0: 6462 6163 6b5f 7665 7273 696f 6e22 2c20  dback_version", 
+00003e00: 5b22 736f 6d65 2d76 6572 7369 6f6e 222c  ["some-version",
+00003e10: 2062 2261 2d76 6572 7369 6f6e 222c 2031   b"a-version", 1
+00003e20: 302e 352c 207b 2276 6572 7369 6f6e 223a  0.5, {"version":
+00003e30: 2022 7965 7322 7d2c 205b 3130 5d5d 0a29   "yes"}, [10]].)
+00003e40: 0a64 6566 2074 6573 745f 6c6f 675f 7265  .def test_log_re
+00003e50: 636f 7264 5f69 6e76 616c 6964 5f66 6565  cord_invalid_fee
+00003e60: 6462 6163 6b5f 7665 7273 696f 6e28 6665  dback_version(fe
+00003e70: 6564 6261 636b 5f76 6572 7369 6f6e 2c20  edback_version, 
+00003e80: 636c 695f 6f62 6a2c 2063 6170 6c6f 6729  cli_obj, caplog)
+00003e90: 3a0a 2020 2020 6361 706c 6f67 2e73 6574  :.    caplog.set
+00003ea0: 5f6c 6576 656c 286c 6f67 6769 6e67 2e45  _level(logging.E
+00003eb0: 5252 4f52 2c20 6c6f 6767 6572 3d22 6761  RROR, logger="ga
+00003ec0: 6e74 7279 2e63 6c69 656e 7422 290a 2020  ntry.client").  
+00003ed0: 2020 636c 695f 6f62 6a2e 6c6f 675f 7265    cli_obj.log_re
+00003ee0: 636f 7264 280a 2020 2020 2020 2020 6170  cord(.        ap
+00003ef0: 706c 6963 6174 696f 6e3d 2266 6f6f 6261  plication="fooba
+00003f00: 7222 2c0a 2020 2020 2020 2020 6665 6564  r",.        feed
+00003f10: 6261 636b 5f69 643d 7b22 7661 6c75 6522  back_id={"value"
+00003f20: 3a20 2262 6172 227d 2c0a 2020 2020 2020  : "bar"},.      
+00003f30: 2020 6665 6564 6261 636b 3d7b 2276 616c    feedback={"val
+00003f40: 7565 223a 2022 666f 6f22 7d2c 0a20 2020  ue": "foo"},.   
+00003f50: 2020 2020 2066 6565 6462 6163 6b5f 7665       feedback_ve
+00003f60: 7273 696f 6e3d 6665 6564 6261 636b 5f76  rsion=feedback_v
+00003f70: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
+00003f80: 7469 6d65 7374 616d 703d 534f 4d45 5f54  timestamp=SOME_T
+00003f90: 494d 452c 0a20 2020 2029 0a20 2020 2061  IME,.    ).    a
+00003fa0: 7373 6572 7420 2249 6e74 6572 6e61 6c20  ssert "Internal 
+00003fb0: 6578 6365 7074 696f 6e20 696e 2047 616e  exception in Gan
+00003fc0: 7472 7920 636c 6965 6e74 2220 696e 2063  try client" in c
+00003fd0: 6170 6c6f 672e 7465 7874 0a20 2020 2061  aplog.text.    a
+00003fe0: 7373 6572 7420 2254 7970 6545 7272 6f72  ssert "TypeError
+00003ff0: 3a22 2069 6e20 6361 706c 6f67 2e74 6578  :" in caplog.tex
+00004000: 740a 0a0a 4070 7974 6573 742e 6d61 726b  t...@pytest.mark
+00004010: 2e70 6172 616d 6574 7269 7a65 2822 7469  .parametrize("ti
+00004020: 6d65 7374 616d 7022 2c20 5b22 736f 6d65  mestamp", ["some
+00004030: 2d74 696d 6573 7461 6d70 222c 2031 302c  -timestamp", 10,
+00004040: 2022 3230 3230 2d31 302d 3130 225d 290a   "2020-10-10"]).
+00004050: 6465 6620 7465 7374 5f6c 6f67 5f72 6563  def test_log_rec
+00004060: 6f72 645f 696e 7661 6c69 645f 7469 6d65  ord_invalid_time
+00004070: 7374 616d 7028 7469 6d65 7374 616d 702c  stamp(timestamp,
+00004080: 2063 6c69 5f6f 626a 2c20 6361 706c 6f67   cli_obj, caplog
+00004090: 293a 0a20 2020 2063 6170 6c6f 672e 7365  ):.    caplog.se
+000040a0: 745f 6c65 7665 6c28 6c6f 6767 696e 672e  t_level(logging.
+000040b0: 4552 524f 522c 206c 6f67 6765 723d 2267  ERROR, logger="g
+000040c0: 616e 7472 792e 636c 6965 6e74 2229 0a20  antry.client"). 
+000040d0: 2020 2063 6c69 5f6f 626a 2e6c 6f67 5f72     cli_obj.log_r
+000040e0: 6563 6f72 6428 0a20 2020 2020 2020 2061  ecord(.        a
+000040f0: 7070 6c69 6361 7469 6f6e 3d22 666f 6f62  pplication="foob
+00004100: 6172 222c 0a20 2020 2020 2020 2066 6565  ar",.        fee
+00004110: 6462 6163 6b5f 6964 3d7b 2276 616c 7565  dback_id={"value
+00004120: 223a 2022 6261 7222 7d2c 0a20 2020 2020  ": "bar"},.     
+00004130: 2020 2066 6565 6462 6163 6b3d 7b22 7661     feedback={"va
+00004140: 6c75 6522 3a20 2266 6f6f 227d 2c0a 2020  lue": "foo"},.  
+00004150: 2020 2020 2020 6665 6564 6261 636b 5f76        feedback_v
+00004160: 6572 7369 6f6e 3d31 302c 0a20 2020 2020  ersion=10,.     
+00004170: 2020 2074 696d 6573 7461 6d70 3d74 696d     timestamp=tim
+00004180: 6573 7461 6d70 2c0a 2020 2020 290a 2020  estamp,.    ).  
+00004190: 2020 6173 7365 7274 2022 496e 7465 726e    assert "Intern
+000041a0: 616c 2065 7863 6570 7469 6f6e 2069 6e20  al exception in 
+000041b0: 4761 6e74 7279 2063 6c69 656e 7422 2069  Gantry client" i
+000041c0: 6e20 6361 706c 6f67 2e74 6578 740a 2020  n caplog.text.  
+000041d0: 2020 6173 7365 7274 2022 5479 7065 4572    assert "TypeEr
+000041e0: 726f 723a 2220 696e 2063 6170 6c6f 672e  ror:" in caplog.
+000041f0: 7465 7874 0a0a 0a40 7079 7465 7374 2e6d  text...@pytest.m
+00004200: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+00004210: 2269 6e70 7574 7322 2c20 5b5b 3130 2c20  "inputs", [[10, 
+00004220: 3230 5d2c 2031 302c 2031 302e 352c 2028  20], 10, 10.5, (
+00004230: 2241 222c 2031 3030 295d 290a 6465 6620  "A", 100)]).def 
+00004240: 7465 7374 5f6c 6f67 5f72 6563 6f72 645f  test_log_record_
+00004250: 696e 7661 6c69 645f 696e 7075 7473 2869  invalid_inputs(i
+00004260: 6e70 7574 732c 2063 6c69 5f6f 626a 2c20  nputs, cli_obj, 
+00004270: 6361 706c 6f67 293a 0a20 2020 2063 6170  caplog):.    cap
+00004280: 6c6f 672e 7365 745f 6c65 7665 6c28 6c6f  log.set_level(lo
+00004290: 6767 696e 672e 4552 524f 522c 206c 6f67  gging.ERROR, log
+000042a0: 6765 723d 2267 616e 7472 792e 636c 6965  ger="gantry.clie
+000042b0: 6e74 2229 0a20 2020 2063 6c69 5f6f 626a  nt").    cli_obj
+000042c0: 2e6c 6f67 5f72 6563 6f72 6428 0a20 2020  .log_record(.   
+000042d0: 2020 2020 2061 7070 6c69 6361 7469 6f6e       application
+000042e0: 3d22 736f 6d65 2d6e 616d 6522 2c0a 2020  ="some-name",.  
+000042f0: 2020 2020 2020 696e 7075 7473 3d69 6e70        inputs=inp
+00004300: 7574 732c 0a20 2020 2020 2020 206f 7574  uts,.        out
+00004310: 7075 7473 3d7b 2276 616c 7565 223a 2022  puts={"value": "
+00004320: 6261 7222 7d2c 0a20 2020 2020 2020 2076  bar"},.        v
+00004330: 6572 7369 6f6e 3d31 302c 0a20 2020 2020  ersion=10,.     
+00004340: 2020 2069 676e 6f72 655f 696e 7075 7473     ignore_inputs
+00004350: 3d5b 2241 225d 2c0a 2020 2020 2020 2020  =["A"],.        
+00004360: 6665 6564 6261 636b 5f69 643d 7b22 4122  feedback_id={"A"
+00004370: 3a20 3130 307d 2c0a 2020 2020 2020 2020  : 100},.        
+00004380: 7469 6d65 7374 616d 703d 534f 4d45 5f54  timestamp=SOME_T
+00004390: 494d 452c 0a20 2020 2029 0a20 2020 2061  IME,.    ).    a
+000043a0: 7373 6572 7420 2249 6e74 6572 6e61 6c20  ssert "Internal 
+000043b0: 6578 6365 7074 696f 6e20 696e 2047 616e  exception in Gan
+000043c0: 7472 7920 636c 6965 6e74 2220 696e 2063  try client" in c
+000043d0: 6170 6c6f 672e 7465 7874 0a20 2020 2061  aplog.text.    a
+000043e0: 7373 6572 7420 2254 7970 6545 7272 6f72  ssert "TypeError
+000043f0: 3a22 2069 6e20 6361 706c 6f67 2e74 6578  :" in caplog.tex
+00004400: 740a 0a0a 4070 7974 6573 742e 6d61 726b  t...@pytest.mark
+00004410: 2e70 6172 616d 6574 7269 7a65 2822 7665  .parametrize("ve
+00004420: 7273 696f 6e22 2c20 5b5b 3130 2c20 3230  rsion", [[10, 20
+00004430: 5d2c 2031 302e 352c 207b 2276 6572 7369  ], 10.5, {"versi
+00004440: 6f6e 223a 2031 307d 5d29 0a64 6566 2074  on": 10}]).def t
+00004450: 6573 745f 6c6f 675f 7265 636f 7264 5f69  est_log_record_i
+00004460: 6e76 616c 6964 5f76 6572 7369 6f6e 2876  nvalid_version(v
+00004470: 6572 7369 6f6e 2c20 636c 695f 6f62 6a2c  ersion, cli_obj,
+00004480: 2063 6170 6c6f 6729 3a0a 2020 2020 6361   caplog):.    ca
+00004490: 706c 6f67 2e73 6574 5f6c 6576 656c 286c  plog.set_level(l
+000044a0: 6f67 6769 6e67 2e45 5252 4f52 2c20 6c6f  ogging.ERROR, lo
+000044b0: 6767 6572 3d22 6761 6e74 7279 2e63 6c69  gger="gantry.cli
+000044c0: 656e 7422 290a 2020 2020 636c 695f 6f62  ent").    cli_ob
+000044d0: 6a2e 6c6f 675f 7265 636f 7264 280a 2020  j.log_record(.  
+000044e0: 2020 2020 2020 6170 706c 6963 6174 696f        applicatio
+000044f0: 6e3d 2273 6f6d 652d 6e61 6d65 222c 0a20  n="some-name",. 
+00004500: 2020 2020 2020 2069 6e70 7574 733d 7b22         inputs={"
+00004510: 4122 3a20 3130 307d 2c0a 2020 2020 2020  A": 100},.      
+00004520: 2020 6f75 7470 7574 733d 7b22 7661 6c75    outputs={"valu
+00004530: 6522 3a20 2262 6172 227d 2c0a 2020 2020  e": "bar"},.    
+00004540: 2020 2020 7665 7273 696f 6e3d 7665 7273      version=vers
+00004550: 696f 6e2c 0a20 2020 2020 2020 2069 676e  ion,.        ign
+00004560: 6f72 655f 696e 7075 7473 3d5b 2241 225d  ore_inputs=["A"]
+00004570: 2c0a 2020 2020 2020 2020 6665 6564 6261  ,.        feedba
+00004580: 636b 5f69 643d 7b22 4122 3a20 3130 307d  ck_id={"A": 100}
+00004590: 2c0a 2020 2020 2020 2020 7469 6d65 7374  ,.        timest
+000045a0: 616d 703d 534f 4d45 5f54 494d 452c 0a20  amp=SOME_TIME,. 
+000045b0: 2020 2029 0a20 2020 2061 7373 6572 7420     ).    assert 
+000045c0: 2249 6e74 6572 6e61 6c20 6578 6365 7074  "Internal except
+000045d0: 696f 6e20 696e 2047 616e 7472 7920 636c  ion in Gantry cl
+000045e0: 6965 6e74 2220 696e 2063 6170 6c6f 672e  ient" in caplog.
+000045f0: 7465 7874 0a20 2020 2061 7373 6572 7420  text.    assert 
+00004600: 2254 7970 6545 7272 6f72 3a22 2069 6e20  "TypeError:" in 
+00004610: 6361 706c 6f67 2e74 6578 740a 0a0a 4070  caplog.text...@p
+00004620: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+00004630: 6574 7269 7a65 2822 6665 6564 6261 636b  etrize("feedback
+00004640: 5f6b 6579 7322 2c20 5b5b 3130 2c20 3230  _keys", [[10, 20
+00004650: 5d2c 2031 302e 352c 2028 2261 222c 2022  ], 10.5, ("a", "
+00004660: 6222 2c20 2263 2229 5d29 0a64 6566 2074  b", "c")]).def t
+00004670: 6573 745f 6c6f 675f 7265 636f 7264 5f69  est_log_record_i
+00004680: 6e76 616c 6964 5f66 6565 6462 6163 6b5f  nvalid_feedback_
+00004690: 6b65 7973 2866 6565 6462 6163 6b5f 6b65  keys(feedback_ke
+000046a0: 7973 2c20 636c 695f 6f62 6a2c 2063 6170  ys, cli_obj, cap
+000046b0: 6c6f 6729 3a0a 2020 2020 6361 706c 6f67  log):.    caplog
+000046c0: 2e73 6574 5f6c 6576 656c 286c 6f67 6769  .set_level(loggi
+000046d0: 6e67 2e45 5252 4f52 2c20 6c6f 6767 6572  ng.ERROR, logger
+000046e0: 3d22 6761 6e74 7279 2e63 6c69 656e 7422  ="gantry.client"
+000046f0: 290a 2020 2020 636c 695f 6f62 6a2e 6c6f  ).    cli_obj.lo
+00004700: 675f 7265 636f 7264 280a 2020 2020 2020  g_record(.      
+00004710: 2020 6170 706c 6963 6174 696f 6e3d 2273    application="s
+00004720: 6f6d 652d 6e61 6d65 222c 0a20 2020 2020  ome-name",.     
+00004730: 2020 2069 6e70 7574 733d 7b22 4122 3a20     inputs={"A": 
+00004740: 3130 307d 2c0a 2020 2020 2020 2020 6f75  100},.        ou
+00004750: 7470 7574 733d 7b22 7661 6c75 6522 3a20  tputs={"value": 
+00004760: 2262 6172 227d 2c0a 2020 2020 2020 2020  "bar"},.        
+00004770: 7665 7273 696f 6e3d 2261 2e62 2e63 222c  version="a.b.c",
+00004780: 0a20 2020 2020 2020 2066 6565 6462 6163  .        feedbac
+00004790: 6b5f 6b65 7973 3d66 6565 6462 6163 6b5f  k_keys=feedback_
+000047a0: 6b65 7973 2c0a 2020 2020 2020 2020 6967  keys,.        ig
+000047b0: 6e6f 7265 5f69 6e70 7574 733d 5b22 4122  nore_inputs=["A"
+000047c0: 5d2c 0a20 2020 2020 2020 2066 6565 6462  ],.        feedb
+000047d0: 6163 6b5f 6964 3d7b 2241 223a 2031 3030  ack_id={"A": 100
+000047e0: 7d2c 0a20 2020 2020 2020 2074 696d 6573  },.        times
+000047f0: 7461 6d70 3d53 4f4d 455f 5449 4d45 2c0a  tamp=SOME_TIME,.
+00004800: 2020 2020 290a 2020 2020 6173 7365 7274      ).    assert
+00004810: 2022 496e 7465 726e 616c 2065 7863 6570   "Internal excep
+00004820: 7469 6f6e 2069 6e20 4761 6e74 7279 2063  tion in Gantry c
+00004830: 6c69 656e 7422 2069 6e20 6361 706c 6f67  lient" in caplog
+00004840: 2e74 6578 740a 2020 2020 6173 7365 7274  .text.    assert
+00004850: 2022 5479 7065 4572 726f 723a 2220 696e   "TypeError:" in
+00004860: 2063 6170 6c6f 672e 7465 7874 0a0a 0a40   caplog.text...@
+00004870: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+00004880: 6d65 7472 697a 6528 0a20 2020 2022 6967  metrize(.    "ig
+00004890: 6e6f 7265 5f69 6e70 7574 7322 2c20 5b5b  nore_inputs", [[
+000048a0: 3130 2c20 3230 5d2c 205b 6222 736f 6d65  10, 20], [b"some
+000048b0: 7468 696e 6722 2c20 2262 696e 6172 7922  thing", "binary"
+000048c0: 5d2c 205b 2262 6172 222c 2031 302e 355d  ], ["bar", 10.5]
+000048d0: 2c20 5b31 302c 2022 666f 6f22 5d2c 2031  , [10, "foo"], 1
+000048e0: 302c 2031 302e 355d 0a29 0a64 6566 2074  0, 10.5].).def t
+000048f0: 6573 745f 6c6f 675f 7265 636f 7264 5f69  est_log_record_i
+00004900: 6e76 616c 6964 5f69 676e 6f72 655f 696e  nvalid_ignore_in
+00004910: 7075 7473 2869 676e 6f72 655f 696e 7075  puts(ignore_inpu
+00004920: 7473 2c20 636c 695f 6f62 6a2c 2063 6170  ts, cli_obj, cap
+00004930: 6c6f 6729 3a0a 2020 2020 6361 706c 6f67  log):.    caplog
+00004940: 2e73 6574 5f6c 6576 656c 286c 6f67 6769  .set_level(loggi
+00004950: 6e67 2e45 5252 4f52 2c20 6c6f 6767 6572  ng.ERROR, logger
+00004960: 3d22 6761 6e74 7279 2e63 6c69 656e 7422  ="gantry.client"
+00004970: 290a 2020 2020 636c 695f 6f62 6a2e 6c6f  ).    cli_obj.lo
+00004980: 675f 7265 636f 7264 280a 2020 2020 2020  g_record(.      
+00004990: 2020 6170 706c 6963 6174 696f 6e3d 2273    application="s
+000049a0: 6f6d 652d 6e61 6d65 222c 0a20 2020 2020  ome-name",.     
+000049b0: 2020 2069 6e70 7574 733d 7b22 4122 3a20     inputs={"A": 
+000049c0: 3130 307d 2c0a 2020 2020 2020 2020 6f75  100},.        ou
+000049d0: 7470 7574 733d 7b22 7661 6c75 6522 3a20  tputs={"value": 
+000049e0: 2262 6172 227d 2c0a 2020 2020 2020 2020  "bar"},.        
+000049f0: 7665 7273 696f 6e3d 2261 2e62 2e63 222c  version="a.b.c",
+00004a00: 0a20 2020 2020 2020 2069 676e 6f72 655f  .        ignore_
+00004a10: 696e 7075 7473 3d69 676e 6f72 655f 696e  inputs=ignore_in
+00004a20: 7075 7473 2c0a 2020 2020 2020 2020 6665  puts,.        fe
+00004a30: 6564 6261 636b 5f69 643d 7b22 4122 3a20  edback_id={"A": 
+00004a40: 3130 307d 2c0a 2020 2020 2020 2020 7469  100},.        ti
+00004a50: 6d65 7374 616d 703d 534f 4d45 5f54 494d  mestamp=SOME_TIM
+00004a60: 452c 0a20 2020 2029 0a20 2020 2061 7373  E,.    ).    ass
+00004a70: 6572 7420 2249 6e74 6572 6e61 6c20 6578  ert "Internal ex
+00004a80: 6365 7074 696f 6e20 696e 2047 616e 7472  ception in Gantr
+00004a90: 7920 636c 6965 6e74 2220 696e 2063 6170  y client" in cap
+00004aa0: 6c6f 672e 7465 7874 0a20 2020 2061 7373  log.text.    ass
+00004ab0: 6572 7420 2254 7970 6545 7272 6f72 3a22  ert "TypeError:"
+00004ac0: 2069 6e20 6361 706c 6f67 2e74 6578 740a   in caplog.text.
+00004ad0: 0a0a 4070 7974 6573 742e 6d61 726b 2e70  ..@pytest.mark.p
+00004ae0: 6172 616d 6574 7269 7a65 2822 6665 6564  arametrize("feed
+00004af0: 6261 636b 5f69 6422 2c20 5b5b 3130 2c20  back_id", [[10, 
+00004b00: 3230 5d2c 205b 2266 6f6f 225d 2c20 3130  20], ["foo"], 10
+00004b10: 2c20 3130 2e35 5d29 0a64 6566 2074 6573  , 10.5]).def tes
+00004b20: 745f 6c6f 675f 7265 636f 7264 5f69 6e76  t_log_record_inv
+00004b30: 616c 6964 5f66 6565 6462 6163 6b5f 6964  alid_feedback_id
+00004b40: 5f66 6f72 5f70 7265 6469 6374 696f 6e28  _for_prediction(
+00004b50: 6665 6564 6261 636b 5f69 642c 2063 6c69  feedback_id, cli
+00004b60: 5f6f 626a 2c20 6361 706c 6f67 293a 0a20  _obj, caplog):. 
+00004b70: 2020 2063 6170 6c6f 672e 7365 745f 6c65     caplog.set_le
+00004b80: 7665 6c28 6c6f 6767 696e 672e 4552 524f  vel(logging.ERRO
+00004b90: 522c 206c 6f67 6765 723d 2267 616e 7472  R, logger="gantr
+00004ba0: 792e 636c 6965 6e74 2229 0a20 2020 2063  y.client").    c
+00004bb0: 6c69 5f6f 626a 2e6c 6f67 5f72 6563 6f72  li_obj.log_recor
+00004bc0: 6428 0a20 2020 2020 2020 2061 7070 6c69  d(.        appli
+00004bd0: 6361 7469 6f6e 3d22 736f 6d65 2d6e 616d  cation="some-nam
+00004be0: 6522 2c0a 2020 2020 2020 2020 696e 7075  e",.        inpu
+00004bf0: 7473 3d7b 2241 223a 2031 3030 7d2c 0a20  ts={"A": 100},. 
+00004c00: 2020 2020 2020 206f 7574 7075 7473 3d7b         outputs={
+00004c10: 2276 616c 7565 223a 2022 6261 7222 7d2c  "value": "bar"},
+00004c20: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
+00004c30: 3d22 612e 622e 6322 2c0a 2020 2020 2020  ="a.b.c",.      
+00004c40: 2020 6665 6564 6261 636b 5f6b 6579 733d    feedback_keys=
+00004c50: 5b22 4122 5d2c 0a20 2020 2020 2020 2069  ["A"],.        i
+00004c60: 676e 6f72 655f 696e 7075 7473 3d5b 2241  gnore_inputs=["A
+00004c70: 225d 2c0a 2020 2020 2020 2020 6665 6564  "],.        feed
+00004c80: 6261 636b 5f69 643d 6665 6564 6261 636b  back_id=feedback
+00004c90: 5f69 642c 0a20 2020 2020 2020 2074 696d  _id,.        tim
+00004ca0: 6573 7461 6d70 3d53 4f4d 455f 5449 4d45  estamp=SOME_TIME
+00004cb0: 2c0a 2020 2020 290a 2020 2020 6173 7365  ,.    ).    asse
+00004cc0: 7274 2022 496e 7465 726e 616c 2065 7863  rt "Internal exc
+00004cd0: 6570 7469 6f6e 2069 6e20 4761 6e74 7279  eption in Gantry
+00004ce0: 2063 6c69 656e 7422 2069 6e20 6361 706c   client" in capl
+00004cf0: 6f67 2e74 6578 740a 2020 2020 6173 7365  og.text.    asse
+00004d00: 7274 2022 5479 7065 4572 726f 723a 2220  rt "TypeError:" 
+00004d10: 696e 2063 6170 6c6f 672e 7465 7874 0a0a  in caplog.text..
+00004d20: 0a40 6672 6565 7a65 5f74 696d 6528 4355  .@freeze_time(CU
+00004d30: 5252 454e 545f 5449 4d45 290a 4070 7974  RRENT_TIME).@pyt
+00004d40: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
+00004d50: 7269 7a65 2822 6665 6564 6261 636b 5f69  rize("feedback_i
+00004d60: 6422 2c20 5b22 666f 6f22 2c20 7b22 666f  d", ["foo", {"fo
+00004d70: 6f22 3a20 2262 6172 227d 5d29 0a40 6d6f  o": "bar"}]).@mo
+00004d80: 636b 2e70 6174 6368 2822 6761 6e74 7279  ck.patch("gantry
+00004d90: 2e6c 6f67 6765 722e 6576 656e 745f 6275  .logger.event_bu
+00004da0: 696c 6465 722e 7575 6964 2e75 7569 6434  ilder.uuid.uuid4
+00004db0: 2229 0a64 6566 2074 6573 745f 6c6f 675f  ").def test_log_
+00004dc0: 7265 636f 7264 5f76 616c 6964 5f66 6565  record_valid_fee
+00004dd0: 6462 6163 6b5f 6964 5f66 6f72 5f70 7265  dback_id_for_pre
+00004de0: 6469 6374 696f 6e28 6d6f 636b 5f75 7569  diction(mock_uui
+00004df0: 642c 2066 6565 6462 6163 6b5f 6964 2c20  d, feedback_id, 
+00004e00: 636c 695f 6f62 6a29 3a0a 2020 2020 6d6f  cli_obj):.    mo
+00004e10: 636b 5f75 7569 642e 7265 7475 726e 5f76  ck_uuid.return_v
+00004e20: 616c 7565 203d 2022 3132 3334 3522 0a20  alue = "12345". 
+00004e30: 2020 2063 6c69 5f6f 626a 2e6c 6f67 5f72     cli_obj.log_r
+00004e40: 6563 6f72 6428 0a20 2020 2020 2020 2061  ecord(.        a
+00004e50: 7070 6c69 6361 7469 6f6e 3d22 736f 6d65  pplication="some
+00004e60: 2d6e 616d 6522 2c0a 2020 2020 2020 2020  -name",.        
+00004e70: 696e 7075 7473 3d7b 2241 223a 2031 3030  inputs={"A": 100
+00004e80: 7d2c 0a20 2020 2020 2020 206f 7574 7075  },.        outpu
+00004e90: 7473 3d7b 2276 616c 7565 223a 2022 6261  ts={"value": "ba
+00004ea0: 7222 7d2c 0a20 2020 2020 2020 2076 6572  r"},.        ver
+00004eb0: 7369 6f6e 3d22 612e 622e 6322 2c0a 2020  sion="a.b.c",.  
+00004ec0: 2020 2020 2020 6967 6e6f 7265 5f69 6e70        ignore_inp
+00004ed0: 7574 733d 5b22 4222 5d2c 0a20 2020 2020  uts=["B"],.     
+00004ee0: 2020 2066 6565 6462 6163 6b5f 6964 3d66     feedback_id=f
+00004ef0: 6565 6462 6163 6b5f 6964 2c0a 2020 2020  eedback_id,.    
+00004f00: 2020 2020 7469 6d65 7374 616d 703d 534f      timestamp=SO
+00004f10: 4d45 5f54 494d 452c 0a20 2020 2029 0a20  ME_TIME,.    ). 
+00004f20: 2020 2061 7373 6572 7420 636c 695f 6f62     assert cli_ob
+00004f30: 6a2e 6c6f 675f 7374 6f72 652e 6c6f 6773  j.log_store.logs
+00004f40: 203d 3d20 5b0a 2020 2020 2020 2020 7b0a   == [.        {.
+00004f50: 2020 2020 2020 2020 2020 2020 2265 7665              "eve
+00004f60: 6e74 7322 3a20 5b0a 2020 2020 2020 2020  nts": [.        
+00004f70: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+00004f80: 2020 2020 2020 2020 2020 2020 2020 2262                "b
+00004f90: 6174 6368 5f69 6422 3a20 4e6f 6e65 2c0a  atch_id": None,.
+00004fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004fb0: 2020 2020 2265 7665 6e74 5f69 6422 3a20      "event_id": 
+00004fc0: 2231 3233 3435 222c 0a20 2020 2020 2020  "12345",.       
+00004fd0: 2020 2020 2020 2020 2020 2020 2022 696e               "in
+00004fe0: 7075 7473 223a 207b 2241 223a 2031 3030  puts": {"A": 100
+00004ff0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+00005000: 2020 2020 2020 2022 6f75 7470 7574 7322         "outputs"
+00005010: 3a20 7b22 7661 6c75 6522 3a20 2262 6172  : {"value": "bar
+00005020: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
+00005030: 2020 2020 2020 2020 2274 6167 7322 3a20          "tags": 
+00005040: 7b22 656e 7622 3a20 2274 6573 7422 7d2c  {"env": "test"},
+00005050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005060: 2020 2020 2022 6665 6564 6261 636b 5f69       "feedback_i
+00005070: 6422 3a20 2234 3261 3562 3762 3939 6233  d": "42a5b7b99b3
+00005080: 3731 3764 3165 6165 6237 3261 3639 3438  717d1eaeb72a6948
+00005090: 6461 6263 3922 0a20 2020 2020 2020 2020  dabc9".         
+000050a0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+000050b0: 696e 7374 616e 6365 2866 6565 6462 6163  instance(feedbac
+000050c0: 6b5f 6964 2c20 6469 6374 290a 2020 2020  k_id, dict).    
+000050d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000050e0: 656c 7365 2066 6565 6462 6163 6b5f 6964  else feedback_id
+000050f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00005100: 2020 2020 2020 226c 6f67 5f74 696d 6573        "log_times
+00005110: 7461 6d70 223a 2043 5552 5245 4e54 5f54  tamp": CURRENT_T
+00005120: 494d 455f 5354 522c 0a20 2020 2020 2020  IME_STR,.       
+00005130: 2020 2020 2020 2020 2020 2020 2022 6d65               "me
+00005140: 7461 6461 7461 223a 207b 0a20 2020 2020  tadata": {.     
+00005150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005160: 2020 2022 6675 6e63 5f6e 616d 6522 3a20     "func_name": 
+00005170: 2273 6f6d 652d 6e61 6d65 222c 0a20 2020  "some-name",.   
+00005180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005190: 2020 2020 2022 7665 7273 696f 6e22 3a20       "version": 
+000051a0: 2261 2e62 2e63 222c 0a20 2020 2020 2020  "a.b.c",.       
+000051b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000051c0: 2022 6967 6e6f 7265 5f69 6e70 7574 7322   "ignore_inputs"
+000051d0: 3a20 5b22 4222 5d2c 0a20 2020 2020 2020  : ["B"],.       
+000051e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000051f0: 2022 6665 6564 6261 636b 5f6b 6579 7322   "feedback_keys"
+00005200: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
+00005210: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+00005220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005230: 2020 2022 7469 6d65 7374 616d 7022 3a20     "timestamp": 
+00005240: 534f 4d45 5f54 494d 455f 5354 522c 0a20  SOME_TIME_STR,. 
+00005250: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00005260: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
+00005270: 2020 2020 2020 2020 2020 2020 2261 7070              "app
+00005280: 6c69 6361 7469 6f6e 223a 2022 736f 6d65  lication": "some
+00005290: 2d6e 616d 6522 2c0a 2020 2020 2020 2020  -name",.        
+000052a0: 7d2c 0a20 2020 205d 0a0a 0a40 6672 6565  },.    ]...@free
+000052b0: 7a65 5f74 696d 6528 4355 5252 454e 545f  ze_time(CURRENT_
+000052c0: 5449 4d45 290a 4070 7974 6573 742e 6d61  TIME).@pytest.ma
+000052d0: 726b 2e70 6172 616d 6574 7269 7a65 2822  rk.parametrize("
+000052e0: 6665 6564 6261 636b 5f69 6422 2c20 5b22  feedback_id", ["
+000052f0: 666f 6f22 2c20 7b22 666f 6f22 3a20 2262  foo", {"foo": "b
+00005300: 6172 227d 5d29 0a40 6d6f 636b 2e70 6174  ar"}]).@mock.pat
+00005310: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
+00005320: 722e 6576 656e 745f 6275 696c 6465 722e  r.event_builder.
+00005330: 7575 6964 2e75 7569 6434 2229 0a64 6566  uuid.uuid4").def
+00005340: 2074 6573 745f 7369 6e67 6c65 5f6c 6f67   test_single_log
+00005350: 5f72 6563 6f72 645f 7661 6c69 645f 6665  _record_valid_fe
+00005360: 6564 6261 636b 5f69 645f 666f 725f 7072  edback_id_for_pr
+00005370: 6564 6963 7469 6f6e 286d 6f63 6b5f 7575  ediction(mock_uu
+00005380: 6964 2c20 6665 6564 6261 636b 5f69 642c  id, feedback_id,
+00005390: 2063 6c69 5f6f 626a 293a 0a20 2020 206d   cli_obj):.    m
+000053a0: 6f63 6b5f 7575 6964 2e72 6574 7572 6e5f  ock_uuid.return_
+000053b0: 7661 6c75 6520 3d20 2231 3233 3435 220a  value = "12345".
+000053c0: 2020 2020 636c 695f 6f62 6a2e 7369 6e67      cli_obj.sing
+000053d0: 6c65 5f6c 6f67 5f72 6563 6f72 6428 0a20  le_log_record(. 
+000053e0: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
+000053f0: 6f6e 3d22 736f 6d65 2d6e 616d 6522 2c0a  on="some-name",.
+00005400: 2020 2020 2020 2020 696e 7075 7473 3d7b          inputs={
+00005410: 2241 223a 2031 3030 7d2c 0a20 2020 2020  "A": 100},.     
+00005420: 2020 206f 7574 7075 7473 3d7b 2276 616c     outputs={"val
+00005430: 7565 223a 2022 6261 7222 7d2c 0a20 2020  ue": "bar"},.   
+00005440: 2020 2020 2076 6572 7369 6f6e 3d22 612e       version="a.
+00005450: 622e 6322 2c0a 2020 2020 2020 2020 6967  b.c",.        ig
+00005460: 6e6f 7265 5f69 6e70 7574 733d 5b22 4222  nore_inputs=["B"
+00005470: 5d2c 0a20 2020 2020 2020 2066 6565 6462  ],.        feedb
+00005480: 6163 6b5f 6964 3d66 6565 6462 6163 6b5f  ack_id=feedback_
+00005490: 6964 2c0a 2020 2020 2020 2020 7469 6d65  id,.        time
+000054a0: 7374 616d 703d 534f 4d45 5f54 494d 452c  stamp=SOME_TIME,
+000054b0: 0a20 2020 2029 0a20 2020 2061 7373 6572  .    ).    asser
+000054c0: 7420 636c 695f 6f62 6a2e 6c6f 675f 7374  t cli_obj.log_st
+000054d0: 6f72 652e 6c6f 6773 203d 3d20 5b0a 2020  ore.logs == [.  
+000054e0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+000054f0: 2020 2020 2265 7665 6e74 7322 3a20 5b0a      "events": [.
 00005500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005510: 2020 2022 6665 6564 6261 636b 5f69 6422     "feedback_id"
-00005520: 3a20 2234 3261 3562 3762 3939 6233 3731  : "42a5b7b99b371
-00005530: 3764 3165 6165 6237 3261 3639 3438 6461  7d1eaeb72a6948da
-00005540: 6263 3922 0a20 2020 2020 2020 2020 2020  bc9".           
-00005550: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-00005560: 7374 616e 6365 2866 6565 6462 6163 6b5f  stance(feedback_
-00005570: 6964 2c20 6469 6374 290a 2020 2020 2020  id, dict).      
-00005580: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00005590: 7365 2066 6565 6462 6163 6b5f 6964 2c0a  se feedback_id,.
-000055a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000055b0: 2020 2020 226c 6f67 5f74 696d 6573 7461      "log_timesta
-000055c0: 6d70 223a 2043 5552 5245 4e54 5f54 494d  mp": CURRENT_TIM
-000055d0: 455f 5354 522c 0a20 2020 2020 2020 2020  E_STR,.         
-000055e0: 2020 2020 2020 2020 2020 2022 6d65 7461             "meta
-000055f0: 6461 7461 223a 207b 0a20 2020 2020 2020  data": {.       
-00005600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005610: 2022 6675 6e63 5f6e 616d 6522 3a20 2273   "func_name": "s
-00005620: 6f6d 652d 6e61 6d65 222c 0a20 2020 2020  ome-name",.     
+00005510: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00005520: 2020 2020 2020 2262 6174 6368 5f69 6422        "batch_id"
+00005530: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
+00005540: 2020 2020 2020 2020 2020 2020 2265 7665              "eve
+00005550: 6e74 5f69 6422 3a20 2231 3233 3435 222c  nt_id": "12345",
+00005560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005570: 2020 2020 2022 696e 7075 7473 223a 207b       "inputs": {
+00005580: 2241 223a 2031 3030 7d2c 0a20 2020 2020  "A": 100},.     
+00005590: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000055a0: 6f75 7470 7574 7322 3a20 7b22 7661 6c75  outputs": {"valu
+000055b0: 6522 3a20 2262 6172 227d 2c0a 2020 2020  e": "bar"},.    
+000055c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000055d0: 2274 6167 7322 3a20 7b22 656e 7622 3a20  "tags": {"env": 
+000055e0: 2274 6573 7422 7d2c 0a20 2020 2020 2020  "test"},.       
+000055f0: 2020 2020 2020 2020 2020 2020 2022 6665               "fe
+00005600: 6564 6261 636b 5f69 6422 3a20 2234 3261  edback_id": "42a
+00005610: 3562 3762 3939 6233 3731 3764 3165 6165  5b7b99b3717d1eae
+00005620: 6237 3261 3639 3438 6461 6263 3922 0a20  b72a6948dabc9". 
 00005630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005640: 2020 2022 6665 6564 6261 636b 5f76 6572     "feedback_ver
-00005650: 7369 6f6e 223a 2022 612e 622e 6322 2c0a  sion": "a.b.c",.
-00005660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005670: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-00005680: 2020 2020 2020 2020 2020 2022 7469 6d65             "time
-00005690: 7374 616d 7022 3a20 534f 4d45 5f54 494d  stamp": SOME_TIM
-000056a0: 455f 5354 522c 0a20 2020 2020 2020 2020  E_STR,.         
-000056b0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-000056c0: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-000056d0: 2020 2020 2261 7070 6c69 6361 7469 6f6e      "application
-000056e0: 223a 2022 736f 6d65 2d6e 616d 6522 2c0a  ": "some-name",.
-000056f0: 2020 2020 2020 2020 7d2c 0a20 2020 205d          },.    ]
-00005700: 0a0a 0a40 7079 7465 7374 2e6d 6172 6b2e  ...@pytest.mark.
-00005710: 7061 7261 6d65 7472 697a 6528 2274 696d  parametrize("tim
-00005720: 6573 7461 6d70 222c 205b 5b5d 2c20 2273  estamp", [[], "s
-00005730: 6f6d 652d 7469 6d65 7374 616d 7022 2c20  ome-timestamp", 
-00005740: 3130 2c20 2232 3032 302d 3130 2d31 3022  10, "2020-10-10"
-00005750: 5d29 0a64 6566 2074 6573 745f 6c6f 675f  ]).def test_log_
-00005760: 7265 636f 7264 5f69 6e76 616c 6964 5f74  record_invalid_t
-00005770: 696d 6573 7461 6d70 5f66 6f72 5f70 7265  imestamp_for_pre
-00005780: 6469 6374 696f 6e28 7469 6d65 7374 616d  diction(timestam
-00005790: 702c 2063 6c69 5f6f 626a 2c20 6361 706c  p, cli_obj, capl
-000057a0: 6f67 293a 0a20 2020 2063 6170 6c6f 672e  og):.    caplog.
-000057b0: 7365 745f 6c65 7665 6c28 6c6f 6767 696e  set_level(loggin
-000057c0: 672e 4552 524f 522c 206c 6f67 6765 723d  g.ERROR, logger=
-000057d0: 2267 616e 7472 792e 636c 6965 6e74 2229  "gantry.client")
-000057e0: 0a20 2020 2063 6c69 5f6f 626a 2e6c 6f67  .    cli_obj.log
-000057f0: 5f72 6563 6f72 6428 0a20 2020 2020 2020  _record(.       
-00005800: 2061 7070 6c69 6361 7469 6f6e 3d22 736f   application="so
-00005810: 6d65 2d6e 616d 6522 2c0a 2020 2020 2020  me-name",.      
-00005820: 2020 696e 7075 7473 3d7b 2241 223a 2031    inputs={"A": 1
-00005830: 3030 7d2c 0a20 2020 2020 2020 206f 7574  00},.        out
-00005840: 7075 7473 3d7b 2276 616c 7565 223a 2022  puts={"value": "
-00005850: 6261 7222 7d2c 0a20 2020 2020 2020 2076  bar"},.        v
-00005860: 6572 7369 6f6e 3d22 612e 622e 6322 2c0a  ersion="a.b.c",.
-00005870: 2020 2020 2020 2020 6665 6564 6261 636b          feedback
-00005880: 5f6b 6579 733d 5b22 4122 5d2c 0a20 2020  _keys=["A"],.   
-00005890: 2020 2020 2069 676e 6f72 655f 696e 7075       ignore_inpu
-000058a0: 7473 3d5b 2241 225d 2c0a 2020 2020 2020  ts=["A"],.      
-000058b0: 2020 6665 6564 6261 636b 5f69 643d 7b22    feedback_id={"
-000058c0: 4122 3a20 3130 307d 2c0a 2020 2020 2020  A": 100},.      
-000058d0: 2020 7469 6d65 7374 616d 703d 7469 6d65    timestamp=time
-000058e0: 7374 616d 702c 0a20 2020 2029 0a20 2020  stamp,.    ).   
-000058f0: 2061 7373 6572 7420 2249 6e74 6572 6e61   assert "Interna
-00005900: 6c20 6578 6365 7074 696f 6e20 696e 2047  l exception in G
-00005910: 616e 7472 7920 636c 6965 6e74 2220 696e  antry client" in
-00005920: 2063 6170 6c6f 672e 7465 7874 0a20 2020   caplog.text.   
-00005930: 2061 7373 6572 7420 2254 7970 6545 7272   assert "TypeErr
-00005940: 6f72 3a22 2069 6e20 6361 706c 6f67 2e74  or:" in caplog.t
-00005950: 6578 740a 0a0a 4070 7974 6573 742e 6d61  ext...@pytest.ma
-00005960: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
-00005970: 2020 2020 5b22 7361 6d70 6c65 5f72 6174      ["sample_rat
-00005980: 6522 2c20 2273 616d 706c 6522 2c20 2265  e", "sample", "e
-00005990: 7870 6563 7465 6422 5d2c 0a20 2020 205b  xpected"],.    [
-000059a0: 0a20 2020 2020 2020 2028 312c 2030 2e39  .        (1, 0.9
-000059b0: 2c20 3129 2c0a 2020 2020 2020 2020 2830  , 1),.        (0
-000059c0: 2c20 302e 392c 2030 292c 0a20 2020 2020  , 0.9, 0),.     
-000059d0: 2020 2028 302e 352c 2030 2e34 2c20 3129     (0.5, 0.4, 1)
-000059e0: 2c0a 2020 2020 2020 2020 2830 2e35 2c20  ,.        (0.5, 
-000059f0: 302e 352c 2031 292c 0a20 2020 2020 2020  0.5, 1),.       
-00005a00: 2028 302e 352c 2030 2e35 312c 2030 292c   (0.5, 0.51, 0),
-00005a10: 0a20 2020 205d 2c0a 290a 6465 6620 7465  .    ],.).def te
-00005a20: 7374 5f6c 6f67 5f72 6563 6f72 645f 7361  st_log_record_sa
-00005a30: 6d70 6c65 5f72 6174 6528 7361 6d70 6c65  mple_rate(sample
-00005a40: 5f72 6174 652c 2073 616d 706c 652c 2065  _rate, sample, e
-00005a50: 7870 6563 7465 642c 2063 6c69 5f6f 626a  xpected, cli_obj
-00005a60: 293a 0a20 2020 2077 6974 6820 6d6f 636b  ):.    with mock
-00005a70: 2e70 6174 6368 2822 7261 6e64 6f6d 2e72  .patch("random.r
-00005a80: 616e 646f 6d22 2c20 7265 7475 726e 5f76  andom", return_v
-00005a90: 616c 7565 3d73 616d 706c 6529 3a0a 2020  alue=sample):.  
-00005aa0: 2020 2020 2020 636c 695f 6f62 6a2e 6c6f        cli_obj.lo
-00005ab0: 675f 7265 636f 7264 280a 2020 2020 2020  g_record(.      
-00005ac0: 2020 2020 2020 6170 706c 6963 6174 696f        applicatio
-00005ad0: 6e3d 2266 6f6f 6261 7222 2c0a 2020 2020  n="foobar",.    
-00005ae0: 2020 2020 2020 2020 696e 7075 7473 3d7b          inputs={
-00005af0: 2241 223a 2031 3030 7d2c 0a20 2020 2020  "A": 100},.     
-00005b00: 2020 2020 2020 206f 7574 7075 7473 3d7b         outputs={
-00005b10: 2242 223a 2031 3030 7d2c 0a20 2020 2020  "B": 100},.     
-00005b20: 2020 2020 2020 2073 616d 706c 655f 7261         sample_ra
-00005b30: 7465 3d73 616d 706c 655f 7261 7465 2c0a  te=sample_rate,.
-00005b40: 2020 2020 2020 2020 290a 0a20 2020 2061          )..    a
-00005b50: 7373 6572 7420 6c65 6e28 636c 695f 6f62  ssert len(cli_ob
-00005b60: 6a2e 6c6f 675f 7374 6f72 652e 6c6f 6773  j.log_store.logs
-00005b70: 2920 3d3d 2065 7870 6563 7465 640a 0a0a  ) == expected...
-00005b80: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
-00005b90: 616d 6574 7269 7a65 280a 2020 2020 5b22  ametrize(.    ["
-00005ba0: 7361 6d70 6c65 5f72 6174 6522 2c20 2273  sample_rate", "s
-00005bb0: 616d 706c 6522 2c20 2265 7870 6563 7465  ample", "expecte
-00005bc0: 6422 5d2c 0a20 2020 205b 0a20 2020 2020  d"],.    [.     
-00005bd0: 2020 2028 312c 2030 2e39 2c20 3129 2c0a     (1, 0.9, 1),.
-00005be0: 2020 2020 2020 2020 2830 2c20 302e 392c          (0, 0.9,
-00005bf0: 2030 292c 0a20 2020 2020 2020 2028 302e   0),.        (0.
-00005c00: 352c 2030 2e34 2c20 3129 2c0a 2020 2020  5, 0.4, 1),.    
-00005c10: 2020 2020 2830 2e35 2c20 302e 352c 2031      (0.5, 0.5, 1
-00005c20: 292c 0a20 2020 2020 2020 2028 302e 352c  ),.        (0.5,
-00005c30: 2030 2e35 312c 2030 292c 0a20 2020 205d   0.51, 0),.    ]
-00005c40: 2c0a 290a 6465 6620 7465 7374 5f73 696e  ,.).def test_sin
-00005c50: 676c 655f 6c6f 675f 7265 636f 7264 5f73  gle_log_record_s
-00005c60: 616d 706c 655f 7261 7465 2873 616d 706c  ample_rate(sampl
-00005c70: 655f 7261 7465 2c20 7361 6d70 6c65 2c20  e_rate, sample, 
-00005c80: 6578 7065 6374 6564 2c20 636c 695f 6f62  expected, cli_ob
-00005c90: 6a29 3a0a 2020 2020 7769 7468 206d 6f63  j):.    with moc
-00005ca0: 6b2e 7061 7463 6828 2272 616e 646f 6d2e  k.patch("random.
-00005cb0: 7261 6e64 6f6d 222c 2072 6574 7572 6e5f  random", return_
-00005cc0: 7661 6c75 653d 7361 6d70 6c65 293a 0a20  value=sample):. 
-00005cd0: 2020 2020 2020 2063 6c69 5f6f 626a 2e73         cli_obj.s
-00005ce0: 696e 676c 655f 6c6f 675f 7265 636f 7264  ingle_log_record
-00005cf0: 280a 2020 2020 2020 2020 2020 2020 6170  (.            ap
-00005d00: 706c 6963 6174 696f 6e3d 2266 6f6f 6261  plication="fooba
-00005d10: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
-00005d20: 696e 7075 7473 3d7b 2241 223a 2031 3030  inputs={"A": 100
-00005d30: 7d2c 0a20 2020 2020 2020 2020 2020 206f  },.            o
-00005d40: 7574 7075 7473 3d7b 2242 223a 2031 3030  utputs={"B": 100
-00005d50: 7d2c 0a20 2020 2020 2020 2020 2020 2073  },.            s
-00005d60: 616d 706c 655f 7261 7465 3d73 616d 706c  ample_rate=sampl
-00005d70: 655f 7261 7465 2c0a 2020 2020 2020 2020  e_rate,.        
-00005d80: 290a 0a20 2020 2061 7373 6572 7420 6c65  )..    assert le
-00005d90: 6e28 636c 695f 6f62 6a2e 6c6f 675f 7374  n(cli_obj.log_st
-00005da0: 6f72 652e 6c6f 6773 2920 3d3d 2065 7870  ore.logs) == exp
-00005db0: 6563 7465 640a 0a0a 4066 7265 657a 655f  ected...@freeze_
-00005dc0: 7469 6d65 2843 5552 5245 4e54 5f54 494d  time(CURRENT_TIM
-00005dd0: 4529 0a40 7079 7465 7374 2e6d 6172 6b2e  E).@pytest.mark.
-00005de0: 7061 7261 6d65 7472 697a 6528 2274 6167  parametrize("tag
-00005df0: 7322 2c20 5b7b 2265 6e76 223a 2022 6f76  s", [{"env": "ov
-00005e00: 6572 7772 6974 655f 656e 7622 7d2c 207b  erwrite_env"}, {
-00005e10: 7d2c 204e 6f6e 655d 290a 4070 7974 6573  }, None]).@pytes
-00005e20: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
-00005e30: 7a65 2822 7469 6d65 7374 616d 7022 2c20  ze("timestamp", 
-00005e40: 5b4e 6f6e 652c 2053 4f4d 455f 5449 4d45  [None, SOME_TIME
-00005e50: 5d29 0a40 6d6f 636b 2e70 6174 6368 2822  ]).@mock.patch("
-00005e60: 6761 6e74 7279 2e6c 6f67 6765 722e 6576  gantry.logger.ev
-00005e70: 656e 745f 6275 696c 6465 722e 7575 6964  ent_builder.uuid
-00005e80: 2e75 7569 6434 2229 0a64 6566 2074 6573  .uuid4").def tes
-00005e90: 745f 6c6f 675f 7072 6564 6963 7469 6f6e  t_log_prediction
-00005ea0: 5f61 6e64 5f66 6565 6462 6163 6b5f 6576  _and_feedback_ev
-00005eb0: 656e 7428 6d6f 636b 5f75 7569 642c 2074  ent(mock_uuid, t
-00005ec0: 696d 6573 7461 6d70 2c20 7461 6773 2c20  imestamp, tags, 
-00005ed0: 636c 695f 6f62 6a29 3a0a 2020 2020 6d6f  cli_obj):.    mo
-00005ee0: 636b 5f75 7569 642e 7265 7475 726e 5f76  ck_uuid.return_v
-00005ef0: 616c 7565 203d 2022 3132 3334 3522 0a20  alue = "12345". 
-00005f00: 2020 2061 7373 6572 7420 280a 2020 2020     assert (.    
-00005f10: 2020 2020 636c 695f 6f62 6a2e 5f6c 6f67      cli_obj._log
-00005f20: 5f70 7265 6469 6374 696f 6e5f 616e 645f  _prediction_and_
-00005f30: 6665 6564 6261 636b 5f65 7665 6e74 280a  feedback_event(.
-00005f40: 2020 2020 2020 2020 2020 2020 6170 706c              appl
-00005f50: 6963 6174 696f 6e3d 2266 6f6f 6261 7222  ication="foobar"
-00005f60: 2c0a 2020 2020 2020 2020 2020 2020 7665  ,.            ve
-00005f70: 7273 696f 6e3d 2261 2e62 2e63 222c 0a20  rsion="a.b.c",. 
-00005f80: 2020 2020 2020 2020 2020 2069 6e70 7574             input
-00005f90: 733d 7b22 4122 3a20 3130 307d 2c0a 2020  s={"A": 100},.  
-00005fa0: 2020 2020 2020 2020 2020 6f75 7470 7574            output
-00005fb0: 733d 7b22 7661 6c75 6522 3a20 2262 6172  s={"value": "bar
-00005fc0: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-00005fd0: 6665 6564 6261 636b 3d7b 2276 616c 7565  feedback={"value
-00005fe0: 223a 2022 706f 7461 746f 227d 2c0a 2020  ": "potato"},.  
-00005ff0: 2020 2020 2020 2020 2020 6a6f 696e 5f6b            join_k
-00006000: 6579 3d22 3132 3334 3536 3738 3930 222c  ey="1234567890",
-00006010: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
-00006020: 6573 7461 6d70 3d74 696d 6573 7461 6d70  estamp=timestamp
-00006030: 2c0a 2020 2020 2020 2020 2020 2020 7461  ,.            ta
-00006040: 6773 3d74 6167 732c 0a20 2020 2020 2020  gs=tags,.       
-00006050: 2029 0a20 2020 2020 2020 203d 3d20 2231   ).        == "1
-00006060: 3233 3435 3637 3839 3022 0a20 2020 2029  234567890".    )
-00006070: 0a0a 2020 2020 6173 7365 7274 2063 6c69  ..    assert cli
-00006080: 5f6f 626a 2e6c 6f67 5f73 746f 7265 2e6c  _obj.log_store.l
-00006090: 6f67 7320 3d3d 205b 0a20 2020 2020 2020  ogs == [.       
-000060a0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-000060b0: 6576 656e 7473 223a 205b 0a20 2020 2020  events": [.     
-000060c0: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
-000060d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000060e0: 2022 6261 7463 685f 6964 223a 204e 6f6e   "batch_id": Non
-000060f0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00006100: 2020 2020 2020 2022 6576 656e 745f 6964         "event_id
-00006110: 223a 2022 3132 3334 3522 2c0a 2020 2020  ": "12345",.    
-00006120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006130: 2266 6565 6462 6163 6b22 3a20 7b22 7661  "feedback": {"va
-00006140: 6c75 6522 3a20 2270 6f74 6174 6f22 7d2c  lue": "potato"},
-00006150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006160: 2020 2020 2022 696e 7075 7473 223a 207b       "inputs": {
-00006170: 2241 223a 2031 3030 7d2c 0a20 2020 2020  "A": 100},.     
-00006180: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00006190: 6f75 7470 7574 7322 3a20 7b22 7661 6c75  outputs": {"valu
-000061a0: 6522 3a20 2262 6172 227d 2c0a 2020 2020  e": "bar"},.    
-000061b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000061c0: 2274 6167 7322 3a20 7461 6773 2069 6620  "tags": tags if 
-000061d0: 7461 6773 2069 7320 6e6f 7420 4e6f 6e65  tags is not None
-000061e0: 2065 6c73 6520 4e6f 6e65 2c0a 2020 2020   else None,.    
-000061f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006200: 2266 6565 6462 6163 6b5f 6964 223a 2022  "feedback_id": "
-00006210: 3132 3334 3536 3738 3930 222c 0a20 2020  1234567890",.   
-00006220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006230: 2022 6c6f 675f 7469 6d65 7374 616d 7022   "log_timestamp"
-00006240: 3a20 4355 5252 454e 545f 5449 4d45 5f53  : CURRENT_TIME_S
-00006250: 5452 2c0a 2020 2020 2020 2020 2020 2020  TR,.            
-00006260: 2020 2020 2020 2020 226d 6574 6164 6174          "metadat
-00006270: 6122 3a20 7b0a 2020 2020 2020 2020 2020  a": {.          
-00006280: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-00006290: 6565 6462 6163 6b5f 7665 7273 696f 6e22  eedback_version"
-000062a0: 3a20 2261 2e62 2e63 222c 0a20 2020 2020  : "a.b.c",.     
-000062b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000062c0: 2020 2022 6675 6e63 5f6e 616d 6522 3a20     "func_name": 
-000062d0: 2266 6f6f 6261 7222 2c0a 2020 2020 2020  "foobar",.      
-000062e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000062f0: 2020 2276 6572 7369 6f6e 223a 2022 612e    "version": "a.
-00006300: 622e 6322 2c0a 2020 2020 2020 2020 2020  b.c",.          
-00006310: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-00006320: 676e 6f72 655f 696e 7075 7473 223a 204e  gnore_inputs": N
-00006330: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-00006340: 2020 2020 2020 2020 2020 2020 2022 6665               "fe
-00006350: 6564 6261 636b 5f6b 6579 7322 3a20 4e6f  edback_keys": No
-00006360: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00006370: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-00006380: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00006390: 7469 6d65 7374 616d 7022 3a20 534f 4d45  timestamp": SOME
-000063a0: 5f54 494d 455f 5354 5220 6966 2074 696d  _TIME_STR if tim
-000063b0: 6573 7461 6d70 2065 6c73 6520 4355 5252  estamp else CURR
-000063c0: 454e 545f 5449 4d45 5f53 5452 2c0a 2020  ENT_TIME_STR,.  
-000063d0: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
-000063e0: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-000063f0: 2020 2020 2020 2020 2020 2022 6170 706c             "appl
-00006400: 6963 6174 696f 6e22 3a20 2266 6f6f 6261  ication": "fooba
-00006410: 7222 2c0a 2020 2020 2020 2020 7d2c 0a20  r",.        },. 
-00006420: 2020 205d 0a0a 0a40 7079 7465 7374 2e6d     ]...@pytest.m
-00006430: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
-00006440: 0a20 2020 205b 226b 7761 7267 7322 2c20  .    ["kwargs", 
-00006450: 2265 7870 6563 7465 645f 636f 6d70 6174  "expected_compat
-00006460: 5f63 616c 6c22 5d2c 0a20 2020 205b 0a20  _call"],.    [. 
-00006470: 2020 2020 2020 2028 7b22 6665 6564 6261         ({"feedba
-00006480: 636b 5f6b 6579 7322 3a20 5b22 4122 5d7d  ck_keys": ["A"]}
-00006490: 2c20 5b7b 2241 223a 2031 3030 7d2c 204e  , [{"A": 100}, N
-000064a0: 6f6e 652c 205b 2241 225d 2c20 4e6f 6e65  one, ["A"], None
-000064b0: 5d29 2c0a 2020 2020 2020 2020 287b 2266  ]),.        ({"f
-000064c0: 6565 6462 6163 6b5f 6964 223a 2022 3132  eedback_id": "12
-000064d0: 3334 3522 7d2c 205b 7b22 4122 3a20 3130  345"}, [{"A": 10
-000064e0: 307d 2c20 2231 3233 3435 222c 204e 6f6e  0}, "12345", Non
-000064f0: 652c 204e 6f6e 655d 292c 0a20 2020 2020  e, None]),.     
-00006500: 2020 2028 7b22 6a6f 696e 5f6b 6579 223a     ({"join_key":
-00006510: 2022 3534 3332 3122 7d2c 205b 7b22 4122   "54321"}, [{"A"
-00006520: 3a20 3130 307d 2c20 4e6f 6e65 2c20 4e6f  : 100}, None, No
-00006530: 6e65 2c20 2235 3433 3231 225d 292c 0a20  ne, "54321"]),. 
-00006540: 2020 205d 2c0a 290a 406d 6f63 6b2e 7061     ],.).@mock.pa
-00006550: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
-00006560: 6572 2e63 6c69 656e 742e 5f72 6573 6f6c  er.client._resol
-00006570: 7665 5f6a 6f69 6e5f 6b65 7922 2c20 7265  ve_join_key", re
-00006580: 7475 726e 5f76 616c 7565 3d22 3132 3334  turn_value="1234
-00006590: 3536 3738 3930 2229 0a40 6d6f 636b 2e70  567890").@mock.p
-000065a0: 6174 6368 280a 2020 2020 2267 616e 7472  atch(.    "gantr
-000065b0: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
-000065c0: 4761 6e74 7279 2e5f 6c6f 675f 7072 6564  Gantry._log_pred
-000065d0: 6963 7469 6f6e 5f61 6e64 5f66 6565 6462  iction_and_feedb
-000065e0: 6163 6b5f 6576 656e 7422 2c20 7265 7475  ack_event", retu
-000065f0: 726e 5f76 616c 7565 3d22 666f 6f62 6172  rn_value="foobar
-00006600: 3132 3334 3522 0a29 0a40 6d6f 636b 2e70  12345".).@mock.p
-00006610: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
-00006620: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
-00006630: 792e 5f6c 6f67 5f70 7265 6469 6374 696f  y._log_predictio
-00006640: 6e5f 6576 656e 7422 290a 406d 6f63 6b2e  n_event").@mock.
-00006650: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
-00006660: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
-00006670: 7279 2e5f 6c6f 675f 6665 6564 6261 636b  ry._log_feedback
-00006680: 5f65 7665 6e74 2229 0a64 6566 2074 6573  _event").def tes
-00006690: 745f 6c6f 675f 7265 636f 7264 5f70 7265  t_log_record_pre
-000066a0: 645f 616e 645f 6665 6564 6261 636b 280a  d_and_feedback(.
-000066b0: 2020 2020 6d6f 636b 5f66 6565 6462 6163      mock_feedbac
-000066c0: 6b2c 0a20 2020 206d 6f63 6b5f 7072 6564  k,.    mock_pred
-000066d0: 2c0a 2020 2020 6d6f 636b 5f70 7265 645f  ,.    mock_pred_
-000066e0: 616e 645f 6665 6564 6261 636b 2c0a 2020  and_feedback,.  
-000066f0: 2020 6d6f 636b 5f67 6574 5f72 6563 6f72    mock_get_recor
-00006700: 642c 0a20 2020 206b 7761 7267 732c 0a20  d,.    kwargs,. 
-00006710: 2020 2065 7870 6563 7465 645f 636f 6d70     expected_comp
-00006720: 6174 5f63 616c 6c2c 0a20 2020 2063 6c69  at_call,.    cli
-00006730: 5f6f 626a 2c0a 293a 0a20 2020 2061 7373  _obj,.):.    ass
-00006740: 6572 7420 280a 2020 2020 2020 2020 636c  ert (.        cl
-00006750: 695f 6f62 6a2e 6c6f 675f 7265 636f 7264  i_obj.log_record
-00006760: 280a 2020 2020 2020 2020 2020 2020 6170  (.            ap
-00006770: 706c 6963 6174 696f 6e3d 2266 6f6f 6261  plication="fooba
-00006780: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
-00006790: 7665 7273 696f 6e3d 2232 2e30 2e31 222c  version="2.0.1",
-000067a0: 0a20 2020 2020 2020 2020 2020 2069 6e70  .            inp
-000067b0: 7574 733d 7b22 4122 3a20 3130 307d 2c0a  uts={"A": 100},.
-000067c0: 2020 2020 2020 2020 2020 2020 6f75 7470              outp
-000067d0: 7574 733d 7b22 4222 3a20 3330 307d 2c0a  uts={"B": 300},.
-000067e0: 2020 2020 2020 2020 2020 2020 6665 6564              feed
-000067f0: 6261 636b 3d7b 2241 223a 2032 3030 7d2c  back={"A": 200},
-00006800: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
-00006810: 6573 7461 6d70 3d4e 6f6e 652c 0a20 2020  estamp=None,.   
-00006820: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
-00006830: 732c 0a20 2020 2020 2020 2029 0a20 2020  s,.        ).   
-00006840: 2020 2020 203d 3d20 2266 6f6f 6261 7231       == "foobar1
-00006850: 3233 3435 220a 2020 2020 290a 0a20 2020  2345".    )..   
-00006860: 206d 6f63 6b5f 7072 6564 5f61 6e64 5f66   mock_pred_and_f
-00006870: 6565 6462 6163 6b2e 6173 7365 7274 5f63  eedback.assert_c
-00006880: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-00006890: 0a20 2020 2020 2020 2061 7070 6c69 6361  .        applica
-000068a0: 7469 6f6e 3d22 666f 6f62 6172 222c 0a20  tion="foobar",. 
-000068b0: 2020 2020 2020 2076 6572 7369 6f6e 3d22         version="
-000068c0: 322e 302e 3122 2c0a 2020 2020 2020 2020  2.0.1",.        
-000068d0: 696e 7075 7473 3d7b 2241 223a 2031 3030  inputs={"A": 100
-000068e0: 7d2c 0a20 2020 2020 2020 206f 7574 7075  },.        outpu
-000068f0: 7473 3d7b 2242 223a 2033 3030 7d2c 0a20  ts={"B": 300},. 
-00006900: 2020 2020 2020 2066 6565 6462 6163 6b3d         feedback=
-00006910: 7b22 4122 3a20 3230 307d 2c0a 2020 2020  {"A": 200},.    
-00006920: 2020 2020 6a6f 696e 5f6b 6579 3d22 3132      join_key="12
-00006930: 3334 3536 3738 3930 222c 0a20 2020 2020  34567890",.     
-00006940: 2020 2069 676e 6f72 655f 696e 7075 7473     ignore_inputs
-00006950: 3d4e 6f6e 652c 0a20 2020 2020 2020 2074  =None,.        t
-00006960: 696d 6573 7461 6d70 3d4e 6f6e 652c 0a20  imestamp=None,. 
-00006970: 2020 2020 2020 2074 6167 733d 7b22 656e         tags={"en
-00006980: 7622 3a20 2274 6573 7422 7d2c 0a20 2020  v": "test"},.   
-00006990: 2029 0a20 2020 206d 6f63 6b5f 7072 6564   ).    mock_pred
-000069a0: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
-000069b0: 6564 2829 0a20 2020 206d 6f63 6b5f 6665  ed().    mock_fe
-000069c0: 6564 6261 636b 2e61 7373 6572 745f 6e6f  edback.assert_no
-000069d0: 745f 6361 6c6c 6564 2829 0a0a 2020 2020  t_called()..    
-000069e0: 6d6f 636b 5f67 6574 5f72 6563 6f72 642e  mock_get_record.
-000069f0: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-00006a00: 6365 5f77 6974 6828 2a65 7870 6563 7465  ce_with(*expecte
-00006a10: 645f 636f 6d70 6174 5f63 616c 6c29 0a0a  d_compat_call)..
-00006a20: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
-00006a30: 7261 6d65 7472 697a 6528 0a20 2020 205b  rametrize(.    [
-00006a40: 226b 7761 7267 7322 2c20 2265 7870 6563  "kwargs", "expec
-00006a50: 7465 645f 636f 6d70 6174 5f63 616c 6c22  ted_compat_call"
-00006a60: 5d2c 0a20 2020 205b 0a20 2020 2020 2020  ],.    [.       
-00006a70: 2028 7b22 6a6f 696e 5f6b 6579 7322 3a20   ({"join_keys": 
-00006a80: 2235 3433 3231 227d 2c20 5b7b 2241 223a  "54321"}, [{"A":
-00006a90: 2031 3030 7d2c 204e 6f6e 652c 204e 6f6e   100}, None, Non
-00006aa0: 652c 2022 3534 3332 3122 5d29 2c0a 2020  e, "54321"]),.  
-00006ab0: 2020 5d2c 0a29 0a40 6d6f 636b 2e70 6174    ],.).@mock.pat
-00006ac0: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
-00006ad0: 722e 636c 6965 6e74 2e5f 7265 736f 6c76  r.client._resolv
-00006ae0: 655f 6a6f 696e 5f6b 6579 222c 2072 6574  e_join_key", ret
-00006af0: 7572 6e5f 7661 6c75 653d 2231 3233 3435  urn_value="12345
-00006b00: 3637 3839 3022 290a 406d 6f63 6b2e 7061  67890").@mock.pa
-00006b10: 7463 6828 0a20 2020 2022 6761 6e74 7279  tch(.    "gantry
-00006b20: 2e6c 6f67 6765 722e 636c 6965 6e74 2e47  .logger.client.G
-00006b30: 616e 7472 792e 5f6c 6f67 5f70 7265 6469  antry._log_predi
-00006b40: 6374 696f 6e5f 616e 645f 6665 6564 6261  ction_and_feedba
-00006b50: 636b 5f65 7665 6e74 222c 2072 6574 7572  ck_event", retur
-00006b60: 6e5f 7661 6c75 653d 2266 6f6f 6261 7231  n_value="foobar1
-00006b70: 3233 3435 220a 290a 406d 6f63 6b2e 7061  2345".).@mock.pa
-00006b80: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
-00006b90: 6572 2e63 6c69 656e 742e 4761 6e74 7279  er.client.Gantry
-00006ba0: 2e5f 6c6f 675f 7072 6564 6963 7469 6f6e  ._log_prediction
-00006bb0: 5f65 7665 6e74 2229 0a40 6d6f 636b 2e70  _event").@mock.p
-00006bc0: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
-00006bd0: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
-00006be0: 792e 5f6c 6f67 5f66 6565 6462 6163 6b5f  y._log_feedback_
-00006bf0: 6576 656e 7422 290a 6465 6620 7465 7374  event").def test
-00006c00: 5f73 696e 676c 655f 6c6f 675f 7072 6564  _single_log_pred
-00006c10: 5f61 6e64 5f66 6565 6462 6163 6b28 0a20  _and_feedback(. 
-00006c20: 2020 206d 6f63 6b5f 6665 6564 6261 636b     mock_feedback
-00006c30: 2c0a 2020 2020 6d6f 636b 5f70 7265 642c  ,.    mock_pred,
-00006c40: 0a20 2020 206d 6f63 6b5f 7072 6564 5f61  .    mock_pred_a
-00006c50: 6e64 5f66 6565 6462 6163 6b2c 0a20 2020  nd_feedback,.   
-00006c60: 206d 6f63 6b5f 6765 745f 7265 636f 7264   mock_get_record
-00006c70: 2c0a 2020 2020 6b77 6172 6773 2c0a 2020  ,.    kwargs,.  
-00006c80: 2020 6578 7065 6374 6564 5f63 6f6d 7061    expected_compa
-00006c90: 745f 6361 6c6c 2c0a 2020 2020 636c 695f  t_call,.    cli_
-00006ca0: 6f62 6a2c 0a29 3a0a 2020 2020 6173 7365  obj,.):.    asse
-00006cb0: 7274 2028 0a20 2020 2020 2020 2063 6c69  rt (.        cli
-00006cc0: 5f6f 626a 2e6c 6f67 280a 2020 2020 2020  _obj.log(.      
-00006cd0: 2020 2020 2020 6170 706c 6963 6174 696f        applicatio
-00006ce0: 6e3d 2266 6f6f 6261 7222 2c0a 2020 2020  n="foobar",.    
-00006cf0: 2020 2020 2020 2020 7665 7273 696f 6e3d          version=
-00006d00: 2232 2e30 2e31 222c 0a20 2020 2020 2020  "2.0.1",.       
-00006d10: 2020 2020 2069 6e70 7574 733d 7b22 4122       inputs={"A"
-00006d20: 3a20 3130 307d 2c0a 2020 2020 2020 2020  : 100},.        
-00006d30: 2020 2020 6f75 7470 7574 733d 7b22 4222      outputs={"B"
-00006d40: 3a20 3330 307d 2c0a 2020 2020 2020 2020  : 300},.        
-00006d50: 2020 2020 6665 6564 6261 636b 733d 7b22      feedbacks={"
-00006d60: 4122 3a20 3230 307d 2c0a 2020 2020 2020  A": 200},.      
-00006d70: 2020 2020 2020 7469 6d65 7374 616d 7073        timestamps
-00006d80: 3d4e 6f6e 652c 0a20 2020 2020 2020 2020  =None,.         
-00006d90: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
-00006da0: 2020 2020 2029 0a20 2020 2020 2020 203d       ).        =
-00006db0: 3d20 2266 6f6f 6261 7231 3233 3435 220a  = "foobar12345".
-00006dc0: 2020 2020 290a 0a20 2020 206d 6f63 6b5f      )..    mock_
-00006dd0: 7072 6564 5f61 6e64 5f66 6565 6462 6163  pred_and_feedbac
-00006de0: 6b2e 6173 7365 7274 5f63 616c 6c65 645f  k.assert_called_
-00006df0: 6f6e 6365 5f77 6974 6828 0a20 2020 2020  once_with(.     
-00006e00: 2020 2061 7070 6c69 6361 7469 6f6e 3d22     application="
-00006e10: 666f 6f62 6172 222c 0a20 2020 2020 2020  foobar",.       
-00006e20: 2076 6572 7369 6f6e 3d22 322e 302e 3122   version="2.0.1"
-00006e30: 2c0a 2020 2020 2020 2020 696e 7075 7473  ,.        inputs
-00006e40: 3d7b 2241 223a 2031 3030 7d2c 0a20 2020  ={"A": 100},.   
-00006e50: 2020 2020 206f 7574 7075 7473 3d7b 2242       outputs={"B
-00006e60: 223a 2033 3030 7d2c 0a20 2020 2020 2020  ": 300},.       
-00006e70: 2066 6565 6462 6163 6b3d 7b22 4122 3a20   feedback={"A": 
-00006e80: 3230 307d 2c0a 2020 2020 2020 2020 6a6f  200},.        jo
-00006e90: 696e 5f6b 6579 3d22 3132 3334 3536 3738  in_key="12345678
-00006ea0: 3930 222c 0a20 2020 2020 2020 2069 676e  90",.        ign
-00006eb0: 6f72 655f 696e 7075 7473 3d4e 6f6e 652c  ore_inputs=None,
-00006ec0: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
-00006ed0: 6d70 3d4e 6f6e 652c 0a20 2020 2020 2020  mp=None,.       
-00006ee0: 2074 6167 733d 7b22 656e 7622 3a20 2274   tags={"env": "t
-00006ef0: 6573 7422 7d2c 0a20 2020 2029 0a20 2020  est"},.    ).   
-00006f00: 206d 6f63 6b5f 7072 6564 2e61 7373 6572   mock_pred.asser
-00006f10: 745f 6e6f 745f 6361 6c6c 6564 2829 0a20  t_not_called(). 
-00006f20: 2020 206d 6f63 6b5f 6665 6564 6261 636b     mock_feedback
-00006f30: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
-00006f40: 6564 2829 0a0a 2020 2020 6d6f 636b 5f67  ed()..    mock_g
-00006f50: 6574 5f72 6563 6f72 642e 6173 7365 7274  et_record.assert
-00006f60: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
-00006f70: 6828 2a65 7870 6563 7465 645f 636f 6d70  h(*expected_comp
-00006f80: 6174 5f63 616c 6c29 0a0a 0a40 7079 7465  at_call)...@pyte
-00006f90: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
-00006fa0: 697a 6528 0a20 2020 205b 226b 7761 7267  ize(.    ["kwarg
-00006fb0: 7322 2c20 2265 7870 6563 7465 645f 636f  s", "expected_co
-00006fc0: 6d70 6174 5f63 616c 6c22 5d2c 0a20 2020  mpat_call"],.   
-00006fd0: 205b 0a20 2020 2020 2020 2028 7b22 6665   [.        ({"fe
-00006fe0: 6564 6261 636b 5f6b 6579 7322 3a20 5b22  edback_keys": ["
-00006ff0: 4122 5d7d 2c20 5b7b 2241 223a 2031 3030  A"]}, [{"A": 100
-00007000: 7d2c 204e 6f6e 652c 205b 2241 225d 2c20  }, None, ["A"], 
-00007010: 4e6f 6e65 5d29 2c0a 2020 2020 2020 2020  None]),.        
-00007020: 287b 2266 6565 6462 6163 6b5f 6964 223a  ({"feedback_id":
-00007030: 2022 3132 3334 3522 7d2c 205b 7b22 4122   "12345"}, [{"A"
-00007040: 3a20 3130 307d 2c20 2231 3233 3435 222c  : 100}, "12345",
-00007050: 204e 6f6e 652c 204e 6f6e 655d 292c 0a20   None, None]),. 
-00007060: 2020 2020 2020 2028 7b22 6a6f 696e 5f6b         ({"join_k
-00007070: 6579 223a 2022 3534 3332 3122 7d2c 205b  ey": "54321"}, [
-00007080: 7b22 4122 3a20 3130 307d 2c20 4e6f 6e65  {"A": 100}, None
-00007090: 2c20 4e6f 6e65 2c20 2235 3433 3231 225d  , None, "54321"]
-000070a0: 292c 0a20 2020 205d 2c0a 290a 406d 6f63  ),.    ],.).@moc
-000070b0: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
-000070c0: 6c6f 6767 6572 2e63 6c69 656e 742e 5f72  logger.client._r
-000070d0: 6573 6f6c 7665 5f6a 6f69 6e5f 6b65 7922  esolve_join_key"
-000070e0: 2c20 7265 7475 726e 5f76 616c 7565 3d22  , return_value="
-000070f0: 3132 3334 3536 3738 3930 2229 0a40 6d6f  1234567890").@mo
-00007100: 636b 2e70 6174 6368 280a 2020 2020 2267  ck.patch(.    "g
-00007110: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
-00007120: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
-00007130: 7072 6564 6963 7469 6f6e 5f61 6e64 5f66  prediction_and_f
-00007140: 6565 6462 6163 6b5f 6576 656e 7422 2c20  eedback_event", 
-00007150: 7265 7475 726e 5f76 616c 7565 3d22 666f  return_value="fo
-00007160: 6f62 6172 3132 3334 3522 0a29 0a40 6d6f  obar12345".).@mo
-00007170: 636b 2e70 6174 6368 2822 6761 6e74 7279  ck.patch("gantry
-00007180: 2e6c 6f67 6765 722e 636c 6965 6e74 2e47  .logger.client.G
-00007190: 616e 7472 792e 5f6c 6f67 5f70 7265 6469  antry._log_predi
-000071a0: 6374 696f 6e5f 6576 656e 7422 290a 406d  ction_event").@m
-000071b0: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
-000071c0: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
-000071d0: 4761 6e74 7279 2e5f 6c6f 675f 6665 6564  Gantry._log_feed
-000071e0: 6261 636b 5f65 7665 6e74 2229 0a64 6566  back_event").def
-000071f0: 2074 6573 745f 7369 6e67 6c65 5f6c 6f67   test_single_log
-00007200: 5f72 6563 6f72 645f 7072 6564 5f61 6e64  _record_pred_and
-00007210: 5f66 6565 6462 6163 6b28 0a20 2020 206d  _feedback(.    m
-00007220: 6f63 6b5f 6665 6564 6261 636b 2c0a 2020  ock_feedback,.  
-00007230: 2020 6d6f 636b 5f70 7265 642c 0a20 2020    mock_pred,.   
-00007240: 206d 6f63 6b5f 7072 6564 5f61 6e64 5f66   mock_pred_and_f
-00007250: 6565 6462 6163 6b2c 0a20 2020 206d 6f63  eedback,.    moc
-00007260: 6b5f 6765 745f 7265 636f 7264 2c0a 2020  k_get_record,.  
-00007270: 2020 6b77 6172 6773 2c0a 2020 2020 6578    kwargs,.    ex
-00007280: 7065 6374 6564 5f63 6f6d 7061 745f 6361  pected_compat_ca
-00007290: 6c6c 2c0a 2020 2020 636c 695f 6f62 6a2c  ll,.    cli_obj,
-000072a0: 0a29 3a0a 2020 2020 6173 7365 7274 2028  .):.    assert (
-000072b0: 0a20 2020 2020 2020 2063 6c69 5f6f 626a  .        cli_obj
-000072c0: 2e73 696e 676c 655f 6c6f 675f 7265 636f  .single_log_reco
-000072d0: 7264 280a 2020 2020 2020 2020 2020 2020  rd(.            
-000072e0: 6170 706c 6963 6174 696f 6e3d 2266 6f6f  application="foo
-000072f0: 6261 7222 2c0a 2020 2020 2020 2020 2020  bar",.          
-00007300: 2020 7665 7273 696f 6e3d 2232 2e30 2e31    version="2.0.1
-00007310: 222c 0a20 2020 2020 2020 2020 2020 2069  ",.            i
-00007320: 6e70 7574 733d 7b22 4122 3a20 3130 307d  nputs={"A": 100}
-00007330: 2c0a 2020 2020 2020 2020 2020 2020 6f75  ,.            ou
-00007340: 7470 7574 733d 7b22 4222 3a20 3330 307d  tputs={"B": 300}
-00007350: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
-00007360: 6564 6261 636b 3d7b 2241 223a 2032 3030  edback={"A": 200
-00007370: 7d2c 0a20 2020 2020 2020 2020 2020 2074  },.            t
-00007380: 696d 6573 7461 6d70 3d4e 6f6e 652c 0a20  imestamp=None,. 
-00007390: 2020 2020 2020 2020 2020 202a 2a6b 7761             **kwa
-000073a0: 7267 732c 0a20 2020 2020 2020 2029 0a20  rgs,.        ). 
-000073b0: 2020 2020 2020 203d 3d20 2266 6f6f 6261         == "fooba
-000073c0: 7231 3233 3435 220a 2020 2020 290a 0a20  r12345".    ).. 
-000073d0: 2020 206d 6f63 6b5f 7072 6564 5f61 6e64     mock_pred_and
-000073e0: 5f66 6565 6462 6163 6b2e 6173 7365 7274  _feedback.assert
-000073f0: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
-00007400: 6828 0a20 2020 2020 2020 2061 7070 6c69  h(.        appli
-00007410: 6361 7469 6f6e 3d22 666f 6f62 6172 222c  cation="foobar",
-00007420: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
-00007430: 3d22 322e 302e 3122 2c0a 2020 2020 2020  ="2.0.1",.      
-00007440: 2020 696e 7075 7473 3d7b 2241 223a 2031    inputs={"A": 1
-00007450: 3030 7d2c 0a20 2020 2020 2020 206f 7574  00},.        out
-00007460: 7075 7473 3d7b 2242 223a 2033 3030 7d2c  puts={"B": 300},
-00007470: 0a20 2020 2020 2020 2066 6565 6462 6163  .        feedbac
-00007480: 6b3d 7b22 4122 3a20 3230 307d 2c0a 2020  k={"A": 200},.  
-00007490: 2020 2020 2020 6a6f 696e 5f6b 6579 3d22        join_key="
-000074a0: 3132 3334 3536 3738 3930 222c 0a20 2020  1234567890",.   
-000074b0: 2020 2020 2069 676e 6f72 655f 696e 7075       ignore_inpu
-000074c0: 7473 3d4e 6f6e 652c 0a20 2020 2020 2020  ts=None,.       
-000074d0: 2074 696d 6573 7461 6d70 3d4e 6f6e 652c   timestamp=None,
-000074e0: 0a20 2020 2020 2020 2074 6167 733d 7b22  .        tags={"
-000074f0: 656e 7622 3a20 2274 6573 7422 7d2c 0a20  env": "test"},. 
-00007500: 2020 2029 0a20 2020 206d 6f63 6b5f 7072     ).    mock_pr
-00007510: 6564 2e61 7373 6572 745f 6e6f 745f 6361  ed.assert_not_ca
-00007520: 6c6c 6564 2829 0a20 2020 206d 6f63 6b5f  lled().    mock_
-00007530: 6665 6564 6261 636b 2e61 7373 6572 745f  feedback.assert_
-00007540: 6e6f 745f 6361 6c6c 6564 2829 0a0a 2020  not_called()..  
-00007550: 2020 6d6f 636b 5f67 6574 5f72 6563 6f72    mock_get_recor
-00007560: 642e 6173 7365 7274 5f63 616c 6c65 645f  d.assert_called_
-00007570: 6f6e 6365 5f77 6974 6828 2a65 7870 6563  once_with(*expec
-00007580: 7465 645f 636f 6d70 6174 5f63 616c 6c29  ted_compat_call)
-00007590: 0a0a 0a40 7079 7465 7374 2e6d 6172 6b2e  ...@pytest.mark.
-000075a0: 7061 7261 6d65 7472 697a 6528 0a20 2020  parametrize(.   
-000075b0: 205b 226b 7761 7267 7322 2c20 2265 7870   ["kwargs", "exp
-000075c0: 6563 7465 645f 636f 6d70 6174 5f63 616c  ected_compat_cal
-000075d0: 6c22 5d2c 0a20 2020 205b 0a20 2020 2020  l"],.    [.     
-000075e0: 2020 2028 7b22 6665 6564 6261 636b 5f6b     ({"feedback_k
-000075f0: 6579 7322 3a20 5b22 4122 5d7d 2c20 5b7b  eys": ["A"]}, [{
-00007600: 2241 223a 2031 3030 7d2c 204e 6f6e 652c  "A": 100}, None,
-00007610: 205b 2241 225d 2c20 4e6f 6e65 5d29 2c0a   ["A"], None]),.
-00007620: 2020 2020 2020 2020 287b 2266 6565 6462          ({"feedb
-00007630: 6163 6b5f 6964 223a 2022 3132 3334 3522  ack_id": "12345"
-00007640: 7d2c 205b 7b22 4122 3a20 3130 307d 2c20  }, [{"A": 100}, 
-00007650: 2231 3233 3435 222c 204e 6f6e 652c 204e  "12345", None, N
-00007660: 6f6e 655d 292c 0a20 2020 2020 2020 2028  one]),.        (
-00007670: 7b22 6a6f 696e 5f6b 6579 223a 2022 3534  {"join_key": "54
-00007680: 3332 3122 7d2c 205b 7b22 4122 3a20 3130  321"}, [{"A": 10
-00007690: 307d 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20  0}, None, None, 
-000076a0: 2235 3433 3231 225d 292c 0a20 2020 205d  "54321"]),.    ]
-000076b0: 2c0a 290a 4070 7974 6573 742e 6d61 726b  ,.).@pytest.mark
-000076c0: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
-000076d0: 2020 2274 6573 745f 6665 6564 6261 636b    "test_feedback
-000076e0: 222c 0a20 2020 205b 4e6f 6e65 2c20 7b7d  ",.    [None, {}
-000076f0: 5d2c 0a29 0a40 6d6f 636b 2e70 6174 6368  ],.).@mock.patch
-00007700: 2822 6761 6e74 7279 2e6c 6f67 6765 722e  ("gantry.logger.
-00007710: 636c 6965 6e74 2e5f 7265 736f 6c76 655f  client._resolve_
-00007720: 6a6f 696e 5f6b 6579 222c 2072 6574 7572  join_key", retur
-00007730: 6e5f 7661 6c75 653d 2231 3233 3435 3637  n_value="1234567
-00007740: 3839 3022 290a 406d 6f63 6b2e 7061 7463  890").@mock.patc
-00007750: 6828 2267 616e 7472 792e 6c6f 6767 6572  h("gantry.logger
-00007760: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
-00007770: 6c6f 675f 7072 6564 6963 7469 6f6e 5f61  log_prediction_a
-00007780: 6e64 5f66 6565 6462 6163 6b5f 6576 656e  nd_feedback_even
-00007790: 7422 290a 406d 6f63 6b2e 7061 7463 6828  t").@mock.patch(
-000077a0: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
-000077b0: 6c69 656e 742e 4761 6e74 7279 2e5f 6c6f  lient.Gantry._lo
-000077c0: 675f 7072 6564 6963 7469 6f6e 5f65 7665  g_prediction_eve
-000077d0: 6e74 222c 2072 6574 7572 6e5f 7661 6c75  nt", return_valu
-000077e0: 653d 2266 6f6f 6261 7231 3233 3435 2229  e="foobar12345")
-000077f0: 0a40 6d6f 636b 2e70 6174 6368 2822 6761  .@mock.patch("ga
-00007800: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
-00007810: 6e74 2e47 616e 7472 792e 5f6c 6f67 5f66  nt.Gantry._log_f
-00007820: 6565 6462 6163 6b5f 6576 656e 7422 290a  eedback_event").
-00007830: 6465 6620 7465 7374 5f6c 6f67 5f72 6563  def test_log_rec
-00007840: 6f72 645f 7072 6564 5f6f 6e6c 7928 0a20  ord_pred_only(. 
-00007850: 2020 206d 6f63 6b5f 6665 6564 6261 636b     mock_feedback
-00007860: 2c0a 2020 2020 6d6f 636b 5f70 7265 642c  ,.    mock_pred,
-00007870: 0a20 2020 206d 6f63 6b5f 7072 6564 5f61  .    mock_pred_a
-00007880: 6e64 5f66 6565 6462 6163 6b2c 0a20 2020  nd_feedback,.   
-00007890: 206d 6f63 6b5f 6765 745f 7265 636f 7264   mock_get_record
-000078a0: 2c0a 2020 2020 7465 7374 5f66 6565 6462  ,.    test_feedb
-000078b0: 6163 6b2c 0a20 2020 206b 7761 7267 732c  ack,.    kwargs,
-000078c0: 0a20 2020 2065 7870 6563 7465 645f 636f  .    expected_co
-000078d0: 6d70 6174 5f63 616c 6c2c 0a20 2020 2063  mpat_call,.    c
-000078e0: 6c69 5f6f 626a 2c0a 293a 0a20 2020 2061  li_obj,.):.    a
-000078f0: 7373 6572 7420 280a 2020 2020 2020 2020  ssert (.        
-00007900: 636c 695f 6f62 6a2e 6c6f 675f 7265 636f  cli_obj.log_reco
-00007910: 7264 280a 2020 2020 2020 2020 2020 2020  rd(.            
-00007920: 6170 706c 6963 6174 696f 6e3d 2266 6f6f  application="foo
-00007930: 6261 7222 2c0a 2020 2020 2020 2020 2020  bar",.          
-00007940: 2020 7665 7273 696f 6e3d 2232 2e30 2e31    version="2.0.1
-00007950: 222c 0a20 2020 2020 2020 2020 2020 2069  ",.            i
-00007960: 6e70 7574 733d 7b22 4122 3a20 3130 307d  nputs={"A": 100}
-00007970: 2c0a 2020 2020 2020 2020 2020 2020 6f75  ,.            ou
-00007980: 7470 7574 733d 7b22 4222 3a20 3330 307d  tputs={"B": 300}
-00007990: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
-000079a0: 6564 6261 636b 3d74 6573 745f 6665 6564  edback=test_feed
-000079b0: 6261 636b 2c0a 2020 2020 2020 2020 2020  back,.          
-000079c0: 2020 7469 6d65 7374 616d 703d 4e6f 6e65    timestamp=None
-000079d0: 2c0a 2020 2020 2020 2020 2020 2020 2a2a  ,.            **
-000079e0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-000079f0: 290a 2020 2020 2020 2020 3d3d 2022 666f  ).        == "fo
-00007a00: 6f62 6172 3132 3334 3522 0a20 2020 2029  obar12345".    )
-00007a10: 0a0a 2020 2020 6d6f 636b 5f70 7265 645f  ..    mock_pred_
-00007a20: 616e 645f 6665 6564 6261 636b 2e61 7373  and_feedback.ass
-00007a30: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
-00007a40: 0a20 2020 206d 6f63 6b5f 7072 6564 2e61  .    mock_pred.a
-00007a50: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-00007a60: 655f 7769 7468 280a 2020 2020 2020 2020  e_with(.        
-00007a70: 6170 706c 6963 6174 696f 6e3d 2266 6f6f  application="foo
-00007a80: 6261 7222 2c0a 2020 2020 2020 2020 696e  bar",.        in
-00007a90: 7075 7473 3d7b 2241 223a 2031 3030 7d2c  puts={"A": 100},
-00007aa0: 0a20 2020 2020 2020 206f 7574 7075 7473  .        outputs
-00007ab0: 3d7b 2242 223a 2033 3030 7d2c 0a20 2020  ={"B": 300},.   
-00007ac0: 2020 2020 2076 6572 7369 6f6e 3d22 322e       version="2.
-00007ad0: 302e 3122 2c0a 2020 2020 2020 2020 6a6f  0.1",.        jo
-00007ae0: 696e 5f6b 6579 3d22 3132 3334 3536 3738  in_key="12345678
-00007af0: 3930 222c 0a20 2020 2020 2020 2069 676e  90",.        ign
-00007b00: 6f72 655f 696e 7075 7473 3d4e 6f6e 652c  ore_inputs=None,
-00007b10: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
-00007b20: 6d70 3d4e 6f6e 652c 0a20 2020 2020 2020  mp=None,.       
-00007b30: 2074 6167 733d 7b22 656e 7622 3a20 2274   tags={"env": "t
-00007b40: 6573 7422 7d2c 0a20 2020 2029 0a20 2020  est"},.    ).   
-00007b50: 206d 6f63 6b5f 6665 6564 6261 636b 2e61   mock_feedback.a
-00007b60: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
-00007b70: 2829 0a0a 2020 2020 6d6f 636b 5f67 6574  ()..    mock_get
-00007b80: 5f72 6563 6f72 642e 6173 7365 7274 5f63  _record.assert_c
-00007b90: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-00007ba0: 2a65 7870 6563 7465 645f 636f 6d70 6174  *expected_compat
-00007bb0: 5f63 616c 6c29 0a0a 0a40 7079 7465 7374  _call)...@pytest
-00007bc0: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
-00007bd0: 6528 0a20 2020 205b 226b 7761 7267 7322  e(.    ["kwargs"
-00007be0: 2c20 2265 7870 6563 7465 645f 636f 6d70  , "expected_comp
-00007bf0: 6174 5f63 616c 6c22 5d2c 0a20 2020 205b  at_call"],.    [
-00007c00: 0a20 2020 2020 2020 2028 7b22 6665 6564  .        ({"feed
-00007c10: 6261 636b 5f6b 6579 7322 3a20 5b22 4122  back_keys": ["A"
-00007c20: 5d7d 2c20 5b7b 2241 223a 2031 3030 7d2c  ]}, [{"A": 100},
-00007c30: 204e 6f6e 652c 205b 2241 225d 2c20 4e6f   None, ["A"], No
-00007c40: 6e65 5d29 2c0a 2020 2020 2020 2020 287b  ne]),.        ({
-00007c50: 2266 6565 6462 6163 6b5f 6964 223a 2022  "feedback_id": "
-00007c60: 3132 3334 3522 7d2c 205b 7b22 4122 3a20  12345"}, [{"A": 
-00007c70: 3130 307d 2c20 2231 3233 3435 222c 204e  100}, "12345", N
-00007c80: 6f6e 652c 204e 6f6e 655d 292c 0a20 2020  one, None]),.   
-00007c90: 2020 2020 2028 7b22 6a6f 696e 5f6b 6579       ({"join_key
-00007ca0: 223a 2022 3534 3332 3122 7d2c 205b 7b22  ": "54321"}, [{"
-00007cb0: 4122 3a20 3130 307d 2c20 4e6f 6e65 2c20  A": 100}, None, 
-00007cc0: 4e6f 6e65 2c20 2235 3433 3231 225d 292c  None, "54321"]),
-00007cd0: 0a20 2020 205d 2c0a 290a 4070 7974 6573  .    ],.).@pytes
-00007ce0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
-00007cf0: 7a65 280a 2020 2020 2274 6573 745f 6665  ze(.    "test_fe
-00007d00: 6564 6261 636b 222c 0a20 2020 205b 4e6f  edback",.    [No
-00007d10: 6e65 2c20 7b7d 5d2c 0a29 0a40 6d6f 636b  ne, {}],.).@mock
-00007d20: 2e70 6174 6368 2822 6761 6e74 7279 2e6c  .patch("gantry.l
-00007d30: 6f67 6765 722e 636c 6965 6e74 2e5f 7265  ogger.client._re
-00007d40: 736f 6c76 655f 6a6f 696e 5f6b 6579 222c  solve_join_key",
-00007d50: 2072 6574 7572 6e5f 7661 6c75 653d 2231   return_value="1
-00007d60: 3233 3435 3637 3839 3022 290a 406d 6f63  234567890").@moc
-00007d70: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
-00007d80: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
-00007d90: 6e74 7279 2e5f 6c6f 675f 7072 6564 6963  ntry._log_predic
-00007da0: 7469 6f6e 5f61 6e64 5f66 6565 6462 6163  tion_and_feedbac
-00007db0: 6b5f 6576 656e 7422 290a 406d 6f63 6b2e  k_event").@mock.
-00007dc0: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
-00007dd0: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
-00007de0: 7279 2e5f 6c6f 675f 7072 6564 6963 7469  ry._log_predicti
-00007df0: 6f6e 5f65 7665 6e74 222c 2072 6574 7572  on_event", retur
-00007e00: 6e5f 7661 6c75 653d 2266 6f6f 6261 7231  n_value="foobar1
-00007e10: 3233 3435 2229 0a40 6d6f 636b 2e70 6174  2345").@mock.pat
-00007e20: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
-00007e30: 722e 636c 6965 6e74 2e47 616e 7472 792e  r.client.Gantry.
-00007e40: 5f6c 6f67 5f66 6565 6462 6163 6b5f 6576  _log_feedback_ev
-00007e50: 656e 7422 290a 6465 6620 7465 7374 5f73  ent").def test_s
-00007e60: 696e 676c 655f 6c6f 675f 7265 636f 7264  ingle_log_record
-00007e70: 5f70 7265 645f 6f6e 6c79 280a 2020 2020  _pred_only(.    
-00007e80: 6d6f 636b 5f66 6565 6462 6163 6b2c 0a20  mock_feedback,. 
-00007e90: 2020 206d 6f63 6b5f 7072 6564 2c0a 2020     mock_pred,.  
-00007ea0: 2020 6d6f 636b 5f70 7265 645f 616e 645f    mock_pred_and_
-00007eb0: 6665 6564 6261 636b 2c0a 2020 2020 6d6f  feedback,.    mo
-00007ec0: 636b 5f67 6574 5f72 6563 6f72 642c 0a20  ck_get_record,. 
-00007ed0: 2020 2074 6573 745f 6665 6564 6261 636b     test_feedback
-00007ee0: 2c0a 2020 2020 6b77 6172 6773 2c0a 2020  ,.    kwargs,.  
-00007ef0: 2020 6578 7065 6374 6564 5f63 6f6d 7061    expected_compa
-00007f00: 745f 6361 6c6c 2c0a 2020 2020 636c 695f  t_call,.    cli_
-00007f10: 6f62 6a2c 0a29 3a0a 2020 2020 6173 7365  obj,.):.    asse
-00007f20: 7274 2028 0a20 2020 2020 2020 2063 6c69  rt (.        cli
-00007f30: 5f6f 626a 2e73 696e 676c 655f 6c6f 675f  _obj.single_log_
-00007f40: 7265 636f 7264 280a 2020 2020 2020 2020  record(.        
-00007f50: 2020 2020 6170 706c 6963 6174 696f 6e3d      application=
-00007f60: 2266 6f6f 6261 7222 2c0a 2020 2020 2020  "foobar",.      
-00007f70: 2020 2020 2020 7665 7273 696f 6e3d 2232        version="2
-00007f80: 2e30 2e31 222c 0a20 2020 2020 2020 2020  .0.1",.         
-00007f90: 2020 2069 6e70 7574 733d 7b22 4122 3a20     inputs={"A": 
-00007fa0: 3130 307d 2c0a 2020 2020 2020 2020 2020  100},.          
-00007fb0: 2020 6f75 7470 7574 733d 7b22 4222 3a20    outputs={"B": 
-00007fc0: 3330 307d 2c0a 2020 2020 2020 2020 2020  300},.          
-00007fd0: 2020 6665 6564 6261 636b 3d74 6573 745f    feedback=test_
-00007fe0: 6665 6564 6261 636b 2c0a 2020 2020 2020  feedback,.      
-00007ff0: 2020 2020 2020 7469 6d65 7374 616d 703d        timestamp=
-00008000: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-00008010: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
-00008020: 2020 2020 290a 2020 2020 2020 2020 3d3d      ).        ==
-00008030: 2022 666f 6f62 6172 3132 3334 3522 0a20   "foobar12345". 
-00008040: 2020 2029 0a0a 2020 2020 6d6f 636b 5f70     )..    mock_p
-00008050: 7265 645f 616e 645f 6665 6564 6261 636b  red_and_feedback
-00008060: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
-00008070: 6564 2829 0a20 2020 206d 6f63 6b5f 7072  ed().    mock_pr
-00008080: 6564 2e61 7373 6572 745f 6361 6c6c 6564  ed.assert_called
-00008090: 5f6f 6e63 655f 7769 7468 280a 2020 2020  _once_with(.    
-000080a0: 2020 2020 6170 706c 6963 6174 696f 6e3d      application=
-000080b0: 2266 6f6f 6261 7222 2c0a 2020 2020 2020  "foobar",.      
-000080c0: 2020 696e 7075 7473 3d7b 2241 223a 2031    inputs={"A": 1
-000080d0: 3030 7d2c 0a20 2020 2020 2020 206f 7574  00},.        out
-000080e0: 7075 7473 3d7b 2242 223a 2033 3030 7d2c  puts={"B": 300},
-000080f0: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
-00008100: 3d22 322e 302e 3122 2c0a 2020 2020 2020  ="2.0.1",.      
-00008110: 2020 6a6f 696e 5f6b 6579 3d22 3132 3334    join_key="1234
-00008120: 3536 3738 3930 222c 0a20 2020 2020 2020  567890",.       
-00008130: 2069 676e 6f72 655f 696e 7075 7473 3d4e   ignore_inputs=N
-00008140: 6f6e 652c 0a20 2020 2020 2020 2074 696d  one,.        tim
-00008150: 6573 7461 6d70 3d4e 6f6e 652c 0a20 2020  estamp=None,.   
-00008160: 2020 2020 2074 6167 733d 7b22 656e 7622       tags={"env"
-00008170: 3a20 2274 6573 7422 7d2c 0a20 2020 2029  : "test"},.    )
-00008180: 0a20 2020 206d 6f63 6b5f 6665 6564 6261  .    mock_feedba
-00008190: 636b 2e61 7373 6572 745f 6e6f 745f 6361  ck.assert_not_ca
-000081a0: 6c6c 6564 2829 0a0a 2020 2020 6d6f 636b  lled()..    mock
-000081b0: 5f67 6574 5f72 6563 6f72 642e 6173 7365  _get_record.asse
-000081c0: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-000081d0: 6974 6828 2a65 7870 6563 7465 645f 636f  ith(*expected_co
-000081e0: 6d70 6174 5f63 616c 6c29 0a0a 0a40 7079  mpat_call)...@py
-000081f0: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
-00008200: 7472 697a 6528 0a20 2020 205b 226b 7761  trize(.    ["kwa
-00008210: 7267 7322 2c20 2265 7870 6563 7465 645f  rgs", "expected_
-00008220: 636f 6d70 6174 5f63 616c 6c22 5d2c 0a20  compat_call"],. 
-00008230: 2020 205b 0a20 2020 2020 2020 2028 7b22     [.        ({"
-00008240: 6665 6564 6261 636b 5f6b 6579 7322 3a20  feedback_keys": 
-00008250: 5b22 4122 5d7d 2c20 5b4e 6f6e 652c 204e  ["A"]}, [None, N
-00008260: 6f6e 652c 205b 2241 225d 2c20 4e6f 6e65  one, ["A"], None
-00008270: 5d29 2c0a 2020 2020 2020 2020 287b 2266  ]),.        ({"f
-00008280: 6565 6462 6163 6b5f 6964 223a 2022 3132  eedback_id": "12
-00008290: 3334 3522 7d2c 205b 4e6f 6e65 2c20 2231  345"}, [None, "1
-000082a0: 3233 3435 222c 204e 6f6e 652c 204e 6f6e  2345", None, Non
-000082b0: 655d 292c 0a20 2020 2020 2020 2028 7b22  e]),.        ({"
-000082c0: 6a6f 696e 5f6b 6579 223a 2022 3534 3332  join_key": "5432
-000082d0: 3122 7d2c 205b 4e6f 6e65 2c20 4e6f 6e65  1"}, [None, None
-000082e0: 2c20 4e6f 6e65 2c20 2235 3433 3231 225d  , None, "54321"]
-000082f0: 292c 0a20 2020 205d 2c0a 290a 4070 7974  ),.    ],.).@pyt
-00008300: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-00008310: 7269 7a65 280a 2020 2020 2274 6573 745f  rize(.    "test_
-00008320: 6f75 7470 7574 222c 0a20 2020 205b 4e6f  output",.    [No
-00008330: 6e65 2c20 7b7d 5d2c 0a29 0a40 7079 7465  ne, {}],.).@pyte
-00008340: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
-00008350: 697a 6528 0a20 2020 2022 7465 7374 5f69  ize(.    "test_i
-00008360: 6e70 7574 222c 0a20 2020 205b 4e6f 6e65  nput",.    [None
-00008370: 2c20 7b7d 5d2c 0a29 0a40 6d6f 636b 2e70  , {}],.).@mock.p
-00008380: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
-00008390: 6765 722e 636c 6965 6e74 2e5f 7265 736f  ger.client._reso
-000083a0: 6c76 655f 6a6f 696e 5f6b 6579 222c 2072  lve_join_key", r
-000083b0: 6574 7572 6e5f 7661 6c75 653d 2231 3233  eturn_value="123
-000083c0: 3435 3637 3839 3022 290a 406d 6f63 6b2e  4567890").@mock.
-000083d0: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
-000083e0: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
-000083f0: 7279 2e5f 6c6f 675f 7072 6564 6963 7469  ry._log_predicti
-00008400: 6f6e 5f61 6e64 5f66 6565 6462 6163 6b5f  on_and_feedback_
-00008410: 6576 656e 7422 290a 406d 6f63 6b2e 7061  event").@mock.pa
-00008420: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
-00008430: 6572 2e63 6c69 656e 742e 4761 6e74 7279  er.client.Gantry
-00008440: 2e5f 6c6f 675f 7072 6564 6963 7469 6f6e  ._log_prediction
-00008450: 5f65 7665 6e74 2229 0a40 6d6f 636b 2e70  _event").@mock.p
-00008460: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
-00008470: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
-00008480: 792e 5f6c 6f67 5f66 6565 6462 6163 6b5f  y._log_feedback_
-00008490: 6576 656e 7422 2c20 7265 7475 726e 5f76  event", return_v
-000084a0: 616c 7565 3d22 666f 6f62 6172 3132 3334  alue="foobar1234
-000084b0: 3522 290a 6465 6620 7465 7374 5f6c 6f67  5").def test_log
-000084c0: 5f72 6563 6f72 645f 6665 6564 6261 636b  _record_feedback
-000084d0: 5f6f 6e6c 7928 0a20 2020 206d 6f63 6b5f  _only(.    mock_
-000084e0: 6665 6564 6261 636b 2c0a 2020 2020 6d6f  feedback,.    mo
-000084f0: 636b 5f70 7265 642c 0a20 2020 206d 6f63  ck_pred,.    moc
-00008500: 6b5f 7072 6564 5f61 6e64 5f66 6565 6462  k_pred_and_feedb
-00008510: 6163 6b2c 0a20 2020 206d 6f63 6b5f 6765  ack,.    mock_ge
-00008520: 745f 7265 636f 7264 2c0a 2020 2020 7465  t_record,.    te
-00008530: 7374 5f69 6e70 7574 2c0a 2020 2020 7465  st_input,.    te
-00008540: 7374 5f6f 7574 7075 742c 0a20 2020 206b  st_output,.    k
-00008550: 7761 7267 732c 0a20 2020 2065 7870 6563  wargs,.    expec
-00008560: 7465 645f 636f 6d70 6174 5f63 616c 6c2c  ted_compat_call,
-00008570: 0a20 2020 2063 6c69 5f6f 626a 2c0a 293a  .    cli_obj,.):
-00008580: 0a20 2020 2023 2048 6163 6b20 7468 6520  .    # Hack the 
-00008590: 7061 7261 6d65 7472 697a 6564 2076 616c  parametrized val
-000085a0: 7565 2077 6974 6820 7468 6520 6f74 6865  ue with the othe
-000085b0: 7220 7061 7261 6d65 7472 697a 6564 2066  r parametrized f
-000085c0: 6978 7475 7265 0a20 2020 2065 7870 6563  ixture.    expec
-000085d0: 7465 645f 636f 6d70 6174 5f63 616c 6c5b  ted_compat_call[
-000085e0: 305d 203d 2074 6573 745f 696e 7075 740a  0] = test_input.
-000085f0: 0a20 2020 2061 7373 6572 7420 280a 2020  .    assert (.  
-00008600: 2020 2020 2020 636c 695f 6f62 6a2e 6c6f        cli_obj.lo
-00008610: 675f 7265 636f 7264 280a 2020 2020 2020  g_record(.      
-00008620: 2020 2020 2020 6170 706c 6963 6174 696f        applicatio
-00008630: 6e3d 2266 6f6f 6261 7222 2c0a 2020 2020  n="foobar",.    
-00008640: 2020 2020 2020 2020 7665 7273 696f 6e3d          version=
-00008650: 2232 2e30 2e31 222c 0a20 2020 2020 2020  "2.0.1",.       
-00008660: 2020 2020 2069 6e70 7574 733d 7465 7374       inputs=test
-00008670: 5f69 6e70 7574 2c0a 2020 2020 2020 2020  _input,.        
-00008680: 2020 2020 6f75 7470 7574 733d 7465 7374      outputs=test
-00008690: 5f6f 7574 7075 742c 0a20 2020 2020 2020  _output,.       
-000086a0: 2020 2020 2066 6565 6462 6163 6b3d 7b22       feedback={"
-000086b0: 4122 3a20 3230 307d 2c0a 2020 2020 2020  A": 200},.      
-000086c0: 2020 2020 2020 7469 6d65 7374 616d 703d        timestamp=
-000086d0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-000086e0: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
-000086f0: 2020 2020 290a 2020 2020 2020 2020 3d3d      ).        ==
-00008700: 2022 666f 6f62 6172 3132 3334 3522 0a20   "foobar12345". 
-00008710: 2020 2029 0a0a 2020 2020 6d6f 636b 5f70     )..    mock_p
-00008720: 7265 645f 616e 645f 6665 6564 6261 636b  red_and_feedback
-00008730: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
-00008740: 6564 2829 0a20 2020 206d 6f63 6b5f 7072  ed().    mock_pr
-00008750: 6564 2e61 7373 6572 745f 6e6f 745f 6361  ed.assert_not_ca
-00008760: 6c6c 6564 2829 0a20 2020 206d 6f63 6b5f  lled().    mock_
-00008770: 6665 6564 6261 636b 2e61 7373 6572 745f  feedback.assert_
-00008780: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
-00008790: 280a 2020 2020 2020 2020 6170 706c 6963  (.        applic
-000087a0: 6174 696f 6e3d 2266 6f6f 6261 7222 2c0a  ation="foobar",.
-000087b0: 2020 2020 2020 2020 6a6f 696e 5f6b 6579          join_key
-000087c0: 3d22 3132 3334 3536 3738 3930 222c 0a20  ="1234567890",. 
-000087d0: 2020 2020 2020 2066 6565 6462 6163 6b3d         feedback=
-000087e0: 7b22 4122 3a20 3230 307d 2c0a 2020 2020  {"A": 200},.    
-000087f0: 2020 2020 6665 6564 6261 636b 5f76 6572      feedback_ver
-00008800: 7369 6f6e 3d22 322e 302e 3122 2c0a 2020  sion="2.0.1",.  
-00008810: 2020 2020 2020 7469 6d65 7374 616d 703d        timestamp=
-00008820: 4e6f 6e65 2c0a 2020 2020 2020 2020 7461  None,.        ta
-00008830: 6773 3d7b 2265 6e76 223a 2022 7465 7374  gs={"env": "test
-00008840: 227d 2c0a 2020 2020 290a 0a20 2020 206d  "},.    )..    m
-00008850: 6f63 6b5f 6765 745f 7265 636f 7264 2e61  ock_get_record.a
-00008860: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-00008870: 655f 7769 7468 282a 6578 7065 6374 6564  e_with(*expected
-00008880: 5f63 6f6d 7061 745f 6361 6c6c 290a 0a0a  _compat_call)...
-00008890: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
-000088a0: 616d 6574 7269 7a65 280a 2020 2020 5b22  ametrize(.    ["
-000088b0: 6b77 6172 6773 222c 2022 6578 7065 6374  kwargs", "expect
-000088c0: 6564 5f63 6f6d 7061 745f 6361 6c6c 225d  ed_compat_call"]
-000088d0: 2c0a 2020 2020 5b0a 2020 2020 2020 2020  ,.    [.        
-000088e0: 287b 2266 6565 6462 6163 6b5f 6b65 7973  ({"feedback_keys
-000088f0: 223a 205b 2241 225d 7d2c 205b 4e6f 6e65  ": ["A"]}, [None
-00008900: 2c20 4e6f 6e65 2c20 5b22 4122 5d2c 204e  , None, ["A"], N
-00008910: 6f6e 655d 292c 0a20 2020 2020 2020 2028  one]),.        (
-00008920: 7b22 6665 6564 6261 636b 5f69 6422 3a20  {"feedback_id": 
-00008930: 2231 3233 3435 227d 2c20 5b4e 6f6e 652c  "12345"}, [None,
-00008940: 2022 3132 3334 3522 2c20 4e6f 6e65 2c20   "12345", None, 
-00008950: 4e6f 6e65 5d29 2c0a 2020 2020 2020 2020  None]),.        
-00008960: 287b 226a 6f69 6e5f 6b65 7922 3a20 2235  ({"join_key": "5
-00008970: 3433 3231 227d 2c20 5b4e 6f6e 652c 204e  4321"}, [None, N
-00008980: 6f6e 652c 204e 6f6e 652c 2022 3534 3332  one, None, "5432
-00008990: 3122 5d29 2c0a 2020 2020 5d2c 0a29 0a40  1"]),.    ],.).@
-000089a0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
-000089b0: 6d65 7472 697a 6528 0a20 2020 2022 7465  metrize(.    "te
-000089c0: 7374 5f6f 7574 7075 7422 2c0a 2020 2020  st_output",.    
-000089d0: 5b4e 6f6e 652c 207b 7d5d 2c0a 290a 4070  [None, {}],.).@p
-000089e0: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
-000089f0: 6574 7269 7a65 280a 2020 2020 2274 6573  etrize(.    "tes
-00008a00: 745f 696e 7075 7422 2c0a 2020 2020 5b4e  t_input",.    [N
-00008a10: 6f6e 652c 207b 7d5d 2c0a 290a 406d 6f63  one, {}],.).@moc
-00008a20: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
-00008a30: 6c6f 6767 6572 2e63 6c69 656e 742e 5f72  logger.client._r
-00008a40: 6573 6f6c 7665 5f6a 6f69 6e5f 6b65 7922  esolve_join_key"
-00008a50: 2c20 7265 7475 726e 5f76 616c 7565 3d22  , return_value="
-00008a60: 3132 3334 3536 3738 3930 2229 0a40 6d6f  1234567890").@mo
-00008a70: 636b 2e70 6174 6368 2822 6761 6e74 7279  ck.patch("gantry
-00008a80: 2e6c 6f67 6765 722e 636c 6965 6e74 2e47  .logger.client.G
-00008a90: 616e 7472 792e 5f6c 6f67 5f70 7265 6469  antry._log_predi
-00008aa0: 6374 696f 6e5f 616e 645f 6665 6564 6261  ction_and_feedba
-00008ab0: 636b 5f65 7665 6e74 2229 0a40 6d6f 636b  ck_event").@mock
-00008ac0: 2e70 6174 6368 2822 6761 6e74 7279 2e6c  .patch("gantry.l
-00008ad0: 6f67 6765 722e 636c 6965 6e74 2e47 616e  ogger.client.Gan
-00008ae0: 7472 792e 5f6c 6f67 5f70 7265 6469 6374  try._log_predict
-00008af0: 696f 6e5f 6576 656e 7422 290a 406d 6f63  ion_event").@moc
-00008b00: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
-00008b10: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
-00008b20: 6e74 7279 2e5f 6c6f 675f 6665 6564 6261  ntry._log_feedba
-00008b30: 636b 5f65 7665 6e74 222c 2072 6574 7572  ck_event", retur
-00008b40: 6e5f 7661 6c75 653d 2266 6f6f 6261 7231  n_value="foobar1
-00008b50: 3233 3435 2229 0a64 6566 2074 6573 745f  2345").def test_
-00008b60: 7369 6e67 6c65 5f6c 6f67 5f72 6563 6f72  single_log_recor
-00008b70: 645f 6665 6564 6261 636b 5f6f 6e6c 7928  d_feedback_only(
-00008b80: 0a20 2020 206d 6f63 6b5f 6665 6564 6261  .    mock_feedba
-00008b90: 636b 2c0a 2020 2020 6d6f 636b 5f70 7265  ck,.    mock_pre
-00008ba0: 642c 0a20 2020 206d 6f63 6b5f 7072 6564  d,.    mock_pred
-00008bb0: 5f61 6e64 5f66 6565 6462 6163 6b2c 0a20  _and_feedback,. 
-00008bc0: 2020 206d 6f63 6b5f 6765 745f 7265 636f     mock_get_reco
-00008bd0: 7264 2c0a 2020 2020 7465 7374 5f69 6e70  rd,.    test_inp
-00008be0: 7574 2c0a 2020 2020 7465 7374 5f6f 7574  ut,.    test_out
-00008bf0: 7075 742c 0a20 2020 206b 7761 7267 732c  put,.    kwargs,
-00008c00: 0a20 2020 2065 7870 6563 7465 645f 636f  .    expected_co
-00008c10: 6d70 6174 5f63 616c 6c2c 0a20 2020 2063  mpat_call,.    c
-00008c20: 6c69 5f6f 626a 2c0a 293a 0a20 2020 2023  li_obj,.):.    #
-00008c30: 2048 6163 6b20 7468 6520 7061 7261 6d65   Hack the parame
-00008c40: 7472 697a 6564 2076 616c 7565 2077 6974  trized value wit
-00008c50: 6820 7468 6520 6f74 6865 7220 7061 7261  h the other para
-00008c60: 6d65 7472 697a 6564 2066 6978 7475 7265  metrized fixture
-00008c70: 0a20 2020 2065 7870 6563 7465 645f 636f  .    expected_co
-00008c80: 6d70 6174 5f63 616c 6c5b 305d 203d 2074  mpat_call[0] = t
-00008c90: 6573 745f 696e 7075 740a 0a20 2020 2061  est_input..    a
-00008ca0: 7373 6572 7420 280a 2020 2020 2020 2020  ssert (.        
-00008cb0: 636c 695f 6f62 6a2e 7369 6e67 6c65 5f6c  cli_obj.single_l
-00008cc0: 6f67 5f72 6563 6f72 6428 0a20 2020 2020  og_record(.     
-00008cd0: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
-00008ce0: 6f6e 3d22 666f 6f62 6172 222c 0a20 2020  on="foobar",.   
-00008cf0: 2020 2020 2020 2020 2076 6572 7369 6f6e           version
-00008d00: 3d22 322e 302e 3122 2c0a 2020 2020 2020  ="2.0.1",.      
-00008d10: 2020 2020 2020 696e 7075 7473 3d74 6573        inputs=tes
-00008d20: 745f 696e 7075 742c 0a20 2020 2020 2020  t_input,.       
-00008d30: 2020 2020 206f 7574 7075 7473 3d74 6573       outputs=tes
-00008d40: 745f 6f75 7470 7574 2c0a 2020 2020 2020  t_output,.      
-00008d50: 2020 2020 2020 6665 6564 6261 636b 3d7b        feedback={
-00008d60: 2241 223a 2032 3030 7d2c 0a20 2020 2020  "A": 200},.     
-00008d70: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
-00008d80: 3d4e 6f6e 652c 0a20 2020 2020 2020 2020  =None,.         
-00008d90: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
-00008da0: 2020 2020 2029 0a20 2020 2020 2020 203d       ).        =
-00008db0: 3d20 2266 6f6f 6261 7231 3233 3435 220a  = "foobar12345".
-00008dc0: 2020 2020 290a 0a20 2020 206d 6f63 6b5f      )..    mock_
-00008dd0: 7072 6564 5f61 6e64 5f66 6565 6462 6163  pred_and_feedbac
-00008de0: 6b2e 6173 7365 7274 5f6e 6f74 5f63 616c  k.assert_not_cal
-00008df0: 6c65 6428 290a 2020 2020 6d6f 636b 5f70  led().    mock_p
-00008e00: 7265 642e 6173 7365 7274 5f6e 6f74 5f63  red.assert_not_c
-00008e10: 616c 6c65 6428 290a 2020 2020 6d6f 636b  alled().    mock
-00008e20: 5f66 6565 6462 6163 6b2e 6173 7365 7274  _feedback.assert
-00008e30: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
-00008e40: 6828 0a20 2020 2020 2020 2061 7070 6c69  h(.        appli
-00008e50: 6361 7469 6f6e 3d22 666f 6f62 6172 222c  cation="foobar",
-00008e60: 0a20 2020 2020 2020 206a 6f69 6e5f 6b65  .        join_ke
-00008e70: 793d 2231 3233 3435 3637 3839 3022 2c0a  y="1234567890",.
-00008e80: 2020 2020 2020 2020 6665 6564 6261 636b          feedback
-00008e90: 3d7b 2241 223a 2032 3030 7d2c 0a20 2020  ={"A": 200},.   
-00008ea0: 2020 2020 2066 6565 6462 6163 6b5f 7665       feedback_ve
-00008eb0: 7273 696f 6e3d 2232 2e30 2e31 222c 0a20  rsion="2.0.1",. 
-00008ec0: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
-00008ed0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2074  =None,.        t
-00008ee0: 6167 733d 7b22 656e 7622 3a20 2274 6573  ags={"env": "tes
-00008ef0: 7422 7d2c 0a20 2020 2029 0a0a 2020 2020  t"},.    )..    
-00008f00: 6d6f 636b 5f67 6574 5f72 6563 6f72 642e  mock_get_record.
-00008f10: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-00008f20: 6365 5f77 6974 6828 2a65 7870 6563 7465  ce_with(*expecte
-00008f30: 645f 636f 6d70 6174 5f63 616c 6c29 0a0a  d_compat_call)..
-00008f40: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
-00008f50: 7261 6d65 7472 697a 6528 0a20 2020 2022  rametrize(.    "
-00008f60: 7465 7374 5f6f 7574 7075 7422 2c0a 2020  test_output",.  
-00008f70: 2020 5b4e 6f6e 652c 207b 7d5d 2c0a 290a    [None, {}],.).
-00008f80: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
-00008f90: 616d 6574 7269 7a65 280a 2020 2020 2274  ametrize(.    "t
-00008fa0: 6573 745f 696e 7075 7422 2c0a 2020 2020  est_input",.    
-00008fb0: 5b4e 6f6e 652c 207b 7d5d 2c0a 290a 406d  [None, {}],.).@m
-00008fc0: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
-00008fd0: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
-00008fe0: 4761 6e74 7279 2e5f 6c6f 675f 7072 6564  Gantry._log_pred
-00008ff0: 6963 7469 6f6e 5f61 6e64 5f66 6565 6462  iction_and_feedb
-00009000: 6163 6b5f 6576 656e 7422 290a 406d 6f63  ack_event").@moc
-00009010: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
-00009020: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
-00009030: 6e74 7279 2e5f 6c6f 675f 7072 6564 6963  ntry._log_predic
-00009040: 7469 6f6e 5f65 7665 6e74 2229 0a40 6d6f  tion_event").@mo
-00009050: 636b 2e70 6174 6368 2822 6761 6e74 7279  ck.patch("gantry
-00009060: 2e6c 6f67 6765 722e 636c 6965 6e74 2e47  .logger.client.G
-00009070: 616e 7472 792e 5f6c 6f67 5f66 6565 6462  antry._log_feedb
-00009080: 6163 6b5f 6576 656e 7422 290a 6465 6620  ack_event").def 
-00009090: 7465 7374 5f6c 6f67 5f72 6563 6f72 645f  test_log_record_
-000090a0: 6665 6564 6261 636b 5f6e 6f5f 6b65 795f  feedback_no_key_
-000090b0: 6572 726f 7228 0a20 2020 206d 6f63 6b5f  error(.    mock_
-000090c0: 6665 6564 6261 636b 2c20 6d6f 636b 5f70  feedback, mock_p
-000090d0: 7265 642c 206d 6f63 6b5f 7072 6564 5f61  red, mock_pred_a
-000090e0: 6e64 5f66 6565 6462 6163 6b2c 2074 6573  nd_feedback, tes
-000090f0: 745f 696e 7075 742c 2074 6573 745f 6f75  t_input, test_ou
-00009100: 7470 7574 2c20 636c 695f 6f62 6a0a 293a  tput, cli_obj.):
-00009110: 0a20 2020 2063 6c69 5f6f 626a 2e6c 6f67  .    cli_obj.log
-00009120: 5f72 6563 6f72 6428 0a20 2020 2020 2020  _record(.       
-00009130: 2061 7070 6c69 6361 7469 6f6e 3d22 666f   application="fo
-00009140: 6f62 6172 222c 0a20 2020 2020 2020 2076  obar",.        v
-00009150: 6572 7369 6f6e 3d22 322e 302e 3122 2c0a  ersion="2.0.1",.
-00009160: 2020 2020 2020 2020 696e 7075 7473 3d74          inputs=t
-00009170: 6573 745f 696e 7075 742c 0a20 2020 2020  est_input,.     
-00009180: 2020 206f 7574 7075 7473 3d74 6573 745f     outputs=test_
-00009190: 6f75 7470 7574 2c0a 2020 2020 2020 2020  output,.        
-000091a0: 6665 6564 6261 636b 3d7b 2241 223a 2032  feedback={"A": 2
-000091b0: 3030 7d2c 0a20 2020 2020 2020 2074 696d  00},.        tim
-000091c0: 6573 7461 6d70 3d4e 6f6e 652c 0a20 2020  estamp=None,.   
-000091d0: 2020 2020 2066 6565 6462 6163 6b5f 6b65       feedback_ke
-000091e0: 7973 3d4e 6f6e 652c 0a20 2020 2020 2020  ys=None,.       
-000091f0: 2066 6565 6462 6163 6b5f 6964 3d4e 6f6e   feedback_id=Non
-00009200: 652c 0a20 2020 2020 2020 206a 6f69 6e5f  e,.        join_
-00009210: 6b65 793d 4e6f 6e65 2c0a 2020 2020 290a  key=None,.    ).
-00009220: 0a20 2020 206d 6f63 6b5f 7072 6564 5f61  .    mock_pred_a
-00009230: 6e64 5f66 6565 6462 6163 6b2e 6173 7365  nd_feedback.asse
-00009240: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
-00009250: 2020 2020 6d6f 636b 5f70 7265 642e 6173      mock_pred.as
-00009260: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
-00009270: 290a 2020 2020 6d6f 636b 5f66 6565 6462  ).    mock_feedb
-00009280: 6163 6b2e 6173 7365 7274 5f6e 6f74 5f63  ack.assert_not_c
-00009290: 616c 6c65 6428 290a 0a0a 4070 7974 6573  alled()...@pytes
-000092a0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
-000092b0: 7a65 280a 2020 2020 226b 7761 7267 7322  ze(.    "kwargs"
-000092c0: 2c0a 2020 2020 5b0a 2020 2020 2020 2020  ,.    [.        
-000092d0: 7b22 6665 6564 6261 636b 5f6b 6579 7322  {"feedback_keys"
-000092e0: 3a20 5b22 4122 5d7d 2c0a 2020 2020 2020  : ["A"]},.      
-000092f0: 2020 7b22 6665 6564 6261 636b 5f69 6422    {"feedback_id"
-00009300: 3a20 2231 3233 3435 227d 2c0a 2020 2020  : "12345"},.    
-00009310: 2020 2020 7b22 6a6f 696e 5f6b 6579 223a      {"join_key":
-00009320: 2022 3534 3332 3122 7d2c 0a20 2020 205d   "54321"},.    ]
-00009330: 2c0a 290a 4070 7974 6573 742e 6d61 726b  ,.).@pytest.mark
-00009340: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
-00009350: 2020 2274 6573 745f 696e 7075 7422 2c0a    "test_input",.
-00009360: 2020 2020 5b4e 6f6e 652c 207b 7d5d 2c0a      [None, {}],.
-00009370: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
-00009380: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
-00009390: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
-000093a0: 7072 6564 6963 7469 6f6e 5f61 6e64 5f66  prediction_and_f
-000093b0: 6565 6462 6163 6b5f 6576 656e 7422 290a  eedback_event").
-000093c0: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
-000093d0: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
-000093e0: 742e 4761 6e74 7279 2e5f 6c6f 675f 7072  t.Gantry._log_pr
-000093f0: 6564 6963 7469 6f6e 5f65 7665 6e74 2229  ediction_event")
-00009400: 0a40 6d6f 636b 2e70 6174 6368 2822 6761  .@mock.patch("ga
-00009410: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
-00009420: 6e74 2e47 616e 7472 792e 5f6c 6f67 5f66  nt.Gantry._log_f
-00009430: 6565 6462 6163 6b5f 6576 656e 7422 290a  eedback_event").
-00009440: 6465 6620 7465 7374 5f6c 6f67 5f72 6563  def test_log_rec
-00009450: 6f72 645f 6e6f 5f64 6174 6128 0a20 2020  ord_no_data(.   
-00009460: 206d 6f63 6b5f 6665 6564 6261 636b 2c20   mock_feedback, 
-00009470: 6d6f 636b 5f70 7265 642c 206d 6f63 6b5f  mock_pred, mock_
-00009480: 7072 6564 5f61 6e64 5f66 6565 6462 6163  pred_and_feedbac
-00009490: 6b2c 2074 6573 745f 696e 7075 742c 206b  k, test_input, k
-000094a0: 7761 7267 732c 2063 6c69 5f6f 626a 0a29  wargs, cli_obj.)
-000094b0: 3a0a 2020 2020 636c 695f 6f62 6a2e 6c6f  :.    cli_obj.lo
-000094c0: 675f 7265 636f 7264 280a 2020 2020 2020  g_record(.      
-000094d0: 2020 6170 706c 6963 6174 696f 6e3d 2266    application="f
-000094e0: 6f6f 6261 7222 2c0a 2020 2020 2020 2020  oobar",.        
-000094f0: 7665 7273 696f 6e3d 2232 2e30 2e31 222c  version="2.0.1",
-00009500: 0a20 2020 2020 2020 2069 6e70 7574 733d  .        inputs=
-00009510: 7465 7374 5f69 6e70 7574 2c0a 2020 2020  test_input,.    
-00009520: 2020 2020 6f75 7470 7574 733d 7b22 4222      outputs={"B"
-00009530: 3a20 3130 307d 2c0a 2020 2020 2020 2020  : 100},.        
-00009540: 6665 6564 6261 636b 3d4e 6f6e 652c 0a20  feedback=None,. 
-00009550: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
-00009560: 3d4e 6f6e 652c 0a20 2020 2020 2020 202a  =None,.        *
-00009570: 2a6b 7761 7267 732c 0a20 2020 2029 0a0a  *kwargs,.    )..
-00009580: 2020 2020 6d6f 636b 5f70 7265 645f 616e      mock_pred_an
-00009590: 645f 6665 6564 6261 636b 2e61 7373 6572  d_feedback.asser
-000095a0: 745f 6e6f 745f 6361 6c6c 6564 2829 0a20  t_not_called(). 
-000095b0: 2020 206d 6f63 6b5f 7072 6564 2e61 7373     mock_pred.ass
-000095c0: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
-000095d0: 0a20 2020 206d 6f63 6b5f 6665 6564 6261  .    mock_feedba
-000095e0: 636b 2e61 7373 6572 745f 6e6f 745f 6361  ck.assert_not_ca
-000095f0: 6c6c 6564 2829 0a0a 0a40 7079 7465 7374  lled()...@pytest
-00009600: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
-00009610: 6528 0a20 2020 2022 6b77 6172 6773 222c  e(.    "kwargs",
-00009620: 0a20 2020 205b 0a20 2020 2020 2020 207b  .    [.        {
-00009630: 2266 6565 6462 6163 6b5f 6b65 7973 223a  "feedback_keys":
-00009640: 205b 2241 225d 7d2c 0a20 2020 2020 2020   ["A"]},.       
-00009650: 207b 2266 6565 6462 6163 6b5f 6964 223a   {"feedback_id":
-00009660: 2022 3132 3334 3522 7d2c 0a20 2020 2020   "12345"},.     
-00009670: 2020 207b 226a 6f69 6e5f 6b65 7922 3a20     {"join_key": 
-00009680: 2235 3433 3231 227d 2c0a 2020 2020 5d2c  "54321"},.    ],
-00009690: 0a29 0a40 7079 7465 7374 2e6d 6172 6b2e  .).@pytest.mark.
-000096a0: 7061 7261 6d65 7472 697a 6528 2266 6565  parametrize("fee
-000096b0: 6462 6163 6b22 2c20 5b4e 6f6e 652c 207b  dback", [None, {
-000096c0: 7d2c 207b 2242 223a 2032 3030 7d5d 290a  }, {"B": 200}]).
-000096d0: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
-000096e0: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
-000096f0: 742e 4761 6e74 7279 2e5f 6c6f 675f 7072  t.Gantry._log_pr
-00009700: 6564 6963 7469 6f6e 5f61 6e64 5f66 6565  ediction_and_fee
-00009710: 6462 6163 6b5f 6576 656e 7422 290a 406d  dback_event").@m
-00009720: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
-00009730: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
-00009740: 4761 6e74 7279 2e5f 6c6f 675f 7072 6564  Gantry._log_pred
-00009750: 6963 7469 6f6e 5f65 7665 6e74 2229 0a40  iction_event").@
-00009760: 6d6f 636b 2e70 6174 6368 2822 6761 6e74  mock.patch("gant
-00009770: 7279 2e6c 6f67 6765 722e 636c 6965 6e74  ry.logger.client
-00009780: 2e47 616e 7472 792e 5f6c 6f67 5f66 6565  .Gantry._log_fee
-00009790: 6462 6163 6b5f 6576 656e 7422 290a 6465  dback_event").de
-000097a0: 6620 7465 7374 5f6c 6f67 5f72 6563 6f72  f test_log_recor
-000097b0: 645f 696e 636f 6d70 6c65 7465 5f70 7265  d_incomplete_pre
-000097c0: 6473 280a 2020 2020 6d6f 636b 5f66 6565  ds(.    mock_fee
-000097d0: 6462 6163 6b2c 206d 6f63 6b5f 7072 6564  dback, mock_pred
-000097e0: 2c20 6d6f 636b 5f70 7265 645f 616e 645f  , mock_pred_and_
-000097f0: 6665 6564 6261 636b 2c20 6665 6564 6261  feedback, feedba
-00009800: 636b 2c20 6b77 6172 6773 2c20 636c 695f  ck, kwargs, cli_
-00009810: 6f62 6a0a 293a 0a20 2020 2063 6c69 5f6f  obj.):.    cli_o
-00009820: 626a 2e6c 6f67 5f72 6563 6f72 6428 0a20  bj.log_record(. 
-00009830: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
-00009840: 6f6e 3d22 666f 6f62 6172 222c 0a20 2020  on="foobar",.   
-00009850: 2020 2020 2076 6572 7369 6f6e 3d22 322e       version="2.
-00009860: 302e 3122 2c0a 2020 2020 2020 2020 696e  0.1",.        in
-00009870: 7075 7473 3d7b 7d2c 0a20 2020 2020 2020  puts={},.       
-00009880: 206f 7574 7075 7473 3d7b 2242 223a 2031   outputs={"B": 1
-00009890: 3030 7d2c 0a20 2020 2020 2020 2066 6565  00},.        fee
-000098a0: 6462 6163 6b3d 6665 6564 6261 636b 2c0a  dback=feedback,.
-000098b0: 2020 2020 2020 2020 7469 6d65 7374 616d          timestam
-000098c0: 703d 4e6f 6e65 2c0a 2020 2020 2020 2020  p=None,.        
-000098d0: 2a2a 6b77 6172 6773 2c0a 2020 2020 290a  **kwargs,.    ).
-000098e0: 0a20 2020 206d 6f63 6b5f 7072 6564 5f61  .    mock_pred_a
-000098f0: 6e64 5f66 6565 6462 6163 6b2e 6173 7365  nd_feedback.asse
-00009900: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
-00009910: 2020 2020 6d6f 636b 5f70 7265 642e 6173      mock_pred.as
-00009920: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
-00009930: 290a 2020 2020 6d6f 636b 5f66 6565 6462  ).    mock_feedb
-00009940: 6163 6b2e 6173 7365 7274 5f6e 6f74 5f63  ack.assert_not_c
-00009950: 616c 6c65 6428 290a 0a0a 2320 544f 444f  alled()...# TODO
-00009960: 202d 3e20 6164 6420 6e70 2e6e 6461 7272   -> add np.ndarr
-00009970: 6179 7320 6173 2070 6f73 7369 626c 6520  ays as possible 
-00009980: 6665 6564 6261 636b 7320 7661 6c75 6573  feedbacks values
-00009990: 0a40 6672 6565 7a65 5f74 696d 6528 4355  .@freeze_time(CU
-000099a0: 5252 454e 545f 5449 4d45 290a 4070 7974  RRENT_TIME).@pyt
-000099b0: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-000099c0: 7269 7a65 280a 2020 2020 2274 6167 7322  rize(.    "tags"
-000099d0: 2c20 5b5b 7b22 656e 7622 3a20 226f 7665  , [[{"env": "ove
-000099e0: 7277 7269 7465 5f65 6e76 227d 2c20 7b22  rwrite_env"}, {"
-000099f0: 656e 7622 3a20 226f 7665 7277 7269 7465  env": "overwrite
-00009a00: 5f65 6e76 5f32 227d 5d2c 205b 7b7d 5d20  _env_2"}], [{}] 
-00009a10: 2a20 322c 204e 6f6e 655d 0a29 0a40 7079  * 2, None].).@py
-00009a20: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
-00009a30: 7472 697a 6528 2273 6f72 7422 2c20 5b46  trize("sort", [F
-00009a40: 616c 7365 2c20 5472 7565 5d29 0a40 7079  alse, True]).@py
-00009a50: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
-00009a60: 7472 697a 6528 0a20 2020 2022 7469 6d65  trize(.    "time
-00009a70: 7374 616d 7073 222c 205b 7064 2e44 6174  stamps", [pd.Dat
-00009a80: 6574 696d 6549 6e64 6578 285b 414e 4f54  etimeIndex([ANOT
-00009a90: 4845 525f 5449 4d45 2c20 534f 4d45 5f54  HER_TIME, SOME_T
-00009aa0: 494d 455d 292c 205b 414e 4f54 4845 525f  IME]), [ANOTHER_
-00009ab0: 5449 4d45 2c20 534f 4d45 5f54 494d 455d  TIME, SOME_TIME]
-00009ac0: 2c20 4e6f 6e65 5d0a 290a 4070 7974 6573  , None].).@pytes
-00009ad0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
-00009ae0: 7a65 280a 2020 2020 2266 6565 6462 6163  ze(.    "feedbac
-00009af0: 6b73 222c 0a20 2020 205b 0a20 2020 2020  ks",.    [.     
-00009b00: 2020 205b 7b31 3030 3a20 2273 6f6d 652d     [{100: "some-
-00009b10: 7661 6c75 6522 7d2c 207b 3130 303a 2022  value"}, {100: "
-00009b20: 736f 6d65 2d6f 7468 6572 2d76 616c 7565  some-other-value
-00009b30: 227d 5d2c 0a20 2020 205d 2c0a 290a 406d  "}],.    ],.).@m
-00009b40: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
-00009b50: 792e 6c6f 6767 6572 2e65 7665 6e74 5f62  y.logger.event_b
-00009b60: 7569 6c64 6572 2e75 7569 642e 7575 6964  uilder.uuid.uuid
-00009b70: 3422 290a 6465 6620 7465 7374 5f6c 6f67  4").def test_log
-00009b80: 5f66 6565 6462 6163 6b5f 6576 656e 7473  _feedback_events
-00009b90: 286d 6f63 6b5f 7575 6964 2c20 6665 6564  (mock_uuid, feed
-00009ba0: 6261 636b 732c 2074 696d 6573 7461 6d70  backs, timestamp
-00009bb0: 732c 2073 6f72 742c 2074 6167 732c 2063  s, sort, tags, c
-00009bc0: 6c69 5f6f 626a 293a 0a20 2020 206d 6f63  li_obj):.    moc
-00009bd0: 6b5f 7575 6964 2e72 6574 7572 6e5f 7661  k_uuid.return_va
-00009be0: 6c75 6520 3d20 2241 4243 4431 3233 3422  lue = "ABCD1234"
-00009bf0: 0a0a 2020 2020 6173 7365 7274 2063 6c69  ..    assert cli
-00009c00: 5f6f 626a 2e5f 6c6f 675f 6665 6564 6261  _obj._log_feedba
-00009c10: 636b 5f65 7665 6e74 7328 0a20 2020 2020  ck_events(.     
-00009c20: 2020 2061 7070 6c69 6361 7469 6f6e 3d22     application="
-00009c30: 666f 6f62 6172 222c 0a20 2020 2020 2020  foobar",.       
-00009c40: 2066 6565 6462 6163 6b73 3d66 6565 6462   feedbacks=feedb
-00009c50: 6163 6b73 2c0a 2020 2020 2020 2020 6a6f  acks,.        jo
-00009c60: 696e 5f6b 6579 733d 5b22 3132 3334 3522  in_keys=["12345"
-00009c70: 2c20 2236 3738 3930 225d 2c0a 2020 2020  , "67890"],.    
-00009c80: 2020 2020 6665 6564 6261 636b 5f76 6572      feedback_ver
-00009c90: 7369 6f6e 3d31 302c 0a20 2020 2020 2020  sion=10,.       
-00009ca0: 2074 696d 6573 7461 6d70 733d 7469 6d65   timestamps=time
-00009cb0: 7374 616d 7073 2c0a 2020 2020 2020 2020  stamps,.        
-00009cc0: 736f 7274 5f6f 6e5f 7469 6d65 7374 616d  sort_on_timestam
-00009cd0: 703d 736f 7274 2c0a 2020 2020 2020 2020  p=sort,.        
-00009ce0: 6173 5f62 6174 6368 3d46 616c 7365 2c0a  as_batch=False,.
-00009cf0: 2020 2020 2020 2020 7461 6773 3d74 6167          tags=tag
-00009d00: 732c 0a20 2020 2029 203d 3d20 284e 6f6e  s,.    ) == (Non
-00009d10: 652c 205b 2231 3233 3435 222c 2022 3637  e, ["12345", "67
-00009d20: 3839 3022 5d29 0a20 2020 2065 7665 6e74  890"]).    event
-00009d30: 7320 3d20 5b0a 2020 2020 2020 2020 7b0a  s = [.        {.
-00009d40: 2020 2020 2020 2020 2020 2020 2262 6174              "bat
-00009d50: 6368 5f69 6422 3a20 4e6f 6e65 2c0a 2020  ch_id": None,.  
-00009d60: 2020 2020 2020 2020 2020 2265 7665 6e74            "event
-00009d70: 5f69 6422 3a20 2241 4243 4431 3233 3422  _id": "ABCD1234"
-00009d80: 2c0a 2020 2020 2020 2020 2020 2020 2266  ,.            "f
-00009d90: 6565 6462 6163 6b22 3a20 7b31 3030 3a20  eedback": {100: 
-00009da0: 2273 6f6d 652d 6f74 6865 722d 7661 6c75  "some-other-valu
-00009db0: 6522 7d2c 0a20 2020 2020 2020 2020 2020  e"},.           
-00009dc0: 2022 6665 6564 6261 636b 5f69 6422 3a20   "feedback_id": 
-00009dd0: 2236 3738 3930 222c 0a20 2020 2020 2020  "67890",.       
-00009de0: 2020 2020 2022 6c6f 675f 7469 6d65 7374       "log_timest
-00009df0: 616d 7022 3a20 4355 5252 454e 545f 5449  amp": CURRENT_TI
-00009e00: 4d45 5f53 5452 2c0a 2020 2020 2020 2020  ME_STR,.        
-00009e10: 2020 2020 226d 6574 6164 6174 6122 3a20      "metadata": 
-00009e20: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00009e30: 2020 2266 6565 6462 6163 6b5f 7665 7273    "feedback_vers
-00009e40: 696f 6e22 3a20 3130 2c0a 2020 2020 2020  ion": 10,.      
-00009e50: 2020 2020 2020 2020 2020 2266 756e 635f            "func_
-00009e60: 6e61 6d65 223a 2022 666f 6f62 6172 222c  name": "foobar",
-00009e70: 0a20 2020 2020 2020 2020 2020 207d 2c0a  .            },.
-00009e80: 2020 2020 2020 2020 2020 2020 2274 696d              "tim
-00009e90: 6573 7461 6d70 223a 2053 4f4d 455f 5449  estamp": SOME_TI
-00009ea0: 4d45 5f53 5452 2069 6620 7469 6d65 7374  ME_STR if timest
-00009eb0: 616d 7073 2069 7320 6e6f 7420 4e6f 6e65  amps is not None
-00009ec0: 2065 6c73 6520 4355 5252 454e 545f 5449   else CURRENT_TI
-00009ed0: 4d45 5f53 5452 2c0a 2020 2020 2020 2020  ME_STR,.        
-00009ee0: 7d2c 0a20 2020 2020 2020 207b 0a20 2020  },.        {.   
-00009ef0: 2020 2020 2020 2020 2022 6261 7463 685f           "batch_
-00009f00: 6964 223a 204e 6f6e 652c 0a20 2020 2020  id": None,.     
-00009f10: 2020 2020 2020 2022 6576 656e 745f 6964         "event_id
-00009f20: 223a 2022 4142 4344 3132 3334 222c 0a20  ": "ABCD1234",. 
-00009f30: 2020 2020 2020 2020 2020 2022 6665 6564             "feed
-00009f40: 6261 636b 223a 207b 3130 303a 2022 736f  back": {100: "so
-00009f50: 6d65 2d76 616c 7565 227d 2c0a 2020 2020  me-value"},.    
-00009f60: 2020 2020 2020 2020 2266 6565 6462 6163          "feedbac
-00009f70: 6b5f 6964 223a 2022 3132 3334 3522 2c0a  k_id": "12345",.
-00009f80: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
-00009f90: 5f74 696d 6573 7461 6d70 223a 2043 5552  _timestamp": CUR
-00009fa0: 5245 4e54 5f54 494d 455f 5354 522c 0a20  RENT_TIME_STR,. 
-00009fb0: 2020 2020 2020 2020 2020 2022 6d65 7461             "meta
-00009fc0: 6461 7461 223a 207b 0a20 2020 2020 2020  data": {.       
-00009fd0: 2020 2020 2020 2020 2022 6665 6564 6261           "feedba
-00009fe0: 636b 5f76 6572 7369 6f6e 223a 2031 302c  ck_version": 10,
-00009ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a000: 2022 6675 6e63 5f6e 616d 6522 3a20 2266   "func_name": "f
-0000a010: 6f6f 6261 7222 2c0a 2020 2020 2020 2020  oobar",.        
-0000a020: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-0000a030: 2020 2022 7469 6d65 7374 616d 7022 3a20     "timestamp": 
-0000a040: 414e 4f54 4845 525f 5449 4d45 5f53 5452  ANOTHER_TIME_STR
-0000a050: 2069 6620 7469 6d65 7374 616d 7073 2069   if timestamps i
-0000a060: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
-0000a070: 4355 5252 454e 545f 5449 4d45 5f53 5452  CURRENT_TIME_STR
-0000a080: 2c0a 2020 2020 2020 2020 7d2c 0a20 2020  ,.        },.   
-0000a090: 205d 0a0a 2020 2020 6966 2074 696d 6573   ]..    if times
-0000a0a0: 7461 6d70 7320 6973 206e 6f74 204e 6f6e  tamps is not Non
-0000a0b0: 653a 0a20 2020 2020 2020 2065 7870 6563  e:.        expec
-0000a0c0: 7465 645f 6576 656e 7473 203d 205b 6576  ted_events = [ev
-0000a0d0: 656e 7473 5b31 5d2c 2065 7665 6e74 735b  ents[1], events[
-0000a0e0: 305d 5d20 6966 206e 6f74 2073 6f72 7420  0]] if not sort 
-0000a0f0: 656c 7365 205b 6576 656e 7473 5b30 5d2c  else [events[0],
-0000a100: 2065 7665 6e74 735b 315d 5d0a 2020 2020   events[1]].    
-0000a110: 656c 7365 3a0a 2020 2020 2020 2020 6578  else:.        ex
-0000a120: 7065 6374 6564 5f65 7665 6e74 7320 3d20  pected_events = 
-0000a130: 5b65 7665 6e74 735b 315d 2c20 6576 656e  [events[1], even
-0000a140: 7473 5b30 5d5d 0a0a 2020 2020 6173 7365  ts[0]]..    asse
-0000a150: 7274 2063 6c69 5f6f 626a 2e6c 6f67 5f73  rt cli_obj.log_s
-0000a160: 746f 7265 2e6c 6f67 7320 3d3d 205b 0a20  tore.logs == [. 
-0000a170: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-0000a180: 2020 2020 2022 6576 656e 7473 223a 2065       "events": e
-0000a190: 7870 6563 7465 645f 6576 656e 7473 2c0a  xpected_events,.
-0000a1a0: 2020 2020 2020 2020 2020 2020 2261 7070              "app
-0000a1b0: 6c69 6361 7469 6f6e 223a 2022 666f 6f62  lication": "foob
-0000a1c0: 6172 222c 0a20 2020 2020 2020 207d 0a20  ar",.        }. 
-0000a1d0: 2020 205d 0a0a 0a23 2054 4f44 4f20 2d3e     ]...# TODO ->
-0000a1e0: 2061 6464 206e 702e 6e64 6172 7261 7973   add np.ndarrays
-0000a1f0: 2061 7320 706f 7373 6962 6c65 2069 6e70   as possible inp
-0000a200: 7574 732f 6f75 7470 7574 7320 7661 6c75  uts/outputs valu
-0000a210: 6573 0a40 6672 6565 7a65 5f74 696d 6528  es.@freeze_time(
-0000a220: 4355 5252 454e 545f 5449 4d45 290a 4070  CURRENT_TIME).@p
-0000a230: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
-0000a240: 6574 7269 7a65 280a 2020 2020 2274 6167  etrize(.    "tag
-0000a250: 7322 2c20 5b5b 7b22 656e 7622 3a20 226f  s", [[{"env": "o
-0000a260: 7665 7277 7269 7465 5f65 6e76 227d 2c20  verwrite_env"}, 
-0000a270: 7b22 656e 7622 3a20 226f 7665 7277 7269  {"env": "overwri
-0000a280: 7465 5f65 6e76 5f32 227d 5d2c 205b 7b7d  te_env_2"}], [{}
-0000a290: 5d20 2a20 322c 204e 6f6e 655d 0a29 0a40  ] * 2, None].).@
-0000a2a0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
-0000a2b0: 6d65 7472 697a 6528 2273 6f72 7422 2c20  metrize("sort", 
-0000a2c0: 5b46 616c 7365 2c20 5472 7565 5d29 0a40  [False, True]).@
-0000a2d0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
-0000a2e0: 6d65 7472 697a 6528 0a20 2020 2022 7469  metrize(.    "ti
-0000a2f0: 6d65 7374 616d 7073 222c 205b 7064 2e44  mestamps", [pd.D
-0000a300: 6174 6574 696d 6549 6e64 6578 285b 414e  atetimeIndex([AN
-0000a310: 4f54 4845 525f 5449 4d45 2c20 534f 4d45  OTHER_TIME, SOME
-0000a320: 5f54 494d 455d 292c 205b 414e 4f54 4845  _TIME]), [ANOTHE
-0000a330: 525f 5449 4d45 2c20 534f 4d45 5f54 494d  R_TIME, SOME_TIM
-0000a340: 455d 2c20 4e6f 6e65 5d0a 290a 4070 7974  E], None].).@pyt
-0000a350: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-0000a360: 7269 7a65 280a 2020 2020 226f 7574 7075  rize(.    "outpu
-0000a370: 7473 222c 0a20 2020 205b 0a20 2020 2020  ts",.    [.     
-0000a380: 2020 205b 7b22 4322 3a20 3330 307d 2c20     [{"C": 300}, 
-0000a390: 7b22 4322 3a20 3330 337d 5d2c 0a20 2020  {"C": 303}],.   
-0000a3a0: 205d 2c0a 290a 4070 7974 6573 742e 6d61   ],.).@pytest.ma
-0000a3b0: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
-0000a3c0: 2020 2020 2269 6e70 7574 7322 2c0a 2020      "inputs",.  
-0000a3d0: 2020 5b0a 2020 2020 2020 2020 5b7b 2241    [.        [{"A
-0000a3e0: 223a 2031 3030 2c20 2242 223a 2032 3030  ": 100, "B": 200
-0000a3f0: 7d2c 207b 2241 223a 2031 3031 2c20 2242  }, {"A": 101, "B
-0000a400: 223a 2032 3032 7d5d 2c0a 2020 2020 5d2c  ": 202}],.    ],
-0000a410: 0a29 0a40 6d6f 636b 2e70 6174 6368 2822  .).@mock.patch("
-0000a420: 6761 6e74 7279 2e6c 6f67 6765 722e 6576  gantry.logger.ev
-0000a430: 656e 745f 6275 696c 6465 722e 7575 6964  ent_builder.uuid
-0000a440: 2e75 7569 6434 2229 0a64 6566 2074 6573  .uuid4").def tes
-0000a450: 745f 6c6f 675f 7072 6564 6963 7469 6f6e  t_log_prediction
-0000a460: 5f65 7665 6e74 7328 6d6f 636b 5f75 7569  _events(mock_uui
-0000a470: 642c 2069 6e70 7574 732c 206f 7574 7075  d, inputs, outpu
-0000a480: 7473 2c20 7469 6d65 7374 616d 7073 2c20  ts, timestamps, 
-0000a490: 736f 7274 2c20 7461 6773 2c20 636c 695f  sort, tags, cli_
-0000a4a0: 6f62 6a29 3a0a 2020 2020 6d6f 636b 5f75  obj):.    mock_u
-0000a4b0: 7569 642e 7265 7475 726e 5f76 616c 7565  uid.return_value
-0000a4c0: 203d 2022 4142 4344 3132 3334 220a 2020   = "ABCD1234".  
-0000a4d0: 2020 6173 7365 7274 2063 6c69 5f6f 626a    assert cli_obj
-0000a4e0: 2e5f 6c6f 675f 7072 6564 6963 7469 6f6e  ._log_prediction
-0000a4f0: 5f65 7665 6e74 7328 0a20 2020 2020 2020  _events(.       
-0000a500: 2061 7070 6c69 6361 7469 6f6e 3d22 666f   application="fo
-0000a510: 6f62 6172 222c 0a20 2020 2020 2020 2069  obar",.        i
-0000a520: 6e70 7574 733d 696e 7075 7473 2c0a 2020  nputs=inputs,.  
-0000a530: 2020 2020 2020 6f75 7470 7574 733d 6f75        outputs=ou
-0000a540: 7470 7574 732c 0a20 2020 2020 2020 206a  tputs,.        j
-0000a550: 6f69 6e5f 6b65 7973 3d5b 2231 3233 3435  oin_keys=["12345
-0000a560: 222c 2022 3637 3839 3022 5d2c 0a20 2020  ", "67890"],.   
-0000a570: 2020 2020 2069 676e 6f72 655f 696e 7075       ignore_inpu
-0000a580: 7473 3d5b 2242 225d 2c0a 2020 2020 2020  ts=["B"],.      
-0000a590: 2020 7665 7273 696f 6e3d 3130 2c0a 2020    version=10,.  
-0000a5a0: 2020 2020 2020 7469 6d65 7374 616d 7073        timestamps
-0000a5b0: 3d74 696d 6573 7461 6d70 732c 0a20 2020  =timestamps,.   
-0000a5c0: 2020 2020 2073 6f72 745f 6f6e 5f74 696d       sort_on_tim
-0000a5d0: 6573 7461 6d70 3d73 6f72 742c 0a20 2020  estamp=sort,.   
-0000a5e0: 2020 2020 2061 735f 6261 7463 683d 4661       as_batch=Fa
-0000a5f0: 6c73 652c 0a20 2020 2020 2020 2074 6167  lse,.        tag
-0000a600: 733d 7461 6773 2c0a 2020 2020 2920 3d3d  s=tags,.    ) ==
-0000a610: 2028 4e6f 6e65 2c20 5b22 3132 3334 3522   (None, ["12345"
-0000a620: 2c20 2236 3738 3930 225d 290a 0a20 2020  , "67890"])..   
-0000a630: 2065 7665 6e74 7320 3d20 5b0a 2020 2020   events = [.    
-0000a640: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
-0000a650: 2020 2262 6174 6368 5f69 6422 3a20 4e6f    "batch_id": No
-0000a660: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0000a670: 2265 7665 6e74 5f69 6422 3a20 2241 4243  "event_id": "ABC
-0000a680: 4431 3233 3422 2c0a 2020 2020 2020 2020  D1234",.        
-0000a690: 2020 2020 2266 6565 6462 6163 6b5f 6964      "feedback_id
-0000a6a0: 223a 2022 3637 3839 3022 2c0a 2020 2020  ": "67890",.    
-0000a6b0: 2020 2020 2020 2020 2269 6e70 7574 7322          "inputs"
-0000a6c0: 3a20 7b22 4122 3a20 3130 317d 2c0a 2020  : {"A": 101},.  
-0000a6d0: 2020 2020 2020 2020 2020 226c 6f67 5f74            "log_t
-0000a6e0: 696d 6573 7461 6d70 223a 2043 5552 5245  imestamp": CURRE
-0000a6f0: 4e54 5f54 494d 455f 5354 522c 0a20 2020  NT_TIME_STR,.   
-0000a700: 2020 2020 2020 2020 2022 6d65 7461 6461           "metada
-0000a710: 7461 223a 207b 0a20 2020 2020 2020 2020  ta": {.         
-0000a720: 2020 2020 2020 2022 6665 6564 6261 636b         "feedback
-0000a730: 5f6b 6579 7322 3a20 4e6f 6e65 2c0a 2020  _keys": None,.  
-0000a740: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-0000a750: 756e 635f 6e61 6d65 223a 2022 666f 6f62  unc_name": "foob
-0000a760: 6172 222c 0a20 2020 2020 2020 2020 2020  ar",.           
-0000a770: 2020 2020 2022 6967 6e6f 7265 5f69 6e70       "ignore_inp
-0000a780: 7574 7322 3a20 5b22 4222 5d2c 0a20 2020  uts": ["B"],.   
-0000a790: 2020 2020 2020 2020 2020 2020 2022 7665               "ve
-0000a7a0: 7273 696f 6e22 3a20 3130 2c0a 2020 2020  rsion": 10,.    
-0000a7b0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-0000a7c0: 2020 2020 2020 2022 6f75 7470 7574 7322         "outputs"
-0000a7d0: 3a20 7b22 4322 3a20 3330 337d 2c0a 2020  : {"C": 303},.  
-0000a7e0: 2020 2020 2020 2020 2020 2274 6167 7322            "tags"
-0000a7f0: 3a20 7461 6773 5b31 5d20 6966 2074 6167  : tags[1] if tag
-0000a800: 7320 656c 7365 204e 6f6e 652c 0a20 2020  s else None,.   
-0000a810: 2020 2020 2020 2020 2022 7469 6d65 7374           "timest
-0000a820: 616d 7022 3a20 534f 4d45 5f54 494d 455f  amp": SOME_TIME_
-0000a830: 5354 5220 6966 2074 696d 6573 7461 6d70  STR if timestamp
-0000a840: 7320 6973 206e 6f74 204e 6f6e 6520 656c  s is not None el
-0000a850: 7365 2043 5552 5245 4e54 5f54 494d 455f  se CURRENT_TIME_
-0000a860: 5354 522c 0a20 2020 2020 2020 207d 2c0a  STR,.        },.
-0000a870: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-0000a880: 2020 2020 2020 2262 6174 6368 5f69 6422        "batch_id"
-0000a890: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-0000a8a0: 2020 2020 2265 7665 6e74 5f69 6422 3a20      "event_id": 
-0000a8b0: 2241 4243 4431 3233 3422 2c0a 2020 2020  "ABCD1234",.    
-0000a8c0: 2020 2020 2020 2020 2266 6565 6462 6163          "feedbac
-0000a8d0: 6b5f 6964 223a 2022 3132 3334 3522 2c0a  k_id": "12345",.
-0000a8e0: 2020 2020 2020 2020 2020 2020 2269 6e70              "inp
-0000a8f0: 7574 7322 3a20 7b22 4122 3a20 3130 307d  uts": {"A": 100}
-0000a900: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
-0000a910: 6f67 5f74 696d 6573 7461 6d70 223a 2043  og_timestamp": C
-0000a920: 5552 5245 4e54 5f54 494d 455f 5354 522c  URRENT_TIME_STR,
-0000a930: 0a20 2020 2020 2020 2020 2020 2022 6d65  .            "me
-0000a940: 7461 6461 7461 223a 207b 0a20 2020 2020  tadata": {.     
-0000a950: 2020 2020 2020 2020 2020 2022 6665 6564             "feed
-0000a960: 6261 636b 5f6b 6579 7322 3a20 4e6f 6e65  back_keys": None
-0000a970: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000a980: 2020 2266 756e 635f 6e61 6d65 223a 2022    "func_name": "
-0000a990: 666f 6f62 6172 222c 0a20 2020 2020 2020  foobar",.       
-0000a9a0: 2020 2020 2020 2020 2022 6967 6e6f 7265           "ignore
-0000a9b0: 5f69 6e70 7574 7322 3a20 5b22 4222 5d2c  _inputs": ["B"],
-0000a9c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a9d0: 2022 7665 7273 696f 6e22 3a20 3130 2c0a   "version": 10,.
-0000a9e0: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-0000a9f0: 2020 2020 2020 2020 2020 2022 6f75 7470             "outp
-0000aa00: 7574 7322 3a20 7b22 4322 3a20 3330 307d  uts": {"C": 300}
-0000aa10: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-0000aa20: 6167 7322 3a20 7461 6773 5b30 5d20 6966  ags": tags[0] if
-0000aa30: 2074 6167 7320 656c 7365 204e 6f6e 652c   tags else None,
-0000aa40: 0a20 2020 2020 2020 2020 2020 2022 7469  .            "ti
-0000aa50: 6d65 7374 616d 7022 3a20 414e 4f54 4845  mestamp": ANOTHE
-0000aa60: 525f 5449 4d45 5f53 5452 2069 6620 7469  R_TIME_STR if ti
-0000aa70: 6d65 7374 616d 7073 2069 7320 6e6f 7420  mestamps is not 
-0000aa80: 4e6f 6e65 2065 6c73 6520 4355 5252 454e  None else CURREN
-0000aa90: 545f 5449 4d45 5f53 5452 2c0a 2020 2020  T_TIME_STR,.    
-0000aaa0: 2020 2020 7d2c 0a20 2020 205d 0a0a 2020      },.    ]..  
-0000aab0: 2020 6966 2074 696d 6573 7461 6d70 7320    if timestamps 
-0000aac0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0000aad0: 2020 2020 2065 7870 6563 7465 645f 6576       expected_ev
-0000aae0: 656e 7473 203d 205b 6576 656e 7473 5b31  ents = [events[1
-0000aaf0: 5d2c 2065 7665 6e74 735b 305d 5d20 6966  ], events[0]] if
-0000ab00: 206e 6f74 2073 6f72 7420 656c 7365 205b   not sort else [
-0000ab10: 6576 656e 7473 5b30 5d2c 2065 7665 6e74  events[0], event
-0000ab20: 735b 315d 5d0a 2020 2020 656c 7365 3a0a  s[1]].    else:.
-0000ab30: 2020 2020 2020 2020 6578 7065 6374 6564          expected
-0000ab40: 5f65 7665 6e74 7320 3d20 5b65 7665 6e74  _events = [event
-0000ab50: 735b 315d 2c20 6576 656e 7473 5b30 5d5d  s[1], events[0]]
-0000ab60: 0a0a 2020 2020 6173 7365 7274 2063 6c69  ..    assert cli
-0000ab70: 5f6f 626a 2e6c 6f67 5f73 746f 7265 2e6c  _obj.log_store.l
-0000ab80: 6f67 7320 3d3d 205b 0a20 2020 2020 2020  ogs == [.       
-0000ab90: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-0000aba0: 6576 656e 7473 223a 2065 7870 6563 7465  events": expecte
-0000abb0: 645f 6576 656e 7473 2c0a 2020 2020 2020  d_events,.      
-0000abc0: 2020 2020 2020 2261 7070 6c69 6361 7469        "applicati
-0000abd0: 6f6e 223a 2022 666f 6f62 6172 222c 0a20  on": "foobar",. 
-0000abe0: 2020 2020 2020 207d 0a20 2020 205d 0a0a         }.    ]..
-0000abf0: 0a23 2054 4f44 4f20 2d3e 2072 6561 6464  .# TODO -> readd
-0000ac00: 2074 6865 2061 735f 6261 7463 683d 5472   the as_batch=Tr
-0000ac10: 7565 2074 6573 7473 0a0a 0a40 6672 6565  ue tests...@free
-0000ac20: 7a65 5f74 696d 6528 4355 5252 454e 545f  ze_time(CURRENT_
-0000ac30: 5449 4d45 290a 4070 7974 6573 742e 6d61  TIME).@pytest.ma
-0000ac40: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
-0000ac50: 2020 2020 2274 6167 7322 2c20 5b5b 7b22      "tags", [[{"
-0000ac60: 656e 7622 3a20 226f 7665 7277 7269 7465  env": "overwrite
-0000ac70: 5f65 6e76 227d 2c20 7b22 656e 7622 3a20  _env"}, {"env": 
-0000ac80: 226f 7665 7277 7269 7465 5f65 6e76 5f32  "overwrite_env_2
-0000ac90: 227d 5d2c 205b 7b7d 5d20 2a20 322c 204e  "}], [{}] * 2, N
-0000aca0: 6f6e 655d 0a29 0a40 7079 7465 7374 2e6d  one].).@pytest.m
-0000acb0: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
-0000acc0: 0a20 2020 2022 7469 6d65 7374 616d 7073  .    "timestamps
-0000acd0: 222c 205b 4e6f 6e65 2c20 7064 2e44 6174  ", [None, pd.Dat
-0000ace0: 6574 696d 6549 6e64 6578 285b 414e 4f54  etimeIndex([ANOT
-0000acf0: 4845 525f 5449 4d45 2c20 534f 4d45 5f54  HER_TIME, SOME_T
-0000ad00: 494d 455d 292c 205b 414e 4f54 4845 525f  IME]), [ANOTHER_
-0000ad10: 5449 4d45 2c20 534f 4d45 5f54 494d 455d  TIME, SOME_TIME]
-0000ad20: 5d0a 290a 4070 7974 6573 742e 6d61 726b  ].).@pytest.mark
-0000ad30: 2e70 6172 616d 6574 7269 7a65 2822 736f  .parametrize("so
-0000ad40: 7274 222c 205b 4661 6c73 652c 2054 7275  rt", [False, Tru
-0000ad50: 655d 290a 4070 7974 6573 742e 6d61 726b  e]).@pytest.mark
-0000ad60: 2e70 6172 616d 6574 7269 7a65 2822 7665  .parametrize("ve
-0000ad70: 7273 696f 6e22 2c20 5b22 3022 2c20 302c  rsion", ["0", 0,
-0000ad80: 204e 6f6e 655d 290a 4070 7974 6573 742e   None]).@pytest.
-0000ad90: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-0000ada0: 2822 6173 5f62 6174 6368 222c 205b 4661  ("as_batch", [Fa
-0000adb0: 6c73 652c 2054 7275 655d 290a 4070 7974  lse, True]).@pyt
-0000adc0: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-0000add0: 7269 7a65 280a 2020 2020 2274 6573 745f  rize(.    "test_
-0000ade0: 6665 6564 6261 636b 7322 2c0a 2020 2020  feedbacks",.    
-0000adf0: 5b0a 2020 2020 2020 2020 5b7b 2241 223a  [.        [{"A":
-0000ae00: 2032 3030 7d2c 207b 2241 223a 2032 3031   200}, {"A": 201
-0000ae10: 7d5d 2c0a 2020 2020 5d2c 0a29 0a40 7079  }],.    ],.).@py
-0000ae20: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
-0000ae30: 7472 697a 6528 0a20 2020 2022 7465 7374  trize(.    "test
-0000ae40: 5f6f 7574 7075 7473 222c 0a20 2020 205b  _outputs",.    [
-0000ae50: 0a20 2020 2020 2020 205b 7b22 4222 3a20  .        [{"B": 
-0000ae60: 3330 307d 2c20 7b22 4222 3a20 3330 317d  300}, {"B": 301}
-0000ae70: 5d2c 0a20 2020 205d 2c0a 290a 4070 7974  ],.    ],.).@pyt
-0000ae80: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-0000ae90: 7269 7a65 280a 2020 2020 2274 6573 745f  rize(.    "test_
-0000aea0: 696e 7075 7473 222c 0a20 2020 205b 0a20  inputs",.    [. 
-0000aeb0: 2020 2020 2020 205b 7b22 4122 3a20 3130         [{"A": 10
-0000aec0: 307d 2c20 7b22 4122 3a20 3130 317d 5d2c  0}, {"A": 101}],
-0000aed0: 0a20 2020 205d 2c0a 290a 406d 6f63 6b2e  .    ],.).@mock.
-0000aee0: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
-0000aef0: 6767 6572 2e65 7665 6e74 5f62 7569 6c64  gger.event_build
-0000af00: 6572 2e75 7569 642e 7575 6964 3422 290a  er.uuid.uuid4").
-0000af10: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
-0000af20: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
-0000af30: 742e 4761 6e74 7279 2e5f 7570 6c6f 6164  t.Gantry._upload
-0000af40: 5f64 6174 615f 6173 5f62 6174 6368 2229  _data_as_batch")
-0000af50: 0a64 6566 2074 6573 745f 6c6f 675f 7072  .def test_log_pr
-0000af60: 6564 6963 7469 6f6e 5f61 6e64 5f66 6565  ediction_and_fee
-0000af70: 6462 6163 6b5f 6576 656e 7473 280a 2020  dback_events(.  
-0000af80: 2020 6d6f 636b 5f75 706c 6f61 645f 6461    mock_upload_da
-0000af90: 7461 5f61 735f 6261 7463 682c 0a20 2020  ta_as_batch,.   
-0000afa0: 206d 6f63 6b5f 7575 6964 2c0a 2020 2020   mock_uuid,.    
-0000afb0: 7465 7374 5f69 6e70 7574 732c 0a20 2020  test_inputs,.   
-0000afc0: 2074 6573 745f 6f75 7470 7574 732c 0a20   test_outputs,. 
-0000afd0: 2020 2074 6573 745f 6665 6564 6261 636b     test_feedback
-0000afe0: 732c 0a20 2020 2061 735f 6261 7463 682c  s,.    as_batch,
-0000aff0: 0a20 2020 2076 6572 7369 6f6e 2c0a 2020  .    version,.  
-0000b000: 2020 736f 7274 2c0a 2020 2020 7469 6d65    sort,.    time
-0000b010: 7374 616d 7073 2c0a 2020 2020 7461 6773  stamps,.    tags
-0000b020: 2c0a 2020 2020 636c 695f 6f62 6a2c 0a20  ,.    cli_obj,. 
-0000b030: 2020 206c 6f67 5f73 746f 7265 2c0a 293a     log_store,.):
-0000b040: 0a20 2020 206d 6f63 6b5f 7570 6c6f 6164  .    mock_upload
-0000b050: 5f64 6174 615f 6173 5f62 6174 6368 2e72  _data_as_batch.r
-0000b060: 6574 7572 6e5f 7661 6c75 6520 3d20 4e6f  eturn_value = No
-0000b070: 6e65 0a20 2020 206d 6f63 6b5f 7575 6964  ne.    mock_uuid
-0000b080: 2e73 6964 655f 6566 6665 6374 203d 205b  .side_effect = [
-0000b090: 2241 4243 4431 222c 2022 4142 4344 3222  "ABCD1", "ABCD2"
-0000b0a0: 2c20 2241 4243 4433 222c 2022 4142 4344  , "ABCD3", "ABCD
-0000b0b0: 3422 5d0a 2020 2020 636c 695f 6f62 6a2e  4"].    cli_obj.
-0000b0c0: 5f6c 6f67 5f70 7265 6469 6374 696f 6e5f  _log_prediction_
-0000b0d0: 616e 645f 6665 6564 6261 636b 5f65 7665  and_feedback_eve
-0000b0e0: 6e74 7328 0a20 2020 2020 2020 2061 7070  nts(.        app
-0000b0f0: 6c69 6361 7469 6f6e 3d22 666f 6f62 6172  lication="foobar
-0000b100: 222c 0a20 2020 2020 2020 2076 6572 7369  ",.        versi
-0000b110: 6f6e 3d76 6572 7369 6f6e 2c0a 2020 2020  on=version,.    
-0000b120: 2020 2020 696e 7075 7473 3d74 6573 745f      inputs=test_
-0000b130: 696e 7075 7473 2c0a 2020 2020 2020 2020  inputs,.        
-0000b140: 6f75 7470 7574 733d 7465 7374 5f6f 7574  outputs=test_out
-0000b150: 7075 7473 2c0a 2020 2020 2020 2020 6a6f  puts,.        jo
-0000b160: 696e 5f6b 6579 733d 5b22 3132 3334 3522  in_keys=["12345"
-0000b170: 2c20 2236 3738 3930 225d 2c0a 2020 2020  , "67890"],.    
-0000b180: 2020 2020 6665 6564 6261 636b 733d 7465      feedbacks=te
-0000b190: 7374 5f66 6565 6462 6163 6b73 2c0a 2020  st_feedbacks,.  
-0000b1a0: 2020 2020 2020 7469 6d65 7374 616d 7073        timestamps
-0000b1b0: 3d74 696d 6573 7461 6d70 732c 0a20 2020  =timestamps,.   
-0000b1c0: 2020 2020 2073 6f72 745f 6f6e 5f74 696d       sort_on_tim
-0000b1d0: 6573 7461 6d70 3d73 6f72 742c 0a20 2020  estamp=sort,.   
-0000b1e0: 2020 2020 2061 735f 6261 7463 683d 6173       as_batch=as
-0000b1f0: 5f62 6174 6368 2c0a 2020 2020 2020 2020  _batch,.        
-0000b200: 7461 6773 3d74 6167 732c 0a20 2020 2029  tags=tags,.    )
-0000b210: 0a0a 2020 2020 6576 656e 745f 3120 3d20  ..    event_1 = 
-0000b220: 7b0a 2020 2020 2020 2020 2265 7665 6e74  {.        "event
-0000b230: 5f69 6422 3a20 2241 4243 4432 2220 6966  _id": "ABCD2" if
-0000b240: 206e 6f74 2028 736f 7274 2061 6e64 2074   not (sort and t
-0000b250: 696d 6573 7461 6d70 7320 6973 206e 6f74  imestamps is not
-0000b260: 204e 6f6e 6529 2065 6c73 6520 2241 4243   None) else "ABC
-0000b270: 4434 222c 0a20 2020 2020 2020 2022 6c6f  D4",.        "lo
-0000b280: 675f 7469 6d65 7374 616d 7022 3a20 4355  g_timestamp": CU
-0000b290: 5252 454e 545f 5449 4d45 5f53 5452 2c0a  RRENT_TIME_STR,.
-0000b2a0: 2020 2020 2020 2020 2274 696d 6573 7461          "timesta
-0000b2b0: 6d70 223a 2041 4e4f 5448 4552 5f54 494d  mp": ANOTHER_TIM
-0000b2c0: 455f 5354 5220 6966 2074 696d 6573 7461  E_STR if timesta
-0000b2d0: 6d70 7320 6973 206e 6f74 204e 6f6e 6520  mps is not None 
-0000b2e0: 656c 7365 2043 5552 5245 4e54 5f54 494d  else CURRENT_TIM
-0000b2f0: 455f 5354 522c 0a20 2020 2020 2020 2022  E_STR,.        "
-0000b300: 6d65 7461 6461 7461 223a 207b 0a20 2020  metadata": {.   
-0000b310: 2020 2020 2020 2020 2022 6675 6e63 5f6e           "func_n
-0000b320: 616d 6522 3a20 2266 6f6f 6261 7222 2c0a  ame": "foobar",.
-0000b330: 2020 2020 2020 2020 2020 2020 2276 6572              "ver
-0000b340: 7369 6f6e 223a 2076 6572 7369 6f6e 2c0a  sion": version,.
-0000b350: 2020 2020 2020 2020 2020 2020 2266 6565              "fee
-0000b360: 6462 6163 6b5f 6b65 7973 223a 204e 6f6e  dback_keys": Non
-0000b370: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-0000b380: 6967 6e6f 7265 5f69 6e70 7574 7322 3a20  ignore_inputs": 
-0000b390: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0000b3a0: 2020 2266 6565 6462 6163 6b5f 7665 7273    "feedback_vers
-0000b3b0: 696f 6e22 3a20 7665 7273 696f 6e2c 0a20  ion": version,. 
-0000b3c0: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-0000b3d0: 2020 2269 6e70 7574 7322 3a20 7b22 4122    "inputs": {"A"
-0000b3e0: 3a20 3130 307d 2c0a 2020 2020 2020 2020  : 100},.        
-0000b3f0: 226f 7574 7075 7473 223a 207b 2242 223a  "outputs": {"B":
-0000b400: 2033 3030 7d2c 0a20 2020 2020 2020 2022   300},.        "
-0000b410: 6665 6564 6261 636b 5f69 6422 3a20 2231  feedback_id": "1
-0000b420: 3233 3435 222c 0a20 2020 2020 2020 2022  2345",.        "
-0000b430: 7461 6773 223a 2074 6167 735b 305d 2069  tags": tags[0] i
-0000b440: 6620 7461 6773 2065 6c73 6520 4e6f 6e65  f tags else None
-0000b450: 2c0a 2020 2020 2020 2020 2262 6174 6368  ,.        "batch
-0000b460: 5f69 6422 3a20 4e6f 6e65 2c0a 2020 2020  _id": None,.    
-0000b470: 2020 2020 2266 6565 6462 6163 6b22 3a20      "feedback": 
-0000b480: 7b22 4122 3a20 3230 307d 2c0a 2020 2020  {"A": 200},.    
-0000b490: 7d0a 0a20 2020 2065 7665 6e74 5f32 203d  }..    event_2 =
-0000b4a0: 207b 0a20 2020 2020 2020 2022 6576 656e   {.        "even
-0000b4b0: 745f 6964 223a 2022 4142 4344 3422 2069  t_id": "ABCD4" i
-0000b4c0: 6620 6e6f 7420 2873 6f72 7420 616e 6420  f not (sort and 
-0000b4d0: 7469 6d65 7374 616d 7073 2069 7320 6e6f  timestamps is no
-0000b4e0: 7420 4e6f 6e65 2920 656c 7365 2022 4142  t None) else "AB
-0000b4f0: 4344 3222 2c0a 2020 2020 2020 2020 226c  CD2",.        "l
-0000b500: 6f67 5f74 696d 6573 7461 6d70 223a 2043  og_timestamp": C
-0000b510: 5552 5245 4e54 5f54 494d 455f 5354 522c  URRENT_TIME_STR,
-0000b520: 0a20 2020 2020 2020 2022 7469 6d65 7374  .        "timest
-0000b530: 616d 7022 3a20 534f 4d45 5f54 494d 455f  amp": SOME_TIME_
-0000b540: 5354 5220 6966 2074 696d 6573 7461 6d70  STR if timestamp
-0000b550: 7320 6973 206e 6f74 204e 6f6e 6520 656c  s is not None el
-0000b560: 7365 2043 5552 5245 4e54 5f54 494d 455f  se CURRENT_TIME_
-0000b570: 5354 522c 0a20 2020 2020 2020 2022 6d65  STR,.        "me
-0000b580: 7461 6461 7461 223a 207b 0a20 2020 2020  tadata": {.     
-0000b590: 2020 2020 2020 2022 6675 6e63 5f6e 616d         "func_nam
-0000b5a0: 6522 3a20 2266 6f6f 6261 7222 2c0a 2020  e": "foobar",.  
-0000b5b0: 2020 2020 2020 2020 2020 2276 6572 7369            "versi
-0000b5c0: 6f6e 223a 2076 6572 7369 6f6e 2c0a 2020  on": version,.  
-0000b5d0: 2020 2020 2020 2020 2020 2266 6565 6462            "feedb
-0000b5e0: 6163 6b5f 6b65 7973 223a 204e 6f6e 652c  ack_keys": None,
-0000b5f0: 0a20 2020 2020 2020 2020 2020 2022 6967  .            "ig
-0000b600: 6e6f 7265 5f69 6e70 7574 7322 3a20 4e6f  nore_inputs": No
-0000b610: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0000b620: 2266 6565 6462 6163 6b5f 7665 7273 696f  "feedback_versio
-0000b630: 6e22 3a20 7665 7273 696f 6e2c 0a20 2020  n": version,.   
-0000b640: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-0000b650: 2269 6e70 7574 7322 3a20 7b22 4122 3a20  "inputs": {"A": 
-0000b660: 3130 317d 2c0a 2020 2020 2020 2020 226f  101},.        "o
-0000b670: 7574 7075 7473 223a 207b 2242 223a 2033  utputs": {"B": 3
-0000b680: 3031 7d2c 0a20 2020 2020 2020 2022 6665  01},.        "fe
-0000b690: 6564 6261 636b 5f69 6422 3a20 2236 3738  edback_id": "678
-0000b6a0: 3930 222c 0a20 2020 2020 2020 2022 7461  90",.        "ta
-0000b6b0: 6773 223a 2074 6167 735b 315d 2069 6620  gs": tags[1] if 
-0000b6c0: 7461 6773 2065 6c73 6520 4e6f 6e65 2c0a  tags else None,.
-0000b6d0: 2020 2020 2020 2020 2262 6174 6368 5f69          "batch_i
-0000b6e0: 6422 3a20 4e6f 6e65 2c0a 2020 2020 2020  d": None,.      
-0000b6f0: 2020 2266 6565 6462 6163 6b22 3a20 7b22    "feedback": {"
-0000b700: 4122 3a20 3230 317d 2c0a 2020 2020 7d0a  A": 201},.    }.
-0000b710: 0a20 2020 2069 6620 6173 5f62 6174 6368  .    if as_batch
-0000b720: 3a0a 2020 2020 2020 2020 6d6f 636b 5f75  :.        mock_u
-0000b730: 706c 6f61 645f 6461 7461 5f61 735f 6261  pload_data_as_ba
-0000b740: 7463 682e 6173 7365 7274 5f63 616c 6c65  tch.assert_calle
-0000b750: 645f 6f6e 6365 5f77 6974 6828 0a20 2020  d_once_with(.   
-0000b760: 2020 2020 2020 2020 2022 666f 6f62 6172           "foobar
-0000b770: 222c 0a20 2020 2020 2020 2020 2020 2076  ",.            v
-0000b780: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
-0000b790: 2020 2020 5b65 7665 6e74 5f31 2c20 6576      [event_1, ev
-0000b7a0: 656e 745f 325d 2069 6620 6e6f 7420 2873  ent_2] if not (s
-0000b7b0: 6f72 7420 616e 6420 7469 6d65 7374 616d  ort and timestam
-0000b7c0: 7073 2069 7320 6e6f 7420 4e6f 6e65 2920  ps is not None) 
-0000b7d0: 656c 7365 205b 6576 656e 745f 322c 2065  else [event_2, e
-0000b7e0: 7665 6e74 5f31 5d2c 0a20 2020 2020 2020  vent_1],.       
-0000b7f0: 2020 2020 2042 6174 6368 5479 7065 2e52       BatchType.R
-0000b800: 4543 4f52 442c 0a20 2020 2020 2020 2029  ECORD,.        )
-0000b810: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-0000b820: 2020 2061 7373 6572 7420 6c6f 675f 7374     assert log_st
-0000b830: 6f72 652e 6c6f 6773 203d 3d20 5b0a 2020  ore.logs == [.  
-0000b840: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-0000b850: 2020 2020 2020 2020 2020 2020 2265 7665              "eve
-0000b860: 6e74 7322 3a20 5b65 7665 6e74 5f31 2c20  nts": [event_1, 
-0000b870: 6576 656e 745f 325d 0a20 2020 2020 2020  event_2].       
-0000b880: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-0000b890: 2873 6f72 7420 616e 6420 7469 6d65 7374  (sort and timest
-0000b8a0: 616d 7073 2069 7320 6e6f 7420 4e6f 6e65  amps is not None
-0000b8b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000b8c0: 2020 656c 7365 205b 6576 656e 745f 322c    else [event_2,
-0000b8d0: 2065 7665 6e74 5f31 5d2c 0a20 2020 2020   event_1],.     
-0000b8e0: 2020 2020 2020 2020 2020 2022 6170 706c             "appl
-0000b8f0: 6963 6174 696f 6e22 3a20 2266 6f6f 6261  ication": "fooba
-0000b900: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
-0000b910: 7d2c 0a20 2020 2020 2020 205d 0a20 2020  },.        ].   
-0000b920: 2020 2020 206d 6f63 6b5f 7570 6c6f 6164       mock_upload
-0000b930: 5f64 6174 615f 6173 5f62 6174 6368 2e61  _data_as_batch.a
-0000b940: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
-0000b950: 2829 0a0a 0a40 6672 6565 7a65 5f74 696d  ()...@freeze_tim
-0000b960: 6528 4355 5252 454e 545f 5449 4d45 290a  e(CURRENT_TIME).
-0000b970: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
-0000b980: 616d 6574 7269 7a65 2822 7461 6773 222c  ametrize("tags",
-0000b990: 205b 7b22 656e 7622 3a20 226f 7665 7277   [{"env": "overw
-0000b9a0: 7269 7465 5f65 6e76 227d 2c20 7b7d 2c20  rite_env"}, {}, 
-0000b9b0: 4e6f 6e65 5d29 0a40 7079 7465 7374 2e6d  None]).@pytest.m
-0000b9c0: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
-0000b9d0: 0a20 2020 2022 7469 6d65 7374 616d 7073  .    "timestamps
-0000b9e0: 222c 205b 4e6f 6e65 2c20 7064 2e44 6174  ", [None, pd.Dat
-0000b9f0: 6574 696d 6549 6e64 6578 285b 414e 4f54  etimeIndex([ANOT
-0000ba00: 4845 525f 5449 4d45 2c20 534f 4d45 5f54  HER_TIME, SOME_T
-0000ba10: 494d 455d 292c 205b 414e 4f54 4845 525f  IME]), [ANOTHER_
-0000ba20: 5449 4d45 2c20 534f 4d45 5f54 494d 455d  TIME, SOME_TIME]
-0000ba30: 5d0a 290a 4070 7974 6573 742e 6d61 726b  ].).@pytest.mark
-0000ba40: 2e70 6172 616d 6574 7269 7a65 2822 736f  .parametrize("so
-0000ba50: 7274 222c 205b 4661 6c73 652c 2054 7275  rt", [False, Tru
-0000ba60: 655d 290a 4070 7974 6573 742e 6d61 726b  e]).@pytest.mark
-0000ba70: 2e70 6172 616d 6574 7269 7a65 2822 7665  .parametrize("ve
-0000ba80: 7273 696f 6e22 2c20 5b22 3022 2c20 302c  rsion", ["0", 0,
-0000ba90: 204e 6f6e 655d 290a 406d 6f63 6b2e 7061   None]).@mock.pa
-0000baa0: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
-0000bab0: 6572 2e65 7665 6e74 5f62 7569 6c64 6572  er.event_builder
-0000bac0: 2e75 7569 642e 7575 6964 3422 290a 406d  .uuid.uuid4").@m
-0000bad0: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
-0000bae0: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
-0000baf0: 4761 6e74 7279 2e5f 6861 6e64 6c65 5f75  Gantry._handle_u
-0000bb00: 706c 6f61 6422 290a 6465 6620 7465 7374  pload").def test
-0000bb10: 5f5f 7570 6c6f 6164 5f64 6174 615f 6173  __upload_data_as
-0000bb20: 5f62 6174 6368 280a 2020 2020 6d6f 636b  _batch(.    mock
-0000bb30: 5f68 616e 646c 655f 7570 6c6f 6164 2c0a  _handle_upload,.
-0000bb40: 2020 2020 6d6f 636b 5f75 7569 642c 0a20      mock_uuid,. 
-0000bb50: 2020 2076 6572 7369 6f6e 2c0a 2020 2020     version,.    
-0000bb60: 736f 7274 2c0a 2020 2020 7469 6d65 7374  sort,.    timest
-0000bb70: 616d 7073 2c0a 2020 2020 7461 6773 2c0a  amps,.    tags,.
-0000bb80: 2020 2020 636c 695f 6f62 6a2c 0a29 3a0a      cli_obj,.):.
-0000bb90: 2020 2020 6d6f 636b 5f75 7569 642e 7369      mock_uuid.si
-0000bba0: 6465 5f65 6666 6563 7420 3d20 5b22 3122  de_effect = ["1"
-0000bbb0: 5d0a 2020 2020 6578 7065 6374 6564 5f74  ].    expected_t
-0000bbc0: 6167 7320 3d20 7461 6773 2069 6620 7461  ags = tags if ta
-0000bbd0: 6773 2065 6c73 6520 7b22 656e 7622 3a20  gs else {"env": 
-0000bbe0: 2274 6573 7422 7d0a 2020 2020 6576 656e  "test"}.    even
-0000bbf0: 745f 3120 3d20 7b0a 2020 2020 2020 2020  t_1 = {.        
-0000bc00: 2265 7665 6e74 5f69 6422 3a20 2241 4243  "event_id": "ABC
-0000bc10: 4432 2220 6966 206e 6f74 2028 736f 7274  D2" if not (sort
-0000bc20: 2061 6e64 2074 696d 6573 7461 6d70 7320   and timestamps 
-0000bc30: 6973 206e 6f74 204e 6f6e 6529 2065 6c73  is not None) els
-0000bc40: 6520 2241 4243 4434 222c 0a20 2020 2020  e "ABCD4",.     
-0000bc50: 2020 2022 6c6f 675f 7469 6d65 7374 616d     "log_timestam
-0000bc60: 7022 3a20 4355 5252 454e 545f 5449 4d45  p": CURRENT_TIME
-0000bc70: 5f53 5452 2c0a 2020 2020 2020 2020 2274  _STR,.        "t
-0000bc80: 696d 6573 7461 6d70 223a 2041 4e4f 5448  imestamp": ANOTH
-0000bc90: 4552 5f54 494d 455f 5354 5220 6966 2074  ER_TIME_STR if t
-0000bca0: 696d 6573 7461 6d70 7320 6973 206e 6f74  imestamps is not
-0000bcb0: 204e 6f6e 6520 656c 7365 2043 5552 5245   None else CURRE
-0000bcc0: 4e54 5f54 494d 455f 5354 522c 0a20 2020  NT_TIME_STR,.   
-0000bcd0: 2020 2020 2022 6d65 7461 6461 7461 223a       "metadata":
-0000bce0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-0000bcf0: 6675 6e63 5f6e 616d 6522 3a20 2266 6f6f  func_name": "foo
-0000bd00: 6261 7222 2c0a 2020 2020 2020 2020 2020  bar",.          
-0000bd10: 2020 2276 6572 7369 6f6e 223a 2076 6572    "version": ver
-0000bd20: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
-0000bd30: 2020 2266 6565 6462 6163 6b5f 6b65 7973    "feedback_keys
-0000bd40: 223a 205b 2241 225d 2c0a 2020 2020 2020  ": ["A"],.      
-0000bd50: 2020 2020 2020 2269 676e 6f72 655f 696e        "ignore_in
-0000bd60: 7075 7473 223a 204e 6f6e 652c 0a20 2020  puts": None,.   
-0000bd70: 2020 2020 2020 2020 2022 7072 6f76 6964           "provid
-0000bd80: 6564 5f66 6565 6462 6163 6b5f 6964 223a  ed_feedback_id":
-0000bd90: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-0000bda0: 2020 2022 6665 6564 6261 636b 5f76 6572     "feedback_ver
-0000bdb0: 7369 6f6e 223a 2076 6572 7369 6f6e 2c0a  sion": version,.
-0000bdc0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-0000bdd0: 2020 2022 696e 7075 7473 223a 207b 2241     "inputs": {"A
-0000bde0: 223a 2031 3030 7d2c 0a20 2020 2020 2020  ": 100},.       
-0000bdf0: 2022 6f75 7470 7574 7322 3a20 7b22 4222   "outputs": {"B"
-0000be00: 3a20 3330 307d 2c0a 2020 2020 2020 2020  : 300},.        
-0000be10: 2266 6565 6462 6163 6b5f 6964 223a 2022  "feedback_id": "
-0000be20: 3564 6431 3436 3135 6566 6562 3264 3038  5dd14615efeb2d08
-0000be30: 3665 3531 3965 6433 3565 6664 3366 3733  6e519ed35efd3f73
-0000be40: 222c 0a20 2020 2020 2020 2022 7461 6773  ",.        "tags
-0000be50: 223a 2065 7870 6563 7465 645f 7461 6773  ": expected_tags
-0000be60: 2c0a 2020 2020 2020 2020 2262 6174 6368  ,.        "batch
-0000be70: 5f69 6422 3a20 4e6f 6e65 2c0a 2020 2020  _id": None,.    
-0000be80: 2020 2020 2266 6565 6462 6163 6b5f 6964      "feedback_id
-0000be90: 5f69 6e70 7574 7322 3a20 7b22 4122 3a20  _inputs": {"A": 
-0000bea0: 3130 307d 2c0a 2020 2020 2020 2020 2266  100},.        "f
-0000beb0: 6565 6462 6163 6b22 3a20 7b22 4122 3a20  eedback": {"A": 
-0000bec0: 3230 307d 2c0a 2020 2020 7d0a 2020 2020  200},.    }.    
-0000bed0: 6576 656e 745f 3220 3d20 7b0a 2020 2020  event_2 = {.    
-0000bee0: 2020 2020 2265 7665 6e74 5f69 6422 3a20      "event_id": 
-0000bef0: 2241 4243 4434 2220 6966 206e 6f74 2028  "ABCD4" if not (
-0000bf00: 736f 7274 2061 6e64 2074 696d 6573 7461  sort and timesta
-0000bf10: 6d70 7320 6973 206e 6f74 204e 6f6e 6529  mps is not None)
-0000bf20: 2065 6c73 6520 2241 4243 4432 222c 0a20   else "ABCD2",. 
-0000bf30: 2020 2020 2020 2022 6c6f 675f 7469 6d65         "log_time
-0000bf40: 7374 616d 7022 3a20 4355 5252 454e 545f  stamp": CURRENT_
-0000bf50: 5449 4d45 5f53 5452 2c0a 2020 2020 2020  TIME_STR,.      
-0000bf60: 2020 2274 696d 6573 7461 6d70 223a 2053    "timestamp": S
-0000bf70: 4f4d 455f 5449 4d45 5f53 5452 2069 6620  OME_TIME_STR if 
-0000bf80: 7469 6d65 7374 616d 7073 2069 7320 6e6f  timestamps is no
-0000bf90: 7420 4e6f 6e65 2065 6c73 6520 4355 5252  t None else CURR
-0000bfa0: 454e 545f 5449 4d45 5f53 5452 2c0a 2020  ENT_TIME_STR,.  
-0000bfb0: 2020 2020 2020 226d 6574 6164 6174 6122        "metadata"
-0000bfc0: 3a20 7b0a 2020 2020 2020 2020 2020 2020  : {.            
-0000bfd0: 2266 756e 635f 6e61 6d65 223a 2022 666f  "func_name": "fo
-0000bfe0: 6f62 6172 222c 0a20 2020 2020 2020 2020  obar",.         
-0000bff0: 2020 2022 7665 7273 696f 6e22 3a20 7665     "version": ve
-0000c000: 7273 696f 6e2c 0a20 2020 2020 2020 2020  rsion,.         
-0000c010: 2020 2022 6665 6564 6261 636b 5f6b 6579     "feedback_key
-0000c020: 7322 3a20 5b22 4122 5d2c 0a20 2020 2020  s": ["A"],.     
-0000c030: 2020 2020 2020 2022 6967 6e6f 7265 5f69         "ignore_i
-0000c040: 6e70 7574 7322 3a20 4e6f 6e65 2c0a 2020  nputs": None,.  
-0000c050: 2020 2020 2020 2020 2020 2270 726f 7669            "provi
-0000c060: 6465 645f 6665 6564 6261 636b 5f69 6422  ded_feedback_id"
-0000c070: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-0000c080: 2020 2020 2266 6565 6462 6163 6b5f 7665      "feedback_ve
-0000c090: 7273 696f 6e22 3a20 7665 7273 696f 6e2c  rsion": version,
-0000c0a0: 0a20 2020 2020 2020 207d 2c0a 2020 2020  .        },.    
-0000c0b0: 2020 2020 2269 6e70 7574 7322 3a20 7b22      "inputs": {"
-0000c0c0: 4122 3a20 3130 317d 2c0a 2020 2020 2020  A": 101},.      
-0000c0d0: 2020 226f 7574 7075 7473 223a 207b 2242    "outputs": {"B
-0000c0e0: 223a 2033 3031 7d2c 0a20 2020 2020 2020  ": 301},.       
-0000c0f0: 2022 6665 6564 6261 636b 5f69 6422 3a20   "feedback_id": 
-0000c100: 2239 6533 3239 3239 3365 3032 3264 3663  "9e329293e022d6c
-0000c110: 6461 6166 6465 6334 3962 3566 3466 6564  daafdec49b5f4fed
-0000c120: 6322 2c0a 2020 2020 2020 2020 2274 6167  c",.        "tag
-0000c130: 7322 3a20 6578 7065 6374 6564 5f74 6167  s": expected_tag
-0000c140: 732c 0a20 2020 2020 2020 2022 6261 7463  s,.        "batc
-0000c150: 685f 6964 223a 204e 6f6e 652c 0a20 2020  h_id": None,.   
-0000c160: 2020 2020 2022 6665 6564 6261 636b 5f69       "feedback_i
-0000c170: 645f 696e 7075 7473 223a 207b 2241 223a  d_inputs": {"A":
-0000c180: 2031 3031 7d2c 0a20 2020 2020 2020 2022   101},.        "
-0000c190: 6665 6564 6261 636b 223a 207b 2241 223a  feedback": {"A":
-0000c1a0: 2032 3031 7d2c 0a20 2020 207d 0a20 2020   201},.    }.   
-0000c1b0: 2065 7665 6e74 7320 3d20 5b65 7665 6e74   events = [event
-0000c1c0: 5f31 2c20 6576 656e 745f 325d 0a0a 2020  _1, event_2]..  
-0000c1d0: 2020 636c 695f 6f62 6a2e 5f75 706c 6f61    cli_obj._uploa
-0000c1e0: 645f 6461 7461 5f61 735f 6261 7463 6828  d_data_as_batch(
-0000c1f0: 2274 6573 745f 6170 7022 2c20 7665 7273  "test_app", vers
-0000c200: 696f 6e2c 2065 7665 6e74 732c 2042 6174  ion, events, Bat
-0000c210: 6368 5479 7065 2e52 4543 4f52 4429 0a0a  chType.RECORD)..
-0000c220: 2020 2020 6d6f 636b 5f68 616e 646c 655f      mock_handle_
-0000c230: 7570 6c6f 6164 2e61 7373 6572 745f 6361  upload.assert_ca
-0000c240: 6c6c 6564 5f6f 6e63 655f 7769 7468 280a  lled_once_with(.
-0000c250: 2020 2020 2020 2020 6d6f 636b 2e41 4e59          mock.ANY
-0000c260: 2c0a 2020 2020 2020 2020 4461 7461 4c69  ,.        DataLi
-0000c270: 6e6b 280a 2020 2020 2020 2020 2020 2020  nk(.            
-0000c280: 6170 706c 6963 6174 696f 6e3d 2274 6573  application="tes
-0000c290: 745f 6170 7022 2c0a 2020 2020 2020 2020  t_app",.        
-0000c2a0: 2020 2020 7665 7273 696f 6e3d 7374 7228      version=str(
-0000c2b0: 7665 7273 696f 6e29 2069 6620 7665 7273  version) if vers
-0000c2c0: 696f 6e20 6973 206e 6f74 204e 6f6e 6520  ion is not None 
-0000c2d0: 656c 7365 2076 6572 7369 6f6e 2c0a 2020  else version,.  
-0000c2e0: 2020 2020 2020 2020 2020 6669 6c65 5f74            file_t
-0000c2f0: 7970 653d 5570 6c6f 6164 4669 6c65 5479  ype=UploadFileTy
-0000c300: 7065 2e45 5645 4e54 532c 0a20 2020 2020  pe.EVENTS,.     
-0000c310: 2020 2020 2020 2062 6174 6368 5f74 7970         batch_typ
-0000c320: 653d 4261 7463 6854 7970 652e 5245 434f  e=BatchType.RECO
-0000c330: 5244 2c0a 2020 2020 2020 2020 2020 2020  RD,.            
-0000c340: 6c6f 675f 7469 6d65 7374 616d 703d 4355  log_timestamp=CU
-0000c350: 5252 454e 545f 5449 4d45 2e69 736f 666f  RRENT_TIME.isofo
-0000c360: 726d 6174 2829 2c0a 2020 2020 2020 2020  rmat(),.        
-0000c370: 2020 2020 6e75 6d5f 6576 656e 7473 3d32      num_events=2
-0000c380: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
-0000c390: 2020 2020 206d 6f63 6b2e 414e 592c 0a20       mock.ANY,. 
-0000c3a0: 2020 2020 2020 2022 7465 7374 5f61 7070         "test_app
-0000c3b0: 5f31 222c 0a20 2020 2029 0a0a 0a40 6d6f  _1",.    )...@mo
-0000c3c0: 636b 2e70 6174 6368 2822 6761 6e74 7279  ck.patch("gantry
-0000c3d0: 2e6c 6f67 6765 722e 636c 6965 6e74 2e47  .logger.client.G
-0000c3e0: 616e 7472 792e 5f67 656e 6572 6174 655f  antry._generate_
-0000c3f0: 7072 6564 6963 7469 6f6e 5f61 6e64 5f66  prediction_and_f
-0000c400: 6565 6462 6163 6b5f 6576 656e 7473 2229  eedback_events")
-0000c410: 0a64 6566 2074 6573 745f 6765 6e65 7261  .def test_genera
-0000c420: 7465 5f72 6563 6f72 6473 5f70 7265 6473  te_records_preds
-0000c430: 5f61 6e64 5f66 6565 6462 6163 6b5f 7365  _and_feedback_se
-0000c440: 7269 6573 5f63 6f65 7263 6564 280a 2020  ries_coerced(.  
-0000c450: 2020 6d6f 636b 5f67 656e 6572 6174 655f    mock_generate_
-0000c460: 7072 6564 735f 616e 645f 6665 6564 6261  preds_and_feedba
-0000c470: 636b 2c0a 2020 2020 636c 695f 6f62 6a2c  ck,.    cli_obj,
-0000c480: 0a29 3a0a 2020 2020 6578 7065 6374 6564  .):.    expected
-0000c490: 5f69 6e70 7574 7320 3d20 7064 2e53 6572  _inputs = pd.Ser
-0000c4a0: 6965 7328 5b32 3030 2c20 3230 315d 290a  ies([200, 201]).
-0000c4b0: 2020 2020 6578 7065 6374 6564 5f6f 7574      expected_out
-0000c4c0: 7075 7473 203d 2070 642e 5365 7269 6573  puts = pd.Series
-0000c4d0: 285b 3330 302c 2033 3031 5d29 0a20 2020  ([300, 301]).   
-0000c4e0: 2065 7870 6563 7465 645f 6665 6564 6261   expected_feedba
-0000c4f0: 636b 7320 3d20 7064 2e53 6572 6965 7328  cks = pd.Series(
-0000c500: 5b31 3030 2c20 3130 315d 290a 2020 2020  [100, 101]).    
-0000c510: 6170 706c 6963 6174 696f 6e20 3d20 2274  application = "t
-0000c520: 6573 745f 6170 7022 0a0a 2020 2020 636c  est_app"..    cl
-0000c530: 695f 6f62 6a2e 6765 6e65 7261 7465 5f72  i_obj.generate_r
-0000c540: 6563 6f72 6473 280a 2020 2020 2020 2020  ecords(.        
-0000c550: 6170 706c 6963 6174 696f 6e3d 6170 706c  application=appl
-0000c560: 6963 6174 696f 6e2c 0a20 2020 2020 2020  ication,.       
-0000c570: 2069 6e70 7574 733d 6578 7065 6374 6564   inputs=expected
-0000c580: 5f69 6e70 7574 732c 0a20 2020 2020 2020  _inputs,.       
-0000c590: 206f 7574 7075 7473 3d65 7870 6563 7465   outputs=expecte
-0000c5a0: 645f 6f75 7470 7574 732c 0a20 2020 2020  d_outputs,.     
-0000c5b0: 2020 2066 6565 6462 6163 6b73 3d65 7870     feedbacks=exp
-0000c5c0: 6563 7465 645f 6665 6564 6261 636b 732c  ected_feedbacks,
-0000c5d0: 0a20 2020 2029 0a0a 2020 2020 646f 776e  .    )..    down
-0000c5e0: 7374 7265 616d 5f6b 7761 7267 7320 3d20  stream_kwargs = 
-0000c5f0: 6d6f 636b 5f67 656e 6572 6174 655f 7072  mock_generate_pr
-0000c600: 6564 735f 616e 645f 6665 6564 6261 636b  eds_and_feedback
-0000c610: 2e63 616c 6c5f 6172 6773 2e6b 7761 7267  .call_args.kwarg
-0000c620: 730a 2020 2020 6163 7475 616c 5f69 6e70  s.    actual_inp
-0000c630: 7574 7320 3d20 646f 776e 7374 7265 616d  uts = downstream
-0000c640: 5f6b 7761 7267 735b 2269 6e70 7574 7322  _kwargs["inputs"
-0000c650: 5d0a 2020 2020 6163 7475 616c 5f6f 7574  ].    actual_out
-0000c660: 7075 7473 203d 2064 6f77 6e73 7472 6561  puts = downstrea
-0000c670: 6d5f 6b77 6172 6773 5b22 6f75 7470 7574  m_kwargs["output
-0000c680: 7322 5d0a 2020 2020 6163 7475 616c 5f66  s"].    actual_f
-0000c690: 6565 6462 6163 6b73 203d 2064 6f77 6e73  eedbacks = downs
-0000c6a0: 7472 6561 6d5f 6b77 6172 6773 5b22 6665  tream_kwargs["fe
-0000c6b0: 6564 6261 636b 7322 5d0a 2020 2020 6173  edbacks"].    as
-0000c6c0: 7365 7274 2061 6374 7561 6c5f 696e 7075  sert actual_inpu
-0000c6d0: 7473 203d 3d20 5b7b 303a 2032 3030 7d2c  ts == [{0: 200},
-0000c6e0: 207b 303a 2032 3031 7d5d 0a20 2020 2061   {0: 201}].    a
-0000c6f0: 7373 6572 7420 6163 7475 616c 5f6f 7574  ssert actual_out
-0000c700: 7075 7473 203d 3d20 5b7b 303a 2033 3030  puts == [{0: 300
-0000c710: 7d2c 207b 303a 2033 3031 7d5d 0a20 2020  }, {0: 301}].   
-0000c720: 2061 7373 6572 7420 6163 7475 616c 5f66   assert actual_f
-0000c730: 6565 6462 6163 6b73 203d 3d20 5b7b 303a  eedbacks == [{0:
-0000c740: 2031 3030 7d2c 207b 303a 2031 3031 7d5d   100}, {0: 101}]
-0000c750: 0a0a 0a40 6d6f 636b 2e70 6174 6368 2822  ...@mock.patch("
-0000c760: 6761 6e74 7279 2e6c 6f67 6765 722e 636c  gantry.logger.cl
-0000c770: 6965 6e74 2e47 616e 7472 792e 5f6c 6f67  ient.Gantry._log
-0000c780: 5f70 7265 6469 6374 696f 6e5f 616e 645f  _prediction_and_
-0000c790: 6665 6564 6261 636b 5f65 7665 6e74 7322  feedback_events"
-0000c7a0: 290a 6465 6620 7465 7374 5f6c 6f67 5f72  ).def test_log_r
-0000c7b0: 6563 6f72 6473 5f70 7265 6473 5f61 6e64  ecords_preds_and
-0000c7c0: 5f66 6565 6462 6163 6b5f 7365 7269 6573  _feedback_series
-0000c7d0: 5f63 6f65 7263 6564 280a 2020 2020 6d6f  _coerced(.    mo
-0000c7e0: 636b 5f70 7265 6473 5f61 6e64 5f66 6565  ck_preds_and_fee
-0000c7f0: 6462 6163 6b2c 0a20 2020 2063 6c69 5f6f  dback,.    cli_o
-0000c800: 626a 2c0a 293a 0a20 2020 2065 7870 6563  bj,.):.    expec
-0000c810: 7465 645f 696e 7075 7473 203d 2070 642e  ted_inputs = pd.
-0000c820: 5365 7269 6573 285b 3230 302c 2032 3031  Series([200, 201
-0000c830: 5d29 0a20 2020 2065 7870 6563 7465 645f  ]).    expected_
-0000c840: 6f75 7470 7574 7320 3d20 7064 2e53 6572  outputs = pd.Ser
-0000c850: 6965 7328 5b33 3030 2c20 3330 315d 290a  ies([300, 301]).
-0000c860: 2020 2020 6578 7065 6374 6564 5f66 6565      expected_fee
-0000c870: 6462 6163 6b73 203d 2070 642e 5365 7269  dbacks = pd.Seri
-0000c880: 6573 285b 3130 302c 2031 3031 5d29 0a20  es([100, 101]). 
-0000c890: 2020 2061 7070 6c69 6361 7469 6f6e 203d     application =
-0000c8a0: 2022 7465 7374 5f61 7070 220a 0a20 2020   "test_app"..   
-0000c8b0: 2063 6c69 5f6f 626a 2e6c 6f67 5f72 6563   cli_obj.log_rec
-0000c8c0: 6f72 6473 280a 2020 2020 2020 2020 6170  ords(.        ap
-0000c8d0: 706c 6963 6174 696f 6e3d 6170 706c 6963  plication=applic
-0000c8e0: 6174 696f 6e2c 0a20 2020 2020 2020 2069  ation,.        i
-0000c8f0: 6e70 7574 733d 6578 7065 6374 6564 5f69  nputs=expected_i
-0000c900: 6e70 7574 732c 0a20 2020 2020 2020 206f  nputs,.        o
-0000c910: 7574 7075 7473 3d65 7870 6563 7465 645f  utputs=expected_
-0000c920: 6f75 7470 7574 732c 0a20 2020 2020 2020  outputs,.       
-0000c930: 2066 6565 6462 6163 6b73 3d65 7870 6563   feedbacks=expec
-0000c940: 7465 645f 6665 6564 6261 636b 732c 0a20  ted_feedbacks,. 
-0000c950: 2020 2029 0a0a 2020 2020 646f 776e 7374     )..    downst
-0000c960: 7265 616d 5f6b 7761 7267 7320 3d20 6d6f  ream_kwargs = mo
-0000c970: 636b 5f70 7265 6473 5f61 6e64 5f66 6565  ck_preds_and_fee
-0000c980: 6462 6163 6b2e 6361 6c6c 5f61 7267 732e  dback.call_args.
-0000c990: 6b77 6172 6773 0a20 2020 2061 6374 7561  kwargs.    actua
-0000c9a0: 6c5f 696e 7075 7473 203d 2064 6f77 6e73  l_inputs = downs
-0000c9b0: 7472 6561 6d5f 6b77 6172 6773 5b22 696e  tream_kwargs["in
-0000c9c0: 7075 7473 225d 0a20 2020 2061 6374 7561  puts"].    actua
-0000c9d0: 6c5f 6f75 7470 7574 7320 3d20 646f 776e  l_outputs = down
-0000c9e0: 7374 7265 616d 5f6b 7761 7267 735b 226f  stream_kwargs["o
-0000c9f0: 7574 7075 7473 225d 0a20 2020 2061 6374  utputs"].    act
-0000ca00: 7561 6c5f 6665 6564 6261 636b 7320 3d20  ual_feedbacks = 
-0000ca10: 646f 776e 7374 7265 616d 5f6b 7761 7267  downstream_kwarg
-0000ca20: 735b 2266 6565 6462 6163 6b73 225d 0a20  s["feedbacks"]. 
-0000ca30: 2020 2061 7373 6572 7420 6163 7475 616c     assert actual
-0000ca40: 5f69 6e70 7574 7320 3d3d 205b 7b30 3a20  _inputs == [{0: 
-0000ca50: 3230 307d 2c20 7b30 3a20 3230 317d 5d0a  200}, {0: 201}].
-0000ca60: 2020 2020 6173 7365 7274 2061 6374 7561      assert actua
-0000ca70: 6c5f 6f75 7470 7574 7320 3d3d 205b 7b30  l_outputs == [{0
-0000ca80: 3a20 3330 307d 2c20 7b30 3a20 3330 317d  : 300}, {0: 301}
-0000ca90: 5d0a 2020 2020 6173 7365 7274 2061 6374  ].    assert act
-0000caa0: 7561 6c5f 6665 6564 6261 636b 7320 3d3d  ual_feedbacks ==
-0000cab0: 205b 7b30 3a20 3130 307d 2c20 7b30 3a20   [{0: 100}, {0: 
-0000cac0: 3130 317d 5d0a 0a0a 406d 6f63 6b2e 7061  101}]...@mock.pa
-0000cad0: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
-0000cae0: 6572 2e63 6c69 656e 742e 4761 6e74 7279  er.client.Gantry
-0000caf0: 2e5f 6c6f 675f 7072 6564 6963 7469 6f6e  ._log_prediction
-0000cb00: 5f61 6e64 5f66 6565 6462 6163 6b5f 6576  _and_feedback_ev
-0000cb10: 656e 7473 2229 0a64 6566 2074 6573 745f  ents").def test_
-0000cb20: 7369 6e67 6c65 5f6c 6f67 5f72 6563 6f72  single_log_recor
-0000cb30: 6473 5f70 7265 6473 5f61 6e64 5f66 6565  ds_preds_and_fee
-0000cb40: 6462 6163 6b5f 7365 7269 6573 5f63 6f65  dback_series_coe
-0000cb50: 7263 6564 280a 2020 2020 6d6f 636b 5f70  rced(.    mock_p
-0000cb60: 7265 6473 5f61 6e64 5f66 6565 6462 6163  reds_and_feedbac
-0000cb70: 6b2c 0a20 2020 2063 6c69 5f6f 626a 2c0a  k,.    cli_obj,.
-0000cb80: 293a 0a20 2020 2065 7870 6563 7465 645f  ):.    expected_
-0000cb90: 696e 7075 7473 203d 2070 642e 5365 7269  inputs = pd.Seri
-0000cba0: 6573 285b 3230 302c 2032 3031 5d29 0a20  es([200, 201]). 
-0000cbb0: 2020 2065 7870 6563 7465 645f 6f75 7470     expected_outp
-0000cbc0: 7574 7320 3d20 7064 2e53 6572 6965 7328  uts = pd.Series(
-0000cbd0: 5b33 3030 2c20 3330 315d 290a 2020 2020  [300, 301]).    
-0000cbe0: 6578 7065 6374 6564 5f66 6565 6462 6163  expected_feedbac
-0000cbf0: 6b73 203d 2070 642e 5365 7269 6573 285b  ks = pd.Series([
-0000cc00: 3130 302c 2031 3031 5d29 0a20 2020 2061  100, 101]).    a
-0000cc10: 7070 6c69 6361 7469 6f6e 203d 2022 7465  pplication = "te
-0000cc20: 7374 5f61 7070 220a 0a20 2020 2063 6c69  st_app"..    cli
-0000cc30: 5f6f 626a 2e73 696e 676c 655f 6c6f 675f  _obj.single_log_
-0000cc40: 7265 636f 7264 7328 0a20 2020 2020 2020  records(.       
-0000cc50: 2061 7070 6c69 6361 7469 6f6e 3d61 7070   application=app
-0000cc60: 6c69 6361 7469 6f6e 2c0a 2020 2020 2020  lication,.      
-0000cc70: 2020 696e 7075 7473 3d65 7870 6563 7465    inputs=expecte
-0000cc80: 645f 696e 7075 7473 2c0a 2020 2020 2020  d_inputs,.      
-0000cc90: 2020 6f75 7470 7574 733d 6578 7065 6374    outputs=expect
-0000cca0: 6564 5f6f 7574 7075 7473 2c0a 2020 2020  ed_outputs,.    
-0000ccb0: 2020 2020 6665 6564 6261 636b 733d 6578      feedbacks=ex
-0000ccc0: 7065 6374 6564 5f66 6565 6462 6163 6b73  pected_feedbacks
-0000ccd0: 2c0a 2020 2020 290a 0a20 2020 2064 6f77  ,.    )..    dow
-0000cce0: 6e73 7472 6561 6d5f 6b77 6172 6773 203d  nstream_kwargs =
-0000ccf0: 206d 6f63 6b5f 7072 6564 735f 616e 645f   mock_preds_and_
-0000cd00: 6665 6564 6261 636b 2e63 616c 6c5f 6172  feedback.call_ar
-0000cd10: 6773 2e6b 7761 7267 730a 2020 2020 6163  gs.kwargs.    ac
-0000cd20: 7475 616c 5f69 6e70 7574 7320 3d20 646f  tual_inputs = do
-0000cd30: 776e 7374 7265 616d 5f6b 7761 7267 735b  wnstream_kwargs[
-0000cd40: 2269 6e70 7574 7322 5d0a 2020 2020 6163  "inputs"].    ac
-0000cd50: 7475 616c 5f6f 7574 7075 7473 203d 2064  tual_outputs = d
-0000cd60: 6f77 6e73 7472 6561 6d5f 6b77 6172 6773  ownstream_kwargs
-0000cd70: 5b22 6f75 7470 7574 7322 5d0a 2020 2020  ["outputs"].    
-0000cd80: 6163 7475 616c 5f66 6565 6462 6163 6b73  actual_feedbacks
-0000cd90: 203d 2064 6f77 6e73 7472 6561 6d5f 6b77   = downstream_kw
-0000cda0: 6172 6773 5b22 6665 6564 6261 636b 7322  args["feedbacks"
-0000cdb0: 5d0a 2020 2020 6173 7365 7274 2061 6374  ].    assert act
-0000cdc0: 7561 6c5f 696e 7075 7473 203d 3d20 5b7b  ual_inputs == [{
-0000cdd0: 303a 2032 3030 7d2c 207b 303a 2032 3031  0: 200}, {0: 201
-0000cde0: 7d5d 0a20 2020 2061 7373 6572 7420 6163  }].    assert ac
-0000cdf0: 7475 616c 5f6f 7574 7075 7473 203d 3d20  tual_outputs == 
-0000ce00: 5b7b 303a 2033 3030 7d2c 207b 303a 2033  [{0: 300}, {0: 3
-0000ce10: 3031 7d5d 0a20 2020 2061 7373 6572 7420  01}].    assert 
-0000ce20: 6163 7475 616c 5f66 6565 6462 6163 6b73  actual_feedbacks
-0000ce30: 203d 3d20 5b7b 303a 2031 3030 7d2c 207b   == [{0: 100}, {
-0000ce40: 303a 2031 3031 7d5d 0a0a 0a40 7079 7465  0: 101}]...@pyte
-0000ce50: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
-0000ce60: 697a 6528 0a20 2020 2022 7465 7374 5f74  ize(.    "test_t
-0000ce70: 696d 6573 7461 6d70 732c 2074 6573 745f  imestamps, test_
-0000ce80: 7469 6d65 7374 616d 7073 5f6c 6973 7422  timestamps_list"
-0000ce90: 2c0a 2020 2020 5b0a 2020 2020 2020 2020  ,.    [.        
-0000cea0: 284e 6f6e 652c 204e 6f6e 6529 2c0a 2020  (None, None),.  
-0000ceb0: 2020 2020 2020 285b 4355 5252 454e 545f        ([CURRENT_
-0000cec0: 5449 4d45 5d20 2a20 322c 205b 4355 5252  TIME] * 2, [CURR
-0000ced0: 454e 545f 5449 4d45 5d20 2a20 3229 2c0a  ENT_TIME] * 2),.
-0000cee0: 2020 2020 2020 2020 286e 702e 6172 7261          (np.arra
-0000cef0: 7928 5b43 5552 5245 4e54 5f54 494d 455d  y([CURRENT_TIME]
-0000cf00: 202a 2032 292c 205b 4355 5252 454e 545f   * 2), [CURRENT_
-0000cf10: 5449 4d45 5d20 2a20 3229 2c0a 2020 2020  TIME] * 2),.    
-0000cf20: 5d2c 0a29 0a40 7079 7465 7374 2e6d 6172  ],.).@pytest.mar
-0000cf30: 6b2e 7061 7261 6d65 7472 697a 6528 0a20  k.parametrize(. 
-0000cf40: 2020 2022 7465 7374 5f66 6565 6462 6163     "test_feedbac
-0000cf50: 6b73 222c 0a20 2020 205b 0a20 2020 2020  ks",.    [.     
-0000cf60: 2020 205b 7b22 4122 3a20 3230 307d 2c20     [{"A": 200}, 
-0000cf70: 7b22 4122 3a20 3230 317d 5d2c 0a20 2020  {"A": 201}],.   
-0000cf80: 2020 2020 2070 642e 4461 7461 4672 616d       pd.DataFram
-0000cf90: 652e 6672 6f6d 5f64 6963 7428 7b22 4122  e.from_dict({"A"
-0000cfa0: 3a20 5b32 3030 2c20 3230 315d 7d29 2c0a  : [200, 201]}),.
-0000cfb0: 2020 2020 2020 2020 7064 2e53 6572 6965          pd.Serie
-0000cfc0: 7328 6e61 6d65 3d22 4122 2c20 6461 7461  s(name="A", data
-0000cfd0: 3d5b 3230 302c 2032 3031 5d29 2c0a 2020  =[200, 201]),.  
-0000cfe0: 2020 2020 2020 6e70 2e61 7272 6179 285b        np.array([
-0000cff0: 7b22 4122 3a20 3230 307d 2c20 7b22 4122  {"A": 200}, {"A"
-0000d000: 3a20 3230 317d 5d29 2c0a 2020 2020 5d2c  : 201}]),.    ],
-0000d010: 0a29 0a40 7079 7465 7374 2e6d 6172 6b2e  .).@pytest.mark.
-0000d020: 7061 7261 6d65 7472 697a 6528 0a20 2020  parametrize(.   
-0000d030: 2022 7465 7374 5f6f 7574 7075 7473 222c   "test_outputs",
-0000d040: 0a20 2020 205b 0a20 2020 2020 2020 205b  .    [.        [
-0000d050: 7b22 4222 3a20 3330 307d 2c20 7b22 4222  {"B": 300}, {"B"
-0000d060: 3a20 3330 317d 5d2c 0a20 2020 2020 2020  : 301}],.       
-0000d070: 2070 642e 4461 7461 4672 616d 652e 6672   pd.DataFrame.fr
-0000d080: 6f6d 5f64 6963 7428 7b22 4222 3a20 5b33  om_dict({"B": [3
-0000d090: 3030 2c20 3330 315d 7d29 2c0a 2020 2020  00, 301]}),.    
-0000d0a0: 2020 2020 7064 2e53 6572 6965 7328 6e61      pd.Series(na
-0000d0b0: 6d65 3d22 4222 2c20 6461 7461 3d5b 3330  me="B", data=[30
-0000d0c0: 302c 2033 3031 5d29 2c0a 2020 2020 2020  0, 301]),.      
-0000d0d0: 2020 6e70 2e61 7272 6179 285b 7b22 4222    np.array([{"B"
-0000d0e0: 3a20 3330 307d 2c20 7b22 4222 3a20 3330  : 300}, {"B": 30
-0000d0f0: 317d 5d29 2c0a 2020 2020 5d2c 0a29 0a40  1}]),.    ],.).@
-0000d100: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
-0000d110: 6d65 7472 697a 6528 0a20 2020 2022 7465  metrize(.    "te
-0000d120: 7374 5f69 6e70 7574 7322 2c0a 2020 2020  st_inputs",.    
-0000d130: 5b0a 2020 2020 2020 2020 5b7b 2241 223a  [.        [{"A":
-0000d140: 2031 3030 7d2c 207b 2241 223a 2031 3031   100}, {"A": 101
-0000d150: 7d5d 2c0a 2020 2020 2020 2020 7064 2e44  }],.        pd.D
-0000d160: 6174 6146 7261 6d65 2e66 726f 6d5f 6469  ataFrame.from_di
-0000d170: 6374 287b 2241 223a 205b 3130 302c 2031  ct({"A": [100, 1
-0000d180: 3031 5d7d 292c 0a20 2020 2020 2020 2070  01]}),.        p
-0000d190: 642e 5365 7269 6573 286e 616d 653d 2241  d.Series(name="A
-0000d1a0: 222c 2064 6174 613d 5b31 3030 2c20 3130  ", data=[100, 10
-0000d1b0: 315d 292c 0a20 2020 2020 2020 206e 702e  1]),.        np.
-0000d1c0: 6172 7261 7928 5b7b 2241 223a 2031 3030  array([{"A": 100
-0000d1d0: 7d2c 207b 2241 223a 2031 3031 7d5d 292c  }, {"A": 101}]),
-0000d1e0: 0a20 2020 205d 2c0a 290a 4070 7974 6573  .    ],.).@pytes
-0000d1f0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
-0000d200: 7a65 2822 7665 7273 696f 6e22 2c20 5b4e  ze("version", [N
-0000d210: 6f6e 652c 2031 302c 2022 312e 322e 3322  one, 10, "1.2.3"
-0000d220: 5d29 0a40 7079 7465 7374 2e6d 6172 6b2e  ]).@pytest.mark.
-0000d230: 7061 7261 6d65 7472 697a 6528 0a20 2020  parametrize(.   
-0000d240: 2022 7461 6773 2c20 726f 775f 7461 6773   "tags, row_tags
-0000d250: 2c20 676c 6f62 616c 5f74 6167 732c 2065  , global_tags, e
-0000d260: 7870 6563 7465 645f 7461 6773 5f70 6172  xpected_tags_par
-0000d270: 616d 222c 0a20 2020 205b 0a20 2020 2020  am",.    [.     
-0000d280: 2020 2028 4e6f 6e65 2c20 4e6f 6e65 2c20     (None, None, 
-0000d290: 4e6f 6e65 2c20 5b7b 2265 6e76 223a 2022  None, [{"env": "
-0000d2a0: 7465 7374 227d 2c20 7b22 656e 7622 3a20  test"}, {"env": 
-0000d2b0: 2274 6573 7422 7d5d 292c 0a20 2020 2020  "test"}]),.     
-0000d2c0: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
-0000d2d0: 207b 2262 6172 223a 2022 6261 7222 7d2c   {"bar": "bar"},
-0000d2e0: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-0000d2f0: 652c 0a20 2020 2020 2020 2020 2020 204e  e,.            N
-0000d300: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-0000d310: 205b 7b22 6261 7222 3a20 2262 6172 222c   [{"bar": "bar",
-0000d320: 2022 656e 7622 3a20 2274 6573 7422 7d2c   "env": "test"},
-0000d330: 207b 2262 6172 223a 2022 6261 7222 2c20   {"bar": "bar", 
-0000d340: 2265 6e76 223a 2022 7465 7374 227d 5d2c  "env": "test"}],
-0000d350: 0a20 2020 2020 2020 2029 2c0a 2020 2020  .        ),.    
-0000d360: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
-0000d370: 2020 7b22 6261 7222 3a20 2262 6172 227d    {"bar": "bar"}
-0000d380: 2c0a 2020 2020 2020 2020 2020 2020 4e6f  ,.            No
-0000d390: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0000d3a0: 7b22 666f 6f22 3a20 2266 6f6f 227d 2c0a  {"foo": "foo"},.
-0000d3b0: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-0000d3c0: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-0000d3d0: 6261 7222 3a20 2262 6172 222c 2022 656e  bar": "bar", "en
-0000d3e0: 7622 3a20 2274 6573 7422 2c20 2266 6f6f  v": "test", "foo
-0000d3f0: 223a 2022 666f 6f22 7d2c 0a20 2020 2020  ": "foo"},.     
-0000d400: 2020 2020 2020 2020 2020 207b 2262 6172             {"bar
-0000d410: 223a 2022 6261 7222 2c20 2265 6e76 223a  ": "bar", "env":
-0000d420: 2022 7465 7374 222c 2022 666f 6f22 3a20   "test", "foo": 
-0000d430: 2266 6f6f 227d 2c0a 2020 2020 2020 2020  "foo"},.        
-0000d440: 2020 2020 5d2c 0a20 2020 2020 2020 2029      ],.        )
-0000d450: 2c0a 2020 2020 2020 2020 280a 2020 2020  ,.        (.    
-0000d460: 2020 2020 2020 2020 5b7b 2262 6172 223a          [{"bar":
-0000d470: 2022 6261 7222 7d2c 207b 2262 6172 223a   "bar"}, {"bar":
-0000d480: 2022 6261 7a22 7d5d 2c0a 2020 2020 2020   "baz"}],.      
-0000d490: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-0000d4a0: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
-0000d4b0: 2020 2020 2020 2020 2020 5b7b 2262 6172            [{"bar
-0000d4c0: 223a 2022 6261 7222 2c20 2265 6e76 223a  ": "bar", "env":
-0000d4d0: 2022 7465 7374 227d 2c20 7b22 6261 7222   "test"}, {"bar"
-0000d4e0: 3a20 2262 617a 222c 2022 656e 7622 3a20  : "baz", "env": 
-0000d4f0: 2274 6573 7422 7d5d 2c0a 2020 2020 2020  "test"}],.      
-0000d500: 2020 292c 0a20 2020 2020 2020 2028 0a20    ),.        (. 
-0000d510: 2020 2020 2020 2020 2020 204e 6f6e 652c             None,
-0000d520: 0a20 2020 2020 2020 2020 2020 205b 7b22  .            [{"
-0000d530: 6261 7222 3a20 2262 6172 227d 2c20 7b22  bar": "bar"}, {"
-0000d540: 6261 7222 3a20 2262 617a 227d 5d2c 0a20  bar": "baz"}],. 
-0000d550: 2020 2020 2020 2020 2020 204e 6f6e 652c             None,
-0000d560: 0a20 2020 2020 2020 2020 2020 205b 7b22  .            [{"
-0000d570: 6261 7222 3a20 2262 6172 222c 2022 656e  bar": "bar", "en
-0000d580: 7622 3a20 2274 6573 7422 7d2c 207b 2262  v": "test"}, {"b
-0000d590: 6172 223a 2022 6261 7a22 2c20 2265 6e76  ar": "baz", "env
-0000d5a0: 223a 2022 7465 7374 227d 5d2c 0a20 2020  ": "test"}],.   
-0000d5b0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-0000d5c0: 280a 2020 2020 2020 2020 2020 2020 4e6f  (.            No
-0000d5d0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0000d5e0: 5b7b 2262 6172 223a 2022 6261 7222 7d2c  [{"bar": "bar"},
-0000d5f0: 207b 2262 6172 223a 2022 6261 7a22 7d5d   {"bar": "baz"}]
-0000d600: 2c0a 2020 2020 2020 2020 2020 2020 7b22  ,.            {"
-0000d610: 666f 6f22 3a20 2266 6f6f 227d 2c0a 2020  foo": "foo"},.  
-0000d620: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-0000d630: 2020 2020 2020 2020 2020 2020 7b22 6261              {"ba
-0000d640: 7222 3a20 2262 6172 222c 2022 656e 7622  r": "bar", "env"
-0000d650: 3a20 2274 6573 7422 2c20 2266 6f6f 223a  : "test", "foo":
-0000d660: 2022 666f 6f22 7d2c 0a20 2020 2020 2020   "foo"},.       
-0000d670: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-0000d680: 2022 6261 7a22 2c20 2265 6e76 223a 2022   "baz", "env": "
-0000d690: 7465 7374 222c 2022 666f 6f22 3a20 2266  test", "foo": "f
-0000d6a0: 6f6f 227d 2c0a 2020 2020 2020 2020 2020  oo"},.          
-0000d6b0: 2020 5d2c 0a20 2020 2020 2020 2029 2c0a    ],.        ),.
-0000d6c0: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
-0000d6d0: 2020 2020 2020 7b22 666f 6f22 3a20 2266        {"foo": "f
-0000d6e0: 6f6f 227d 2c0a 2020 2020 2020 2020 2020  oo"},.          
-0000d6f0: 2020 5b7b 2262 6172 223a 2022 6261 7222    [{"bar": "bar"
-0000d700: 7d2c 207b 2262 6172 223a 2022 6261 7a22  }, {"bar": "baz"
-0000d710: 7d5d 2c0a 2020 2020 2020 2020 2020 2020  }],.            
-0000d720: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0000d730: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-0000d740: 2020 2020 7b22 6261 7222 3a20 2262 6172      {"bar": "bar
-0000d750: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
-0000d760: 2c20 2266 6f6f 223a 2022 666f 6f22 7d2c  , "foo": "foo"},
-0000d770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d780: 207b 2262 6172 223a 2022 6261 7a22 2c20   {"bar": "baz", 
-0000d790: 2265 6e76 223a 2022 7465 7374 222c 2022  "env": "test", "
-0000d7a0: 666f 6f22 3a20 2266 6f6f 227d 2c0a 2020  foo": "foo"},.  
-0000d7b0: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-0000d7c0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-0000d7d0: 280a 2020 2020 2020 2020 2020 2020 7b22  (.            {"
-0000d7e0: 6261 7222 3a20 2262 6172 227d 2c0a 2020  bar": "bar"},.  
-0000d7f0: 2020 2020 2020 2020 2020 5b7b 2266 6f6f            [{"foo
-0000d800: 223a 2022 666f 6f22 7d2c 207b 2262 617a  ": "foo"}, {"baz
-0000d810: 223a 2022 6261 7a22 7d5d 2c0a 2020 2020  ": "baz"}],.    
-0000d820: 2020 2020 2020 2020 7b22 656e 7622 3a20          {"env": 
-0000d830: 2266 6f6f 6261 7222 7d2c 0a20 2020 2020  "foobar"},.     
-0000d840: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-0000d850: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-0000d860: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
-0000d870: 666f 6f62 6172 222c 2022 666f 6f22 3a20  foobar", "foo": 
-0000d880: 2266 6f6f 227d 2c0a 2020 2020 2020 2020  "foo"},.        
-0000d890: 2020 2020 2020 2020 7b22 6261 7222 3a20          {"bar": 
-0000d8a0: 2262 6172 222c 2022 656e 7622 3a20 2266  "bar", "env": "f
-0000d8b0: 6f6f 6261 7222 2c20 2262 617a 223a 2022  oobar", "baz": "
-0000d8c0: 6261 7a22 7d2c 0a20 2020 2020 2020 2020  baz"},.         
-0000d8d0: 2020 205d 2c0a 2020 2020 2020 2020 292c     ],.        ),
-0000d8e0: 0a20 2020 2020 2020 2028 0a20 2020 2020  .        (.     
-0000d8f0: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
-0000d900: 2020 2020 2020 2020 205b 7b22 6261 7222           [{"bar"
-0000d910: 3a20 2262 6172 227d 2c20 7b22 6261 7222  : "bar"}, {"bar"
-0000d920: 3a20 2262 617a 227d 5d2c 0a20 2020 2020  : "baz"}],.     
-0000d930: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
-0000d940: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
-0000d950: 2020 2020 2020 2020 2020 207b 2262 6172             {"bar
-0000d960: 223a 2022 6261 7222 2c20 2265 6e76 223a  ": "bar", "env":
-0000d970: 2022 7465 7374 227d 2c0a 2020 2020 2020   "test"},.      
-0000d980: 2020 2020 2020 2020 2020 7b22 6261 7222            {"bar"
-0000d990: 3a20 2262 617a 222c 2022 656e 7622 3a20  : "baz", "env": 
-0000d9a0: 2274 6573 7422 7d2c 0a20 2020 2020 2020  "test"},.       
-0000d9b0: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-0000d9c0: 292c 0a20 2020 2020 2020 2028 0a20 2020  ),.        (.   
-0000d9d0: 2020 2020 2020 2020 204e 6f6e 652c 0a20           None,. 
-0000d9e0: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
-0000d9f0: 7261 7928 5b7b 2262 6172 223a 2022 6261  ray([{"bar": "ba
-0000da00: 7222 7d2c 207b 2262 6172 223a 2022 6261  r"}, {"bar": "ba
-0000da10: 7a22 7d5d 292c 0a20 2020 2020 2020 2020  z"}]),.         
-0000da20: 2020 204e 6f6e 652c 0a20 2020 2020 2020     None,.       
-0000da30: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-0000da40: 2020 2020 2020 207b 2262 6172 223a 2022         {"bar": "
-0000da50: 6261 7222 2c20 2265 6e76 223a 2022 7465  bar", "env": "te
-0000da60: 7374 227d 2c0a 2020 2020 2020 2020 2020  st"},.          
-0000da70: 2020 2020 2020 7b22 6261 7222 3a20 2262        {"bar": "b
-0000da80: 617a 222c 2022 656e 7622 3a20 2274 6573  az", "env": "tes
-0000da90: 7422 7d2c 0a20 2020 2020 2020 2020 2020  t"},.           
-0000daa0: 205d 2c0a 2020 2020 2020 2020 292c 0a20   ],.        ),. 
-0000dab0: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
-0000dac0: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
-0000dad0: 2020 2020 2020 2070 642e 5365 7269 6573         pd.Series
-0000dae0: 285b 2262 6172 222c 2022 6261 7a22 5d2c  (["bar", "baz"],
-0000daf0: 206e 616d 653d 2262 6172 2229 2c0a 2020   name="bar"),.  
-0000db00: 2020 2020 2020 2020 2020 4e6f 6e65 2c0a            None,.
-0000db10: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-0000db20: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-0000db30: 6261 7222 3a20 2262 6172 222c 2022 656e  bar": "bar", "en
-0000db40: 7622 3a20 2274 6573 7422 7d2c 0a20 2020  v": "test"},.   
-0000db50: 2020 2020 2020 2020 2020 2020 207b 2262               {"b
-0000db60: 6172 223a 2022 6261 7a22 2c20 2265 6e76  ar": "baz", "env
-0000db70: 223a 2022 7465 7374 227d 2c0a 2020 2020  ": "test"},.    
-0000db80: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-0000db90: 2020 2029 2c0a 2020 2020 2020 2020 280a     ),.        (.
-0000dba0: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-0000dbb0: 2c0a 2020 2020 2020 2020 2020 2020 7064  ,.            pd
-0000dbc0: 2e44 6174 6146 7261 6d65 287b 2262 6172  .DataFrame({"bar
-0000dbd0: 223a 205b 2262 6172 222c 2022 6261 7a22  ": ["bar", "baz"
-0000dbe0: 5d7d 292c 0a20 2020 2020 2020 2020 2020  ]}),.           
-0000dbf0: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-0000dc00: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-0000dc10: 2020 2020 207b 2262 6172 223a 2022 6261       {"bar": "ba
-0000dc20: 7222 2c20 2265 6e76 223a 2022 7465 7374  r", "env": "test
-0000dc30: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-0000dc40: 2020 2020 7b22 6261 7222 3a20 2262 617a      {"bar": "baz
-0000dc50: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
-0000dc60: 7d2c 0a20 2020 2020 2020 2020 2020 205d  },.            ]
-0000dc70: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
-0000dc80: 205d 2c0a 290a 4070 7974 6573 742e 6d61   ],.).@pytest.ma
-0000dc90: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
-0000dca0: 2020 2020 226b 7761 7267 7322 2c0a 2020      "kwargs",.  
-0000dcb0: 2020 5b0a 2020 2020 2020 2020 7b22 6665    [.        {"fe
-0000dcc0: 6564 6261 636b 5f6b 6579 7322 3a20 5b22  edback_keys": ["
-0000dcd0: 4122 5d7d 2c0a 2020 2020 2020 2020 7b22  A"]},.        {"
-0000dce0: 6665 6564 6261 636b 5f69 6473 223a 205b  feedback_ids": [
-0000dcf0: 2231 3233 3435 222c 2022 3637 3839 3022  "12345", "67890"
-0000dd00: 5d7d 2c0a 2020 2020 2020 2020 7b22 6a6f  ]},.        {"jo
-0000dd10: 696e 5f6b 6579 7322 3a20 5b22 3534 3332  in_keys": ["5432
-0000dd20: 3122 2c20 2236 3738 3930 225d 7d2c 0a20  1", "67890"]},. 
-0000dd30: 2020 2020 2020 207b 226a 6f69 6e5f 6b65         {"join_ke
-0000dd40: 7973 223a 2070 642e 5365 7269 6573 285b  ys": pd.Series([
-0000dd50: 2235 3433 3231 222c 2022 3637 3839 3022  "54321", "67890"
-0000dd60: 5d29 7d2c 0a20 2020 2020 2020 207b 7d2c  ])},.        {},
-0000dd70: 0a20 2020 205d 2c0a 290a 406d 6f63 6b2e  .    ],.).@mock.
-0000dd80: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
-0000dd90: 6767 6572 2e63 6c69 656e 742e 5f72 6573  gger.client._res
-0000dda0: 6f6c 7665 5f6a 6f69 6e5f 6b65 7973 2229  olve_join_keys")
-0000ddb0: 0a40 6d6f 636b 2e70 6174 6368 280a 2020  .@mock.patch(.  
-0000ddc0: 2020 2267 616e 7472 792e 6c6f 6767 6572    "gantry.logger
-0000ddd0: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
-0000dde0: 6c6f 675f 7072 6564 6963 7469 6f6e 5f61  log_prediction_a
-0000ddf0: 6e64 5f66 6565 6462 6163 6b5f 6576 656e  nd_feedback_even
-0000de00: 7473 222c 0a20 2020 2072 6574 7572 6e5f  ts",.    return_
-0000de10: 7661 6c75 653d 284e 6f6e 652c 205b 2231  value=(None, ["1
-0000de20: 3233 3435 222c 2022 3637 3839 3022 5d29  2345", "67890"])
-0000de30: 2c0a 290a 406d 6f63 6b2e 7061 7463 6828  ,.).@mock.patch(
-0000de40: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
-0000de50: 6c69 656e 742e 4761 6e74 7279 2e5f 6c6f  lient.Gantry._lo
-0000de60: 675f 7072 6564 6963 7469 6f6e 5f65 7665  g_prediction_eve
-0000de70: 6e74 7322 290a 406d 6f63 6b2e 7061 7463  nts").@mock.patc
-0000de80: 6828 2267 616e 7472 792e 6c6f 6767 6572  h("gantry.logger
-0000de90: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
-0000dea0: 6c6f 675f 6665 6564 6261 636b 5f65 7665  log_feedback_eve
-0000deb0: 6e74 7322 290a 406d 6f63 6b2e 7061 7463  nts").@mock.patc
-0000dec0: 6828 2267 616e 7472 792e 6c6f 6767 6572  h("gantry.logger
-0000ded0: 2e63 6c69 656e 742e 5f73 616d 706c 655f  .client._sample_
-0000dee0: 7265 636f 7264 7322 2c20 7369 6465 5f65  records", side_e
-0000def0: 6666 6563 743d 636c 6965 6e74 2e5f 7361  ffect=client._sa
-0000df00: 6d70 6c65 5f72 6563 6f72 6473 290a 406d  mple_records).@m
-0000df10: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
-0000df20: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
-0000df30: 5f64 6566 6175 6c74 5f6a 6f69 6e5f 6b65  _default_join_ke
-0000df40: 795f 6765 6e22 290a 6465 6620 7465 7374  y_gen").def test
-0000df50: 5f73 696e 676c 655f 6c6f 675f 7265 636f  _single_log_reco
-0000df60: 7264 735f 7072 6564 735f 616e 645f 6665  rds_preds_and_fe
-0000df70: 6564 6261 636b 280a 2020 2020 6d6f 636b  edback(.    mock
-0000df80: 5f6a 6f69 6e5f 6b65 795f 6765 6e2c 0a20  _join_key_gen,. 
-0000df90: 2020 206d 6f63 6b5f 7361 6d70 6c65 5f72     mock_sample_r
-0000dfa0: 6563 6f72 6473 2c0a 2020 2020 6d6f 636b  ecords,.    mock
-0000dfb0: 5f66 6565 6462 6163 6b2c 0a20 2020 206d  _feedback,.    m
-0000dfc0: 6f63 6b5f 7072 6564 732c 0a20 2020 206d  ock_preds,.    m
-0000dfd0: 6f63 6b5f 7072 6564 735f 616e 645f 6665  ock_preds_and_fe
-0000dfe0: 6564 6261 636b 2c0a 2020 2020 6d6f 636b  edback,.    mock
-0000dff0: 5f72 6573 6f6c 7665 5f6a 6f69 6e5f 6b65  _resolve_join_ke
-0000e000: 7973 2c0a 2020 2020 6b77 6172 6773 2c0a  ys,.    kwargs,.
-0000e010: 2020 2020 7665 7273 696f 6e2c 0a20 2020      version,.   
-0000e020: 2074 6167 732c 0a20 2020 2072 6f77 5f74   tags,.    row_t
-0000e030: 6167 732c 0a20 2020 2067 6c6f 6261 6c5f  ags,.    global_
-0000e040: 7461 6773 2c0a 2020 2020 6578 7065 6374  tags,.    expect
-0000e050: 6564 5f74 6167 735f 7061 7261 6d2c 0a20  ed_tags_param,. 
-0000e060: 2020 2074 6573 745f 7469 6d65 7374 616d     test_timestam
-0000e070: 7073 2c0a 2020 2020 7465 7374 5f74 696d  ps,.    test_tim
-0000e080: 6573 7461 6d70 735f 6c69 7374 2c0a 2020  estamps_list,.  
-0000e090: 2020 7465 7374 5f69 6e70 7574 732c 0a20    test_inputs,. 
-0000e0a0: 2020 2074 6573 745f 6f75 7470 7574 732c     test_outputs,
-0000e0b0: 0a20 2020 2074 6573 745f 6665 6564 6261  .    test_feedba
-0000e0c0: 636b 732c 0a20 2020 2063 6c69 5f6f 626a  cks,.    cli_obj
-0000e0d0: 2c0a 293a 0a20 2020 206d 6f63 6b5f 6a6f  ,.):.    mock_jo
-0000e0e0: 696e 5f6b 6579 5f67 656e 2e73 6964 655f  in_key_gen.side_
-0000e0f0: 6566 6665 6374 203d 205b 2236 3738 3930  effect = ["67890
-0000e100: 222c 2022 3132 3334 3522 5d0a 2020 2020  ", "12345"].    
-0000e110: 6d6f 636b 5f72 6573 6f6c 7665 5f6a 6f69  mock_resolve_joi
-0000e120: 6e5f 6b65 7973 2e72 6574 7572 6e5f 7661  n_keys.return_va
-0000e130: 6c75 6520 3d20 5b22 3132 3334 3522 2c20  lue = ["12345", 
-0000e140: 2236 3738 3930 225d 2069 6620 6b77 6172  "67890"] if kwar
-0000e150: 6773 2065 6c73 6520 4e6f 6e65 0a20 2020  gs else None.   
-0000e160: 2061 7373 6572 7420 636c 695f 6f62 6a2e   assert cli_obj.
-0000e170: 7369 6e67 6c65 5f6c 6f67 5f72 6563 6f72  single_log_recor
-0000e180: 6473 280a 2020 2020 2020 2020 6170 706c  ds(.        appl
-0000e190: 6963 6174 696f 6e3d 2266 6f6f 6261 7222  ication="foobar"
-0000e1a0: 2c0a 2020 2020 2020 2020 7665 7273 696f  ,.        versio
-0000e1b0: 6e3d 7665 7273 696f 6e2c 0a20 2020 2020  n=version,.     
-0000e1c0: 2020 2069 6e70 7574 733d 7465 7374 5f69     inputs=test_i
-0000e1d0: 6e70 7574 732c 0a20 2020 2020 2020 206f  nputs,.        o
-0000e1e0: 7574 7075 7473 3d74 6573 745f 6f75 7470  utputs=test_outp
-0000e1f0: 7574 732c 0a20 2020 2020 2020 2066 6565  uts,.        fee
-0000e200: 6462 6163 6b73 3d74 6573 745f 6665 6564  dbacks=test_feed
-0000e210: 6261 636b 732c 0a20 2020 2020 2020 2074  backs,.        t
-0000e220: 696d 6573 7461 6d70 733d 7465 7374 5f74  imestamps=test_t
-0000e230: 696d 6573 7461 6d70 732c 0a20 2020 2020  imestamps,.     
-0000e240: 2020 2073 6f72 745f 6f6e 5f74 696d 6573     sort_on_times
-0000e250: 7461 6d70 3d54 7275 652c 0a20 2020 2020  tamp=True,.     
-0000e260: 2020 2073 616d 706c 655f 7261 7465 3d31     sample_rate=1
-0000e270: 2c0a 2020 2020 2020 2020 7461 6773 3d74  ,.        tags=t
-0000e280: 6167 732c 0a20 2020 2020 2020 2072 6f77  ags,.        row
-0000e290: 5f74 6167 733d 726f 775f 7461 6773 2c0a  _tags=row_tags,.
-0000e2a0: 2020 2020 2020 2020 676c 6f62 616c 5f74          global_t
-0000e2b0: 6167 733d 676c 6f62 616c 5f74 6167 732c  ags=global_tags,
-0000e2c0: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
-0000e2d0: 732c 0a20 2020 2029 203d 3d20 284e 6f6e  s,.    ) == (Non
-0000e2e0: 652c 205b 2231 3233 3435 222c 2022 3637  e, ["12345", "67
-0000e2f0: 3839 3022 5d29 0a0a 2020 2020 6d6f 636b  890"])..    mock
-0000e300: 5f70 7265 6473 5f61 6e64 5f66 6565 6462  _preds_and_feedb
-0000e310: 6163 6b2e 6173 7365 7274 5f63 616c 6c65  ack.assert_calle
-0000e320: 645f 6f6e 6365 5f77 6974 6828 0a20 2020  d_once_with(.   
-0000e330: 2020 2020 2061 7070 6c69 6361 7469 6f6e       application
-0000e340: 3d22 666f 6f62 6172 222c 0a20 2020 2020  ="foobar",.     
-0000e350: 2020 2069 6e70 7574 733d 5b7b 2241 223a     inputs=[{"A":
-0000e360: 2031 3030 7d2c 207b 2241 223a 2031 3031   100}, {"A": 101
-0000e370: 7d5d 2c0a 2020 2020 2020 2020 6f75 7470  }],.        outp
-0000e380: 7574 733d 5b7b 2242 223a 2033 3030 7d2c  uts=[{"B": 300},
-0000e390: 207b 2242 223a 2033 3031 7d5d 2c0a 2020   {"B": 301}],.  
-0000e3a0: 2020 2020 2020 6665 6564 6261 636b 733d        feedbacks=
-0000e3b0: 5b7b 2241 223a 2032 3030 7d2c 207b 2241  [{"A": 200}, {"A
-0000e3c0: 223a 2032 3031 7d5d 2c0a 2020 2020 2020  ": 201}],.      
-0000e3d0: 2020 6a6f 696e 5f6b 6579 733d 5b22 3132    join_keys=["12
-0000e3e0: 3334 3522 2c20 2236 3738 3930 225d 2069  345", "67890"] i
-0000e3f0: 6620 6b77 6172 6773 2065 6c73 6520 5b22  f kwargs else ["
-0000e400: 3637 3839 3022 2c20 2231 3233 3435 225d  67890", "12345"]
-0000e410: 2c0a 2020 2020 2020 2020 7665 7273 696f  ,.        versio
-0000e420: 6e3d 7665 7273 696f 6e2c 0a20 2020 2020  n=version,.     
-0000e430: 2020 2069 676e 6f72 655f 696e 7075 7473     ignore_inputs
-0000e440: 3d4e 6f6e 652c 0a20 2020 2020 2020 2074  =None,.        t
-0000e450: 696d 6573 7461 6d70 733d 7465 7374 5f74  imestamps=test_t
-0000e460: 696d 6573 7461 6d70 735f 6c69 7374 2c0a  imestamps_list,.
-0000e470: 2020 2020 2020 2020 736f 7274 5f6f 6e5f          sort_on_
-0000e480: 7469 6d65 7374 616d 703d 5472 7565 2c0a  timestamp=True,.
-0000e490: 2020 2020 2020 2020 6173 5f62 6174 6368          as_batch
-0000e4a0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-0000e4b0: 7461 6773 3d65 7870 6563 7465 645f 7461  tags=expected_ta
-0000e4c0: 6773 5f70 6172 616d 2c0a 2020 2020 290a  gs_param,.    ).
-0000e4d0: 2020 2020 6d6f 636b 5f70 7265 6473 2e61      mock_preds.a
-0000e4e0: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
-0000e4f0: 2829 0a20 2020 206d 6f63 6b5f 6665 6564  ().    mock_feed
-0000e500: 6261 636b 2e61 7373 6572 745f 6e6f 745f  back.assert_not_
-0000e510: 6361 6c6c 6564 2829 0a0a 2020 2020 6d6f  called()..    mo
-0000e520: 636b 5f73 616d 706c 655f 7265 636f 7264  ck_sample_record
-0000e530: 732e 6173 7365 7274 5f63 616c 6c65 645f  s.assert_called_
-0000e540: 6f6e 6365 5f77 6974 6828 0a20 2020 2020  once_with(.     
-0000e550: 2020 2032 2c0a 2020 2020 2020 2020 312c     2,.        1,
-0000e560: 0a20 2020 2020 2020 205b 7b22 4122 3a20  .        [{"A": 
-0000e570: 3130 307d 2c20 7b22 4122 3a20 3130 317d  100}, {"A": 101}
-0000e580: 5d2c 0a20 2020 2020 2020 205b 7b22 4222  ],.        [{"B"
-0000e590: 3a20 3330 307d 2c20 7b22 4222 3a20 3330  : 300}, {"B": 30
-0000e5a0: 317d 5d2c 0a20 2020 2020 2020 205b 7b22  1}],.        [{"
-0000e5b0: 4122 3a20 3230 307d 2c20 7b22 4122 3a20  A": 200}, {"A": 
-0000e5c0: 3230 317d 5d2c 0a20 2020 2020 2020 2063  201}],.        c
-0000e5d0: 6c69 656e 742e 5f72 6573 6f6c 7665 5f6a  lient._resolve_j
-0000e5e0: 6f69 6e5f 6b65 7973 282a 2a6b 7761 7267  oin_keys(**kwarg
-0000e5f0: 7329 2c0a 2020 2020 2020 2020 7465 7374  s),.        test
-0000e600: 5f74 696d 6573 7461 6d70 735f 6c69 7374  _timestamps_list
-0000e610: 2c0a 2020 2020 2020 2020 6578 7065 6374  ,.        expect
-0000e620: 6564 5f74 6167 735f 7061 7261 6d2c 0a20  ed_tags_param,. 
-0000e630: 2020 2029 0a0a 2020 2020 6966 206b 7761     )..    if kwa
-0000e640: 7267 733a 0a20 2020 2020 2020 206d 6f63  rgs:.        moc
-0000e650: 6b5f 6a6f 696e 5f6b 6579 5f67 656e 2e61  k_join_key_gen.a
-0000e660: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
-0000e670: 2829 0a20 2020 2065 6c73 653a 0a20 2020  ().    else:.   
-0000e680: 2020 2020 206d 6f63 6b5f 6a6f 696e 5f6b       mock_join_k
-0000e690: 6579 5f67 656e 2e61 7373 6572 745f 6361  ey_gen.assert_ca
-0000e6a0: 6c6c 6564 2829 0a0a 0a40 7079 7465 7374  lled()...@pytest
-0000e6b0: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
-0000e6c0: 6528 0a20 2020 2022 7465 7374 5f74 696d  e(.    "test_tim
-0000e6d0: 6573 7461 6d70 732c 2074 6573 745f 7469  estamps, test_ti
-0000e6e0: 6d65 7374 616d 7073 5f6c 6973 7422 2c0a  mestamps_list",.
-0000e6f0: 2020 2020 5b0a 2020 2020 2020 2020 284e      [.        (N
-0000e700: 6f6e 652c 204e 6f6e 6529 2c0a 2020 2020  one, None),.    
-0000e710: 2020 2020 285b 4355 5252 454e 545f 5449      ([CURRENT_TI
-0000e720: 4d45 5d20 2a20 322c 205b 4355 5252 454e  ME] * 2, [CURREN
-0000e730: 545f 5449 4d45 5d20 2a20 3229 2c0a 2020  T_TIME] * 2),.  
-0000e740: 2020 2020 2020 286e 702e 6172 7261 7928        (np.array(
-0000e750: 5b43 5552 5245 4e54 5f54 494d 455d 202a  [CURRENT_TIME] *
-0000e760: 2032 292c 205b 4355 5252 454e 545f 5449   2), [CURRENT_TI
-0000e770: 4d45 5d20 2a20 3229 2c0a 2020 2020 5d2c  ME] * 2),.    ],
-0000e780: 0a29 0a40 7079 7465 7374 2e6d 6172 6b2e  .).@pytest.mark.
-0000e790: 7061 7261 6d65 7472 697a 6528 0a20 2020  parametrize(.   
-0000e7a0: 2022 7465 7374 5f66 6565 6462 6163 6b73   "test_feedbacks
-0000e7b0: 222c 0a20 2020 205b 0a20 2020 2020 2020  ",.    [.       
-0000e7c0: 205b 7b22 4122 3a20 3230 307d 2c20 7b22   [{"A": 200}, {"
-0000e7d0: 4122 3a20 3230 317d 5d2c 0a20 2020 2020  A": 201}],.     
-0000e7e0: 2020 2070 642e 4461 7461 4672 616d 652e     pd.DataFrame.
-0000e7f0: 6672 6f6d 5f64 6963 7428 7b22 4122 3a20  from_dict({"A": 
-0000e800: 5b32 3030 2c20 3230 315d 7d29 2c0a 2020  [200, 201]}),.  
-0000e810: 2020 2020 2020 7064 2e53 6572 6965 7328        pd.Series(
-0000e820: 6e61 6d65 3d22 4122 2c20 6461 7461 3d5b  name="A", data=[
-0000e830: 3230 302c 2032 3031 5d29 2c0a 2020 2020  200, 201]),.    
-0000e840: 2020 2020 6e70 2e61 7272 6179 285b 7b22      np.array([{"
-0000e850: 4122 3a20 3230 307d 2c20 7b22 4122 3a20  A": 200}, {"A": 
-0000e860: 3230 317d 5d29 2c0a 2020 2020 5d2c 0a29  201}]),.    ],.)
-0000e870: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
-0000e880: 7261 6d65 7472 697a 6528 0a20 2020 2022  rametrize(.    "
-0000e890: 7465 7374 5f6f 7574 7075 7473 222c 0a20  test_outputs",. 
-0000e8a0: 2020 205b 0a20 2020 2020 2020 205b 7b22     [.        [{"
-0000e8b0: 4222 3a20 3330 307d 2c20 7b22 4222 3a20  B": 300}, {"B": 
-0000e8c0: 3330 317d 5d2c 0a20 2020 2020 2020 2070  301}],.        p
-0000e8d0: 642e 4461 7461 4672 616d 652e 6672 6f6d  d.DataFrame.from
-0000e8e0: 5f64 6963 7428 7b22 4222 3a20 5b33 3030  _dict({"B": [300
-0000e8f0: 2c20 3330 315d 7d29 2c0a 2020 2020 2020  , 301]}),.      
-0000e900: 2020 7064 2e53 6572 6965 7328 6e61 6d65    pd.Series(name
-0000e910: 3d22 4222 2c20 6461 7461 3d5b 3330 302c  ="B", data=[300,
-0000e920: 2033 3031 5d29 2c0a 2020 2020 2020 2020   301]),.        
-0000e930: 6e70 2e61 7272 6179 285b 7b22 4222 3a20  np.array([{"B": 
-0000e940: 3330 307d 2c20 7b22 4222 3a20 3330 317d  300}, {"B": 301}
-0000e950: 5d29 2c0a 2020 2020 5d2c 0a29 0a40 7079  ]),.    ],.).@py
-0000e960: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
-0000e970: 7472 697a 6528 0a20 2020 2022 7465 7374  trize(.    "test
-0000e980: 5f69 6e70 7574 7322 2c0a 2020 2020 5b0a  _inputs",.    [.
-0000e990: 2020 2020 2020 2020 5b7b 2241 223a 2031          [{"A": 1
-0000e9a0: 3030 7d2c 207b 2241 223a 2031 3031 7d5d  00}, {"A": 101}]
-0000e9b0: 2c0a 2020 2020 2020 2020 7064 2e44 6174  ,.        pd.Dat
-0000e9c0: 6146 7261 6d65 2e66 726f 6d5f 6469 6374  aFrame.from_dict
-0000e9d0: 287b 2241 223a 205b 3130 302c 2031 3031  ({"A": [100, 101
-0000e9e0: 5d7d 292c 0a20 2020 2020 2020 2070 642e  ]}),.        pd.
-0000e9f0: 5365 7269 6573 286e 616d 653d 2241 222c  Series(name="A",
-0000ea00: 2064 6174 613d 5b31 3030 2c20 3130 315d   data=[100, 101]
-0000ea10: 292c 0a20 2020 2020 2020 206e 702e 6172  ),.        np.ar
-0000ea20: 7261 7928 5b7b 2241 223a 2031 3030 7d2c  ray([{"A": 100},
-0000ea30: 207b 2241 223a 2031 3031 7d5d 292c 0a20   {"A": 101}]),. 
-0000ea40: 2020 205d 2c0a 290a 4070 7974 6573 742e     ],.).@pytest.
-0000ea50: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-0000ea60: 2822 7665 7273 696f 6e22 2c20 5b4e 6f6e  ("version", [Non
-0000ea70: 652c 2031 302c 2022 312e 322e 3322 5d29  e, 10, "1.2.3"])
-0000ea80: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
-0000ea90: 7261 6d65 7472 697a 6528 0a20 2020 2022  rametrize(.    "
-0000eaa0: 7461 6773 2c20 726f 775f 7461 6773 2c20  tags, row_tags, 
-0000eab0: 676c 6f62 616c 5f74 6167 732c 2065 7870  global_tags, exp
-0000eac0: 6563 7465 645f 7461 6773 5f70 6172 616d  ected_tags_param
-0000ead0: 222c 0a20 2020 205b 0a20 2020 2020 2020  ",.    [.       
-0000eae0: 2028 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f   (None, None, No
-0000eaf0: 6e65 2c20 5b7b 2265 6e76 223a 2022 7465  ne, [{"env": "te
-0000eb00: 7374 227d 2c20 7b22 656e 7622 3a20 2274  st"}, {"env": "t
-0000eb10: 6573 7422 7d5d 292c 0a20 2020 2020 2020  est"}]),.       
-0000eb20: 2028 0a20 2020 2020 2020 2020 2020 207b   (.            {
-0000eb30: 2262 6172 223a 2022 6261 7222 7d2c 0a20  "bar": "bar"},. 
-0000eb40: 2020 2020 2020 2020 2020 204e 6f6e 652c             None,
-0000eb50: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-0000eb60: 652c 0a20 2020 2020 2020 2020 2020 205b  e,.            [
-0000eb70: 7b22 6261 7222 3a20 2262 6172 222c 2022  {"bar": "bar", "
-0000eb80: 656e 7622 3a20 2274 6573 7422 7d2c 207b  env": "test"}, {
-0000eb90: 2262 6172 223a 2022 6261 7222 2c20 2265  "bar": "bar", "e
-0000eba0: 6e76 223a 2022 7465 7374 227d 5d2c 0a20  nv": "test"}],. 
-0000ebb0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-0000ebc0: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-0000ebd0: 7b22 6261 7222 3a20 2262 6172 227d 2c0a  {"bar": "bar"},.
-0000ebe0: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-0000ebf0: 2c0a 2020 2020 2020 2020 2020 2020 7b22  ,.            {"
-0000ec00: 666f 6f22 3a20 2266 6f6f 227d 2c0a 2020  foo": "foo"},.  
-0000ec10: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-0000ec20: 2020 2020 2020 2020 2020 2020 7b22 6261              {"ba
-0000ec30: 7222 3a20 2262 6172 222c 2022 656e 7622  r": "bar", "env"
-0000ec40: 3a20 2274 6573 7422 2c20 2266 6f6f 223a  : "test", "foo":
-0000ec50: 2022 666f 6f22 7d2c 0a20 2020 2020 2020   "foo"},.       
-0000ec60: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-0000ec70: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
-0000ec80: 7465 7374 222c 2022 666f 6f22 3a20 2266  test", "foo": "f
-0000ec90: 6f6f 227d 2c0a 2020 2020 2020 2020 2020  oo"},.          
-0000eca0: 2020 5d2c 0a20 2020 2020 2020 2029 2c0a    ],.        ),.
-0000ecb0: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
-0000ecc0: 2020 2020 2020 5b7b 2262 6172 223a 2022        [{"bar": "
-0000ecd0: 6261 7222 7d2c 207b 2262 6172 223a 2022  bar"}, {"bar": "
-0000ece0: 6261 7a22 7d5d 2c0a 2020 2020 2020 2020  baz"}],.        
-0000ecf0: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
-0000ed00: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-0000ed10: 2020 2020 2020 2020 5b7b 2262 6172 223a          [{"bar":
-0000ed20: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
-0000ed30: 7465 7374 227d 2c20 7b22 6261 7222 3a20  test"}, {"bar": 
-0000ed40: 2262 617a 222c 2022 656e 7622 3a20 2274  "baz", "env": "t
-0000ed50: 6573 7422 7d5d 2c0a 2020 2020 2020 2020  est"}],.        
-0000ed60: 292c 0a20 2020 2020 2020 2028 0a20 2020  ),.        (.   
-0000ed70: 2020 2020 2020 2020 204e 6f6e 652c 0a20           None,. 
-0000ed80: 2020 2020 2020 2020 2020 205b 7b22 6261             [{"ba
-0000ed90: 7222 3a20 2262 6172 227d 2c20 7b22 6261  r": "bar"}, {"ba
-0000eda0: 7222 3a20 2262 617a 227d 5d2c 0a20 2020  r": "baz"}],.   
-0000edb0: 2020 2020 2020 2020 204e 6f6e 652c 0a20           None,. 
-0000edc0: 2020 2020 2020 2020 2020 205b 7b22 6261             [{"ba
-0000edd0: 7222 3a20 2262 6172 222c 2022 656e 7622  r": "bar", "env"
-0000ede0: 3a20 2274 6573 7422 7d2c 207b 2262 6172  : "test"}, {"bar
-0000edf0: 223a 2022 6261 7a22 2c20 2265 6e76 223a  ": "baz", "env":
-0000ee00: 2022 7465 7374 227d 5d2c 0a20 2020 2020   "test"}],.     
-0000ee10: 2020 2029 2c0a 2020 2020 2020 2020 280a     ),.        (.
-0000ee20: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-0000ee30: 2c0a 2020 2020 2020 2020 2020 2020 5b7b  ,.            [{
-0000ee40: 2262 6172 223a 2022 6261 7222 7d2c 207b  "bar": "bar"}, {
-0000ee50: 2262 6172 223a 2022 6261 7a22 7d5d 2c0a  "bar": "baz"}],.
-0000ee60: 2020 2020 2020 2020 2020 2020 7b22 666f              {"fo
-0000ee70: 6f22 3a20 2266 6f6f 227d 2c0a 2020 2020  o": "foo"},.    
-0000ee80: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-0000ee90: 2020 2020 2020 2020 2020 7b22 6261 7222            {"bar"
-0000eea0: 3a20 2262 6172 222c 2022 656e 7622 3a20  : "bar", "env": 
-0000eeb0: 2274 6573 7422 2c20 2266 6f6f 223a 2022  "test", "foo": "
-0000eec0: 666f 6f22 7d2c 0a20 2020 2020 2020 2020  foo"},.         
-0000eed0: 2020 2020 2020 207b 2262 6172 223a 2022         {"bar": "
-0000eee0: 6261 7a22 2c20 2265 6e76 223a 2022 7465  baz", "env": "te
-0000eef0: 7374 222c 2022 666f 6f22 3a20 2266 6f6f  st", "foo": "foo
-0000ef00: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-0000ef10: 5d2c 0a20 2020 2020 2020 2029 2c0a 2020  ],.        ),.  
-0000ef20: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-0000ef30: 2020 2020 7b22 666f 6f22 3a20 2266 6f6f      {"foo": "foo
-0000ef40: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-0000ef50: 5b7b 2262 6172 223a 2022 6261 7222 7d2c  [{"bar": "bar"},
-0000ef60: 207b 2262 6172 223a 2022 6261 7a22 7d5d   {"bar": "baz"}]
-0000ef70: 2c0a 2020 2020 2020 2020 2020 2020 4e6f  ,.            No
-0000ef80: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0000ef90: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0000efa0: 2020 7b22 6261 7222 3a20 2262 6172 222c    {"bar": "bar",
-0000efb0: 2022 656e 7622 3a20 2274 6573 7422 2c20   "env": "test", 
-0000efc0: 2266 6f6f 223a 2022 666f 6f22 7d2c 0a20  "foo": "foo"},. 
-0000efd0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0000efe0: 2262 6172 223a 2022 6261 7a22 2c20 2265  "bar": "baz", "e
-0000eff0: 6e76 223a 2022 7465 7374 222c 2022 666f  nv": "test", "fo
-0000f000: 6f22 3a20 2266 6f6f 227d 2c0a 2020 2020  o": "foo"},.    
-0000f010: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-0000f020: 2020 2029 2c0a 2020 2020 2020 2020 280a     ),.        (.
-0000f030: 2020 2020 2020 2020 2020 2020 7b22 6261              {"ba
-0000f040: 7222 3a20 2262 6172 227d 2c0a 2020 2020  r": "bar"},.    
-0000f050: 2020 2020 2020 2020 5b7b 2266 6f6f 223a          [{"foo":
-0000f060: 2022 666f 6f22 7d2c 207b 2262 617a 223a   "foo"}, {"baz":
-0000f070: 2022 6261 7a22 7d5d 2c0a 2020 2020 2020   "baz"}],.      
-0000f080: 2020 2020 2020 7b22 656e 7622 3a20 2266        {"env": "f
-0000f090: 6f6f 6261 7222 7d2c 0a20 2020 2020 2020  oobar"},.       
-0000f0a0: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-0000f0b0: 2020 2020 2020 207b 2262 6172 223a 2022         {"bar": "
-0000f0c0: 6261 7222 2c20 2265 6e76 223a 2022 666f  bar", "env": "fo
-0000f0d0: 6f62 6172 222c 2022 666f 6f22 3a20 2266  obar", "foo": "f
-0000f0e0: 6f6f 227d 2c0a 2020 2020 2020 2020 2020  oo"},.          
-0000f0f0: 2020 2020 2020 7b22 6261 7222 3a20 2262        {"bar": "b
-0000f100: 6172 222c 2022 656e 7622 3a20 2266 6f6f  ar", "env": "foo
-0000f110: 6261 7222 2c20 2262 617a 223a 2022 6261  bar", "baz": "ba
-0000f120: 7a22 7d2c 0a20 2020 2020 2020 2020 2020  z"},.           
-0000f130: 205d 2c0a 2020 2020 2020 2020 292c 0a20   ],.        ),. 
-0000f140: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
-0000f150: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
-0000f160: 2020 2020 2020 205b 7b22 6261 7222 3a20         [{"bar": 
-0000f170: 2262 6172 227d 2c20 7b22 6261 7222 3a20  "bar"}, {"bar": 
-0000f180: 2262 617a 227d 5d2c 0a20 2020 2020 2020  "baz"}],.       
-0000f190: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
-0000f1a0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-0000f1b0: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-0000f1c0: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
-0000f1d0: 7465 7374 227d 2c0a 2020 2020 2020 2020  test"},.        
-0000f1e0: 2020 2020 2020 2020 7b22 6261 7222 3a20          {"bar": 
-0000f1f0: 2262 617a 222c 2022 656e 7622 3a20 2274  "baz", "env": "t
-0000f200: 6573 7422 7d2c 0a20 2020 2020 2020 2020  est"},.         
-0000f210: 2020 205d 2c0a 2020 2020 2020 2020 292c     ],.        ),
-0000f220: 0a20 2020 2020 2020 2028 0a20 2020 2020  .        (.     
-0000f230: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
-0000f240: 2020 2020 2020 2020 206e 702e 6172 7261           np.arra
-0000f250: 7928 5b7b 2262 6172 223a 2022 6261 7222  y([{"bar": "bar"
-0000f260: 7d2c 207b 2262 6172 223a 2022 6261 7a22  }, {"bar": "baz"
-0000f270: 7d5d 292c 0a20 2020 2020 2020 2020 2020  }]),.           
-0000f280: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-0000f290: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-0000f2a0: 2020 2020 207b 2262 6172 223a 2022 6261       {"bar": "ba
-0000f2b0: 7222 2c20 2265 6e76 223a 2022 7465 7374  r", "env": "test
-0000f2c0: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-0000f2d0: 2020 2020 7b22 6261 7222 3a20 2262 617a      {"bar": "baz
-0000f2e0: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
-0000f2f0: 7d2c 0a20 2020 2020 2020 2020 2020 205d  },.            ]
-0000f300: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
-0000f310: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
-0000f320: 2020 204e 6f6e 652c 0a20 2020 2020 2020     None,.       
-0000f330: 2020 2020 2070 642e 5365 7269 6573 285b       pd.Series([
-0000f340: 2262 6172 222c 2022 6261 7a22 5d2c 206e  "bar", "baz"], n
-0000f350: 616d 653d 2262 6172 2229 2c0a 2020 2020  ame="bar"),.    
-0000f360: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
-0000f370: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-0000f380: 2020 2020 2020 2020 2020 2020 7b22 6261              {"ba
-0000f390: 7222 3a20 2262 6172 222c 2022 656e 7622  r": "bar", "env"
-0000f3a0: 3a20 2274 6573 7422 7d2c 0a20 2020 2020  : "test"},.     
-0000f3b0: 2020 2020 2020 2020 2020 207b 2262 6172             {"bar
-0000f3c0: 223a 2022 6261 7a22 2c20 2265 6e76 223a  ": "baz", "env":
-0000f3d0: 2022 7465 7374 227d 2c0a 2020 2020 2020   "test"},.      
-0000f3e0: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-0000f3f0: 2029 2c0a 2020 2020 2020 2020 280a 2020   ),.        (.  
-0000f400: 2020 2020 2020 2020 2020 4e6f 6e65 2c0a            None,.
-0000f410: 2020 2020 2020 2020 2020 2020 7064 2e44              pd.D
-0000f420: 6174 6146 7261 6d65 287b 2262 6172 223a  ataFrame({"bar":
-0000f430: 205b 2262 6172 222c 2022 6261 7a22 5d7d   ["bar", "baz"]}
-0000f440: 292c 0a20 2020 2020 2020 2020 2020 204e  ),.            N
-0000f450: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-0000f460: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-0000f470: 2020 207b 2262 6172 223a 2022 6261 7222     {"bar": "bar"
-0000f480: 2c20 2265 6e76 223a 2022 7465 7374 227d  , "env": "test"}
-0000f490: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000f4a0: 2020 7b22 6261 7222 3a20 2262 617a 222c    {"bar": "baz",
-0000f4b0: 2022 656e 7622 3a20 2274 6573 7422 7d2c   "env": "test"},
-0000f4c0: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
-0000f4d0: 2020 2020 2020 2020 292c 0a20 2020 205d          ),.    ]
-0000f4e0: 2c0a 290a 4070 7974 6573 742e 6d61 726b  ,.).@pytest.mark
-0000f4f0: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
-0000f500: 2020 226b 7761 7267 7322 2c0a 2020 2020    "kwargs",.    
-0000f510: 5b0a 2020 2020 2020 2020 7b22 6665 6564  [.        {"feed
-0000f520: 6261 636b 5f6b 6579 7322 3a20 5b22 4122  back_keys": ["A"
-0000f530: 5d7d 2c0a 2020 2020 2020 2020 7b22 6665  ]},.        {"fe
-0000f540: 6564 6261 636b 5f69 6473 223a 205b 2231  edback_ids": ["1
-0000f550: 3233 3435 222c 2022 3637 3839 3022 5d7d  2345", "67890"]}
-0000f560: 2c0a 2020 2020 2020 2020 7b22 6a6f 696e  ,.        {"join
-0000f570: 5f6b 6579 7322 3a20 5b22 3534 3332 3122  _keys": ["54321"
-0000f580: 2c20 2236 3738 3930 225d 7d2c 0a20 2020  , "67890"]},.   
-0000f590: 2020 2020 207b 226a 6f69 6e5f 6b65 7973       {"join_keys
-0000f5a0: 223a 2070 642e 5365 7269 6573 285b 2235  ": pd.Series(["5
-0000f5b0: 3433 3231 222c 2022 3637 3839 3022 5d29  4321", "67890"])
-0000f5c0: 7d2c 0a20 2020 2020 2020 207b 7d2c 0a20  },.        {},. 
-0000f5d0: 2020 205d 2c0a 290a 406d 6f63 6b2e 7061     ],.).@mock.pa
-0000f5e0: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
-0000f5f0: 6572 2e63 6c69 656e 742e 5f72 6573 6f6c  er.client._resol
-0000f600: 7665 5f6a 6f69 6e5f 6b65 7973 2229 0a40  ve_join_keys").@
-0000f610: 6d6f 636b 2e70 6174 6368 280a 2020 2020  mock.patch(.    
-0000f620: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
-0000f630: 6c69 656e 742e 4761 6e74 7279 2e5f 6c6f  lient.Gantry._lo
-0000f640: 675f 7072 6564 6963 7469 6f6e 5f61 6e64  g_prediction_and
-0000f650: 5f66 6565 6462 6163 6b5f 6576 656e 7473  _feedback_events
-0000f660: 222c 0a20 2020 2072 6574 7572 6e5f 7661  ",.    return_va
-0000f670: 6c75 653d 284e 6f6e 652c 205b 2231 3233  lue=(None, ["123
-0000f680: 3435 222c 2022 3637 3839 3022 5d29 2c0a  45", "67890"]),.
-0000f690: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
-0000f6a0: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
-0000f6b0: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
-0000f6c0: 7072 6564 6963 7469 6f6e 5f65 7665 6e74  prediction_event
-0000f6d0: 7322 290a 406d 6f63 6b2e 7061 7463 6828  s").@mock.patch(
-0000f6e0: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
-0000f6f0: 6c69 656e 742e 4761 6e74 7279 2e5f 6c6f  lient.Gantry._lo
-0000f700: 675f 6665 6564 6261 636b 5f65 7665 6e74  g_feedback_event
-0000f710: 7322 290a 406d 6f63 6b2e 7061 7463 6828  s").@mock.patch(
-0000f720: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
-0000f730: 6c69 656e 742e 5f73 616d 706c 655f 7265  lient._sample_re
-0000f740: 636f 7264 7322 2c20 7369 6465 5f65 6666  cords", side_eff
-0000f750: 6563 743d 636c 6965 6e74 2e5f 7361 6d70  ect=client._samp
-0000f760: 6c65 5f72 6563 6f72 6473 290a 406d 6f63  le_records).@moc
-0000f770: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
-0000f780: 6c6f 6767 6572 2e63 6c69 656e 742e 5f64  logger.client._d
-0000f790: 6566 6175 6c74 5f6a 6f69 6e5f 6b65 795f  efault_join_key_
-0000f7a0: 6765 6e22 290a 6465 6620 7465 7374 5f6c  gen").def test_l
-0000f7b0: 6f67 5f72 6563 6f72 6473 5f70 7265 6473  og_records_preds
-0000f7c0: 5f61 6e64 5f66 6565 6462 6163 6b28 0a20  _and_feedback(. 
-0000f7d0: 2020 206d 6f63 6b5f 6a6f 696e 5f6b 6579     mock_join_key
-0000f7e0: 5f67 656e 2c0a 2020 2020 6d6f 636b 5f73  _gen,.    mock_s
-0000f7f0: 616d 706c 655f 7265 636f 7264 732c 0a20  ample_records,. 
-0000f800: 2020 206d 6f63 6b5f 6665 6564 6261 636b     mock_feedback
-0000f810: 2c0a 2020 2020 6d6f 636b 5f70 7265 6473  ,.    mock_preds
-0000f820: 2c0a 2020 2020 6d6f 636b 5f70 7265 6473  ,.    mock_preds
-0000f830: 5f61 6e64 5f66 6565 6462 6163 6b2c 0a20  _and_feedback,. 
-0000f840: 2020 206d 6f63 6b5f 7265 736f 6c76 655f     mock_resolve_
-0000f850: 6a6f 696e 5f6b 6579 732c 0a20 2020 206b  join_keys,.    k
-0000f860: 7761 7267 732c 0a20 2020 2076 6572 7369  wargs,.    versi
-0000f870: 6f6e 2c0a 2020 2020 7461 6773 2c0a 2020  on,.    tags,.  
-0000f880: 2020 726f 775f 7461 6773 2c0a 2020 2020    row_tags,.    
-0000f890: 676c 6f62 616c 5f74 6167 732c 0a20 2020  global_tags,.   
-0000f8a0: 2065 7870 6563 7465 645f 7461 6773 5f70   expected_tags_p
-0000f8b0: 6172 616d 2c0a 2020 2020 7465 7374 5f74  aram,.    test_t
-0000f8c0: 696d 6573 7461 6d70 732c 0a20 2020 2074  imestamps,.    t
-0000f8d0: 6573 745f 7469 6d65 7374 616d 7073 5f6c  est_timestamps_l
-0000f8e0: 6973 742c 0a20 2020 2074 6573 745f 696e  ist,.    test_in
-0000f8f0: 7075 7473 2c0a 2020 2020 7465 7374 5f6f  puts,.    test_o
-0000f900: 7574 7075 7473 2c0a 2020 2020 7465 7374  utputs,.    test
-0000f910: 5f66 6565 6462 6163 6b73 2c0a 2020 2020  _feedbacks,.    
-0000f920: 636c 695f 6f62 6a2c 0a29 3a0a 2020 2020  cli_obj,.):.    
-0000f930: 6d6f 636b 5f6a 6f69 6e5f 6b65 795f 6765  mock_join_key_ge
-0000f940: 6e2e 7369 6465 5f65 6666 6563 7420 3d20  n.side_effect = 
-0000f950: 5b22 3637 3839 3022 2c20 2231 3233 3435  ["67890", "12345
-0000f960: 225d 0a20 2020 206d 6f63 6b5f 7265 736f  "].    mock_reso
-0000f970: 6c76 655f 6a6f 696e 5f6b 6579 732e 7265  lve_join_keys.re
-0000f980: 7475 726e 5f76 616c 7565 203d 205b 2231  turn_value = ["1
-0000f990: 3233 3435 222c 2022 3637 3839 3022 5d20  2345", "67890"] 
-0000f9a0: 6966 206b 7761 7267 7320 656c 7365 204e  if kwargs else N
-0000f9b0: 6f6e 650a 2020 2020 6173 7365 7274 2063  one.    assert c
-0000f9c0: 6c69 5f6f 626a 2e6c 6f67 5f72 6563 6f72  li_obj.log_recor
-0000f9d0: 6473 280a 2020 2020 2020 2020 6170 706c  ds(.        appl
-0000f9e0: 6963 6174 696f 6e3d 2266 6f6f 6261 7222  ication="foobar"
-0000f9f0: 2c0a 2020 2020 2020 2020 7665 7273 696f  ,.        versio
-0000fa00: 6e3d 7665 7273 696f 6e2c 0a20 2020 2020  n=version,.     
-0000fa10: 2020 2069 6e70 7574 733d 7465 7374 5f69     inputs=test_i
-0000fa20: 6e70 7574 732c 0a20 2020 2020 2020 206f  nputs,.        o
-0000fa30: 7574 7075 7473 3d74 6573 745f 6f75 7470  utputs=test_outp
-0000fa40: 7574 732c 0a20 2020 2020 2020 2066 6565  uts,.        fee
-0000fa50: 6462 6163 6b73 3d74 6573 745f 6665 6564  dbacks=test_feed
-0000fa60: 6261 636b 732c 0a20 2020 2020 2020 2074  backs,.        t
-0000fa70: 696d 6573 7461 6d70 733d 7465 7374 5f74  imestamps=test_t
-0000fa80: 696d 6573 7461 6d70 732c 0a20 2020 2020  imestamps,.     
-0000fa90: 2020 2073 6f72 745f 6f6e 5f74 696d 6573     sort_on_times
-0000faa0: 7461 6d70 3d54 7275 652c 0a20 2020 2020  tamp=True,.     
-0000fab0: 2020 2073 616d 706c 655f 7261 7465 3d31     sample_rate=1
-0000fac0: 2c0a 2020 2020 2020 2020 7461 6773 3d74  ,.        tags=t
-0000fad0: 6167 732c 0a20 2020 2020 2020 2072 6f77  ags,.        row
-0000fae0: 5f74 6167 733d 726f 775f 7461 6773 2c0a  _tags=row_tags,.
-0000faf0: 2020 2020 2020 2020 676c 6f62 616c 5f74          global_t
-0000fb00: 6167 733d 676c 6f62 616c 5f74 6167 732c  ags=global_tags,
-0000fb10: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
-0000fb20: 732c 0a20 2020 2029 203d 3d20 284e 6f6e  s,.    ) == (Non
-0000fb30: 652c 205b 2231 3233 3435 222c 2022 3637  e, ["12345", "67
-0000fb40: 3839 3022 5d29 0a0a 2020 2020 6d6f 636b  890"])..    mock
-0000fb50: 5f70 7265 6473 5f61 6e64 5f66 6565 6462  _preds_and_feedb
-0000fb60: 6163 6b2e 6173 7365 7274 5f63 616c 6c65  ack.assert_calle
-0000fb70: 645f 6f6e 6365 5f77 6974 6828 0a20 2020  d_once_with(.   
-0000fb80: 2020 2020 2061 7070 6c69 6361 7469 6f6e       application
-0000fb90: 3d22 666f 6f62 6172 222c 0a20 2020 2020  ="foobar",.     
-0000fba0: 2020 2069 6e70 7574 733d 5b7b 2241 223a     inputs=[{"A":
-0000fbb0: 2031 3030 7d2c 207b 2241 223a 2031 3031   100}, {"A": 101
-0000fbc0: 7d5d 2c0a 2020 2020 2020 2020 6f75 7470  }],.        outp
-0000fbd0: 7574 733d 5b7b 2242 223a 2033 3030 7d2c  uts=[{"B": 300},
-0000fbe0: 207b 2242 223a 2033 3031 7d5d 2c0a 2020   {"B": 301}],.  
-0000fbf0: 2020 2020 2020 6665 6564 6261 636b 733d        feedbacks=
-0000fc00: 5b7b 2241 223a 2032 3030 7d2c 207b 2241  [{"A": 200}, {"A
-0000fc10: 223a 2032 3031 7d5d 2c0a 2020 2020 2020  ": 201}],.      
-0000fc20: 2020 6a6f 696e 5f6b 6579 733d 5b22 3132    join_keys=["12
-0000fc30: 3334 3522 2c20 2236 3738 3930 225d 2069  345", "67890"] i
-0000fc40: 6620 6b77 6172 6773 2065 6c73 6520 5b22  f kwargs else ["
-0000fc50: 3637 3839 3022 2c20 2231 3233 3435 225d  67890", "12345"]
-0000fc60: 2c0a 2020 2020 2020 2020 7665 7273 696f  ,.        versio
-0000fc70: 6e3d 7665 7273 696f 6e2c 0a20 2020 2020  n=version,.     
-0000fc80: 2020 2069 676e 6f72 655f 696e 7075 7473     ignore_inputs
-0000fc90: 3d4e 6f6e 652c 0a20 2020 2020 2020 2074  =None,.        t
-0000fca0: 696d 6573 7461 6d70 733d 7465 7374 5f74  imestamps=test_t
-0000fcb0: 696d 6573 7461 6d70 735f 6c69 7374 2c0a  imestamps_list,.
-0000fcc0: 2020 2020 2020 2020 736f 7274 5f6f 6e5f          sort_on_
-0000fcd0: 7469 6d65 7374 616d 703d 5472 7565 2c0a  timestamp=True,.
-0000fce0: 2020 2020 2020 2020 6173 5f62 6174 6368          as_batch
-0000fcf0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-0000fd00: 7461 6773 3d65 7870 6563 7465 645f 7461  tags=expected_ta
-0000fd10: 6773 5f70 6172 616d 2c0a 2020 2020 290a  gs_param,.    ).
-0000fd20: 2020 2020 6d6f 636b 5f70 7265 6473 2e61      mock_preds.a
-0000fd30: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
-0000fd40: 2829 0a20 2020 206d 6f63 6b5f 6665 6564  ().    mock_feed
-0000fd50: 6261 636b 2e61 7373 6572 745f 6e6f 745f  back.assert_not_
-0000fd60: 6361 6c6c 6564 2829 0a0a 2020 2020 6d6f  called()..    mo
-0000fd70: 636b 5f73 616d 706c 655f 7265 636f 7264  ck_sample_record
-0000fd80: 732e 6173 7365 7274 5f63 616c 6c65 645f  s.assert_called_
-0000fd90: 6f6e 6365 5f77 6974 6828 0a20 2020 2020  once_with(.     
-0000fda0: 2020 2032 2c0a 2020 2020 2020 2020 312c     2,.        1,
-0000fdb0: 0a20 2020 2020 2020 205b 7b22 4122 3a20  .        [{"A": 
-0000fdc0: 3130 307d 2c20 7b22 4122 3a20 3130 317d  100}, {"A": 101}
-0000fdd0: 5d2c 0a20 2020 2020 2020 205b 7b22 4222  ],.        [{"B"
-0000fde0: 3a20 3330 307d 2c20 7b22 4222 3a20 3330  : 300}, {"B": 30
-0000fdf0: 317d 5d2c 0a20 2020 2020 2020 205b 7b22  1}],.        [{"
-0000fe00: 4122 3a20 3230 307d 2c20 7b22 4122 3a20  A": 200}, {"A": 
-0000fe10: 3230 317d 5d2c 0a20 2020 2020 2020 2063  201}],.        c
-0000fe20: 6c69 656e 742e 5f72 6573 6f6c 7665 5f6a  lient._resolve_j
-0000fe30: 6f69 6e5f 6b65 7973 282a 2a6b 7761 7267  oin_keys(**kwarg
-0000fe40: 7329 2c0a 2020 2020 2020 2020 7465 7374  s),.        test
-0000fe50: 5f74 696d 6573 7461 6d70 735f 6c69 7374  _timestamps_list
-0000fe60: 2c0a 2020 2020 2020 2020 6578 7065 6374  ,.        expect
-0000fe70: 6564 5f74 6167 735f 7061 7261 6d2c 0a20  ed_tags_param,. 
-0000fe80: 2020 2029 0a0a 2020 2020 6966 206b 7761     )..    if kwa
-0000fe90: 7267 733a 0a20 2020 2020 2020 206d 6f63  rgs:.        moc
-0000fea0: 6b5f 6a6f 696e 5f6b 6579 5f67 656e 2e61  k_join_key_gen.a
-0000feb0: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
-0000fec0: 2829 0a20 2020 2065 6c73 653a 0a20 2020  ().    else:.   
-0000fed0: 2020 2020 206d 6f63 6b5f 6a6f 696e 5f6b       mock_join_k
-0000fee0: 6579 5f67 656e 2e61 7373 6572 745f 6361  ey_gen.assert_ca
-0000fef0: 6c6c 6564 2829 0a0a 0a40 7079 7465 7374  lled()...@pytest
-0000ff00: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
-0000ff10: 6528 0a20 2020 2022 7465 7374 5f74 696d  e(.    "test_tim
-0000ff20: 6573 7461 6d70 732c 2074 6573 745f 7469  estamps, test_ti
-0000ff30: 6d65 7374 616d 7073 5f6c 6973 7422 2c0a  mestamps_list",.
-0000ff40: 2020 2020 5b0a 2020 2020 2020 2020 284e      [.        (N
-0000ff50: 6f6e 652c 204e 6f6e 6529 2c0a 2020 2020  one, None),.    
-0000ff60: 2020 2020 285b 4355 5252 454e 545f 5449      ([CURRENT_TI
-0000ff70: 4d45 5d20 2a20 322c 205b 4355 5252 454e  ME] * 2, [CURREN
-0000ff80: 545f 5449 4d45 5d20 2a20 3229 2c0a 2020  T_TIME] * 2),.  
-0000ff90: 2020 2020 2020 286e 702e 6172 7261 7928        (np.array(
-0000ffa0: 5b43 5552 5245 4e54 5f54 494d 455d 202a  [CURRENT_TIME] *
-0000ffb0: 2032 292c 205b 4355 5252 454e 545f 5449   2), [CURRENT_TI
-0000ffc0: 4d45 5d20 2a20 3229 2c0a 2020 2020 5d2c  ME] * 2),.    ],
-0000ffd0: 0a29 0a40 7079 7465 7374 2e6d 6172 6b2e  .).@pytest.mark.
-0000ffe0: 7061 7261 6d65 7472 697a 6528 0a20 2020  parametrize(.   
-0000fff0: 2022 7465 7374 5f66 6565 6462 6163 6b73   "test_feedbacks
-00010000: 222c 0a20 2020 205b 0a20 2020 2020 2020  ",.    [.       
-00010010: 205b 7b22 4122 3a20 3230 307d 2c20 7b22   [{"A": 200}, {"
-00010020: 4122 3a20 3230 317d 5d2c 0a20 2020 2020  A": 201}],.     
-00010030: 2020 2070 642e 4461 7461 4672 616d 652e     pd.DataFrame.
-00010040: 6672 6f6d 5f64 6963 7428 7b22 4122 3a20  from_dict({"A": 
-00010050: 5b32 3030 2c20 3230 315d 7d29 2c0a 2020  [200, 201]}),.  
-00010060: 2020 2020 2020 7064 2e53 6572 6965 7328        pd.Series(
-00010070: 6e61 6d65 3d22 4122 2c20 6461 7461 3d5b  name="A", data=[
-00010080: 3230 302c 2032 3031 5d29 2c0a 2020 2020  200, 201]),.    
-00010090: 2020 2020 6e70 2e61 7272 6179 285b 7b22      np.array([{"
-000100a0: 4122 3a20 3230 307d 2c20 7b22 4122 3a20  A": 200}, {"A": 
-000100b0: 3230 317d 5d29 2c0a 2020 2020 5d2c 0a29  201}]),.    ],.)
-000100c0: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
-000100d0: 7261 6d65 7472 697a 6528 0a20 2020 2022  rametrize(.    "
-000100e0: 7465 7374 5f6f 7574 7075 7473 222c 0a20  test_outputs",. 
-000100f0: 2020 205b 0a20 2020 2020 2020 205b 7b22     [.        [{"
-00010100: 4222 3a20 3330 307d 2c20 7b22 4222 3a20  B": 300}, {"B": 
-00010110: 3330 317d 5d2c 0a20 2020 2020 2020 2070  301}],.        p
-00010120: 642e 4461 7461 4672 616d 652e 6672 6f6d  d.DataFrame.from
-00010130: 5f64 6963 7428 7b22 4222 3a20 5b33 3030  _dict({"B": [300
-00010140: 2c20 3330 315d 7d29 2c0a 2020 2020 2020  , 301]}),.      
-00010150: 2020 7064 2e53 6572 6965 7328 6e61 6d65    pd.Series(name
-00010160: 3d22 4222 2c20 6461 7461 3d5b 3330 302c  ="B", data=[300,
-00010170: 2033 3031 5d29 2c0a 2020 2020 2020 2020   301]),.        
-00010180: 6e70 2e61 7272 6179 285b 7b22 4222 3a20  np.array([{"B": 
-00010190: 3330 307d 2c20 7b22 4222 3a20 3330 317d  300}, {"B": 301}
-000101a0: 5d29 2c0a 2020 2020 5d2c 0a29 0a40 7079  ]),.    ],.).@py
-000101b0: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
-000101c0: 7472 697a 6528 0a20 2020 2022 7465 7374  trize(.    "test
-000101d0: 5f69 6e70 7574 7322 2c0a 2020 2020 5b0a  _inputs",.    [.
-000101e0: 2020 2020 2020 2020 5b7b 2241 223a 2031          [{"A": 1
-000101f0: 3030 7d2c 207b 2241 223a 2031 3031 7d5d  00}, {"A": 101}]
-00010200: 2c0a 2020 2020 2020 2020 7064 2e44 6174  ,.        pd.Dat
-00010210: 6146 7261 6d65 2e66 726f 6d5f 6469 6374  aFrame.from_dict
-00010220: 287b 2241 223a 205b 3130 302c 2031 3031  ({"A": [100, 101
-00010230: 5d7d 292c 0a20 2020 2020 2020 2070 642e  ]}),.        pd.
-00010240: 5365 7269 6573 286e 616d 653d 2241 222c  Series(name="A",
-00010250: 2064 6174 613d 5b31 3030 2c20 3130 315d   data=[100, 101]
-00010260: 292c 0a20 2020 2020 2020 206e 702e 6172  ),.        np.ar
-00010270: 7261 7928 5b7b 2241 223a 2031 3030 7d2c  ray([{"A": 100},
-00010280: 207b 2241 223a 2031 3031 7d5d 292c 0a20   {"A": 101}]),. 
-00010290: 2020 205d 2c0a 290a 4070 7974 6573 742e     ],.).@pytest.
-000102a0: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-000102b0: 2822 7665 7273 696f 6e22 2c20 5b4e 6f6e  ("version", [Non
-000102c0: 652c 2031 302c 2022 312e 322e 3322 5d29  e, 10, "1.2.3"])
-000102d0: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
-000102e0: 7261 6d65 7472 697a 6528 0a20 2020 2022  rametrize(.    "
-000102f0: 7461 6773 2c20 726f 775f 7461 6773 2c20  tags, row_tags, 
-00010300: 676c 6f62 616c 5f74 6167 732c 2065 7870  global_tags, exp
-00010310: 6563 7465 645f 7461 6773 5f70 6172 616d  ected_tags_param
-00010320: 222c 0a20 2020 205b 0a20 2020 2020 2020  ",.    [.       
-00010330: 2028 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f   (None, None, No
-00010340: 6e65 2c20 5b7b 2265 6e76 223a 2022 7465  ne, [{"env": "te
-00010350: 7374 227d 2c20 7b22 656e 7622 3a20 2274  st"}, {"env": "t
-00010360: 6573 7422 7d5d 292c 0a20 2020 2020 2020  est"}]),.       
-00010370: 2028 0a20 2020 2020 2020 2020 2020 207b   (.            {
-00010380: 2262 6172 223a 2022 6261 7222 7d2c 0a20  "bar": "bar"},. 
-00010390: 2020 2020 2020 2020 2020 204e 6f6e 652c             None,
-000103a0: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-000103b0: 652c 0a20 2020 2020 2020 2020 2020 205b  e,.            [
-000103c0: 7b22 6261 7222 3a20 2262 6172 222c 2022  {"bar": "bar", "
-000103d0: 656e 7622 3a20 2274 6573 7422 7d2c 207b  env": "test"}, {
-000103e0: 2262 6172 223a 2022 6261 7222 2c20 2265  "bar": "bar", "e
-000103f0: 6e76 223a 2022 7465 7374 227d 5d2c 0a20  nv": "test"}],. 
-00010400: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-00010410: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-00010420: 7b22 6261 7222 3a20 2262 6172 227d 2c0a  {"bar": "bar"},.
-00010430: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-00010440: 2c0a 2020 2020 2020 2020 2020 2020 7b22  ,.            {"
-00010450: 666f 6f22 3a20 2266 6f6f 227d 2c0a 2020  foo": "foo"},.  
-00010460: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-00010470: 2020 2020 2020 2020 2020 2020 7b22 6261              {"ba
-00010480: 7222 3a20 2262 6172 222c 2022 656e 7622  r": "bar", "env"
-00010490: 3a20 2274 6573 7422 2c20 2266 6f6f 223a  : "test", "foo":
-000104a0: 2022 666f 6f22 7d2c 0a20 2020 2020 2020   "foo"},.       
-000104b0: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-000104c0: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
-000104d0: 7465 7374 222c 2022 666f 6f22 3a20 2266  test", "foo": "f
-000104e0: 6f6f 227d 2c0a 2020 2020 2020 2020 2020  oo"},.          
-000104f0: 2020 5d2c 0a20 2020 2020 2020 2029 2c0a    ],.        ),.
-00010500: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
-00010510: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-00010520: 2020 2020 2020 2020 5b7b 2262 6172 223a          [{"bar":
-00010530: 2022 6261 7222 7d2c 207b 2262 6172 223a   "bar"}, {"bar":
-00010540: 2022 6261 7a22 7d5d 2c0a 2020 2020 2020   "baz"}],.      
-00010550: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-00010560: 2020 2020 2020 2020 5b7b 2262 6172 223a          [{"bar":
-00010570: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
-00010580: 7465 7374 227d 2c20 7b22 6261 7222 3a20  test"}, {"bar": 
-00010590: 2262 617a 222c 2022 656e 7622 3a20 2274  "baz", "env": "t
-000105a0: 6573 7422 7d5d 2c0a 2020 2020 2020 2020  est"}],.        
-000105b0: 292c 0a20 2020 2020 2020 2028 0a20 2020  ),.        (.   
-000105c0: 2020 2020 2020 2020 204e 6f6e 652c 0a20           None,. 
-000105d0: 2020 2020 2020 2020 2020 205b 7b22 6261             [{"ba
-000105e0: 7222 3a20 2262 6172 227d 2c20 7b22 6261  r": "bar"}, {"ba
-000105f0: 7222 3a20 2262 617a 227d 5d2c 0a20 2020  r": "baz"}],.   
-00010600: 2020 2020 2020 2020 207b 2266 6f6f 223a           {"foo":
-00010610: 2022 666f 6f22 7d2c 0a20 2020 2020 2020   "foo"},.       
-00010620: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00010630: 2020 2020 2020 207b 2262 6172 223a 2022         {"bar": "
-00010640: 6261 7222 2c20 2265 6e76 223a 2022 7465  bar", "env": "te
-00010650: 7374 222c 2022 666f 6f22 3a20 2266 6f6f  st", "foo": "foo
-00010660: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-00010670: 2020 2020 7b22 6261 7222 3a20 2262 617a      {"bar": "baz
-00010680: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
-00010690: 2c20 2266 6f6f 223a 2022 666f 6f22 7d2c  , "foo": "foo"},
-000106a0: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
-000106b0: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-000106c0: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
-000106d0: 207b 2266 6f6f 223a 2022 666f 6f22 7d2c   {"foo": "foo"},
-000106e0: 0a20 2020 2020 2020 2020 2020 205b 7b22  .            [{"
-000106f0: 6261 7222 3a20 2262 6172 227d 2c20 7b22  bar": "bar"}, {"
-00010700: 6261 7222 3a20 2262 617a 227d 5d2c 0a20  bar": "baz"}],. 
-00010710: 2020 2020 2020 2020 2020 204e 6f6e 652c             None,
-00010720: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
-00010730: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00010740: 2262 6172 223a 2022 6261 7222 2c20 2265  "bar": "bar", "e
-00010750: 6e76 223a 2022 7465 7374 222c 2022 666f  nv": "test", "fo
-00010760: 6f22 3a20 2266 6f6f 227d 2c0a 2020 2020  o": "foo"},.    
-00010770: 2020 2020 2020 2020 2020 2020 7b22 6261              {"ba
-00010780: 7222 3a20 2262 617a 222c 2022 656e 7622  r": "baz", "env"
-00010790: 3a20 2274 6573 7422 2c20 2266 6f6f 223a  : "test", "foo":
-000107a0: 2022 666f 6f22 7d2c 0a20 2020 2020 2020   "foo"},.       
-000107b0: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-000107c0: 292c 0a20 2020 2020 2020 2028 0a20 2020  ),.        (.   
-000107d0: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-000107e0: 2022 6261 7222 7d2c 0a20 2020 2020 2020   "bar"},.       
-000107f0: 2020 2020 205b 7b22 666f 6f22 3a20 2266       [{"foo": "f
-00010800: 6f6f 227d 2c20 7b22 6261 7a22 3a20 2262  oo"}, {"baz": "b
-00010810: 617a 227d 5d2c 0a20 2020 2020 2020 2020  az"}],.         
-00010820: 2020 207b 2265 6e76 223a 2022 666f 6f62     {"env": "foob
-00010830: 6172 227d 2c0a 2020 2020 2020 2020 2020  ar"},.          
-00010840: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-00010850: 2020 2020 7b22 6261 7222 3a20 2262 6172      {"bar": "bar
-00010860: 222c 2022 656e 7622 3a20 2266 6f6f 6261  ", "env": "fooba
-00010870: 7222 2c20 2266 6f6f 223a 2022 666f 6f22  r", "foo": "foo"
-00010880: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-00010890: 2020 207b 2262 6172 223a 2022 6261 7222     {"bar": "bar"
-000108a0: 2c20 2265 6e76 223a 2022 666f 6f62 6172  , "env": "foobar
-000108b0: 222c 2022 6261 7a22 3a20 2262 617a 227d  ", "baz": "baz"}
-000108c0: 2c0a 2020 2020 2020 2020 2020 2020 5d2c  ,.            ],
-000108d0: 0a20 2020 2020 2020 2029 2c0a 2020 2020  .        ),.    
-000108e0: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
-000108f0: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
-00010900: 2020 2020 5b7b 2262 6172 223a 2022 6261      [{"bar": "ba
-00010910: 7222 7d2c 207b 2262 6172 223a 2022 6261  r"}, {"bar": "ba
-00010920: 7a22 7d5d 2c0a 2020 2020 2020 2020 2020  z"}],.          
-00010930: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
-00010940: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-00010950: 2020 2020 2020 7b22 6261 7222 3a20 2262        {"bar": "b
-00010960: 6172 222c 2022 656e 7622 3a20 2274 6573  ar", "env": "tes
-00010970: 7422 7d2c 0a20 2020 2020 2020 2020 2020  t"},.           
-00010980: 2020 2020 207b 2262 6172 223a 2022 6261       {"bar": "ba
-00010990: 7a22 2c20 2265 6e76 223a 2022 7465 7374  z", "env": "test
-000109a0: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-000109b0: 5d2c 0a20 2020 2020 2020 2029 2c0a 2020  ],.        ),.  
-000109c0: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-000109d0: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
-000109e0: 2020 2020 2020 6e70 2e61 7272 6179 285b        np.array([
-000109f0: 7b22 6261 7222 3a20 2262 6172 227d 2c20  {"bar": "bar"}, 
-00010a00: 7b22 6261 7222 3a20 2262 617a 227d 5d29  {"bar": "baz"}])
-00010a10: 2c0a 2020 2020 2020 2020 2020 2020 4e6f  ,.            No
-00010a20: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00010a30: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00010a40: 2020 7b22 6261 7222 3a20 2262 6172 222c    {"bar": "bar",
-00010a50: 2022 656e 7622 3a20 2274 6573 7422 7d2c   "env": "test"},
-00010a60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010a70: 207b 2262 6172 223a 2022 6261 7a22 2c20   {"bar": "baz", 
-00010a80: 2265 6e76 223a 2022 7465 7374 227d 2c0a  "env": "test"},.
-00010a90: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-00010aa0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-00010ab0: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-00010ac0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-00010ad0: 2020 7064 2e53 6572 6965 7328 5b22 6261    pd.Series(["ba
-00010ae0: 7222 2c20 2262 617a 225d 2c20 6e61 6d65  r", "baz"], name
-00010af0: 3d22 6261 7222 292c 0a20 2020 2020 2020  ="bar"),.       
-00010b00: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
-00010b10: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-00010b20: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-00010b30: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
-00010b40: 7465 7374 227d 2c0a 2020 2020 2020 2020  test"},.        
-00010b50: 2020 2020 2020 2020 7b22 6261 7222 3a20          {"bar": 
-00010b60: 2262 617a 222c 2022 656e 7622 3a20 2274  "baz", "env": "t
-00010b70: 6573 7422 7d2c 0a20 2020 2020 2020 2020  est"},.         
-00010b80: 2020 205d 2c0a 2020 2020 2020 2020 292c     ],.        ),
-00010b90: 0a20 2020 2020 2020 2028 0a20 2020 2020  .        (.     
-00010ba0: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
-00010bb0: 2020 2020 2020 2020 2070 642e 4461 7461           pd.Data
-00010bc0: 4672 616d 6528 7b22 6261 7222 3a20 5b22  Frame({"bar": ["
-00010bd0: 6261 7222 2c20 2262 617a 225d 7d29 2c0a  bar", "baz"]}),.
-00010be0: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-00010bf0: 2c0a 2020 2020 2020 2020 2020 2020 5b0a  ,.            [.
-00010c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010c10: 7b22 6261 7222 3a20 2262 6172 222c 2022  {"bar": "bar", "
-00010c20: 656e 7622 3a20 2274 6573 7422 7d2c 0a20  env": "test"},. 
-00010c30: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00010c40: 2262 6172 223a 2022 6261 7a22 2c20 2265  "bar": "baz", "e
-00010c50: 6e76 223a 2022 7465 7374 227d 2c0a 2020  nv": "test"},.  
-00010c60: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-00010c70: 2020 2020 2029 2c0a 2020 2020 5d2c 0a29       ),.    ],.)
-00010c80: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
-00010c90: 7261 6d65 7472 697a 6528 0a20 2020 2022  rametrize(.    "
-00010ca0: 6b77 6172 6773 222c 0a20 2020 205b 0a20  kwargs",.    [. 
-00010cb0: 2020 2020 2020 207b 226a 6f69 6e5f 6b65         {"join_ke
-00010cc0: 7973 223a 205b 2235 3433 3231 222c 2022  ys": ["54321", "
-00010cd0: 3637 3839 3022 5d7d 2c0a 2020 2020 2020  67890"]},.      
-00010ce0: 2020 7b22 6a6f 696e 5f6b 6579 7322 3a20    {"join_keys": 
-00010cf0: 7064 2e53 6572 6965 7328 5b22 3534 3332  pd.Series(["5432
-00010d00: 3122 2c20 2236 3738 3930 225d 297d 2c0a  1", "67890"])},.
-00010d10: 2020 2020 2020 2020 7b7d 2c0a 2020 2020          {},.    
-00010d20: 5d2c 0a29 0a40 6d6f 636b 2e70 6174 6368  ],.).@mock.patch
-00010d30: 2822 6761 6e74 7279 2e6c 6f67 6765 722e  ("gantry.logger.
-00010d40: 636c 6965 6e74 2e5f 7265 736f 6c76 655f  client._resolve_
-00010d50: 6a6f 696e 5f6b 6579 7322 290a 406d 6f63  join_keys").@moc
-00010d60: 6b2e 7061 7463 6828 0a20 2020 2022 6761  k.patch(.    "ga
-00010d70: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
-00010d80: 6e74 2e47 616e 7472 792e 5f67 656e 6572  nt.Gantry._gener
-00010d90: 6174 655f 7072 6564 6963 7469 6f6e 5f61  ate_prediction_a
-00010da0: 6e64 5f66 6565 6462 6163 6b5f 6576 656e  nd_feedback_even
-00010db0: 7473 222c 0a20 2020 2072 6574 7572 6e5f  ts",.    return_
-00010dc0: 7661 6c75 653d 285b 7b22 6576 656e 7422  value=([{"event"
-00010dd0: 3a20 2270 6c61 6365 5f68 6f6c 6465 7222  : "place_holder"
-00010de0: 7d5d 2c20 5b22 3132 3334 3522 2c20 2236  }], ["12345", "6
-00010df0: 3738 3930 225d 292c 0a29 0a40 6d6f 636b  7890"]),.).@mock
-00010e00: 2e70 6174 6368 2822 6761 6e74 7279 2e6c  .patch("gantry.l
-00010e10: 6f67 6765 722e 636c 6965 6e74 2e47 616e  ogger.client.Gan
-00010e20: 7472 792e 5f67 656e 6572 6174 655f 7072  try._generate_pr
-00010e30: 6564 6963 7469 6f6e 5f65 7665 6e74 7322  ediction_events"
-00010e40: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
-00010e50: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
-00010e60: 656e 742e 4761 6e74 7279 2e5f 6765 6e65  ent.Gantry._gene
-00010e70: 7261 7465 5f66 6565 6462 6163 6b5f 6576  rate_feedback_ev
-00010e80: 656e 7473 2229 0a40 6d6f 636b 2e70 6174  ents").@mock.pat
-00010e90: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
-00010ea0: 722e 636c 6965 6e74 2e5f 7361 6d70 6c65  r.client._sample
-00010eb0: 5f72 6563 6f72 6473 222c 2073 6964 655f  _records", side_
-00010ec0: 6566 6665 6374 3d63 6c69 656e 742e 5f73  effect=client._s
-00010ed0: 616d 706c 655f 7265 636f 7264 7329 0a40  ample_records).@
-00010ee0: 6d6f 636b 2e70 6174 6368 2822 6761 6e74  mock.patch("gant
-00010ef0: 7279 2e6c 6f67 6765 722e 636c 6965 6e74  ry.logger.client
-00010f00: 2e5f 6465 6661 756c 745f 6a6f 696e 5f6b  ._default_join_k
-00010f10: 6579 5f67 656e 2229 0a64 6566 2074 6573  ey_gen").def tes
-00010f20: 745f 6765 6e65 7261 7465 5f72 6563 6f72  t_generate_recor
-00010f30: 6473 5f70 7265 6473 5f61 6e64 5f66 6565  ds_preds_and_fee
-00010f40: 6462 6163 6b28 0a20 2020 206d 6f63 6b5f  dback(.    mock_
-00010f50: 6a6f 696e 5f6b 6579 5f67 656e 2c0a 2020  join_key_gen,.  
-00010f60: 2020 6d6f 636b 5f73 616d 706c 655f 7265    mock_sample_re
-00010f70: 636f 7264 732c 0a20 2020 206d 6f63 6b5f  cords,.    mock_
-00010f80: 6765 6e65 7261 7465 5f66 6565 6462 6163  generate_feedbac
-00010f90: 6b2c 0a20 2020 206d 6f63 6b5f 6765 6e65  k,.    mock_gene
-00010fa0: 7261 7465 5f70 7265 6473 2c0a 2020 2020  rate_preds,.    
-00010fb0: 6d6f 636b 5f67 656e 6572 6174 655f 7072  mock_generate_pr
-00010fc0: 6564 735f 616e 645f 6665 6564 6261 636b  eds_and_feedback
-00010fd0: 2c0a 2020 2020 6d6f 636b 5f72 6573 6f6c  ,.    mock_resol
-00010fe0: 7665 5f6a 6f69 6e5f 6b65 7973 2c0a 2020  ve_join_keys,.  
-00010ff0: 2020 6b77 6172 6773 2c0a 2020 2020 7665    kwargs,.    ve
-00011000: 7273 696f 6e2c 0a20 2020 2074 6167 732c  rsion,.    tags,
-00011010: 0a20 2020 2072 6f77 5f74 6167 732c 0a20  .    row_tags,. 
-00011020: 2020 2067 6c6f 6261 6c5f 7461 6773 2c0a     global_tags,.
-00011030: 2020 2020 6578 7065 6374 6564 5f74 6167      expected_tag
-00011040: 735f 7061 7261 6d2c 0a20 2020 2074 6573  s_param,.    tes
-00011050: 745f 7469 6d65 7374 616d 7073 2c0a 2020  t_timestamps,.  
-00011060: 2020 7465 7374 5f74 696d 6573 7461 6d70    test_timestamp
-00011070: 735f 6c69 7374 2c0a 2020 2020 7465 7374  s_list,.    test
-00011080: 5f69 6e70 7574 732c 0a20 2020 2074 6573  _inputs,.    tes
-00011090: 745f 6f75 7470 7574 732c 0a20 2020 2074  t_outputs,.    t
-000110a0: 6573 745f 6665 6564 6261 636b 732c 0a20  est_feedbacks,. 
-000110b0: 2020 2063 6c69 5f6f 626a 2c0a 293a 0a20     cli_obj,.):. 
-000110c0: 2020 206d 6f63 6b5f 6a6f 696e 5f6b 6579     mock_join_key
-000110d0: 5f67 656e 2e73 6964 655f 6566 6665 6374  _gen.side_effect
-000110e0: 203d 205b 2236 3738 3930 222c 2022 3132   = ["67890", "12
-000110f0: 3334 3522 5d0a 2020 2020 6d6f 636b 5f72  345"].    mock_r
-00011100: 6573 6f6c 7665 5f6a 6f69 6e5f 6b65 7973  esolve_join_keys
-00011110: 2e72 6574 7572 6e5f 7661 6c75 6520 3d20  .return_value = 
-00011120: 5b22 3132 3334 3522 2c20 2236 3738 3930  ["12345", "67890
-00011130: 225d 2069 6620 6b77 6172 6773 2065 6c73  "] if kwargs els
-00011140: 6520 4e6f 6e65 0a20 2020 2072 756e 5f69  e None.    run_i
-00011150: 6420 3d20 7374 7228 7575 6964 2e75 7569  d = str(uuid.uui
-00011160: 6434 2829 290a 2020 2020 7275 6e5f 7461  d4()).    run_ta
-00011170: 6773 203d 204e 6f6e 650a 2020 2020 6966  gs = None.    if
-00011180: 2074 6167 7320 616e 6420 676c 6f62 616c   tags and global
-00011190: 5f74 6167 733a 0a20 2020 2020 2020 2072  _tags:.        r
-000111a0: 756e 5f74 6167 7320 3d20 7b2a 2a74 6167  un_tags = {**tag
-000111b0: 732c 202a 2a67 6c6f 6261 6c5f 7461 6773  s, **global_tags
-000111c0: 7d0a 2020 2020 656c 6966 2074 6167 733a  }.    elif tags:
-000111d0: 0a20 2020 2020 2020 2072 756e 5f74 6167  .        run_tag
-000111e0: 7320 3d20 7461 6773 0a20 2020 2065 6c69  s = tags.    eli
-000111f0: 6620 676c 6f62 616c 5f74 6167 733a 0a20  f global_tags:. 
-00011200: 2020 2020 2020 2072 756e 5f74 6167 7320         run_tags 
-00011210: 3d20 676c 6f62 616c 5f74 6167 730a 2020  = global_tags.  
-00011220: 2020 6173 7365 7274 2063 6c69 5f6f 626a    assert cli_obj
-00011230: 2e6c 6f67 280a 2020 2020 2020 2020 6170  .log(.        ap
-00011240: 706c 6963 6174 696f 6e3d 2266 6f6f 6261  plication="fooba
-00011250: 7222 2c0a 2020 2020 2020 2020 7665 7273  r",.        vers
-00011260: 696f 6e3d 7665 7273 696f 6e2c 0a20 2020  ion=version,.   
-00011270: 2020 2020 2069 6e70 7574 733d 7465 7374       inputs=test
-00011280: 5f69 6e70 7574 732c 0a20 2020 2020 2020  _inputs,.       
-00011290: 206f 7574 7075 7473 3d74 6573 745f 6f75   outputs=test_ou
-000112a0: 7470 7574 732c 0a20 2020 2020 2020 2066  tputs,.        f
-000112b0: 6565 6462 6163 6b73 3d74 6573 745f 6665  eedbacks=test_fe
-000112c0: 6564 6261 636b 732c 0a20 2020 2020 2020  edbacks,.       
-000112d0: 2074 696d 6573 7461 6d70 733d 7465 7374   timestamps=test
-000112e0: 5f74 696d 6573 7461 6d70 732c 0a20 2020  _timestamps,.   
-000112f0: 2020 2020 2073 6f72 745f 6f6e 5f74 696d       sort_on_tim
-00011300: 6573 7461 6d70 3d54 7275 652c 0a20 2020  estamp=True,.   
-00011310: 2020 2020 2073 616d 706c 655f 7261 7465       sample_rate
-00011320: 3d31 2c0a 2020 2020 2020 2020 7275 6e5f  =1,.        run_
-00011330: 7461 6773 3d72 756e 5f74 6167 732c 0a20  tags=run_tags,. 
-00011340: 2020 2020 2020 2072 6f77 5f74 6167 733d         row_tags=
-00011350: 726f 775f 7461 6773 2c0a 2020 2020 2020  row_tags,.      
-00011360: 2020 7275 6e5f 6964 3d72 756e 5f69 642c    run_id=run_id,
-00011370: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
-00011380: 732c 0a20 2020 2029 203d 3d20 5b7b 2265  s,.    ) == [{"e
-00011390: 7665 6e74 223a 2022 706c 6163 655f 686f  vent": "place_ho
-000113a0: 6c64 6572 227d 5d0a 0a20 2020 206d 6f63  lder"}]..    moc
-000113b0: 6b5f 6765 6e65 7261 7465 5f70 7265 6473  k_generate_preds
-000113c0: 5f61 6e64 5f66 6565 6462 6163 6b2e 6173  _and_feedback.as
-000113d0: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
-000113e0: 5f77 6974 6828 0a20 2020 2020 2020 2061  _with(.        a
-000113f0: 7070 6c69 6361 7469 6f6e 3d22 666f 6f62  pplication="foob
-00011400: 6172 222c 0a20 2020 2020 2020 2069 6e70  ar",.        inp
-00011410: 7574 733d 5b7b 2241 223a 2031 3030 7d2c  uts=[{"A": 100},
-00011420: 207b 2241 223a 2031 3031 7d5d 2c0a 2020   {"A": 101}],.  
-00011430: 2020 2020 2020 6f75 7470 7574 733d 5b7b        outputs=[{
-00011440: 2242 223a 2033 3030 7d2c 207b 2242 223a  "B": 300}, {"B":
-00011450: 2033 3031 7d5d 2c0a 2020 2020 2020 2020   301}],.        
-00011460: 6665 6564 6261 636b 733d 5b7b 2241 223a  feedbacks=[{"A":
-00011470: 2032 3030 7d2c 207b 2241 223a 2032 3031   200}, {"A": 201
-00011480: 7d5d 2c0a 2020 2020 2020 2020 6a6f 696e  }],.        join
-00011490: 5f6b 6579 733d 5b22 3132 3334 3522 2c20  _keys=["12345", 
-000114a0: 2236 3738 3930 225d 2069 6620 6b77 6172  "67890"] if kwar
-000114b0: 6773 2065 6c73 6520 5b22 3637 3839 3022  gs else ["67890"
-000114c0: 2c20 2231 3233 3435 225d 2c0a 2020 2020  , "12345"],.    
-000114d0: 2020 2020 7665 7273 696f 6e3d 7665 7273      version=vers
-000114e0: 696f 6e2c 0a20 2020 2020 2020 2069 676e  ion,.        ign
-000114f0: 6f72 655f 696e 7075 7473 3d4e 6f6e 652c  ore_inputs=None,
-00011500: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
-00011510: 6d70 733d 7465 7374 5f74 696d 6573 7461  mps=test_timesta
-00011520: 6d70 735f 6c69 7374 2c0a 2020 2020 2020  mps_list,.      
-00011530: 2020 736f 7274 5f6f 6e5f 7469 6d65 7374    sort_on_timest
-00011540: 616d 703d 5472 7565 2c0a 2020 2020 2020  amp=True,.      
-00011550: 2020 7275 6e5f 6964 3d72 756e 5f69 642c    run_id=run_id,
-00011560: 0a20 2020 2020 2020 2074 6167 733d 6578  .        tags=ex
-00011570: 7065 6374 6564 5f74 6167 735f 7061 7261  pected_tags_para
-00011580: 6d2c 0a20 2020 2029 0a20 2020 206d 6f63  m,.    ).    moc
-00011590: 6b5f 6765 6e65 7261 7465 5f70 7265 6473  k_generate_preds
-000115a0: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
-000115b0: 6564 2829 0a20 2020 206d 6f63 6b5f 6765  ed().    mock_ge
-000115c0: 6e65 7261 7465 5f66 6565 6462 6163 6b2e  nerate_feedback.
-000115d0: 6173 7365 7274 5f6e 6f74 5f63 616c 6c65  assert_not_calle
-000115e0: 6428 290a 0a20 2020 206d 6f63 6b5f 7361  d()..    mock_sa
-000115f0: 6d70 6c65 5f72 6563 6f72 6473 2e61 7373  mple_records.ass
-00011600: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
-00011610: 7769 7468 280a 2020 2020 2020 2020 322c  with(.        2,
-00011620: 0a20 2020 2020 2020 2031 2c0a 2020 2020  .        1,.    
-00011630: 2020 2020 5b7b 2241 223a 2031 3030 7d2c      [{"A": 100},
-00011640: 207b 2241 223a 2031 3031 7d5d 2c0a 2020   {"A": 101}],.  
-00011650: 2020 2020 2020 5b7b 2242 223a 2033 3030        [{"B": 300
-00011660: 7d2c 207b 2242 223a 2033 3031 7d5d 2c0a  }, {"B": 301}],.
-00011670: 2020 2020 2020 2020 5b7b 2241 223a 2032          [{"A": 2
-00011680: 3030 7d2c 207b 2241 223a 2032 3031 7d5d  00}, {"A": 201}]
-00011690: 2c0a 2020 2020 2020 2020 636c 6965 6e74  ,.        client
-000116a0: 2e5f 7265 736f 6c76 655f 6a6f 696e 5f6b  ._resolve_join_k
-000116b0: 6579 7328 2a2a 6b77 6172 6773 292c 0a20  eys(**kwargs),. 
-000116c0: 2020 2020 2020 2074 6573 745f 7469 6d65         test_time
-000116d0: 7374 616d 7073 5f6c 6973 742c 0a20 2020  stamps_list,.   
-000116e0: 2020 2020 2065 7870 6563 7465 645f 7461       expected_ta
-000116f0: 6773 5f70 6172 616d 2c0a 2020 2020 290a  gs_param,.    ).
-00011700: 0a20 2020 2069 6620 6b77 6172 6773 3a0a  .    if kwargs:.
-00011710: 2020 2020 2020 2020 6d6f 636b 5f6a 6f69          mock_joi
-00011720: 6e5f 6b65 795f 6765 6e2e 6173 7365 7274  n_key_gen.assert
-00011730: 5f6e 6f74 5f63 616c 6c65 6428 290a 2020  _not_called().  
-00011740: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00011750: 6d6f 636b 5f6a 6f69 6e5f 6b65 795f 6765  mock_join_key_ge
-00011760: 6e2e 6173 7365 7274 5f63 616c 6c65 6428  n.assert_called(
-00011770: 290a 0a0a 4070 7974 6573 742e 6d61 726b  )...@pytest.mark
-00011780: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
-00011790: 2020 2274 6573 745f 7469 6d65 7374 616d    "test_timestam
-000117a0: 7073 2c20 7465 7374 5f74 696d 6573 7461  ps, test_timesta
-000117b0: 6d70 735f 6c69 7374 222c 0a20 2020 205b  mps_list",.    [
-000117c0: 0a20 2020 2020 2020 2028 4e6f 6e65 2c20  .        (None, 
-000117d0: 4e6f 6e65 292c 0a20 2020 2020 2020 2028  None),.        (
-000117e0: 5b43 5552 5245 4e54 5f54 494d 455d 202a  [CURRENT_TIME] *
-000117f0: 2032 2c20 5b43 5552 5245 4e54 5f54 494d   2, [CURRENT_TIM
-00011800: 455d 202a 2032 292c 0a20 2020 2020 2020  E] * 2),.       
-00011810: 2028 6e70 2e61 7272 6179 285b 4355 5252   (np.array([CURR
-00011820: 454e 545f 5449 4d45 5d20 2a20 3229 2c20  ENT_TIME] * 2), 
-00011830: 5b43 5552 5245 4e54 5f54 494d 455d 202a  [CURRENT_TIME] *
-00011840: 2032 292c 0a20 2020 205d 2c0a 290a 4070   2),.    ],.).@p
-00011850: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
-00011860: 6574 7269 7a65 280a 2020 2020 2274 6573  etrize(.    "tes
-00011870: 745f 6665 6564 6261 636b 7322 2c0a 2020  t_feedbacks",.  
-00011880: 2020 5b0a 2020 2020 2020 2020 5b7b 2241    [.        [{"A
-00011890: 223a 2032 3030 7d2c 207b 2241 223a 2032  ": 200}, {"A": 2
-000118a0: 3031 7d5d 2c0a 2020 2020 2020 2020 7064  01}],.        pd
-000118b0: 2e44 6174 6146 7261 6d65 2e66 726f 6d5f  .DataFrame.from_
-000118c0: 6469 6374 287b 2241 223a 205b 3230 302c  dict({"A": [200,
-000118d0: 2032 3031 5d7d 292c 0a20 2020 2020 2020   201]}),.       
-000118e0: 2070 642e 5365 7269 6573 286e 616d 653d   pd.Series(name=
-000118f0: 2241 222c 2064 6174 613d 5b32 3030 2c20  "A", data=[200, 
-00011900: 3230 315d 292c 0a20 2020 2020 2020 206e  201]),.        n
-00011910: 702e 6172 7261 7928 5b7b 2241 223a 2032  p.array([{"A": 2
-00011920: 3030 7d2c 207b 2241 223a 2032 3031 7d5d  00}, {"A": 201}]
-00011930: 292c 0a20 2020 205d 2c0a 290a 4070 7974  ),.    ],.).@pyt
-00011940: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-00011950: 7269 7a65 280a 2020 2020 2274 6573 745f  rize(.    "test_
-00011960: 6f75 7470 7574 7322 2c0a 2020 2020 5b0a  outputs",.    [.
-00011970: 2020 2020 2020 2020 5b7b 2242 223a 2033          [{"B": 3
-00011980: 3030 7d2c 207b 2242 223a 2033 3031 7d5d  00}, {"B": 301}]
-00011990: 2c0a 2020 2020 2020 2020 7064 2e44 6174  ,.        pd.Dat
-000119a0: 6146 7261 6d65 2e66 726f 6d5f 6469 6374  aFrame.from_dict
-000119b0: 287b 2242 223a 205b 3330 302c 2033 3031  ({"B": [300, 301
-000119c0: 5d7d 292c 0a20 2020 2020 2020 2070 642e  ]}),.        pd.
-000119d0: 5365 7269 6573 286e 616d 653d 2242 222c  Series(name="B",
-000119e0: 2064 6174 613d 5b33 3030 2c20 3330 315d   data=[300, 301]
-000119f0: 292c 0a20 2020 2020 2020 206e 702e 6172  ),.        np.ar
-00011a00: 7261 7928 5b7b 2242 223a 2033 3030 7d2c  ray([{"B": 300},
-00011a10: 207b 2242 223a 2033 3031 7d5d 292c 0a20   {"B": 301}]),. 
-00011a20: 2020 205d 2c0a 290a 4070 7974 6573 742e     ],.).@pytest.
-00011a30: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-00011a40: 280a 2020 2020 2274 6573 745f 696e 7075  (.    "test_inpu
-00011a50: 7473 222c 0a20 2020 205b 0a20 2020 2020  ts",.    [.     
-00011a60: 2020 205b 7b22 4122 3a20 3130 307d 2c20     [{"A": 100}, 
-00011a70: 7b22 4122 3a20 3130 317d 5d2c 0a20 2020  {"A": 101}],.   
-00011a80: 2020 2020 2070 642e 4461 7461 4672 616d       pd.DataFram
-00011a90: 652e 6672 6f6d 5f64 6963 7428 7b22 4122  e.from_dict({"A"
-00011aa0: 3a20 5b31 3030 2c20 3130 315d 7d29 2c0a  : [100, 101]}),.
-00011ab0: 2020 2020 2020 2020 7064 2e53 6572 6965          pd.Serie
-00011ac0: 7328 6e61 6d65 3d22 4122 2c20 6461 7461  s(name="A", data
-00011ad0: 3d5b 3130 302c 2031 3031 5d29 2c0a 2020  =[100, 101]),.  
-00011ae0: 2020 2020 2020 6e70 2e61 7272 6179 285b        np.array([
-00011af0: 7b22 4122 3a20 3130 307d 2c20 7b22 4122  {"A": 100}, {"A"
-00011b00: 3a20 3130 317d 5d29 2c0a 2020 2020 5d2c  : 101}]),.    ],
-00011b10: 0a29 0a40 7079 7465 7374 2e6d 6172 6b2e  .).@pytest.mark.
-00011b20: 7061 7261 6d65 7472 697a 6528 2276 6572  parametrize("ver
-00011b30: 7369 6f6e 222c 205b 4e6f 6e65 2c20 3130  sion", [None, 10
-00011b40: 2c20 2231 2e32 2e33 225d 290a 4070 7974  , "1.2.3"]).@pyt
-00011b50: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-00011b60: 7269 7a65 280a 2020 2020 2274 6167 732c  rize(.    "tags,
-00011b70: 2072 6f77 5f74 6167 732c 2067 6c6f 6261   row_tags, globa
-00011b80: 6c5f 7461 6773 2c20 6578 7065 6374 6564  l_tags, expected
-00011b90: 5f74 6167 735f 7061 7261 6d22 2c0a 2020  _tags_param",.  
-00011ba0: 2020 5b0a 2020 2020 2020 2020 284e 6f6e    [.        (Non
-00011bb0: 652c 204e 6f6e 652c 204e 6f6e 652c 205b  e, None, None, [
-00011bc0: 7b22 656e 7622 3a20 2274 6573 7422 7d2c  {"env": "test"},
-00011bd0: 207b 2265 6e76 223a 2022 7465 7374 227d   {"env": "test"}
-00011be0: 5d29 2c0a 2020 2020 2020 2020 280a 2020  ]),.        (.  
-00011bf0: 2020 2020 2020 2020 2020 7b22 6261 7222            {"bar"
-00011c00: 3a20 2262 6172 227d 2c0a 2020 2020 2020  : "bar"},.      
-00011c10: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-00011c20: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
-00011c30: 2020 2020 2020 2020 2020 5b7b 2262 6172            [{"bar
-00011c40: 223a 2022 6261 7222 2c20 2265 6e76 223a  ": "bar", "env":
-00011c50: 2022 7465 7374 227d 2c20 7b22 6261 7222   "test"}, {"bar"
-00011c60: 3a20 2262 6172 222c 2022 656e 7622 3a20  : "bar", "env": 
-00011c70: 2274 6573 7422 7d5d 2c0a 2020 2020 2020  "test"}],.      
-00011c80: 2020 292c 0a20 2020 2020 2020 2028 0a20    ),.        (. 
-00011c90: 2020 2020 2020 2020 2020 207b 2262 6172             {"bar
-00011ca0: 223a 2022 6261 7222 7d2c 0a20 2020 2020  ": "bar"},.     
-00011cb0: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
-00011cc0: 2020 2020 2020 2020 207b 2266 6f6f 223a           {"foo":
-00011cd0: 2022 666f 6f22 7d2c 0a20 2020 2020 2020   "foo"},.       
-00011ce0: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00011cf0: 2020 2020 2020 207b 2262 6172 223a 2022         {"bar": "
-00011d00: 6261 7222 2c20 2265 6e76 223a 2022 7465  bar", "env": "te
-00011d10: 7374 222c 2022 666f 6f22 3a20 2266 6f6f  st", "foo": "foo
-00011d20: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-00011d30: 2020 2020 7b22 6261 7222 3a20 2262 6172      {"bar": "bar
-00011d40: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
-00011d50: 2c20 2266 6f6f 223a 2022 666f 6f22 7d2c  , "foo": "foo"},
-00011d60: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
-00011d70: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-00011d80: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
-00011d90: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-00011da0: 2020 205b 7b22 6261 7222 3a20 2262 6172     [{"bar": "bar
-00011db0: 227d 2c20 7b22 6261 7222 3a20 2262 617a  "}, {"bar": "baz
-00011dc0: 227d 5d2c 0a20 2020 2020 2020 2020 2020  "}],.           
-00011dd0: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-00011de0: 2020 205b 7b22 6261 7222 3a20 2262 6172     [{"bar": "bar
-00011df0: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
-00011e00: 7d2c 207b 2262 6172 223a 2022 6261 7a22  }, {"bar": "baz"
-00011e10: 2c20 2265 6e76 223a 2022 7465 7374 227d  , "env": "test"}
-00011e20: 5d2c 0a20 2020 2020 2020 2029 2c0a 2020  ],.        ),.  
-00011e30: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-00011e40: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
-00011e50: 2020 2020 2020 5b7b 2262 6172 223a 2022        [{"bar": "
-00011e60: 6261 7222 7d2c 207b 2262 6172 223a 2022  bar"}, {"bar": "
-00011e70: 6261 7a22 7d5d 2c0a 2020 2020 2020 2020  baz"}],.        
-00011e80: 2020 2020 7b22 666f 6f22 3a20 2266 6f6f      {"foo": "foo
-00011e90: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-00011ea0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00011eb0: 2020 7b22 6261 7222 3a20 2262 6172 222c    {"bar": "bar",
-00011ec0: 2022 656e 7622 3a20 2274 6573 7422 2c20   "env": "test", 
-00011ed0: 2266 6f6f 223a 2022 666f 6f22 7d2c 0a20  "foo": "foo"},. 
-00011ee0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00011ef0: 2262 6172 223a 2022 6261 7a22 2c20 2265  "bar": "baz", "e
-00011f00: 6e76 223a 2022 7465 7374 222c 2022 666f  nv": "test", "fo
-00011f10: 6f22 3a20 2266 6f6f 227d 2c0a 2020 2020  o": "foo"},.    
-00011f20: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-00011f30: 2020 2029 2c0a 2020 2020 2020 2020 280a     ),.        (.
-00011f40: 2020 2020 2020 2020 2020 2020 7b22 666f              {"fo
-00011f50: 6f22 3a20 2266 6f6f 227d 2c0a 2020 2020  o": "foo"},.    
-00011f60: 2020 2020 2020 2020 5b7b 2262 6172 223a          [{"bar":
-00011f70: 2022 6261 7222 7d2c 207b 2262 6172 223a   "bar"}, {"bar":
-00011f80: 2022 6261 7a22 7d5d 2c0a 2020 2020 2020   "baz"}],.      
-00011f90: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-00011fa0: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-00011fb0: 2020 2020 2020 2020 2020 7b22 6261 7222            {"bar"
-00011fc0: 3a20 2262 6172 222c 2022 656e 7622 3a20  : "bar", "env": 
-00011fd0: 2274 6573 7422 2c20 2266 6f6f 223a 2022  "test", "foo": "
-00011fe0: 666f 6f22 7d2c 0a20 2020 2020 2020 2020  foo"},.         
-00011ff0: 2020 2020 2020 207b 2262 6172 223a 2022         {"bar": "
-00012000: 6261 7a22 2c20 2265 6e76 223a 2022 7465  baz", "env": "te
-00012010: 7374 222c 2022 666f 6f22 3a20 2266 6f6f  st", "foo": "foo
-00012020: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-00012030: 5d2c 0a20 2020 2020 2020 2029 2c0a 2020  ],.        ),.  
-00012040: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-00012050: 2020 2020 7b22 6261 7222 3a20 2262 6172      {"bar": "bar
-00012060: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-00012070: 5b7b 2266 6f6f 223a 2022 666f 6f22 7d2c  [{"foo": "foo"},
-00012080: 207b 2262 617a 223a 2022 6261 7a22 7d5d   {"baz": "baz"}]
-00012090: 2c0a 2020 2020 2020 2020 2020 2020 7b22  ,.            {"
-000120a0: 656e 7622 3a20 2266 6f6f 6261 7222 7d2c  env": "foobar"},
-000120b0: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
-000120c0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-000120d0: 2262 6172 223a 2022 6261 7222 2c20 2265  "bar": "bar", "e
-000120e0: 6e76 223a 2022 666f 6f62 6172 222c 2022  nv": "foobar", "
-000120f0: 666f 6f22 3a20 2266 6f6f 227d 2c0a 2020  foo": "foo"},.  
-00012100: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-00012110: 6261 7222 3a20 2262 6172 222c 2022 656e  bar": "bar", "en
-00012120: 7622 3a20 2266 6f6f 6261 7222 2c20 2262  v": "foobar", "b
-00012130: 617a 223a 2022 6261 7a22 7d2c 0a20 2020  az": "baz"},.   
-00012140: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-00012150: 2020 2020 292c 0a20 2020 2020 2020 2028      ),.        (
-00012160: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-00012170: 652c 0a20 2020 2020 2020 2020 2020 205b  e,.            [
-00012180: 7b22 6261 7222 3a20 2262 6172 227d 2c20  {"bar": "bar"}, 
-00012190: 7b22 6261 7222 3a20 2262 617a 227d 5d2c  {"bar": "baz"}],
-000121a0: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-000121b0: 652c 0a20 2020 2020 2020 2020 2020 205b  e,.            [
-000121c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000121d0: 207b 2262 6172 223a 2022 6261 7222 2c20   {"bar": "bar", 
-000121e0: 2265 6e76 223a 2022 7465 7374 227d 2c0a  "env": "test"},.
-000121f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012200: 7b22 6261 7222 3a20 2262 617a 222c 2022  {"bar": "baz", "
-00012210: 656e 7622 3a20 2274 6573 7422 7d2c 0a20  env": "test"},. 
-00012220: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
-00012230: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-00012240: 2028 0a20 2020 2020 2020 2020 2020 204e   (.            N
-00012250: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-00012260: 206e 702e 6172 7261 7928 5b7b 2262 6172   np.array([{"bar
-00012270: 223a 2022 6261 7222 7d2c 207b 2262 6172  ": "bar"}, {"bar
-00012280: 223a 2022 6261 7a22 7d5d 292c 0a20 2020  ": "baz"}]),.   
-00012290: 2020 2020 2020 2020 204e 6f6e 652c 0a20           None,. 
-000122a0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
-000122b0: 2020 2020 2020 2020 2020 2020 207b 2262               {"b
-000122c0: 6172 223a 2022 6261 7222 2c20 2265 6e76  ar": "bar", "env
-000122d0: 223a 2022 7465 7374 227d 2c0a 2020 2020  ": "test"},.    
-000122e0: 2020 2020 2020 2020 2020 2020 7b22 6261              {"ba
-000122f0: 7222 3a20 2262 617a 222c 2022 656e 7622  r": "baz", "env"
-00012300: 3a20 2274 6573 7422 7d2c 0a20 2020 2020  : "test"},.     
-00012310: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-00012320: 2020 292c 0a20 2020 2020 2020 2028 0a20    ),.        (. 
-00012330: 2020 2020 2020 2020 2020 204e 6f6e 652c             None,
-00012340: 0a20 2020 2020 2020 2020 2020 2070 642e  .            pd.
-00012350: 5365 7269 6573 285b 2262 6172 222c 2022  Series(["bar", "
-00012360: 6261 7a22 5d2c 206e 616d 653d 2262 6172  baz"], name="bar
-00012370: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
-00012380: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-00012390: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-000123a0: 2020 2020 7b22 6261 7222 3a20 2262 6172      {"bar": "bar
-000123b0: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
-000123c0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-000123d0: 2020 207b 2262 6172 223a 2022 6261 7a22     {"bar": "baz"
-000123e0: 2c20 2265 6e76 223a 2022 7465 7374 227d  , "env": "test"}
-000123f0: 2c0a 2020 2020 2020 2020 2020 2020 5d2c  ,.            ],
-00012400: 0a20 2020 2020 2020 2029 2c0a 2020 2020  .        ),.    
-00012410: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
-00012420: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
-00012430: 2020 2020 7064 2e44 6174 6146 7261 6d65      pd.DataFrame
-00012440: 287b 2262 6172 223a 205b 2262 6172 222c  ({"bar": ["bar",
-00012450: 2022 6261 7a22 5d7d 292c 0a20 2020 2020   "baz"]}),.     
-00012460: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
-00012470: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
-00012480: 2020 2020 2020 2020 2020 207b 2262 6172             {"bar
-00012490: 223a 2022 6261 7222 2c20 2265 6e76 223a  ": "bar", "env":
-000124a0: 2022 7465 7374 227d 2c0a 2020 2020 2020   "test"},.      
-000124b0: 2020 2020 2020 2020 2020 7b22 6261 7222            {"bar"
-000124c0: 3a20 2262 617a 222c 2022 656e 7622 3a20  : "baz", "env": 
-000124d0: 2274 6573 7422 7d2c 0a20 2020 2020 2020  "test"},.       
-000124e0: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-000124f0: 292c 0a20 2020 205d 2c0a 290a 4070 7974  ),.    ],.).@pyt
-00012500: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-00012510: 7269 7a65 280a 2020 2020 226b 7761 7267  rize(.    "kwarg
-00012520: 7322 2c0a 2020 2020 5b0a 2020 2020 2020  s",.    [.      
-00012530: 2020 7b22 6a6f 696e 5f6b 6579 7322 3a20    {"join_keys": 
-00012540: 5b22 3534 3332 3122 2c20 2236 3738 3930  ["54321", "67890
-00012550: 225d 7d2c 0a20 2020 2020 2020 207b 226a  "]},.        {"j
-00012560: 6f69 6e5f 6b65 7973 223a 2070 642e 5365  oin_keys": pd.Se
-00012570: 7269 6573 285b 2235 3433 3231 222c 2022  ries(["54321", "
-00012580: 3637 3839 3022 5d29 7d2c 0a20 2020 2020  67890"])},.     
-00012590: 2020 207b 7d2c 0a20 2020 205d 2c0a 290a     {},.    ],.).
-000125a0: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
-000125b0: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
-000125c0: 742e 5f72 6573 6f6c 7665 5f6a 6f69 6e5f  t._resolve_join_
-000125d0: 6b65 7973 2229 0a40 6d6f 636b 2e70 6174  keys").@mock.pat
-000125e0: 6368 280a 2020 2020 2267 616e 7472 792e  ch(.    "gantry.
-000125f0: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
-00012600: 6e74 7279 2e5f 6c6f 675f 7072 6564 6963  ntry._log_predic
-00012610: 7469 6f6e 5f61 6e64 5f66 6565 6462 6163  tion_and_feedbac
-00012620: 6b5f 6576 656e 7473 222c 0a20 2020 2072  k_events",.    r
-00012630: 6574 7572 6e5f 7661 6c75 653d 284e 6f6e  eturn_value=(Non
-00012640: 652c 205b 2231 3233 3435 222c 2022 3637  e, ["12345", "67
-00012650: 3839 3022 5d29 2c0a 290a 406d 6f63 6b2e  890"]),.).@mock.
-00012660: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
-00012670: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
-00012680: 7279 2e5f 6c6f 675f 7072 6564 6963 7469  ry._log_predicti
-00012690: 6f6e 5f65 7665 6e74 7322 290a 406d 6f63  on_events").@moc
-000126a0: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
-000126b0: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
-000126c0: 6e74 7279 2e5f 6c6f 675f 6665 6564 6261  ntry._log_feedba
-000126d0: 636b 5f65 7665 6e74 7322 290a 406d 6f63  ck_events").@moc
-000126e0: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
-000126f0: 6c6f 6767 6572 2e63 6c69 656e 742e 5f73  logger.client._s
-00012700: 616d 706c 655f 7265 636f 7264 7322 2c20  ample_records", 
-00012710: 7369 6465 5f65 6666 6563 743d 636c 6965  side_effect=clie
-00012720: 6e74 2e5f 7361 6d70 6c65 5f72 6563 6f72  nt._sample_recor
-00012730: 6473 290a 406d 6f63 6b2e 7061 7463 6828  ds).@mock.patch(
-00012740: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
-00012750: 6c69 656e 742e 5f64 6566 6175 6c74 5f6a  lient._default_j
-00012760: 6f69 6e5f 6b65 795f 6765 6e22 290a 6465  oin_key_gen").de
-00012770: 6620 7465 7374 5f73 696e 676c 655f 6c6f  f test_single_lo
-00012780: 675f 7072 6564 735f 616e 645f 6665 6564  g_preds_and_feed
-00012790: 6261 636b 280a 2020 2020 6d6f 636b 5f6a  back(.    mock_j
-000127a0: 6f69 6e5f 6b65 795f 6765 6e2c 0a20 2020  oin_key_gen,.   
-000127b0: 206d 6f63 6b5f 7361 6d70 6c65 5f72 6563   mock_sample_rec
-000127c0: 6f72 6473 2c0a 2020 2020 6d6f 636b 5f6c  ords,.    mock_l
-000127d0: 6f67 5f66 6565 6462 6163 6b2c 0a20 2020  og_feedback,.   
-000127e0: 206d 6f63 6b5f 6c6f 675f 7072 6564 732c   mock_log_preds,
-000127f0: 0a20 2020 206d 6f63 6b5f 6c6f 675f 7072  .    mock_log_pr
-00012800: 6564 735f 616e 645f 6665 6564 6261 636b  eds_and_feedback
-00012810: 2c0a 2020 2020 6d6f 636b 5f72 6573 6f6c  ,.    mock_resol
-00012820: 7665 5f6a 6f69 6e5f 6b65 7973 2c0a 2020  ve_join_keys,.  
-00012830: 2020 6b77 6172 6773 2c0a 2020 2020 7665    kwargs,.    ve
-00012840: 7273 696f 6e2c 0a20 2020 2074 6167 732c  rsion,.    tags,
-00012850: 0a20 2020 2072 6f77 5f74 6167 732c 0a20  .    row_tags,. 
-00012860: 2020 2067 6c6f 6261 6c5f 7461 6773 2c0a     global_tags,.
-00012870: 2020 2020 6578 7065 6374 6564 5f74 6167      expected_tag
-00012880: 735f 7061 7261 6d2c 0a20 2020 2074 6573  s_param,.    tes
-00012890: 745f 7469 6d65 7374 616d 7073 2c0a 2020  t_timestamps,.  
-000128a0: 2020 7465 7374 5f74 696d 6573 7461 6d70    test_timestamp
-000128b0: 735f 6c69 7374 2c0a 2020 2020 7465 7374  s_list,.    test
-000128c0: 5f69 6e70 7574 732c 0a20 2020 2074 6573  _inputs,.    tes
-000128d0: 745f 6f75 7470 7574 732c 0a20 2020 2074  t_outputs,.    t
-000128e0: 6573 745f 6665 6564 6261 636b 732c 0a20  est_feedbacks,. 
-000128f0: 2020 2063 6c69 5f6f 626a 2c0a 293a 0a20     cli_obj,.):. 
-00012900: 2020 206d 6f63 6b5f 6a6f 696e 5f6b 6579     mock_join_key
-00012910: 5f67 656e 2e73 6964 655f 6566 6665 6374  _gen.side_effect
-00012920: 203d 205b 2236 3738 3930 222c 2022 3132   = ["67890", "12
-00012930: 3334 3522 5d0a 2020 2020 6d6f 636b 5f72  345"].    mock_r
-00012940: 6573 6f6c 7665 5f6a 6f69 6e5f 6b65 7973  esolve_join_keys
-00012950: 2e72 6574 7572 6e5f 7661 6c75 6520 3d20  .return_value = 
-00012960: 5b22 3132 3334 3522 2c20 2236 3738 3930  ["12345", "67890
-00012970: 225d 2069 6620 6b77 6172 6773 2065 6c73  "] if kwargs els
-00012980: 6520 4e6f 6e65 0a20 2020 2063 6c69 5f6f  e None.    cli_o
-00012990: 626a 2e6c 6f67 280a 2020 2020 2020 2020  bj.log(.        
-000129a0: 6170 706c 6963 6174 696f 6e3d 2266 6f6f  application="foo
-000129b0: 6261 7222 2c0a 2020 2020 2020 2020 7665  bar",.        ve
-000129c0: 7273 696f 6e3d 7665 7273 696f 6e2c 0a20  rsion=version,. 
-000129d0: 2020 2020 2020 2069 6e70 7574 733d 7465         inputs=te
-000129e0: 7374 5f69 6e70 7574 732c 0a20 2020 2020  st_inputs,.     
-000129f0: 2020 206f 7574 7075 7473 3d74 6573 745f     outputs=test_
-00012a00: 6f75 7470 7574 732c 0a20 2020 2020 2020  outputs,.       
-00012a10: 2066 6565 6462 6163 6b73 3d74 6573 745f   feedbacks=test_
-00012a20: 6665 6564 6261 636b 732c 0a20 2020 2020  feedbacks,.     
-00012a30: 2020 2074 696d 6573 7461 6d70 733d 7465     timestamps=te
-00012a40: 7374 5f74 696d 6573 7461 6d70 732c 0a20  st_timestamps,. 
-00012a50: 2020 2020 2020 2073 6f72 745f 6f6e 5f74         sort_on_t
-00012a60: 696d 6573 7461 6d70 3d54 7275 652c 0a20  imestamp=True,. 
-00012a70: 2020 2020 2020 2073 616d 706c 655f 7261         sample_ra
-00012a80: 7465 3d31 2c0a 2020 2020 2020 2020 676c  te=1,.        gl
-00012a90: 6f62 616c 5f74 6167 733d 676c 6f62 616c  obal_tags=global
-00012aa0: 5f74 6167 732c 0a20 2020 2020 2020 2074  _tags,.        t
-00012ab0: 6167 733d 7461 6773 2c0a 2020 2020 2020  ags=tags,.      
-00012ac0: 2020 726f 775f 7461 6773 3d72 6f77 5f74    row_tags=row_t
-00012ad0: 6167 732c 0a20 2020 2020 2020 202a 2a6b  ags,.        **k
-00012ae0: 7761 7267 732c 0a20 2020 2029 0a0a 2020  wargs,.    )..  
-00012af0: 2020 6d6f 636b 5f6c 6f67 5f70 7265 6473    mock_log_preds
-00012b00: 5f61 6e64 5f66 6565 6462 6163 6b2e 6173  _and_feedback.as
-00012b10: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
-00012b20: 5f77 6974 6828 0a20 2020 2020 2020 2061  _with(.        a
-00012b30: 7070 6c69 6361 7469 6f6e 3d22 666f 6f62  pplication="foob
-00012b40: 6172 222c 0a20 2020 2020 2020 2069 6e70  ar",.        inp
-00012b50: 7574 733d 5b7b 2241 223a 2031 3030 7d2c  uts=[{"A": 100},
-00012b60: 207b 2241 223a 2031 3031 7d5d 2c0a 2020   {"A": 101}],.  
-00012b70: 2020 2020 2020 6f75 7470 7574 733d 5b7b        outputs=[{
-00012b80: 2242 223a 2033 3030 7d2c 207b 2242 223a  "B": 300}, {"B":
-00012b90: 2033 3031 7d5d 2c0a 2020 2020 2020 2020   301}],.        
-00012ba0: 6665 6564 6261 636b 733d 5b7b 2241 223a  feedbacks=[{"A":
-00012bb0: 2032 3030 7d2c 207b 2241 223a 2032 3031   200}, {"A": 201
-00012bc0: 7d5d 2c0a 2020 2020 2020 2020 6a6f 696e  }],.        join
-00012bd0: 5f6b 6579 733d 5b22 3132 3334 3522 2c20  _keys=["12345", 
-00012be0: 2236 3738 3930 225d 2069 6620 6b77 6172  "67890"] if kwar
-00012bf0: 6773 2065 6c73 6520 5b22 3637 3839 3022  gs else ["67890"
-00012c00: 2c20 2231 3233 3435 225d 2c0a 2020 2020  , "12345"],.    
-00012c10: 2020 2020 7665 7273 696f 6e3d 7665 7273      version=vers
-00012c20: 696f 6e2c 0a20 2020 2020 2020 2069 676e  ion,.        ign
-00012c30: 6f72 655f 696e 7075 7473 3d4e 6f6e 652c  ore_inputs=None,
-00012c40: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
-00012c50: 6d70 733d 7465 7374 5f74 696d 6573 7461  mps=test_timesta
-00012c60: 6d70 735f 6c69 7374 2c0a 2020 2020 2020  mps_list,.      
-00012c70: 2020 736f 7274 5f6f 6e5f 7469 6d65 7374    sort_on_timest
-00012c80: 616d 703d 5472 7565 2c0a 2020 2020 2020  amp=True,.      
-00012c90: 2020 7461 6773 3d65 7870 6563 7465 645f    tags=expected_
-00012ca0: 7461 6773 5f70 6172 616d 2c0a 2020 2020  tags_param,.    
-00012cb0: 2020 2020 6173 5f62 6174 6368 3d46 616c      as_batch=Fal
-00012cc0: 7365 2c0a 2020 2020 290a 2020 2020 6d6f  se,.    ).    mo
-00012cd0: 636b 5f6c 6f67 5f70 7265 6473 2e61 7373  ck_log_preds.ass
-00012ce0: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
-00012cf0: 0a20 2020 206d 6f63 6b5f 6c6f 675f 6665  .    mock_log_fe
-00012d00: 6564 6261 636b 2e61 7373 6572 745f 6e6f  edback.assert_no
-00012d10: 745f 6361 6c6c 6564 2829 0a0a 2020 2020  t_called()..    
-00012d20: 6d6f 636b 5f73 616d 706c 655f 7265 636f  mock_sample_reco
-00012d30: 7264 732e 6173 7365 7274 5f63 616c 6c65  rds.assert_calle
-00012d40: 645f 6f6e 6365 5f77 6974 6828 0a20 2020  d_once_with(.   
-00012d50: 2020 2020 2032 2c0a 2020 2020 2020 2020       2,.        
-00012d60: 312c 0a20 2020 2020 2020 205b 7b22 4122  1,.        [{"A"
-00012d70: 3a20 3130 307d 2c20 7b22 4122 3a20 3130  : 100}, {"A": 10
-00012d80: 317d 5d2c 0a20 2020 2020 2020 205b 7b22  1}],.        [{"
-00012d90: 4222 3a20 3330 307d 2c20 7b22 4222 3a20  B": 300}, {"B": 
-00012da0: 3330 317d 5d2c 0a20 2020 2020 2020 205b  301}],.        [
-00012db0: 7b22 4122 3a20 3230 307d 2c20 7b22 4122  {"A": 200}, {"A"
-00012dc0: 3a20 3230 317d 5d2c 0a20 2020 2020 2020  : 201}],.       
-00012dd0: 2063 6c69 656e 742e 5f72 6573 6f6c 7665   client._resolve
-00012de0: 5f6a 6f69 6e5f 6b65 7973 282a 2a6b 7761  _join_keys(**kwa
-00012df0: 7267 7329 2c0a 2020 2020 2020 2020 7465  rgs),.        te
-00012e00: 7374 5f74 696d 6573 7461 6d70 735f 6c69  st_timestamps_li
-00012e10: 7374 2c0a 2020 2020 2020 2020 6578 7065  st,.        expe
-00012e20: 6374 6564 5f74 6167 735f 7061 7261 6d2c  cted_tags_param,
-00012e30: 0a20 2020 2029 0a0a 2020 2020 6966 206b  .    )..    if k
-00012e40: 7761 7267 733a 0a20 2020 2020 2020 206d  wargs:.        m
-00012e50: 6f63 6b5f 6a6f 696e 5f6b 6579 5f67 656e  ock_join_key_gen
-00012e60: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
-00012e70: 6564 2829 0a20 2020 2065 6c73 653a 0a20  ed().    else:. 
-00012e80: 2020 2020 2020 206d 6f63 6b5f 6a6f 696e         mock_join
-00012e90: 5f6b 6579 5f67 656e 2e61 7373 6572 745f  _key_gen.assert_
-00012ea0: 6361 6c6c 6564 2829 0a0a 0a40 7079 7465  called()...@pyte
-00012eb0: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
-00012ec0: 697a 6528 0a20 2020 2022 696e 7075 7473  ize(.    "inputs
-00012ed0: 2c20 6f75 7470 7574 732c 2066 6565 6462  , outputs, feedb
-00012ee0: 6163 6b73 222c 0a20 2020 205b 0a20 2020  acks",.    [.   
-00012ef0: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
-00012f00: 2020 206e 702e 6172 7261 7928 5b32 3030     np.array([200
-00012f10: 2c20 3230 315d 292c 0a20 2020 2020 2020  , 201]),.       
-00012f20: 2020 2020 205b 7b22 4222 3a20 3230 307d       [{"B": 200}
-00012f30: 2c20 7b22 4222 3a20 3230 317d 5d2c 0a20  , {"B": 201}],. 
-00012f40: 2020 2020 2020 2020 2020 205b 7b22 4122             [{"A"
-00012f50: 3a20 3230 307d 2c20 7b22 4122 3a20 3230  : 200}, {"A": 20
-00012f60: 317d 5d2c 0a20 2020 2020 2020 2029 2c0a  1}],.        ),.
-00012f70: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
-00012f80: 2020 2020 2020 6e70 2e61 7272 6179 285b        np.array([
-00012f90: 3230 302c 2032 3031 5d29 2c0a 2020 2020  200, 201]),.    
-00012fa0: 2020 2020 2020 2020 5b7b 2242 223a 2032          [{"B": 2
-00012fb0: 3030 7d2c 207b 2242 223a 2032 3031 7d5d  00}, {"B": 201}]
-00012fc0: 2c0a 2020 2020 2020 2020 2020 2020 4e6f  ,.            No
-00012fd0: 6e65 2c0a 2020 2020 2020 2020 292c 0a20  ne,.        ),. 
-00012fe0: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
-00012ff0: 2020 2020 206e 702e 6172 7261 7928 5b32       np.array([2
-00013000: 3030 2c20 3230 315d 292c 0a20 2020 2020  00, 201]),.     
-00013010: 2020 2020 2020 206e 702e 6172 7261 7928         np.array(
-00013020: 5b32 3030 2c20 3230 315d 292c 0a20 2020  [200, 201]),.   
-00013030: 2020 2020 2020 2020 204e 6f6e 652c 0a20           None,. 
-00013040: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-00013050: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-00013060: 5b7b 2242 223a 2032 3030 7d2c 207b 2242  [{"B": 200}, {"B
-00013070: 223a 2032 3031 7d5d 2c0a 2020 2020 2020  ": 201}],.      
-00013080: 2020 2020 2020 6e70 2e61 7272 6179 285b        np.array([
-00013090: 3230 302c 2032 3031 5d29 2c0a 2020 2020  200, 201]),.    
-000130a0: 2020 2020 2020 2020 5b7b 2241 223a 2032          [{"A": 2
-000130b0: 3030 7d2c 207b 2241 223a 2032 3031 7d5d  00}, {"A": 201}]
-000130c0: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
-000130d0: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
-000130e0: 2020 205b 7b22 4222 3a20 3230 307d 2c20     [{"B": 200}, 
-000130f0: 7b22 4222 3a20 3230 317d 5d2c 0a20 2020  {"B": 201}],.   
-00013100: 2020 2020 2020 2020 205b 7b22 4122 3a20           [{"A": 
-00013110: 3230 307d 2c20 7b22 4122 3a20 3230 317d  200}, {"A": 201}
-00013120: 5d2c 0a20 2020 2020 2020 2020 2020 206e  ],.            n
-00013130: 702e 6172 7261 7928 5b32 3030 2c20 3230  p.array([200, 20
-00013140: 315d 292c 0a20 2020 2020 2020 2029 2c0a  1]),.        ),.
-00013150: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
-00013160: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-00013170: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
-00013180: 2020 2020 2020 2020 2020 6e70 2e61 7272            np.arr
-00013190: 6179 285b 3230 302c 2032 3031 5d29 2c0a  ay([200, 201]),.
-000131a0: 2020 2020 2020 2020 292c 0a20 2020 205d          ),.    ]
-000131b0: 2c0a 290a 406d 6f63 6b2e 7061 7463 6828  ,.).@mock.patch(
-000131c0: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
-000131d0: 6c69 656e 742e 4761 6e74 7279 2e5f 6c6f  lient.Gantry._lo
-000131e0: 675f 7072 6564 6963 7469 6f6e 5f61 6e64  g_prediction_and
-000131f0: 5f66 6565 6462 6163 6b5f 6576 656e 7473  _feedback_events
-00013200: 2229 0a40 6d6f 636b 2e70 6174 6368 2822  ").@mock.patch("
-00013210: 6761 6e74 7279 2e6c 6f67 6765 722e 636c  gantry.logger.cl
-00013220: 6965 6e74 2e47 616e 7472 792e 5f6c 6f67  ient.Gantry._log
-00013230: 5f70 7265 6469 6374 696f 6e5f 6576 656e  _prediction_even
-00013240: 7473 2229 0a40 6d6f 636b 2e70 6174 6368  ts").@mock.patch
-00013250: 2822 6761 6e74 7279 2e6c 6f67 6765 722e  ("gantry.logger.
-00013260: 636c 6965 6e74 2e47 616e 7472 792e 5f6c  client.Gantry._l
-00013270: 6f67 5f66 6565 6462 6163 6b5f 6576 656e  og_feedback_even
-00013280: 7473 2229 0a64 6566 2074 6573 745f 6c6f  ts").def test_lo
-00013290: 675f 7265 636f 7264 735f 7072 6564 735f  g_records_preds_
-000132a0: 616e 645f 6665 6564 6261 636b 5f77 726f  and_feedback_wro
-000132b0: 6e67 5f6e 705f 6172 7261 7928 0a20 2020  ng_np_array(.   
-000132c0: 206d 6f63 6b5f 6665 6564 6261 636b 2c0a   mock_feedback,.
-000132d0: 2020 2020 6d6f 636b 5f70 7265 6473 2c0a      mock_preds,.
-000132e0: 2020 2020 6d6f 636b 5f70 7265 6473 5f61      mock_preds_a
-000132f0: 6e64 5f66 6565 6462 6163 6b2c 0a20 2020  nd_feedback,.   
-00013300: 2069 6e70 7574 732c 0a20 2020 206f 7574   inputs,.    out
-00013310: 7075 7473 2c0a 2020 2020 6665 6564 6261  puts,.    feedba
-00013320: 636b 732c 0a20 2020 2063 6c69 5f6f 626a  cks,.    cli_obj
-00013330: 2c0a 293a 0a20 2020 2061 7373 6572 7420  ,.):.    assert 
-00013340: 280a 2020 2020 2020 2020 636c 695f 6f62  (.        cli_ob
-00013350: 6a2e 6c6f 675f 7265 636f 7264 7328 0a20  j.log_records(. 
-00013360: 2020 2020 2020 2020 2020 2061 7070 6c69             appli
-00013370: 6361 7469 6f6e 3d22 666f 6f62 6172 222c  cation="foobar",
-00013380: 0a20 2020 2020 2020 2020 2020 2076 6572  .            ver
-00013390: 7369 6f6e 3d22 312e 322e 3322 2c0a 2020  sion="1.2.3",.  
-000133a0: 2020 2020 2020 2020 2020 696e 7075 7473            inputs
-000133b0: 3d69 6e70 7574 732c 0a20 2020 2020 2020  =inputs,.       
-000133c0: 2020 2020 206f 7574 7075 7473 3d6f 7574       outputs=out
-000133d0: 7075 7473 2c0a 2020 2020 2020 2020 2020  puts,.          
-000133e0: 2020 6665 6564 6261 636b 733d 6665 6564    feedbacks=feed
-000133f0: 6261 636b 732c 0a20 2020 2020 2020 2020  backs,.         
-00013400: 2020 2074 696d 6573 7461 6d70 733d 4e6f     timestamps=No
-00013410: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00013420: 736f 7274 5f6f 6e5f 7469 6d65 7374 616d  sort_on_timestam
-00013430: 703d 5472 7565 2c0a 2020 2020 2020 2020  p=True,.        
-00013440: 2020 2020 7361 6d70 6c65 5f72 6174 653d      sample_rate=
-00013450: 312c 0a20 2020 2020 2020 2020 2020 206a  1,.            j
-00013460: 6f69 6e5f 6b65 7973 3d5b 2266 6f6f 6261  oin_keys=["fooba
-00013470: 7222 2c20 2262 6172 6261 7a22 5d2c 0a20  r", "barbaz"],. 
-00013480: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00013490: 2069 7320 4e6f 6e65 0a20 2020 2029 0a20   is None.    ). 
-000134a0: 2020 206d 6f63 6b5f 7072 6564 735f 616e     mock_preds_an
-000134b0: 645f 6665 6564 6261 636b 2e61 7373 6572  d_feedback.asser
-000134c0: 745f 6e6f 745f 6361 6c6c 6564 2829 0a20  t_not_called(). 
-000134d0: 2020 206d 6f63 6b5f 7072 6564 732e 6173     mock_preds.as
-000134e0: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
-000134f0: 290a 2020 2020 6d6f 636b 5f66 6565 6462  ).    mock_feedb
-00013500: 6163 6b2e 6173 7365 7274 5f6e 6f74 5f63  ack.assert_not_c
-00013510: 616c 6c65 6428 290a 0a0a 4070 7974 6573  alled()...@pytes
-00013520: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
-00013530: 7a65 280a 2020 2020 2269 6e70 7574 732c  ze(.    "inputs,
-00013540: 206f 7574 7075 7473 2c20 6665 6564 6261   outputs, feedba
-00013550: 636b 7322 2c0a 2020 2020 5b0a 2020 2020  cks",.    [.    
-00013560: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
-00013570: 2020 6e70 2e61 7272 6179 285b 3230 302c    np.array([200,
-00013580: 2032 3031 5d29 2c0a 2020 2020 2020 2020   201]),.        
-00013590: 2020 2020 5b7b 2242 223a 2032 3030 7d2c      [{"B": 200},
-000135a0: 207b 2242 223a 2032 3031 7d5d 2c0a 2020   {"B": 201}],.  
-000135b0: 2020 2020 2020 2020 2020 5b7b 2241 223a            [{"A":
-000135c0: 2032 3030 7d2c 207b 2241 223a 2032 3031   200}, {"A": 201
-000135d0: 7d5d 2c0a 2020 2020 2020 2020 292c 0a20  }],.        ),. 
-000135e0: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
-000135f0: 2020 2020 206e 702e 6172 7261 7928 5b32       np.array([2
-00013600: 3030 2c20 3230 315d 292c 0a20 2020 2020  00, 201]),.     
-00013610: 2020 2020 2020 205b 7b22 4222 3a20 3230         [{"B": 20
-00013620: 307d 2c20 7b22 4222 3a20 3230 317d 5d2c  0}, {"B": 201}],
-00013630: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-00013640: 652c 0a20 2020 2020 2020 2029 2c0a 2020  e,.        ),.  
-00013650: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-00013660: 2020 2020 6e70 2e61 7272 6179 285b 3230      np.array([20
-00013670: 302c 2032 3031 5d29 2c0a 2020 2020 2020  0, 201]),.      
-00013680: 2020 2020 2020 6e70 2e61 7272 6179 285b        np.array([
-00013690: 3230 302c 2032 3031 5d29 2c0a 2020 2020  200, 201]),.    
-000136a0: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
-000136b0: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-000136c0: 2028 0a20 2020 2020 2020 2020 2020 205b   (.            [
-000136d0: 7b22 4222 3a20 3230 307d 2c20 7b22 4222  {"B": 200}, {"B"
-000136e0: 3a20 3230 317d 5d2c 0a20 2020 2020 2020  : 201}],.       
-000136f0: 2020 2020 206e 702e 6172 7261 7928 5b32       np.array([2
-00013700: 3030 2c20 3230 315d 292c 0a20 2020 2020  00, 201]),.     
-00013710: 2020 2020 2020 205b 7b22 4122 3a20 3230         [{"A": 20
-00013720: 307d 2c20 7b22 4122 3a20 3230 317d 5d2c  0}, {"A": 201}],
-00013730: 0a20 2020 2020 2020 2029 2c0a 2020 2020  .        ),.    
-00013740: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
-00013750: 2020 5b7b 2242 223a 2032 3030 7d2c 207b    [{"B": 200}, {
-00013760: 2242 223a 2032 3031 7d5d 2c0a 2020 2020  "B": 201}],.    
-00013770: 2020 2020 2020 2020 5b7b 2241 223a 2032          [{"A": 2
-00013780: 3030 7d2c 207b 2241 223a 2032 3031 7d5d  00}, {"A": 201}]
-00013790: 2c0a 2020 2020 2020 2020 2020 2020 6e70  ,.            np
-000137a0: 2e61 7272 6179 285b 3230 302c 2032 3031  .array([200, 201
-000137b0: 5d29 2c0a 2020 2020 2020 2020 292c 0a20  ]),.        ),. 
-000137c0: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
-000137d0: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
-000137e0: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
-000137f0: 2020 2020 2020 2020 206e 702e 6172 7261           np.arra
-00013800: 7928 5b32 3030 2c20 3230 315d 292c 0a20  y([200, 201]),. 
-00013810: 2020 2020 2020 2029 2c0a 2020 2020 5d2c         ),.    ],
-00013820: 0a29 0a40 6d6f 636b 2e70 6174 6368 2822  .).@mock.patch("
-00013830: 6761 6e74 7279 2e6c 6f67 6765 722e 636c  gantry.logger.cl
-00013840: 6965 6e74 2e47 616e 7472 792e 5f67 656e  ient.Gantry._gen
-00013850: 6572 6174 655f 7072 6564 6963 7469 6f6e  erate_prediction
-00013860: 5f61 6e64 5f66 6565 6462 6163 6b5f 6576  _and_feedback_ev
-00013870: 656e 7473 2229 0a40 6d6f 636b 2e70 6174  ents").@mock.pat
-00013880: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
-00013890: 722e 636c 6965 6e74 2e47 616e 7472 792e  r.client.Gantry.
-000138a0: 5f67 656e 6572 6174 655f 7072 6564 6963  _generate_predic
-000138b0: 7469 6f6e 5f65 7665 6e74 7322 290a 406d  tion_events").@m
-000138c0: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
-000138d0: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
-000138e0: 4761 6e74 7279 2e5f 6765 6e65 7261 7465  Gantry._generate
-000138f0: 5f66 6565 6462 6163 6b5f 6576 656e 7473  _feedback_events
-00013900: 2229 0a64 6566 2074 6573 745f 6765 6e65  ").def test_gene
-00013910: 7261 7465 5f72 6563 6f72 6473 5f70 7265  rate_records_pre
-00013920: 6473 5f61 6e64 5f66 6565 6462 6163 6b5f  ds_and_feedback_
-00013930: 7772 6f6e 675f 6e70 5f61 7272 6179 280a  wrong_np_array(.
-00013940: 2020 2020 6d6f 636b 5f67 656e 6572 6174      mock_generat
-00013950: 655f 6665 6564 6261 636b 2c0a 2020 2020  e_feedback,.    
-00013960: 6d6f 636b 5f67 656e 6572 6174 655f 7072  mock_generate_pr
-00013970: 6564 732c 0a20 2020 206d 6f63 6b5f 6765  eds,.    mock_ge
-00013980: 6e65 7261 7465 5f70 7265 6473 5f61 6e64  nerate_preds_and
-00013990: 5f66 6565 6462 6163 6b2c 0a20 2020 2069  _feedback,.    i
-000139a0: 6e70 7574 732c 0a20 2020 206f 7574 7075  nputs,.    outpu
-000139b0: 7473 2c0a 2020 2020 6665 6564 6261 636b  ts,.    feedback
-000139c0: 732c 0a20 2020 2063 6c69 5f6f 626a 2c0a  s,.    cli_obj,.
-000139d0: 293a 0a20 2020 2061 7373 6572 7420 280a  ):.    assert (.
-000139e0: 2020 2020 2020 2020 636c 695f 6f62 6a2e          cli_obj.
-000139f0: 6765 6e65 7261 7465 5f72 6563 6f72 6473  generate_records
-00013a00: 280a 2020 2020 2020 2020 2020 2020 6170  (.            ap
-00013a10: 706c 6963 6174 696f 6e3d 2266 6f6f 6261  plication="fooba
-00013a20: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
-00013a30: 7665 7273 696f 6e3d 2231 2e32 2e33 222c  version="1.2.3",
-00013a40: 0a20 2020 2020 2020 2020 2020 2069 6e70  .            inp
-00013a50: 7574 733d 696e 7075 7473 2c0a 2020 2020  uts=inputs,.    
-00013a60: 2020 2020 2020 2020 6f75 7470 7574 733d          outputs=
-00013a70: 6f75 7470 7574 732c 0a20 2020 2020 2020  outputs,.       
-00013a80: 2020 2020 2066 6565 6462 6163 6b73 3d66       feedbacks=f
-00013a90: 6565 6462 6163 6b73 2c0a 2020 2020 2020  eedbacks,.      
-00013aa0: 2020 2020 2020 7469 6d65 7374 616d 7073        timestamps
-00013ab0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2020  =None,.         
-00013ac0: 2020 2073 6f72 745f 6f6e 5f74 696d 6573     sort_on_times
-00013ad0: 7461 6d70 3d54 7275 652c 0a20 2020 2020  tamp=True,.     
-00013ae0: 2020 2020 2020 2073 616d 706c 655f 7261         sample_ra
-00013af0: 7465 3d31 2c0a 2020 2020 2020 2020 2020  te=1,.          
-00013b00: 2020 6a6f 696e 5f6b 6579 733d 5b22 666f    join_keys=["fo
-00013b10: 6f62 6172 222c 2022 6261 7262 617a 225d  obar", "barbaz"]
-00013b20: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00013b30: 2020 2020 6973 204e 6f6e 650a 2020 2020      is None.    
-00013b40: 290a 2020 2020 6d6f 636b 5f67 656e 6572  ).    mock_gener
-00013b50: 6174 655f 7072 6564 735f 616e 645f 6665  ate_preds_and_fe
-00013b60: 6564 6261 636b 2e61 7373 6572 745f 6e6f  edback.assert_no
-00013b70: 745f 6361 6c6c 6564 2829 0a20 2020 206d  t_called().    m
-00013b80: 6f63 6b5f 6765 6e65 7261 7465 5f70 7265  ock_generate_pre
-00013b90: 6473 2e61 7373 6572 745f 6e6f 745f 6361  ds.assert_not_ca
-00013ba0: 6c6c 6564 2829 0a20 2020 206d 6f63 6b5f  lled().    mock_
-00013bb0: 6765 6e65 7261 7465 5f66 6565 6462 6163  generate_feedbac
-00013bc0: 6b2e 6173 7365 7274 5f6e 6f74 5f63 616c  k.assert_not_cal
-00013bd0: 6c65 6428 290a 0a0a 4070 7974 6573 742e  led()...@pytest.
-00013be0: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-00013bf0: 280a 2020 2020 2274 696d 6573 7461 6d70  (.    "timestamp
-00013c00: 7322 2c0a 2020 2020 5b0a 2020 2020 2020  s",.    [.      
-00013c10: 2020 6e70 2e61 7272 6179 285b 3230 302c    np.array([200,
-00013c20: 2032 3031 5d29 2c0a 2020 2020 2020 2020   201]),.        
-00013c30: 6e70 2e61 7272 6179 285b 3230 302c 2043  np.array([200, C
-00013c40: 5552 5245 4e54 5f54 494d 455d 292c 0a20  URRENT_TIME]),. 
-00013c50: 2020 205d 2c0a 290a 406d 6f63 6b2e 7061     ],.).@mock.pa
-00013c60: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
-00013c70: 6572 2e63 6c69 656e 742e 4761 6e74 7279  er.client.Gantry
-00013c80: 2e5f 6c6f 675f 7072 6564 6963 7469 6f6e  ._log_prediction
-00013c90: 5f61 6e64 5f66 6565 6462 6163 6b5f 6576  _and_feedback_ev
-00013ca0: 656e 7473 2229 0a40 6d6f 636b 2e70 6174  ents").@mock.pat
-00013cb0: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
-00013cc0: 722e 636c 6965 6e74 2e47 616e 7472 792e  r.client.Gantry.
-00013cd0: 5f6c 6f67 5f70 7265 6469 6374 696f 6e5f  _log_prediction_
-00013ce0: 6576 656e 7473 2229 0a40 6d6f 636b 2e70  events").@mock.p
-00013cf0: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
-00013d00: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
-00013d10: 792e 5f6c 6f67 5f66 6565 6462 6163 6b5f  y._log_feedback_
-00013d20: 6576 656e 7473 2229 0a64 6566 2074 6573  events").def tes
-00013d30: 745f 6c6f 675f 7265 636f 7264 735f 7072  t_log_records_pr
-00013d40: 6564 735f 616e 645f 6665 6564 6261 636b  eds_and_feedback
-00013d50: 5f77 726f 6e67 5f74 696d 6573 7461 6d70  _wrong_timestamp
-00013d60: 7328 0a20 2020 206d 6f63 6b5f 6665 6564  s(.    mock_feed
-00013d70: 6261 636b 2c0a 2020 2020 6d6f 636b 5f70  back,.    mock_p
-00013d80: 7265 6473 2c0a 2020 2020 6d6f 636b 5f70  reds,.    mock_p
-00013d90: 7265 6473 5f61 6e64 5f66 6565 6462 6163  reds_and_feedbac
-00013da0: 6b2c 0a20 2020 2074 696d 6573 7461 6d70  k,.    timestamp
-00013db0: 732c 0a20 2020 2063 6c69 5f6f 626a 2c0a  s,.    cli_obj,.
-00013dc0: 293a 0a20 2020 2061 7373 6572 7420 280a  ):.    assert (.
-00013dd0: 2020 2020 2020 2020 636c 695f 6f62 6a2e          cli_obj.
-00013de0: 6c6f 675f 7265 636f 7264 7328 0a20 2020  log_records(.   
-00013df0: 2020 2020 2020 2020 2061 7070 6c69 6361           applica
-00013e00: 7469 6f6e 3d22 666f 6f62 6172 222c 0a20  tion="foobar",. 
-00013e10: 2020 2020 2020 2020 2020 2076 6572 7369             versi
-00013e20: 6f6e 3d22 312e 322e 3322 2c0a 2020 2020  on="1.2.3",.    
-00013e30: 2020 2020 2020 2020 696e 7075 7473 3d5b          inputs=[
-00013e40: 7b22 666f 6f22 3a20 2262 6172 227d 2c20  {"foo": "bar"}, 
-00013e50: 7b22 666f 6f22 3a20 2262 617a 227d 5d2c  {"foo": "baz"}],
-00013e60: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
-00013e70: 7075 7473 3d5b 7b22 666f 6f22 3a20 2262  puts=[{"foo": "b
-00013e80: 6172 227d 2c20 7b22 666f 6f22 3a20 2262  ar"}, {"foo": "b
-00013e90: 617a 227d 5d2c 0a20 2020 2020 2020 2020  az"}],.         
-00013ea0: 2020 2066 6565 6462 6163 6b73 3d4e 6f6e     feedbacks=Non
-00013eb0: 652c 0a20 2020 2020 2020 2020 2020 2074  e,.            t
-00013ec0: 696d 6573 7461 6d70 733d 7469 6d65 7374  imestamps=timest
-00013ed0: 616d 7073 2c0a 2020 2020 2020 2020 2020  amps,.          
-00013ee0: 2020 736f 7274 5f6f 6e5f 7469 6d65 7374    sort_on_timest
-00013ef0: 616d 703d 5472 7565 2c0a 2020 2020 2020  amp=True,.      
-00013f00: 2020 2020 2020 7361 6d70 6c65 5f72 6174        sample_rat
-00013f10: 653d 312c 0a20 2020 2020 2020 2020 2020  e=1,.           
-00013f20: 206a 6f69 6e5f 6b65 7973 3d5b 2266 6f6f   join_keys=["foo
-00013f30: 6261 7222 2c20 2262 6172 6261 7a22 5d2c  bar", "barbaz"],
-00013f40: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00013f50: 2020 2069 7320 4e6f 6e65 0a20 2020 2029     is None.    )
-00013f60: 0a20 2020 206d 6f63 6b5f 7072 6564 735f  .    mock_preds_
-00013f70: 616e 645f 6665 6564 6261 636b 2e61 7373  and_feedback.ass
-00013f80: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
-00013f90: 0a20 2020 206d 6f63 6b5f 7072 6564 732e  .    mock_preds.
-00013fa0: 6173 7365 7274 5f6e 6f74 5f63 616c 6c65  assert_not_calle
-00013fb0: 6428 290a 2020 2020 6d6f 636b 5f66 6565  d().    mock_fee
-00013fc0: 6462 6163 6b2e 6173 7365 7274 5f6e 6f74  dback.assert_not
-00013fd0: 5f63 616c 6c65 6428 290a 0a0a 4070 7974  _called()...@pyt
-00013fe0: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-00013ff0: 7269 7a65 280a 2020 2020 2274 696d 6573  rize(.    "times
-00014000: 7461 6d70 7322 2c0a 2020 2020 5b0a 2020  tamps",.    [.  
-00014010: 2020 2020 2020 6e70 2e61 7272 6179 285b        np.array([
-00014020: 3230 302c 2032 3031 5d29 2c0a 2020 2020  200, 201]),.    
-00014030: 2020 2020 6e70 2e61 7272 6179 285b 3230      np.array([20
-00014040: 302c 2043 5552 5245 4e54 5f54 494d 455d  0, CURRENT_TIME]
-00014050: 292c 0a20 2020 205d 2c0a 290a 406d 6f63  ),.    ],.).@moc
-00014060: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
-00014070: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
-00014080: 6e74 7279 2e5f 6765 6e65 7261 7465 5f70  ntry._generate_p
-00014090: 7265 6469 6374 696f 6e5f 616e 645f 6665  rediction_and_fe
-000140a0: 6564 6261 636b 5f65 7665 6e74 7322 290a  edback_events").
-000140b0: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
-000140c0: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
-000140d0: 742e 4761 6e74 7279 2e5f 6765 6e65 7261  t.Gantry._genera
-000140e0: 7465 5f70 7265 6469 6374 696f 6e5f 6576  te_prediction_ev
-000140f0: 656e 7473 2229 0a40 6d6f 636b 2e70 6174  ents").@mock.pat
-00014100: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
-00014110: 722e 636c 6965 6e74 2e47 616e 7472 792e  r.client.Gantry.
-00014120: 5f67 656e 6572 6174 655f 6665 6564 6261  _generate_feedba
-00014130: 636b 5f65 7665 6e74 7322 290a 6465 6620  ck_events").def 
-00014140: 7465 7374 5f67 656e 6572 6174 655f 7265  test_generate_re
-00014150: 636f 7264 735f 7072 6564 735f 616e 645f  cords_preds_and_
-00014160: 6665 6564 6261 636b 5f77 726f 6e67 5f74  feedback_wrong_t
-00014170: 696d 6573 7461 6d70 7328 0a20 2020 206d  imestamps(.    m
-00014180: 6f63 6b5f 6765 6e65 7261 7465 5f66 6565  ock_generate_fee
-00014190: 6462 6163 6b2c 0a20 2020 206d 6f63 6b5f  dback,.    mock_
-000141a0: 6765 6e65 7261 7465 5f70 7265 6473 2c0a  generate_preds,.
-000141b0: 2020 2020 6d6f 636b 5f67 656e 6572 6174      mock_generat
-000141c0: 655f 7072 6564 735f 616e 645f 6665 6564  e_preds_and_feed
-000141d0: 6261 636b 2c0a 2020 2020 7469 6d65 7374  back,.    timest
-000141e0: 616d 7073 2c0a 2020 2020 636c 695f 6f62  amps,.    cli_ob
-000141f0: 6a2c 0a29 3a0a 2020 2020 6173 7365 7274  j,.):.    assert
-00014200: 2028 0a20 2020 2020 2020 2063 6c69 5f6f   (.        cli_o
-00014210: 626a 2e67 656e 6572 6174 655f 7265 636f  bj.generate_reco
-00014220: 7264 7328 0a20 2020 2020 2020 2020 2020  rds(.           
-00014230: 2061 7070 6c69 6361 7469 6f6e 3d22 666f   application="fo
-00014240: 6f62 6172 222c 0a20 2020 2020 2020 2020  obar",.         
-00014250: 2020 2076 6572 7369 6f6e 3d22 312e 322e     version="1.2.
-00014260: 3322 2c0a 2020 2020 2020 2020 2020 2020  3",.            
-00014270: 696e 7075 7473 3d5b 7b22 666f 6f22 3a20  inputs=[{"foo": 
-00014280: 2262 6172 227d 2c20 7b22 666f 6f22 3a20  "bar"}, {"foo": 
-00014290: 2262 617a 227d 5d2c 0a20 2020 2020 2020  "baz"}],.       
-000142a0: 2020 2020 206f 7574 7075 7473 3d5b 7b22       outputs=[{"
-000142b0: 666f 6f22 3a20 2262 6172 227d 2c20 7b22  foo": "bar"}, {"
-000142c0: 666f 6f22 3a20 2262 617a 227d 5d2c 0a20  foo": "baz"}],. 
-000142d0: 2020 2020 2020 2020 2020 2066 6565 6462             feedb
-000142e0: 6163 6b73 3d4e 6f6e 652c 0a20 2020 2020  acks=None,.     
-000142f0: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
-00014300: 733d 7469 6d65 7374 616d 7073 2c0a 2020  s=timestamps,.  
-00014310: 2020 2020 2020 2020 2020 736f 7274 5f6f            sort_o
-00014320: 6e5f 7469 6d65 7374 616d 703d 5472 7565  n_timestamp=True
-00014330: 2c0a 2020 2020 2020 2020 2020 2020 7361  ,.            sa
-00014340: 6d70 6c65 5f72 6174 653d 312c 0a20 2020  mple_rate=1,.   
-00014350: 2020 2020 2020 2020 206a 6f69 6e5f 6b65           join_ke
-00014360: 7973 3d5b 2266 6f6f 6261 7222 2c20 2262  ys=["foobar", "b
-00014370: 6172 6261 7a22 5d2c 0a20 2020 2020 2020  arbaz"],.       
-00014380: 2029 0a20 2020 2020 2020 2069 7320 4e6f   ).        is No
-00014390: 6e65 0a20 2020 2029 0a20 2020 206d 6f63  ne.    ).    moc
-000143a0: 6b5f 6765 6e65 7261 7465 5f70 7265 6473  k_generate_preds
-000143b0: 5f61 6e64 5f66 6565 6462 6163 6b2e 6173  _and_feedback.as
-000143c0: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
-000143d0: 290a 2020 2020 6d6f 636b 5f67 656e 6572  ).    mock_gener
-000143e0: 6174 655f 7072 6564 732e 6173 7365 7274  ate_preds.assert
-000143f0: 5f6e 6f74 5f63 616c 6c65 6428 290a 2020  _not_called().  
-00014400: 2020 6d6f 636b 5f67 656e 6572 6174 655f    mock_generate_
-00014410: 6665 6564 6261 636b 2e61 7373 6572 745f  feedback.assert_
-00014420: 6e6f 745f 6361 6c6c 6564 2829 0a0a 0a40  not_called()...@
-00014430: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
-00014440: 6d65 7472 697a 6528 226a 6f69 6e5f 6b65  metrize("join_ke
-00014450: 7973 222c 205b 5b31 2c20 322c 2033 5d2c  ys", [[1, 2, 3],
-00014460: 2070 642e 5365 7269 6573 285b 312c 2032   pd.Series([1, 2
-00014470: 2c20 335d 295d 290a 406d 6f63 6b2e 7061  , 3])]).@mock.pa
-00014480: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
-00014490: 6572 2e63 6c69 656e 742e 4761 6e74 7279  er.client.Gantry
-000144a0: 2e5f 6c6f 675f 7072 6564 6963 7469 6f6e  ._log_prediction
-000144b0: 5f61 6e64 5f66 6565 6462 6163 6b5f 6576  _and_feedback_ev
-000144c0: 656e 7473 2229 0a40 6d6f 636b 2e70 6174  ents").@mock.pat
-000144d0: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
-000144e0: 722e 636c 6965 6e74 2e47 616e 7472 792e  r.client.Gantry.
-000144f0: 5f6c 6f67 5f70 7265 6469 6374 696f 6e5f  _log_prediction_
-00014500: 6576 656e 7473 2229 0a40 6d6f 636b 2e70  events").@mock.p
-00014510: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
-00014520: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
-00014530: 792e 5f6c 6f67 5f66 6565 6462 6163 6b5f  y._log_feedback_
-00014540: 6576 656e 7473 2229 0a64 6566 2074 6573  events").def tes
-00014550: 745f 6c6f 675f 7265 636f 7264 735f 7072  t_log_records_pr
-00014560: 6564 735f 616e 645f 6665 6564 6261 636b  eds_and_feedback
-00014570: 5f77 726f 6e67 5f6a 6f69 6e5f 6b65 7973  _wrong_join_keys
-00014580: 280a 2020 2020 6d6f 636b 5f66 6565 6462  (.    mock_feedb
-00014590: 6163 6b2c 0a20 2020 206d 6f63 6b5f 7072  ack,.    mock_pr
-000145a0: 6564 732c 0a20 2020 206d 6f63 6b5f 7072  eds,.    mock_pr
-000145b0: 6564 735f 616e 645f 6665 6564 6261 636b  eds_and_feedback
-000145c0: 2c0a 2020 2020 6a6f 696e 5f6b 6579 732c  ,.    join_keys,
-000145d0: 0a20 2020 2063 6c69 5f6f 626a 2c0a 293a  .    cli_obj,.):
-000145e0: 0a20 2020 2061 7373 6572 7420 280a 2020  .    assert (.  
-000145f0: 2020 2020 2020 636c 695f 6f62 6a2e 6c6f        cli_obj.lo
-00014600: 675f 7265 636f 7264 7328 0a20 2020 2020  g_records(.     
-00014610: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
-00014620: 6f6e 3d22 666f 6f62 6172 222c 0a20 2020  on="foobar",.   
-00014630: 2020 2020 2020 2020 2076 6572 7369 6f6e           version
-00014640: 3d22 312e 322e 3322 2c0a 2020 2020 2020  ="1.2.3",.      
-00014650: 2020 2020 2020 696e 7075 7473 3d5b 7b22        inputs=[{"
-00014660: 4122 3a20 3230 307d 2c20 7b22 4122 3a20  A": 200}, {"A": 
-00014670: 3230 317d 5d2c 0a20 2020 2020 2020 2020  201}],.         
-00014680: 2020 206f 7574 7075 7473 3d5b 7b22 4222     outputs=[{"B"
-00014690: 3a20 3230 307d 2c20 7b22 4222 3a20 3230  : 200}, {"B": 20
-000146a0: 317d 5d2c 0a20 2020 2020 2020 2020 2020  1}],.           
-000146b0: 2066 6565 6462 6163 6b73 3d5b 7b22 4322   feedbacks=[{"C"
-000146c0: 3a20 3230 307d 2c20 7b22 4322 3a20 3230  : 200}, {"C": 20
-000146d0: 317d 5d2c 0a20 2020 2020 2020 2020 2020  1}],.           
-000146e0: 2074 696d 6573 7461 6d70 733d 4e6f 6e65   timestamps=None
-000146f0: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
-00014700: 7274 5f6f 6e5f 7469 6d65 7374 616d 703d  rt_on_timestamp=
-00014710: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
-00014720: 2020 7361 6d70 6c65 5f72 6174 653d 312c    sample_rate=1,
-00014730: 0a20 2020 2020 2020 2020 2020 206a 6f69  .            joi
-00014740: 6e5f 6b65 7973 3d6a 6f69 6e5f 6b65 7973  n_keys=join_keys
-00014750: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00014760: 2020 2020 6973 204e 6f6e 650a 2020 2020      is None.    
-00014770: 290a 2020 2020 6d6f 636b 5f70 7265 6473  ).    mock_preds
-00014780: 5f61 6e64 5f66 6565 6462 6163 6b2e 6173  _and_feedback.as
-00014790: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
-000147a0: 290a 2020 2020 6d6f 636b 5f70 7265 6473  ).    mock_preds
-000147b0: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
-000147c0: 6564 2829 0a20 2020 206d 6f63 6b5f 6665  ed().    mock_fe
-000147d0: 6564 6261 636b 2e61 7373 6572 745f 6e6f  edback.assert_no
-000147e0: 745f 6361 6c6c 6564 2829 0a0a 0a40 7079  t_called()...@py
-000147f0: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
-00014800: 7472 697a 6528 226a 6f69 6e5f 6b65 7973  trize("join_keys
-00014810: 222c 205b 5b31 2c20 322c 2033 5d2c 2070  ", [[1, 2, 3], p
-00014820: 642e 5365 7269 6573 285b 312c 2032 2c20  d.Series([1, 2, 
-00014830: 335d 295d 290a 406d 6f63 6b2e 7061 7463  3])]).@mock.patc
-00014840: 6828 2267 616e 7472 792e 6c6f 6767 6572  h("gantry.logger
-00014850: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
-00014860: 6765 6e65 7261 7465 5f70 7265 6469 6374  generate_predict
-00014870: 696f 6e5f 616e 645f 6665 6564 6261 636b  ion_and_feedback
-00014880: 5f65 7665 6e74 7322 290a 406d 6f63 6b2e  _events").@mock.
-00014890: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
-000148a0: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
-000148b0: 7279 2e5f 6765 6e65 7261 7465 5f70 7265  ry._generate_pre
-000148c0: 6469 6374 696f 6e5f 6576 656e 7473 2229  diction_events")
-000148d0: 0a40 6d6f 636b 2e70 6174 6368 2822 6761  .@mock.patch("ga
-000148e0: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
-000148f0: 6e74 2e47 616e 7472 792e 5f67 656e 6572  nt.Gantry._gener
-00014900: 6174 655f 6665 6564 6261 636b 5f65 7665  ate_feedback_eve
-00014910: 6e74 7322 290a 6465 6620 7465 7374 5f67  nts").def test_g
-00014920: 656e 6572 6174 655f 7265 636f 7264 735f  enerate_records_
-00014930: 7072 6564 735f 616e 645f 6665 6564 6261  preds_and_feedba
-00014940: 636b 5f77 726f 6e67 5f6a 6f69 6e5f 6b65  ck_wrong_join_ke
-00014950: 7973 280a 2020 2020 6d6f 636b 5f67 656e  ys(.    mock_gen
-00014960: 6572 6174 655f 6665 6564 6261 636b 2c0a  erate_feedback,.
-00014970: 2020 2020 6d6f 636b 5f67 656e 6572 6174      mock_generat
-00014980: 655f 7072 6564 732c 0a20 2020 206d 6f63  e_preds,.    moc
-00014990: 6b5f 6765 6e65 7261 7465 5f70 7265 6473  k_generate_preds
-000149a0: 5f61 6e64 5f66 6565 6462 6163 6b2c 0a20  _and_feedback,. 
-000149b0: 2020 206a 6f69 6e5f 6b65 7973 2c0a 2020     join_keys,.  
-000149c0: 2020 636c 695f 6f62 6a2c 0a29 3a0a 2020    cli_obj,.):.  
-000149d0: 2020 6173 7365 7274 2028 0a20 2020 2020    assert (.     
-000149e0: 2020 2063 6c69 5f6f 626a 2e67 656e 6572     cli_obj.gener
-000149f0: 6174 655f 7265 636f 7264 7328 0a20 2020  ate_records(.   
-00014a00: 2020 2020 2020 2020 2061 7070 6c69 6361           applica
-00014a10: 7469 6f6e 3d22 666f 6f62 6172 222c 0a20  tion="foobar",. 
-00014a20: 2020 2020 2020 2020 2020 2076 6572 7369             versi
-00014a30: 6f6e 3d22 312e 322e 3322 2c0a 2020 2020  on="1.2.3",.    
-00014a40: 2020 2020 2020 2020 696e 7075 7473 3d5b          inputs=[
-00014a50: 7b22 4122 3a20 3230 307d 2c20 7b22 4122  {"A": 200}, {"A"
-00014a60: 3a20 3230 317d 5d2c 0a20 2020 2020 2020  : 201}],.       
-00014a70: 2020 2020 206f 7574 7075 7473 3d5b 7b22       outputs=[{"
-00014a80: 4222 3a20 3230 307d 2c20 7b22 4222 3a20  B": 200}, {"B": 
-00014a90: 3230 317d 5d2c 0a20 2020 2020 2020 2020  201}],.         
-00014aa0: 2020 2066 6565 6462 6163 6b73 3d5b 7b22     feedbacks=[{"
-00014ab0: 4322 3a20 3230 307d 2c20 7b22 4322 3a20  C": 200}, {"C": 
-00014ac0: 3230 317d 5d2c 0a20 2020 2020 2020 2020  201}],.         
-00014ad0: 2020 2074 696d 6573 7461 6d70 733d 4e6f     timestamps=No
-00014ae0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00014af0: 736f 7274 5f6f 6e5f 7469 6d65 7374 616d  sort_on_timestam
-00014b00: 703d 5472 7565 2c0a 2020 2020 2020 2020  p=True,.        
-00014b10: 2020 2020 7361 6d70 6c65 5f72 6174 653d      sample_rate=
-00014b20: 312c 0a20 2020 2020 2020 2020 2020 206a  1,.            j
-00014b30: 6f69 6e5f 6b65 7973 3d6a 6f69 6e5f 6b65  oin_keys=join_ke
-00014b40: 7973 2c0a 2020 2020 2020 2020 290a 2020  ys,.        ).  
-00014b50: 2020 2020 2020 6973 204e 6f6e 650a 2020        is None.  
-00014b60: 2020 290a 2020 2020 6d6f 636b 5f67 656e    ).    mock_gen
-00014b70: 6572 6174 655f 7072 6564 735f 616e 645f  erate_preds_and_
-00014b80: 6665 6564 6261 636b 2e61 7373 6572 745f  feedback.assert_
-00014b90: 6e6f 745f 6361 6c6c 6564 2829 0a20 2020  not_called().   
-00014ba0: 206d 6f63 6b5f 6765 6e65 7261 7465 5f70   mock_generate_p
-00014bb0: 7265 6473 2e61 7373 6572 745f 6e6f 745f  reds.assert_not_
-00014bc0: 6361 6c6c 6564 2829 0a20 2020 206d 6f63  called().    moc
-00014bd0: 6b5f 6765 6e65 7261 7465 5f66 6565 6462  k_generate_feedb
-00014be0: 6163 6b2e 6173 7365 7274 5f6e 6f74 5f63  ack.assert_not_c
-00014bf0: 616c 6c65 6428 290a 0a0a 4070 7974 6573  alled()...@pytes
-00014c00: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
-00014c10: 7a65 280a 2020 2020 2274 6573 745f 7469  ze(.    "test_ti
-00014c20: 6d65 7374 616d 7073 2c20 7465 7374 5f74  mestamps, test_t
-00014c30: 696d 6573 7461 6d70 735f 6c69 7374 222c  imestamps_list",
-00014c40: 0a20 2020 205b 0a20 2020 2020 2020 2028  .    [.        (
-00014c50: 4e6f 6e65 2c20 4e6f 6e65 292c 0a20 2020  None, None),.   
-00014c60: 2020 2020 2028 5b43 5552 5245 4e54 5f54       ([CURRENT_T
-00014c70: 494d 455d 202a 2032 2c20 5b43 5552 5245  IME] * 2, [CURRE
-00014c80: 4e54 5f54 494d 455d 202a 2032 292c 0a20  NT_TIME] * 2),. 
-00014c90: 2020 2020 2020 2028 6e70 2e61 7272 6179         (np.array
-00014ca0: 285b 4355 5252 454e 545f 5449 4d45 5d20  ([CURRENT_TIME] 
-00014cb0: 2a20 3229 2c20 5b43 5552 5245 4e54 5f54  * 2), [CURRENT_T
-00014cc0: 494d 455d 202a 2032 292c 0a20 2020 205d  IME] * 2),.    ]
-00014cd0: 2c0a 290a 4070 7974 6573 742e 6d61 726b  ,.).@pytest.mark
-00014ce0: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
-00014cf0: 2020 226b 7761 7267 7322 2c0a 2020 2020    "kwargs",.    
-00014d00: 5b0a 2020 2020 2020 2020 7b22 6665 6564  [.        {"feed
-00014d10: 6261 636b 5f6b 6579 7322 3a20 5b22 4122  back_keys": ["A"
-00014d20: 5d7d 2c0a 2020 2020 2020 2020 7b22 6665  ]},.        {"fe
-00014d30: 6564 6261 636b 5f69 6473 223a 205b 2231  edback_ids": ["1
-00014d40: 3233 3435 222c 2022 3637 3839 3022 5d7d  2345", "67890"]}
-00014d50: 2c0a 2020 2020 2020 2020 7b22 6a6f 696e  ,.        {"join
-00014d60: 5f6b 6579 7322 3a20 5b22 3534 3332 3122  _keys": ["54321"
-00014d70: 2c20 2236 3738 3930 225d 7d2c 0a20 2020  , "67890"]},.   
-00014d80: 2020 2020 207b 226a 6f69 6e5f 6b65 7973       {"join_keys
-00014d90: 223a 2070 642e 5365 7269 6573 285b 2235  ": pd.Series(["5
-00014da0: 3433 3231 222c 2022 3637 3839 3022 5d29  4321", "67890"])
-00014db0: 7d2c 0a20 2020 2020 2020 207b 7d2c 0a20  },.        {},. 
-00014dc0: 2020 205d 2c0a 290a 4070 7974 6573 742e     ],.).@pytest.
-00014dd0: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-00014de0: 280a 2020 2020 2274 6573 745f 6f75 7470  (.    "test_outp
-00014df0: 7574 7322 2c0a 2020 2020 5b0a 2020 2020  uts",.    [.    
-00014e00: 2020 2020 5b7b 2242 223a 2033 3030 7d2c      [{"B": 300},
-00014e10: 207b 2242 223a 2033 3031 7d5d 2c0a 2020   {"B": 301}],.  
-00014e20: 2020 2020 2020 7064 2e44 6174 6146 7261        pd.DataFra
-00014e30: 6d65 2e66 726f 6d5f 6469 6374 287b 2242  me.from_dict({"B
-00014e40: 223a 205b 3330 302c 2033 3031 5d7d 292c  ": [300, 301]}),
-00014e50: 0a20 2020 2020 2020 2070 642e 5365 7269  .        pd.Seri
-00014e60: 6573 286e 616d 653d 2242 222c 2064 6174  es(name="B", dat
-00014e70: 613d 5b33 3030 2c20 3330 315d 292c 0a20  a=[300, 301]),. 
-00014e80: 2020 2020 2020 206e 702e 6172 7261 7928         np.array(
-00014e90: 5b7b 2242 223a 2033 3030 7d2c 207b 2242  [{"B": 300}, {"B
-00014ea0: 223a 2033 3031 7d5d 292c 0a20 2020 205d  ": 301}]),.    ]
-00014eb0: 2c0a 290a 4070 7974 6573 742e 6d61 726b  ,.).@pytest.mark
-00014ec0: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
-00014ed0: 2020 2274 6573 745f 696e 7075 7473 222c    "test_inputs",
-00014ee0: 0a20 2020 205b 0a20 2020 2020 2020 205b  .    [.        [
-00014ef0: 7b22 4122 3a20 3130 307d 2c20 7b22 4122  {"A": 100}, {"A"
-00014f00: 3a20 3130 317d 5d2c 0a20 2020 2020 2020  : 101}],.       
-00014f10: 2070 642e 4461 7461 4672 616d 652e 6672   pd.DataFrame.fr
-00014f20: 6f6d 5f64 6963 7428 7b22 4122 3a20 5b31  om_dict({"A": [1
-00014f30: 3030 2c20 3130 315d 7d29 2c0a 2020 2020  00, 101]}),.    
-00014f40: 2020 2020 7064 2e53 6572 6965 7328 6e61      pd.Series(na
-00014f50: 6d65 3d22 4122 2c20 6461 7461 3d5b 3130  me="A", data=[10
-00014f60: 302c 2031 3031 5d29 2c0a 2020 2020 2020  0, 101]),.      
-00014f70: 2020 6e70 2e61 7272 6179 285b 7b22 4122    np.array([{"A"
-00014f80: 3a20 3130 307d 2c20 7b22 4122 3a20 3130  : 100}, {"A": 10
-00014f90: 317d 5d29 2c0a 2020 2020 5d2c 0a29 0a40  1}]),.    ],.).@
-00014fa0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
-00014fb0: 6d65 7472 697a 6528 2276 6572 7369 6f6e  metrize("version
-00014fc0: 222c 205b 4e6f 6e65 2c20 3130 2c20 2231  ", [None, 10, "1
-00014fd0: 2e32 2e33 225d 290a 4070 7974 6573 742e  .2.3"]).@pytest.
-00014fe0: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-00014ff0: 280a 2020 2020 2274 6167 732c 2072 6f77  (.    "tags, row
-00015000: 5f74 6167 732c 2067 6c6f 6261 6c5f 7461  _tags, global_ta
-00015010: 6773 2c20 6578 7065 6374 6564 5f74 6167  gs, expected_tag
-00015020: 735f 7061 7261 6d22 2c0a 2020 2020 5b0a  s_param",.    [.
-00015030: 2020 2020 2020 2020 284e 6f6e 652c 204e          (None, N
-00015040: 6f6e 652c 204e 6f6e 652c 205b 7b22 656e  one, None, [{"en
-00015050: 7622 3a20 2274 6573 7422 7d2c 207b 2265  v": "test"}, {"e
-00015060: 6e76 223a 2022 7465 7374 227d 5d29 2c0a  nv": "test"}]),.
-00015070: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
-00015080: 2020 2020 2020 7b22 6261 7222 3a20 2262        {"bar": "b
-00015090: 6172 227d 2c0a 2020 2020 2020 2020 2020  ar"},.          
-000150a0: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
-000150b0: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
-000150c0: 2020 2020 2020 5b7b 2262 6172 223a 2022        [{"bar": "
-000150d0: 6261 7222 2c20 2265 6e76 223a 2022 7465  bar", "env": "te
-000150e0: 7374 227d 2c20 7b22 6261 7222 3a20 2262  st"}, {"bar": "b
-000150f0: 6172 222c 2022 656e 7622 3a20 2274 6573  ar", "env": "tes
-00015100: 7422 7d5d 2c0a 2020 2020 2020 2020 292c  t"}],.        ),
-00015110: 0a20 2020 2020 2020 2028 0a20 2020 2020  .        (.     
-00015120: 2020 2020 2020 207b 2262 6172 223a 2022         {"bar": "
-00015130: 6261 7222 7d2c 0a20 2020 2020 2020 2020  bar"},.         
-00015140: 2020 204e 6f6e 652c 0a20 2020 2020 2020     None,.       
-00015150: 2020 2020 207b 2266 6f6f 223a 2022 666f       {"foo": "fo
-00015160: 6f22 7d2c 0a20 2020 2020 2020 2020 2020  o"},.           
-00015170: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-00015180: 2020 207b 2262 6172 223a 2022 6261 7222     {"bar": "bar"
-00015190: 2c20 2265 6e76 223a 2022 7465 7374 222c  , "env": "test",
-000151a0: 2022 666f 6f22 3a20 2266 6f6f 227d 2c0a   "foo": "foo"},.
-000151b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000151c0: 7b22 6261 7222 3a20 2262 6172 222c 2022  {"bar": "bar", "
-000151d0: 656e 7622 3a20 2274 6573 7422 2c20 2266  env": "test", "f
-000151e0: 6f6f 223a 2022 666f 6f22 7d2c 0a20 2020  oo": "foo"},.   
-000151f0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-00015200: 2020 2020 292c 0a20 2020 2020 2020 2028      ),.        (
-00015210: 0a20 2020 2020 2020 2020 2020 205b 7b22  .            [{"
-00015220: 6261 7222 3a20 2262 6172 227d 2c20 7b22  bar": "bar"}, {"
-00015230: 6261 7222 3a20 2262 617a 227d 5d2c 0a20  bar": "baz"}],. 
-00015240: 2020 2020 2020 2020 2020 204e 6f6e 652c             None,
-00015250: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-00015260: 652c 0a20 2020 2020 2020 2020 2020 205b  e,.            [
-00015270: 7b22 6261 7222 3a20 2262 6172 222c 2022  {"bar": "bar", "
-00015280: 656e 7622 3a20 2274 6573 7422 7d2c 207b  env": "test"}, {
-00015290: 2262 6172 223a 2022 6261 7a22 2c20 2265  "bar": "baz", "e
-000152a0: 6e76 223a 2022 7465 7374 227d 5d2c 0a20  nv": "test"}],. 
-000152b0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-000152c0: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-000152d0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-000152e0: 2020 5b7b 2262 6172 223a 2022 6261 7222    [{"bar": "bar"
-000152f0: 7d2c 207b 2262 6172 223a 2022 6261 7a22  }, {"bar": "baz"
-00015300: 7d5d 2c0a 2020 2020 2020 2020 2020 2020  }],.            
-00015310: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-00015320: 2020 5b7b 2262 6172 223a 2022 6261 7222    [{"bar": "bar"
-00015330: 2c20 2265 6e76 223a 2022 7465 7374 227d  , "env": "test"}
-00015340: 2c20 7b22 6261 7222 3a20 2262 617a 222c  , {"bar": "baz",
-00015350: 2022 656e 7622 3a20 2274 6573 7422 7d5d   "env": "test"}]
-00015360: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
-00015370: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
-00015380: 2020 204e 6f6e 652c 0a20 2020 2020 2020     None,.       
-00015390: 2020 2020 205b 7b22 6261 7222 3a20 2262       [{"bar": "b
-000153a0: 6172 227d 2c20 7b22 6261 7222 3a20 2262  ar"}, {"bar": "b
-000153b0: 617a 227d 5d2c 0a20 2020 2020 2020 2020  az"}],.         
-000153c0: 2020 207b 2266 6f6f 223a 2022 666f 6f22     {"foo": "foo"
-000153d0: 7d2c 0a20 2020 2020 2020 2020 2020 205b  },.            [
-000153e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000153f0: 207b 2262 6172 223a 2022 6261 7222 2c20   {"bar": "bar", 
-00015400: 2265 6e76 223a 2022 7465 7374 222c 2022  "env": "test", "
-00015410: 666f 6f22 3a20 2266 6f6f 227d 2c0a 2020  foo": "foo"},.  
-00015420: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-00015430: 6261 7222 3a20 2262 617a 222c 2022 656e  bar": "baz", "en
-00015440: 7622 3a20 2274 6573 7422 2c20 2266 6f6f  v": "test", "foo
-00015450: 223a 2022 666f 6f22 7d2c 0a20 2020 2020  ": "foo"},.     
-00015460: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-00015470: 2020 292c 0a20 2020 2020 2020 2028 0a20    ),.        (. 
-00015480: 2020 2020 2020 2020 2020 207b 2266 6f6f             {"foo
-00015490: 223a 2022 666f 6f22 7d2c 0a20 2020 2020  ": "foo"},.     
-000154a0: 2020 2020 2020 205b 7b22 6261 7222 3a20         [{"bar": 
-000154b0: 2262 6172 227d 2c20 7b22 6261 7222 3a20  "bar"}, {"bar": 
-000154c0: 2262 617a 227d 5d2c 0a20 2020 2020 2020  "baz"}],.       
-000154d0: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
-000154e0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-000154f0: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-00015500: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
-00015510: 7465 7374 222c 2022 666f 6f22 3a20 2266  test", "foo": "f
-00015520: 6f6f 227d 2c0a 2020 2020 2020 2020 2020  oo"},.          
-00015530: 2020 2020 2020 7b22 6261 7222 3a20 2262        {"bar": "b
-00015540: 617a 222c 2022 656e 7622 3a20 2274 6573  az", "env": "tes
-00015550: 7422 2c20 2266 6f6f 223a 2022 666f 6f22  t", "foo": "foo"
-00015560: 7d2c 0a20 2020 2020 2020 2020 2020 205d  },.            ]
-00015570: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
-00015580: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
-00015590: 2020 207b 2262 6172 223a 2022 6261 7222     {"bar": "bar"
-000155a0: 7d2c 0a20 2020 2020 2020 2020 2020 205b  },.            [
-000155b0: 7b22 666f 6f22 3a20 2266 6f6f 227d 2c20  {"foo": "foo"}, 
-000155c0: 7b22 6261 7a22 3a20 2262 617a 227d 5d2c  {"baz": "baz"}],
-000155d0: 0a20 2020 2020 2020 2020 2020 207b 2265  .            {"e
-000155e0: 6e76 223a 2022 666f 6f62 6172 227d 2c0a  nv": "foobar"},.
-000155f0: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-00015600: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-00015610: 6261 7222 3a20 2262 6172 222c 2022 656e  bar": "bar", "en
-00015620: 7622 3a20 2266 6f6f 6261 7222 2c20 2266  v": "foobar", "f
-00015630: 6f6f 223a 2022 666f 6f22 7d2c 0a20 2020  oo": "foo"},.   
-00015640: 2020 2020 2020 2020 2020 2020 207b 2262               {"b
-00015650: 6172 223a 2022 6261 7222 2c20 2265 6e76  ar": "bar", "env
-00015660: 223a 2022 666f 6f62 6172 222c 2022 6261  ": "foobar", "ba
-00015670: 7a22 3a20 2262 617a 227d 2c0a 2020 2020  z": "baz"},.    
-00015680: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-00015690: 2020 2029 2c0a 2020 2020 2020 2020 280a     ),.        (.
-000156a0: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-000156b0: 2c0a 2020 2020 2020 2020 2020 2020 5b7b  ,.            [{
-000156c0: 2262 6172 223a 2022 6261 7222 7d2c 207b  "bar": "bar"}, {
-000156d0: 2262 6172 223a 2022 6261 7a22 7d5d 2c0a  "bar": "baz"}],.
-000156e0: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-000156f0: 2c0a 2020 2020 2020 2020 2020 2020 5b0a  ,.            [.
-00015700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015710: 7b22 6261 7222 3a20 2262 6172 222c 2022  {"bar": "bar", "
-00015720: 656e 7622 3a20 2274 6573 7422 7d2c 0a20  env": "test"},. 
-00015730: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00015740: 2262 6172 223a 2022 6261 7a22 2c20 2265  "bar": "baz", "e
-00015750: 6e76 223a 2022 7465 7374 227d 2c0a 2020  nv": "test"},.  
-00015760: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-00015770: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-00015780: 280a 2020 2020 2020 2020 2020 2020 4e6f  (.            No
-00015790: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-000157a0: 6e70 2e61 7272 6179 285b 7b22 6261 7222  np.array([{"bar"
-000157b0: 3a20 2262 6172 227d 2c20 7b22 6261 7222  : "bar"}, {"bar"
-000157c0: 3a20 2262 617a 227d 5d29 2c0a 2020 2020  : "baz"}]),.    
-000157d0: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
-000157e0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-000157f0: 2020 2020 2020 2020 2020 2020 7b22 6261              {"ba
-00015800: 7222 3a20 2262 6172 222c 2022 656e 7622  r": "bar", "env"
-00015810: 3a20 2274 6573 7422 7d2c 0a20 2020 2020  : "test"},.     
-00015820: 2020 2020 2020 2020 2020 207b 2262 6172             {"bar
-00015830: 223a 2022 6261 7a22 2c20 2265 6e76 223a  ": "baz", "env":
-00015840: 2022 7465 7374 227d 2c0a 2020 2020 2020   "test"},.      
-00015850: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-00015860: 2029 2c0a 2020 2020 2020 2020 280a 2020   ),.        (.  
-00015870: 2020 2020 2020 2020 2020 4e6f 6e65 2c0a            None,.
-00015880: 2020 2020 2020 2020 2020 2020 7064 2e53              pd.S
-00015890: 6572 6965 7328 5b22 6261 7222 2c20 2262  eries(["bar", "b
-000158a0: 617a 225d 2c20 6e61 6d65 3d22 6261 7222  az"], name="bar"
-000158b0: 292c 0a20 2020 2020 2020 2020 2020 204e  ),.            N
-000158c0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-000158d0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-000158e0: 2020 207b 2262 6172 223a 2022 6261 7222     {"bar": "bar"
-000158f0: 2c20 2265 6e76 223a 2022 7465 7374 227d  , "env": "test"}
-00015900: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00015910: 2020 7b22 6261 7222 3a20 2262 617a 222c    {"bar": "baz",
-00015920: 2022 656e 7622 3a20 2274 6573 7422 7d2c   "env": "test"},
-00015930: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
-00015940: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-00015950: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
-00015960: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-00015970: 2020 2070 642e 4461 7461 4672 616d 6528     pd.DataFrame(
-00015980: 7b22 6261 7222 3a20 5b22 6261 7222 2c20  {"bar": ["bar", 
-00015990: 2262 617a 225d 7d29 2c0a 2020 2020 2020  "baz"]}),.      
-000159a0: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-000159b0: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-000159c0: 2020 2020 2020 2020 2020 7b22 6261 7222            {"bar"
-000159d0: 3a20 2262 6172 222c 2022 656e 7622 3a20  : "bar", "env": 
-000159e0: 2274 6573 7422 7d2c 0a20 2020 2020 2020  "test"},.       
-000159f0: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-00015a00: 2022 6261 7a22 2c20 2265 6e76 223a 2022   "baz", "env": "
-00015a10: 7465 7374 227d 2c0a 2020 2020 2020 2020  test"},.        
-00015a20: 2020 2020 5d2c 0a20 2020 2020 2020 2029      ],.        )
-00015a30: 2c0a 2020 2020 5d2c 0a29 0a40 6d6f 636b  ,.    ],.).@mock
-00015a40: 2e70 6174 6368 2822 6761 6e74 7279 2e6c  .patch("gantry.l
-00015a50: 6f67 6765 722e 636c 6965 6e74 2e5f 7265  ogger.client._re
-00015a60: 736f 6c76 655f 6a6f 696e 5f6b 6579 7322  solve_join_keys"
-00015a70: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
-00015a80: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
-00015a90: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
-00015aa0: 7072 6564 6963 7469 6f6e 5f61 6e64 5f66  prediction_and_f
-00015ab0: 6565 6462 6163 6b5f 6576 656e 7473 2229  eedback_events")
-00015ac0: 0a40 6d6f 636b 2e70 6174 6368 280a 2020  .@mock.patch(.  
-00015ad0: 2020 2267 616e 7472 792e 6c6f 6767 6572    "gantry.logger
-00015ae0: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
-00015af0: 6c6f 675f 7072 6564 6963 7469 6f6e 5f65  log_prediction_e
-00015b00: 7665 6e74 7322 2c20 7265 7475 726e 5f76  vents", return_v
-00015b10: 616c 7565 3d28 4e6f 6e65 2c20 5b22 3132  alue=(None, ["12
-00015b20: 3334 3522 2c20 2236 3738 3930 225d 290a  345", "67890"]).
-00015b30: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
-00015b40: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
-00015b50: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
-00015b60: 6665 6564 6261 636b 5f65 7665 6e74 7322  feedback_events"
-00015b70: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
-00015b80: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
-00015b90: 656e 742e 5f73 616d 706c 655f 7265 636f  ent._sample_reco
-00015ba0: 7264 7322 2c20 7369 6465 5f65 6666 6563  rds", side_effec
-00015bb0: 743d 636c 6965 6e74 2e5f 7361 6d70 6c65  t=client._sample
-00015bc0: 5f72 6563 6f72 6473 290a 406d 6f63 6b2e  _records).@mock.
-00015bd0: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
-00015be0: 6767 6572 2e63 6c69 656e 742e 5f64 6566  gger.client._def
-00015bf0: 6175 6c74 5f6a 6f69 6e5f 6b65 795f 6765  ault_join_key_ge
-00015c00: 6e22 290a 6465 6620 7465 7374 5f6c 6f67  n").def test_log
-00015c10: 5f72 6563 6f72 6473 5f70 7265 6473 5f6f  _records_preds_o
-00015c20: 6e6c 7928 0a20 2020 206d 6f63 6b5f 6a6f  nly(.    mock_jo
-00015c30: 696e 5f6b 6579 5f67 656e 2c0a 2020 2020  in_key_gen,.    
-00015c40: 6d6f 636b 5f73 616d 706c 655f 7265 636f  mock_sample_reco
-00015c50: 7264 732c 0a20 2020 206d 6f63 6b5f 6665  rds,.    mock_fe
-00015c60: 6564 6261 636b 2c0a 2020 2020 6d6f 636b  edback,.    mock
-00015c70: 5f70 7265 6473 2c0a 2020 2020 6d6f 636b  _preds,.    mock
-00015c80: 5f70 7265 6473 5f61 6e64 5f66 6565 6462  _preds_and_feedb
-00015c90: 6163 6b2c 0a20 2020 206d 6f63 6b5f 7265  ack,.    mock_re
-00015ca0: 736f 6c76 655f 6a6f 696e 5f6b 6579 732c  solve_join_keys,
-00015cb0: 0a20 2020 2076 6572 7369 6f6e 2c0a 2020  .    version,.  
-00015cc0: 2020 7461 6773 2c0a 2020 2020 726f 775f    tags,.    row_
-00015cd0: 7461 6773 2c0a 2020 2020 676c 6f62 616c  tags,.    global
-00015ce0: 5f74 6167 732c 0a20 2020 2065 7870 6563  _tags,.    expec
-00015cf0: 7465 645f 7461 6773 5f70 6172 616d 2c0a  ted_tags_param,.
-00015d00: 2020 2020 7465 7374 5f74 696d 6573 7461      test_timesta
-00015d10: 6d70 732c 0a20 2020 2074 6573 745f 7469  mps,.    test_ti
-00015d20: 6d65 7374 616d 7073 5f6c 6973 742c 0a20  mestamps_list,. 
-00015d30: 2020 2074 6573 745f 696e 7075 7473 2c0a     test_inputs,.
-00015d40: 2020 2020 7465 7374 5f6f 7574 7075 7473      test_outputs
-00015d50: 2c0a 2020 2020 6b77 6172 6773 2c0a 2020  ,.    kwargs,.  
-00015d60: 2020 636c 695f 6f62 6a2c 0a29 3a0a 2020    cli_obj,.):.  
-00015d70: 2020 6d6f 636b 5f6a 6f69 6e5f 6b65 795f    mock_join_key_
-00015d80: 6765 6e2e 7369 6465 5f65 6666 6563 7420  gen.side_effect 
-00015d90: 3d20 5b22 3637 3839 3022 2c20 2231 3233  = ["67890", "123
-00015da0: 3435 225d 0a20 2020 206d 6f63 6b5f 7265  45"].    mock_re
-00015db0: 736f 6c76 655f 6a6f 696e 5f6b 6579 732e  solve_join_keys.
-00015dc0: 7265 7475 726e 5f76 616c 7565 203d 205b  return_value = [
-00015dd0: 2231 3233 3435 222c 2022 3637 3839 3022  "12345", "67890"
-00015de0: 5d20 6966 206b 7761 7267 7320 656c 7365  ] if kwargs else
-00015df0: 204e 6f6e 650a 2020 2020 6173 7365 7274   None.    assert
-00015e00: 2063 6c69 5f6f 626a 2e6c 6f67 5f72 6563   cli_obj.log_rec
-00015e10: 6f72 6473 280a 2020 2020 2020 2020 6170  ords(.        ap
-00015e20: 706c 6963 6174 696f 6e3d 2266 6f6f 6261  plication="fooba
-00015e30: 7222 2c0a 2020 2020 2020 2020 7665 7273  r",.        vers
-00015e40: 696f 6e3d 7665 7273 696f 6e2c 0a20 2020  ion=version,.   
-00015e50: 2020 2020 2069 6e70 7574 733d 7465 7374       inputs=test
-00015e60: 5f69 6e70 7574 732c 0a20 2020 2020 2020  _inputs,.       
-00015e70: 206f 7574 7075 7473 3d74 6573 745f 6f75   outputs=test_ou
-00015e80: 7470 7574 732c 0a20 2020 2020 2020 2066  tputs,.        f
-00015e90: 6565 6462 6163 6b73 3d4e 6f6e 652c 0a20  eedbacks=None,. 
-00015ea0: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
-00015eb0: 733d 7465 7374 5f74 696d 6573 7461 6d70  s=test_timestamp
-00015ec0: 732c 0a20 2020 2020 2020 2073 6f72 745f  s,.        sort_
-00015ed0: 6f6e 5f74 696d 6573 7461 6d70 3d54 7275  on_timestamp=Tru
-00015ee0: 652c 0a20 2020 2020 2020 2074 6167 733d  e,.        tags=
-00015ef0: 7461 6773 2c0a 2020 2020 2020 2020 726f  tags,.        ro
-00015f00: 775f 7461 6773 3d72 6f77 5f74 6167 732c  w_tags=row_tags,
-00015f10: 0a20 2020 2020 2020 2067 6c6f 6261 6c5f  .        global_
-00015f20: 7461 6773 3d67 6c6f 6261 6c5f 7461 6773  tags=global_tags
-00015f30: 2c0a 2020 2020 2020 2020 2a2a 6b77 6172  ,.        **kwar
-00015f40: 6773 2c0a 2020 2020 2920 3d3d 2028 4e6f  gs,.    ) == (No
-00015f50: 6e65 2c20 5b22 3132 3334 3522 2c20 2236  ne, ["12345", "6
-00015f60: 3738 3930 225d 290a 0a20 2020 206d 6f63  7890"])..    moc
-00015f70: 6b5f 7072 6564 735f 616e 645f 6665 6564  k_preds_and_feed
-00015f80: 6261 636b 2e61 7373 6572 745f 6e6f 745f  back.assert_not_
-00015f90: 6361 6c6c 6564 2829 0a20 2020 206d 6f63  called().    moc
-00015fa0: 6b5f 7072 6564 732e 6173 7365 7274 5f63  k_preds.assert_c
-00015fb0: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-00015fc0: 0a20 2020 2020 2020 2061 7070 6c69 6361  .        applica
-00015fd0: 7469 6f6e 3d22 666f 6f62 6172 222c 0a20  tion="foobar",. 
-00015fe0: 2020 2020 2020 2069 6e70 7574 733d 5b7b         inputs=[{
-00015ff0: 2241 223a 2031 3030 7d2c 207b 2241 223a  "A": 100}, {"A":
-00016000: 2031 3031 7d5d 2c0a 2020 2020 2020 2020   101}],.        
-00016010: 6f75 7470 7574 733d 5b7b 2242 223a 2033  outputs=[{"B": 3
-00016020: 3030 7d2c 207b 2242 223a 2033 3031 7d5d  00}, {"B": 301}]
-00016030: 2c0a 2020 2020 2020 2020 6a6f 696e 5f6b  ,.        join_k
-00016040: 6579 733d 5b22 3132 3334 3522 2c20 2236  eys=["12345", "6
-00016050: 3738 3930 225d 2069 6620 6b77 6172 6773  7890"] if kwargs
-00016060: 2065 6c73 6520 5b22 3637 3839 3022 2c20   else ["67890", 
-00016070: 2231 3233 3435 225d 2c0a 2020 2020 2020  "12345"],.      
-00016080: 2020 7665 7273 696f 6e3d 7665 7273 696f    version=versio
-00016090: 6e2c 0a20 2020 2020 2020 2069 676e 6f72  n,.        ignor
-000160a0: 655f 696e 7075 7473 3d4e 6f6e 652c 0a20  e_inputs=None,. 
-000160b0: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
-000160c0: 733d 7465 7374 5f74 696d 6573 7461 6d70  s=test_timestamp
-000160d0: 735f 6c69 7374 2c0a 2020 2020 2020 2020  s_list,.        
-000160e0: 736f 7274 5f6f 6e5f 7469 6d65 7374 616d  sort_on_timestam
-000160f0: 703d 5472 7565 2c0a 2020 2020 2020 2020  p=True,.        
-00016100: 6173 5f62 6174 6368 3d46 616c 7365 2c0a  as_batch=False,.
-00016110: 2020 2020 2020 2020 7461 6773 3d65 7870          tags=exp
-00016120: 6563 7465 645f 7461 6773 5f70 6172 616d  ected_tags_param
-00016130: 2c0a 2020 2020 290a 2020 2020 6d6f 636b  ,.    ).    mock
-00016140: 5f66 6565 6462 6163 6b2e 6173 7365 7274  _feedback.assert
-00016150: 5f6e 6f74 5f63 616c 6c65 6428 290a 0a20  _not_called().. 
-00016160: 2020 206d 6f63 6b5f 7361 6d70 6c65 5f72     mock_sample_r
-00016170: 6563 6f72 6473 2e61 7373 6572 745f 6361  ecords.assert_ca
-00016180: 6c6c 6564 5f6f 6e63 655f 7769 7468 280a  lled_once_with(.
-00016190: 2020 2020 2020 2020 322c 0a20 2020 2020          2,.     
-000161a0: 2020 2031 2c0a 2020 2020 2020 2020 5b7b     1,.        [{
-000161b0: 2241 223a 2031 3030 7d2c 207b 2241 223a  "A": 100}, {"A":
-000161c0: 2031 3031 7d5d 2c0a 2020 2020 2020 2020   101}],.        
-000161d0: 5b7b 2242 223a 2033 3030 7d2c 207b 2242  [{"B": 300}, {"B
-000161e0: 223a 2033 3031 7d5d 2c0a 2020 2020 2020  ": 301}],.      
-000161f0: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
-00016200: 636c 6965 6e74 2e5f 7265 736f 6c76 655f  client._resolve_
-00016210: 6a6f 696e 5f6b 6579 7328 2a2a 6b77 6172  join_keys(**kwar
-00016220: 6773 292c 0a20 2020 2020 2020 2074 6573  gs),.        tes
-00016230: 745f 7469 6d65 7374 616d 7073 5f6c 6973  t_timestamps_lis
-00016240: 742c 0a20 2020 2020 2020 2065 7870 6563  t,.        expec
-00016250: 7465 645f 7461 6773 5f70 6172 616d 2c0a  ted_tags_param,.
-00016260: 2020 2020 290a 0a20 2020 2069 6620 6b77      )..    if kw
-00016270: 6172 6773 3a0a 2020 2020 2020 2020 6d6f  args:.        mo
-00016280: 636b 5f6a 6f69 6e5f 6b65 795f 6765 6e2e  ck_join_key_gen.
-00016290: 6173 7365 7274 5f6e 6f74 5f63 616c 6c65  assert_not_calle
-000162a0: 6428 290a 2020 2020 656c 7365 3a0a 2020  d().    else:.  
-000162b0: 2020 2020 2020 6d6f 636b 5f6a 6f69 6e5f        mock_join_
-000162c0: 6b65 795f 6765 6e2e 6173 7365 7274 5f63  key_gen.assert_c
-000162d0: 616c 6c65 6428 290a 0a0a 4070 7974 6573  alled()...@pytes
-000162e0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
-000162f0: 7a65 280a 2020 2020 2274 6573 745f 7469  ze(.    "test_ti
-00016300: 6d65 7374 616d 7073 2c20 7465 7374 5f74  mestamps, test_t
-00016310: 696d 6573 7461 6d70 735f 6c69 7374 222c  imestamps_list",
-00016320: 0a20 2020 205b 0a20 2020 2020 2020 2028  .    [.        (
-00016330: 4e6f 6e65 2c20 4e6f 6e65 292c 0a20 2020  None, None),.   
-00016340: 2020 2020 2028 5b43 5552 5245 4e54 5f54       ([CURRENT_T
-00016350: 494d 455d 202a 2032 2c20 5b43 5552 5245  IME] * 2, [CURRE
-00016360: 4e54 5f54 494d 455d 202a 2032 292c 0a20  NT_TIME] * 2),. 
-00016370: 2020 2020 2020 2028 6e70 2e61 7272 6179         (np.array
-00016380: 285b 4355 5252 454e 545f 5449 4d45 5d20  ([CURRENT_TIME] 
-00016390: 2a20 3229 2c20 5b43 5552 5245 4e54 5f54  * 2), [CURRENT_T
-000163a0: 494d 455d 202a 2032 292c 0a20 2020 205d  IME] * 2),.    ]
-000163b0: 2c0a 290a 4070 7974 6573 742e 6d61 726b  ,.).@pytest.mark
-000163c0: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
-000163d0: 2020 226b 7761 7267 7322 2c0a 2020 2020    "kwargs",.    
-000163e0: 5b0a 2020 2020 2020 2020 7b22 6665 6564  [.        {"feed
-000163f0: 6261 636b 5f6b 6579 7322 3a20 5b22 4122  back_keys": ["A"
-00016400: 5d7d 2c0a 2020 2020 2020 2020 7b22 6665  ]},.        {"fe
-00016410: 6564 6261 636b 5f69 6473 223a 205b 2231  edback_ids": ["1
-00016420: 3233 3435 222c 2022 3637 3839 3022 5d7d  2345", "67890"]}
-00016430: 2c0a 2020 2020 2020 2020 7b22 6a6f 696e  ,.        {"join
-00016440: 5f6b 6579 7322 3a20 5b22 3534 3332 3122  _keys": ["54321"
-00016450: 2c20 2236 3738 3930 225d 7d2c 0a20 2020  , "67890"]},.   
-00016460: 2020 2020 207b 226a 6f69 6e5f 6b65 7973       {"join_keys
-00016470: 223a 2070 642e 5365 7269 6573 285b 2235  ": pd.Series(["5
-00016480: 3433 3231 222c 2022 3637 3839 3022 5d29  4321", "67890"])
-00016490: 7d2c 0a20 2020 2020 2020 207b 7d2c 0a20  },.        {},. 
-000164a0: 2020 205d 2c0a 290a 4070 7974 6573 742e     ],.).@pytest.
-000164b0: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-000164c0: 280a 2020 2020 2274 6573 745f 6f75 7470  (.    "test_outp
-000164d0: 7574 7322 2c0a 2020 2020 5b0a 2020 2020  uts",.    [.    
-000164e0: 2020 2020 5b7b 2242 223a 2033 3030 7d2c      [{"B": 300},
-000164f0: 207b 2242 223a 2033 3031 7d5d 2c0a 2020   {"B": 301}],.  
-00016500: 2020 2020 2020 7064 2e44 6174 6146 7261        pd.DataFra
-00016510: 6d65 2e66 726f 6d5f 6469 6374 287b 2242  me.from_dict({"B
-00016520: 223a 205b 3330 302c 2033 3031 5d7d 292c  ": [300, 301]}),
-00016530: 0a20 2020 2020 2020 2070 642e 5365 7269  .        pd.Seri
-00016540: 6573 286e 616d 653d 2242 222c 2064 6174  es(name="B", dat
-00016550: 613d 5b33 3030 2c20 3330 315d 292c 0a20  a=[300, 301]),. 
-00016560: 2020 2020 2020 206e 702e 6172 7261 7928         np.array(
-00016570: 5b7b 2242 223a 2033 3030 7d2c 207b 2242  [{"B": 300}, {"B
-00016580: 223a 2033 3031 7d5d 292c 0a20 2020 205d  ": 301}]),.    ]
-00016590: 2c0a 290a 4070 7974 6573 742e 6d61 726b  ,.).@pytest.mark
-000165a0: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
-000165b0: 2020 2274 6573 745f 696e 7075 7473 222c    "test_inputs",
-000165c0: 0a20 2020 205b 0a20 2020 2020 2020 205b  .    [.        [
-000165d0: 7b22 4122 3a20 3130 307d 2c20 7b22 4122  {"A": 100}, {"A"
-000165e0: 3a20 3130 317d 5d2c 0a20 2020 2020 2020  : 101}],.       
-000165f0: 2070 642e 4461 7461 4672 616d 652e 6672   pd.DataFrame.fr
-00016600: 6f6d 5f64 6963 7428 7b22 4122 3a20 5b31  om_dict({"A": [1
-00016610: 3030 2c20 3130 315d 7d29 2c0a 2020 2020  00, 101]}),.    
-00016620: 2020 2020 7064 2e53 6572 6965 7328 6e61      pd.Series(na
-00016630: 6d65 3d22 4122 2c20 6461 7461 3d5b 3130  me="A", data=[10
-00016640: 302c 2031 3031 5d29 2c0a 2020 2020 2020  0, 101]),.      
-00016650: 2020 6e70 2e61 7272 6179 285b 7b22 4122    np.array([{"A"
-00016660: 3a20 3130 307d 2c20 7b22 4122 3a20 3130  : 100}, {"A": 10
-00016670: 317d 5d29 2c0a 2020 2020 5d2c 0a29 0a40  1}]),.    ],.).@
-00016680: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
-00016690: 6d65 7472 697a 6528 2276 6572 7369 6f6e  metrize("version
-000166a0: 222c 205b 4e6f 6e65 2c20 3130 2c20 2231  ", [None, 10, "1
-000166b0: 2e32 2e33 225d 290a 4070 7974 6573 742e  .2.3"]).@pytest.
-000166c0: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-000166d0: 280a 2020 2020 2274 6167 732c 2072 6f77  (.    "tags, row
-000166e0: 5f74 6167 732c 2067 6c6f 6261 6c5f 7461  _tags, global_ta
-000166f0: 6773 2c20 6578 7065 6374 6564 5f74 6167  gs, expected_tag
-00016700: 735f 7061 7261 6d22 2c0a 2020 2020 5b0a  s_param",.    [.
-00016710: 2020 2020 2020 2020 284e 6f6e 652c 204e          (None, N
-00016720: 6f6e 652c 204e 6f6e 652c 205b 7b22 656e  one, None, [{"en
-00016730: 7622 3a20 2274 6573 7422 7d2c 207b 2265  v": "test"}, {"e
-00016740: 6e76 223a 2022 7465 7374 227d 5d29 2c0a  nv": "test"}]),.
-00016750: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
-00016760: 2020 2020 2020 7b22 6261 7222 3a20 2262        {"bar": "b
-00016770: 6172 227d 2c0a 2020 2020 2020 2020 2020  ar"},.          
-00016780: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
-00016790: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
-000167a0: 2020 2020 2020 5b7b 2262 6172 223a 2022        [{"bar": "
-000167b0: 6261 7222 2c20 2265 6e76 223a 2022 7465  bar", "env": "te
-000167c0: 7374 227d 2c20 7b22 6261 7222 3a20 2262  st"}, {"bar": "b
-000167d0: 6172 222c 2022 656e 7622 3a20 2274 6573  ar", "env": "tes
-000167e0: 7422 7d5d 2c0a 2020 2020 2020 2020 292c  t"}],.        ),
-000167f0: 0a20 2020 2020 2020 2028 0a20 2020 2020  .        (.     
-00016800: 2020 2020 2020 207b 2262 6172 223a 2022         {"bar": "
-00016810: 6261 7222 7d2c 0a20 2020 2020 2020 2020  bar"},.         
-00016820: 2020 204e 6f6e 652c 0a20 2020 2020 2020     None,.       
-00016830: 2020 2020 207b 2266 6f6f 223a 2022 666f       {"foo": "fo
-00016840: 6f22 7d2c 0a20 2020 2020 2020 2020 2020  o"},.           
-00016850: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-00016860: 2020 207b 2262 6172 223a 2022 6261 7222     {"bar": "bar"
-00016870: 2c20 2265 6e76 223a 2022 7465 7374 222c  , "env": "test",
-00016880: 2022 666f 6f22 3a20 2266 6f6f 227d 2c0a   "foo": "foo"},.
-00016890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000168a0: 7b22 6261 7222 3a20 2262 6172 222c 2022  {"bar": "bar", "
-000168b0: 656e 7622 3a20 2274 6573 7422 2c20 2266  env": "test", "f
-000168c0: 6f6f 223a 2022 666f 6f22 7d2c 0a20 2020  oo": "foo"},.   
-000168d0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-000168e0: 2020 2020 292c 0a20 2020 2020 2020 2028      ),.        (
-000168f0: 0a20 2020 2020 2020 2020 2020 205b 7b22  .            [{"
-00016900: 6261 7222 3a20 2262 6172 227d 2c20 7b22  bar": "bar"}, {"
-00016910: 6261 7222 3a20 2262 617a 227d 5d2c 0a20  bar": "baz"}],. 
-00016920: 2020 2020 2020 2020 2020 204e 6f6e 652c             None,
-00016930: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-00016940: 652c 0a20 2020 2020 2020 2020 2020 205b  e,.            [
-00016950: 7b22 6261 7222 3a20 2262 6172 222c 2022  {"bar": "bar", "
-00016960: 656e 7622 3a20 2274 6573 7422 7d2c 207b  env": "test"}, {
-00016970: 2262 6172 223a 2022 6261 7a22 2c20 2265  "bar": "baz", "e
-00016980: 6e76 223a 2022 7465 7374 227d 5d2c 0a20  nv": "test"}],. 
-00016990: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-000169a0: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-000169b0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-000169c0: 2020 5b7b 2262 6172 223a 2022 6261 7222    [{"bar": "bar"
-000169d0: 7d2c 207b 2262 6172 223a 2022 6261 7a22  }, {"bar": "baz"
-000169e0: 7d5d 2c0a 2020 2020 2020 2020 2020 2020  }],.            
-000169f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-00016a00: 2020 5b7b 2262 6172 223a 2022 6261 7222    [{"bar": "bar"
-00016a10: 2c20 2265 6e76 223a 2022 7465 7374 227d  , "env": "test"}
-00016a20: 2c20 7b22 6261 7222 3a20 2262 617a 222c  , {"bar": "baz",
-00016a30: 2022 656e 7622 3a20 2274 6573 7422 7d5d   "env": "test"}]
-00016a40: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
-00016a50: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
-00016a60: 2020 204e 6f6e 652c 0a20 2020 2020 2020     None,.       
-00016a70: 2020 2020 205b 7b22 6261 7222 3a20 2262       [{"bar": "b
-00016a80: 6172 227d 2c20 7b22 6261 7222 3a20 2262  ar"}, {"bar": "b
-00016a90: 617a 227d 5d2c 0a20 2020 2020 2020 2020  az"}],.         
-00016aa0: 2020 207b 2266 6f6f 223a 2022 666f 6f22     {"foo": "foo"
-00016ab0: 7d2c 0a20 2020 2020 2020 2020 2020 205b  },.            [
-00016ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016ad0: 207b 2262 6172 223a 2022 6261 7222 2c20   {"bar": "bar", 
-00016ae0: 2265 6e76 223a 2022 7465 7374 222c 2022  "env": "test", "
-00016af0: 666f 6f22 3a20 2266 6f6f 227d 2c0a 2020  foo": "foo"},.  
-00016b00: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-00016b10: 6261 7222 3a20 2262 617a 222c 2022 656e  bar": "baz", "en
-00016b20: 7622 3a20 2274 6573 7422 2c20 2266 6f6f  v": "test", "foo
-00016b30: 223a 2022 666f 6f22 7d2c 0a20 2020 2020  ": "foo"},.     
-00016b40: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-00016b50: 2020 292c 0a20 2020 2020 2020 2028 0a20    ),.        (. 
-00016b60: 2020 2020 2020 2020 2020 207b 2266 6f6f             {"foo
-00016b70: 223a 2022 666f 6f22 7d2c 0a20 2020 2020  ": "foo"},.     
-00016b80: 2020 2020 2020 205b 7b22 6261 7222 3a20         [{"bar": 
-00016b90: 2262 6172 227d 2c20 7b22 6261 7222 3a20  "bar"}, {"bar": 
-00016ba0: 2262 617a 227d 5d2c 0a20 2020 2020 2020  "baz"}],.       
-00016bb0: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
-00016bc0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-00016bd0: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-00016be0: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
-00016bf0: 7465 7374 222c 2022 666f 6f22 3a20 2266  test", "foo": "f
-00016c00: 6f6f 227d 2c0a 2020 2020 2020 2020 2020  oo"},.          
-00016c10: 2020 2020 2020 7b22 6261 7222 3a20 2262        {"bar": "b
-00016c20: 617a 222c 2022 656e 7622 3a20 2274 6573  az", "env": "tes
-00016c30: 7422 2c20 2266 6f6f 223a 2022 666f 6f22  t", "foo": "foo"
-00016c40: 7d2c 0a20 2020 2020 2020 2020 2020 205d  },.            ]
-00016c50: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
-00016c60: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
-00016c70: 2020 207b 2262 6172 223a 2022 6261 7222     {"bar": "bar"
-00016c80: 7d2c 0a20 2020 2020 2020 2020 2020 205b  },.            [
-00016c90: 7b22 666f 6f22 3a20 2266 6f6f 227d 2c20  {"foo": "foo"}, 
-00016ca0: 7b22 6261 7a22 3a20 2262 617a 227d 5d2c  {"baz": "baz"}],
-00016cb0: 0a20 2020 2020 2020 2020 2020 207b 2265  .            {"e
-00016cc0: 6e76 223a 2022 666f 6f62 6172 227d 2c0a  nv": "foobar"},.
-00016cd0: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-00016ce0: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-00016cf0: 6261 7222 3a20 2262 6172 222c 2022 656e  bar": "bar", "en
-00016d00: 7622 3a20 2266 6f6f 6261 7222 2c20 2266  v": "foobar", "f
-00016d10: 6f6f 223a 2022 666f 6f22 7d2c 0a20 2020  oo": "foo"},.   
-00016d20: 2020 2020 2020 2020 2020 2020 207b 2262               {"b
-00016d30: 6172 223a 2022 6261 7222 2c20 2265 6e76  ar": "bar", "env
-00016d40: 223a 2022 666f 6f62 6172 222c 2022 6261  ": "foobar", "ba
-00016d50: 7a22 3a20 2262 617a 227d 2c0a 2020 2020  z": "baz"},.    
-00016d60: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-00016d70: 2020 2029 2c0a 2020 2020 2020 2020 280a     ),.        (.
-00016d80: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-00016d90: 2c0a 2020 2020 2020 2020 2020 2020 5b7b  ,.            [{
-00016da0: 2262 6172 223a 2022 6261 7222 7d2c 207b  "bar": "bar"}, {
-00016db0: 2262 6172 223a 2022 6261 7a22 7d5d 2c0a  "bar": "baz"}],.
-00016dc0: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-00016dd0: 2c0a 2020 2020 2020 2020 2020 2020 5b0a  ,.            [.
-00016de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016df0: 7b22 6261 7222 3a20 2262 6172 222c 2022  {"bar": "bar", "
-00016e00: 656e 7622 3a20 2274 6573 7422 7d2c 0a20  env": "test"},. 
-00016e10: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00016e20: 2262 6172 223a 2022 6261 7a22 2c20 2265  "bar": "baz", "e
-00016e30: 6e76 223a 2022 7465 7374 227d 2c0a 2020  nv": "test"},.  
-00016e40: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-00016e50: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-00016e60: 280a 2020 2020 2020 2020 2020 2020 4e6f  (.            No
-00016e70: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00016e80: 6e70 2e61 7272 6179 285b 7b22 6261 7222  np.array([{"bar"
-00016e90: 3a20 2262 6172 227d 2c20 7b22 6261 7222  : "bar"}, {"bar"
-00016ea0: 3a20 2262 617a 227d 5d29 2c0a 2020 2020  : "baz"}]),.    
-00016eb0: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
-00016ec0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-00016ed0: 2020 2020 2020 2020 2020 2020 7b22 6261              {"ba
-00016ee0: 7222 3a20 2262 6172 222c 2022 656e 7622  r": "bar", "env"
-00016ef0: 3a20 2274 6573 7422 7d2c 0a20 2020 2020  : "test"},.     
-00016f00: 2020 2020 2020 2020 2020 207b 2262 6172             {"bar
-00016f10: 223a 2022 6261 7a22 2c20 2265 6e76 223a  ": "baz", "env":
-00016f20: 2022 7465 7374 227d 2c0a 2020 2020 2020   "test"},.      
-00016f30: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-00016f40: 2029 2c0a 2020 2020 2020 2020 280a 2020   ),.        (.  
-00016f50: 2020 2020 2020 2020 2020 4e6f 6e65 2c0a            None,.
-00016f60: 2020 2020 2020 2020 2020 2020 7064 2e53              pd.S
-00016f70: 6572 6965 7328 5b22 6261 7222 2c20 2262  eries(["bar", "b
-00016f80: 617a 225d 2c20 6e61 6d65 3d22 6261 7222  az"], name="bar"
-00016f90: 292c 0a20 2020 2020 2020 2020 2020 204e  ),.            N
-00016fa0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-00016fb0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-00016fc0: 2020 207b 2262 6172 223a 2022 6261 7222     {"bar": "bar"
-00016fd0: 2c20 2265 6e76 223a 2022 7465 7374 227d  , "env": "test"}
-00016fe0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00016ff0: 2020 7b22 6261 7222 3a20 2262 617a 222c    {"bar": "baz",
-00017000: 2022 656e 7622 3a20 2274 6573 7422 7d2c   "env": "test"},
-00017010: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
-00017020: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-00017030: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
-00017040: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-00017050: 2020 2070 642e 4461 7461 4672 616d 6528     pd.DataFrame(
-00017060: 7b22 6261 7222 3a20 5b22 6261 7222 2c20  {"bar": ["bar", 
-00017070: 2262 617a 225d 7d29 2c0a 2020 2020 2020  "baz"]}),.      
-00017080: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-00017090: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-000170a0: 2020 2020 2020 2020 2020 7b22 6261 7222            {"bar"
-000170b0: 3a20 2262 6172 222c 2022 656e 7622 3a20  : "bar", "env": 
-000170c0: 2274 6573 7422 7d2c 0a20 2020 2020 2020  "test"},.       
-000170d0: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-000170e0: 2022 6261 7a22 2c20 2265 6e76 223a 2022   "baz", "env": "
-000170f0: 7465 7374 227d 2c0a 2020 2020 2020 2020  test"},.        
-00017100: 2020 2020 5d2c 0a20 2020 2020 2020 2029      ],.        )
-00017110: 2c0a 2020 2020 5d2c 0a29 0a40 6d6f 636b  ,.    ],.).@mock
+00005640: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00005650: 2866 6565 6462 6163 6b5f 6964 2c20 6469  (feedback_id, di
+00005660: 6374 290a 2020 2020 2020 2020 2020 2020  ct).            
+00005670: 2020 2020 2020 2020 656c 7365 2066 6565          else fee
+00005680: 6462 6163 6b5f 6964 2c0a 2020 2020 2020  dback_id,.      
+00005690: 2020 2020 2020 2020 2020 2020 2020 226c                "l
+000056a0: 6f67 5f74 696d 6573 7461 6d70 223a 2043  og_timestamp": C
+000056b0: 5552 5245 4e54 5f54 494d 455f 5354 522c  URRENT_TIME_STR,
+000056c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000056d0: 2020 2020 2022 6d65 7461 6461 7461 223a       "metadata":
+000056e0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+000056f0: 2020 2020 2020 2020 2020 2022 6675 6e63             "func
+00005700: 5f6e 616d 6522 3a20 2273 6f6d 652d 6e61  _name": "some-na
+00005710: 6d65 222c 0a20 2020 2020 2020 2020 2020  me",.           
+00005720: 2020 2020 2020 2020 2020 2020 2022 7665               "ve
+00005730: 7273 696f 6e22 3a20 2261 2e62 2e63 222c  rsion": "a.b.c",
+00005740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005750: 2020 2020 2020 2020 2022 6967 6e6f 7265           "ignore
+00005760: 5f69 6e70 7574 7322 3a20 5b22 4222 5d2c  _inputs": ["B"],
+00005770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005780: 2020 2020 2020 2020 2022 6665 6564 6261           "feedba
+00005790: 636b 5f6b 6579 7322 3a20 4e6f 6e65 2c0a  ck_keys": None,.
+000057a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000057b0: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+000057c0: 2020 2020 2020 2020 2020 2022 7469 6d65             "time
+000057d0: 7374 616d 7022 3a20 534f 4d45 5f54 494d  stamp": SOME_TIM
+000057e0: 455f 5354 522c 0a20 2020 2020 2020 2020  E_STR,.         
+000057f0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00005800: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+00005810: 2020 2020 2261 7070 6c69 6361 7469 6f6e      "application
+00005820: 223a 2022 736f 6d65 2d6e 616d 6522 2c0a  ": "some-name",.
+00005830: 2020 2020 2020 2020 7d2c 0a20 2020 205d          },.    ]
+00005840: 0a0a 0a40 6672 6565 7a65 5f74 696d 6528  ...@freeze_time(
+00005850: 4355 5252 454e 545f 5449 4d45 290a 4070  CURRENT_TIME).@p
+00005860: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+00005870: 6574 7269 7a65 2822 6665 6564 6261 636b  etrize("feedback
+00005880: 5f69 6422 2c20 5b22 666f 6f22 2c20 7b22  _id", ["foo", {"
+00005890: 666f 6f22 3a20 2262 6172 227d 5d29 0a40  foo": "bar"}]).@
+000058a0: 6d6f 636b 2e70 6174 6368 2822 6761 6e74  mock.patch("gant
+000058b0: 7279 2e6c 6f67 6765 722e 6576 656e 745f  ry.logger.event_
+000058c0: 6275 696c 6465 722e 7575 6964 2e75 7569  builder.uuid.uui
+000058d0: 6434 2229 0a64 6566 2074 6573 745f 6c6f  d4").def test_lo
+000058e0: 675f 7265 636f 7264 5f76 616c 6964 5f66  g_record_valid_f
+000058f0: 6565 6462 6163 6b5f 6964 5f66 6f72 5f66  eedback_id_for_f
+00005900: 6565 6462 6163 6b28 6d6f 636b 5f75 7569  eedback(mock_uui
+00005910: 642c 2066 6565 6462 6163 6b5f 6964 2c20  d, feedback_id, 
+00005920: 636c 695f 6f62 6a29 3a0a 2020 2020 6d6f  cli_obj):.    mo
+00005930: 636b 5f75 7569 642e 7265 7475 726e 5f76  ck_uuid.return_v
+00005940: 616c 7565 203d 2022 3132 3334 3522 0a20  alue = "12345". 
+00005950: 2020 2063 6c69 5f6f 626a 2e6c 6f67 5f72     cli_obj.log_r
+00005960: 6563 6f72 6428 0a20 2020 2020 2020 2061  ecord(.        a
+00005970: 7070 6c69 6361 7469 6f6e 3d22 736f 6d65  pplication="some
+00005980: 2d6e 616d 6522 2c0a 2020 2020 2020 2020  -name",.        
+00005990: 6665 6564 6261 636b 3d7b 2241 223a 2031  feedback={"A": 1
+000059a0: 3030 7d2c 0a20 2020 2020 2020 2076 6572  00},.        ver
+000059b0: 7369 6f6e 3d22 612e 622e 6322 2c0a 2020  sion="a.b.c",.  
+000059c0: 2020 2020 2020 6665 6564 6261 636b 5f69        feedback_i
+000059d0: 643d 6665 6564 6261 636b 5f69 642c 0a20  d=feedback_id,. 
+000059e0: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
+000059f0: 3d53 4f4d 455f 5449 4d45 2c0a 2020 2020  =SOME_TIME,.    
+00005a00: 290a 2020 2020 6173 7365 7274 2063 6c69  ).    assert cli
+00005a10: 5f6f 626a 2e6c 6f67 5f73 746f 7265 2e6c  _obj.log_store.l
+00005a20: 6f67 7320 3d3d 205b 0a20 2020 2020 2020  ogs == [.       
+00005a30: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00005a40: 6576 656e 7473 223a 205b 0a20 2020 2020  events": [.     
+00005a50: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+00005a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005a70: 2022 6261 7463 685f 6964 223a 204e 6f6e   "batch_id": Non
+00005a80: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00005a90: 2020 2020 2020 2022 6576 656e 745f 6964         "event_id
+00005aa0: 223a 2022 3132 3334 3522 2c0a 2020 2020  ": "12345",.    
+00005ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ac0: 2266 6565 6462 6163 6b22 3a20 7b22 4122  "feedback": {"A"
+00005ad0: 3a20 3130 307d 2c0a 2020 2020 2020 2020  : 100},.        
+00005ae0: 2020 2020 2020 2020 2020 2020 2266 6565              "fee
+00005af0: 6462 6163 6b5f 6964 223a 2022 3432 6135  dback_id": "42a5
+00005b00: 6237 6239 3962 3337 3137 6431 6561 6562  b7b99b3717d1eaeb
+00005b10: 3732 6136 3934 3864 6162 6339 220a 2020  72a6948dabc9".  
+00005b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005b30: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00005b40: 6665 6564 6261 636b 5f69 642c 2064 6963  feedback_id, dic
+00005b50: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
+00005b60: 2020 2020 2020 2065 6c73 6520 6665 6564         else feed
+00005b70: 6261 636b 5f69 642c 0a20 2020 2020 2020  back_id,.       
+00005b80: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
+00005b90: 675f 7469 6d65 7374 616d 7022 3a20 4355  g_timestamp": CU
+00005ba0: 5252 454e 545f 5449 4d45 5f53 5452 2c0a  RRENT_TIME_STR,.
+00005bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005bc0: 2020 2020 226d 6574 6164 6174 6122 3a20      "metadata": 
+00005bd0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00005be0: 2020 2020 2020 2020 2020 2266 756e 635f            "func_
+00005bf0: 6e61 6d65 223a 2022 736f 6d65 2d6e 616d  name": "some-nam
+00005c00: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00005c10: 2020 2020 2020 2020 2020 2020 2266 6565              "fee
+00005c20: 6462 6163 6b5f 7665 7273 696f 6e22 3a20  dback_version": 
+00005c30: 2261 2e62 2e63 222c 0a20 2020 2020 2020  "a.b.c",.       
+00005c40: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+00005c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005c60: 2020 2020 2274 696d 6573 7461 6d70 223a      "timestamp":
+00005c70: 2053 4f4d 455f 5449 4d45 5f53 5452 2c0a   SOME_TIME_STR,.
+00005c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005c90: 7d0a 2020 2020 2020 2020 2020 2020 5d2c  }.            ],
+00005ca0: 0a20 2020 2020 2020 2020 2020 2022 6170  .            "ap
+00005cb0: 706c 6963 6174 696f 6e22 3a20 2273 6f6d  plication": "som
+00005cc0: 652d 6e61 6d65 222c 0a20 2020 2020 2020  e-name",.       
+00005cd0: 207d 2c0a 2020 2020 5d0a 0a0a 4066 7265   },.    ]...@fre
+00005ce0: 657a 655f 7469 6d65 2843 5552 5245 4e54  eze_time(CURRENT
+00005cf0: 5f54 494d 4529 0a40 7079 7465 7374 2e6d  _TIME).@pytest.m
+00005d00: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+00005d10: 2266 6565 6462 6163 6b5f 6964 222c 205b  "feedback_id", [
+00005d20: 2266 6f6f 222c 207b 2266 6f6f 223a 2022  "foo", {"foo": "
+00005d30: 6261 7222 7d5d 290a 406d 6f63 6b2e 7061  bar"}]).@mock.pa
+00005d40: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
+00005d50: 6572 2e65 7665 6e74 5f62 7569 6c64 6572  er.event_builder
+00005d60: 2e75 7569 642e 7575 6964 3422 290a 6465  .uuid.uuid4").de
+00005d70: 6620 7465 7374 5f73 696e 676c 655f 6c6f  f test_single_lo
+00005d80: 675f 7265 636f 7264 5f76 616c 6964 5f66  g_record_valid_f
+00005d90: 6565 6462 6163 6b5f 6964 5f66 6f72 5f66  eedback_id_for_f
+00005da0: 6565 6462 6163 6b28 6d6f 636b 5f75 7569  eedback(mock_uui
+00005db0: 642c 2066 6565 6462 6163 6b5f 6964 2c20  d, feedback_id, 
+00005dc0: 636c 695f 6f62 6a29 3a0a 2020 2020 6d6f  cli_obj):.    mo
+00005dd0: 636b 5f75 7569 642e 7265 7475 726e 5f76  ck_uuid.return_v
+00005de0: 616c 7565 203d 2022 3132 3334 3522 0a20  alue = "12345". 
+00005df0: 2020 2063 6c69 5f6f 626a 2e73 696e 676c     cli_obj.singl
+00005e00: 655f 6c6f 675f 7265 636f 7264 280a 2020  e_log_record(.  
+00005e10: 2020 2020 2020 6170 706c 6963 6174 696f        applicatio
+00005e20: 6e3d 2273 6f6d 652d 6e61 6d65 222c 0a20  n="some-name",. 
+00005e30: 2020 2020 2020 2066 6565 6462 6163 6b3d         feedback=
+00005e40: 7b22 4122 3a20 3130 307d 2c0a 2020 2020  {"A": 100},.    
+00005e50: 2020 2020 7665 7273 696f 6e3d 2261 2e62      version="a.b
+00005e60: 2e63 222c 0a20 2020 2020 2020 2066 6565  .c",.        fee
+00005e70: 6462 6163 6b5f 6964 3d66 6565 6462 6163  dback_id=feedbac
+00005e80: 6b5f 6964 2c0a 2020 2020 2020 2020 7469  k_id,.        ti
+00005e90: 6d65 7374 616d 703d 534f 4d45 5f54 494d  mestamp=SOME_TIM
+00005ea0: 452c 0a20 2020 2029 0a20 2020 2061 7373  E,.    ).    ass
+00005eb0: 6572 7420 636c 695f 6f62 6a2e 6c6f 675f  ert cli_obj.log_
+00005ec0: 7374 6f72 652e 6c6f 6773 203d 3d20 5b0a  store.logs == [.
+00005ed0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+00005ee0: 2020 2020 2020 2265 7665 6e74 7322 3a20        "events": 
+00005ef0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00005f00: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00005f10: 2020 2020 2020 2020 2262 6174 6368 5f69          "batch_i
+00005f20: 6422 3a20 4e6f 6e65 2c0a 2020 2020 2020  d": None,.      
+00005f30: 2020 2020 2020 2020 2020 2020 2020 2265                "e
+00005f40: 7665 6e74 5f69 6422 3a20 2231 3233 3435  vent_id": "12345
+00005f50: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00005f60: 2020 2020 2020 2022 6665 6564 6261 636b         "feedback
+00005f70: 223a 207b 2241 223a 2031 3030 7d2c 0a20  ": {"A": 100},. 
+00005f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005f90: 2020 2022 6665 6564 6261 636b 5f69 6422     "feedback_id"
+00005fa0: 3a20 2234 3261 3562 3762 3939 6233 3731  : "42a5b7b99b371
+00005fb0: 3764 3165 6165 6237 3261 3639 3438 6461  7d1eaeb72a6948da
+00005fc0: 6263 3922 0a20 2020 2020 2020 2020 2020  bc9".           
+00005fd0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+00005fe0: 7374 616e 6365 2866 6565 6462 6163 6b5f  stance(feedback_
+00005ff0: 6964 2c20 6469 6374 290a 2020 2020 2020  id, dict).      
+00006000: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00006010: 7365 2066 6565 6462 6163 6b5f 6964 2c0a  se feedback_id,.
+00006020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006030: 2020 2020 226c 6f67 5f74 696d 6573 7461      "log_timesta
+00006040: 6d70 223a 2043 5552 5245 4e54 5f54 494d  mp": CURRENT_TIM
+00006050: 455f 5354 522c 0a20 2020 2020 2020 2020  E_STR,.         
+00006060: 2020 2020 2020 2020 2020 2022 6d65 7461             "meta
+00006070: 6461 7461 223a 207b 0a20 2020 2020 2020  data": {.       
+00006080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006090: 2022 6675 6e63 5f6e 616d 6522 3a20 2273   "func_name": "s
+000060a0: 6f6d 652d 6e61 6d65 222c 0a20 2020 2020  ome-name",.     
+000060b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000060c0: 2020 2022 6665 6564 6261 636b 5f76 6572     "feedback_ver
+000060d0: 7369 6f6e 223a 2022 612e 622e 6322 2c0a  sion": "a.b.c",.
+000060e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000060f0: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+00006100: 2020 2020 2020 2020 2020 2022 7469 6d65             "time
+00006110: 7374 616d 7022 3a20 534f 4d45 5f54 494d  stamp": SOME_TIM
+00006120: 455f 5354 522c 0a20 2020 2020 2020 2020  E_STR,.         
+00006130: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00006140: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+00006150: 2020 2020 2261 7070 6c69 6361 7469 6f6e      "application
+00006160: 223a 2022 736f 6d65 2d6e 616d 6522 2c0a  ": "some-name",.
+00006170: 2020 2020 2020 2020 7d2c 0a20 2020 205d          },.    ]
+00006180: 0a0a 0a40 7079 7465 7374 2e6d 6172 6b2e  ...@pytest.mark.
+00006190: 7061 7261 6d65 7472 697a 6528 2274 696d  parametrize("tim
+000061a0: 6573 7461 6d70 222c 205b 5b5d 2c20 2273  estamp", [[], "s
+000061b0: 6f6d 652d 7469 6d65 7374 616d 7022 2c20  ome-timestamp", 
+000061c0: 3130 2c20 2232 3032 302d 3130 2d31 3022  10, "2020-10-10"
+000061d0: 5d29 0a64 6566 2074 6573 745f 6c6f 675f  ]).def test_log_
+000061e0: 7265 636f 7264 5f69 6e76 616c 6964 5f74  record_invalid_t
+000061f0: 696d 6573 7461 6d70 5f66 6f72 5f70 7265  imestamp_for_pre
+00006200: 6469 6374 696f 6e28 7469 6d65 7374 616d  diction(timestam
+00006210: 702c 2063 6c69 5f6f 626a 2c20 6361 706c  p, cli_obj, capl
+00006220: 6f67 293a 0a20 2020 2063 6170 6c6f 672e  og):.    caplog.
+00006230: 7365 745f 6c65 7665 6c28 6c6f 6767 696e  set_level(loggin
+00006240: 672e 4552 524f 522c 206c 6f67 6765 723d  g.ERROR, logger=
+00006250: 2267 616e 7472 792e 636c 6965 6e74 2229  "gantry.client")
+00006260: 0a20 2020 2063 6c69 5f6f 626a 2e6c 6f67  .    cli_obj.log
+00006270: 5f72 6563 6f72 6428 0a20 2020 2020 2020  _record(.       
+00006280: 2061 7070 6c69 6361 7469 6f6e 3d22 736f   application="so
+00006290: 6d65 2d6e 616d 6522 2c0a 2020 2020 2020  me-name",.      
+000062a0: 2020 696e 7075 7473 3d7b 2241 223a 2031    inputs={"A": 1
+000062b0: 3030 7d2c 0a20 2020 2020 2020 206f 7574  00},.        out
+000062c0: 7075 7473 3d7b 2276 616c 7565 223a 2022  puts={"value": "
+000062d0: 6261 7222 7d2c 0a20 2020 2020 2020 2076  bar"},.        v
+000062e0: 6572 7369 6f6e 3d22 612e 622e 6322 2c0a  ersion="a.b.c",.
+000062f0: 2020 2020 2020 2020 6665 6564 6261 636b          feedback
+00006300: 5f6b 6579 733d 5b22 4122 5d2c 0a20 2020  _keys=["A"],.   
+00006310: 2020 2020 2069 676e 6f72 655f 696e 7075       ignore_inpu
+00006320: 7473 3d5b 2241 225d 2c0a 2020 2020 2020  ts=["A"],.      
+00006330: 2020 6665 6564 6261 636b 5f69 643d 7b22    feedback_id={"
+00006340: 4122 3a20 3130 307d 2c0a 2020 2020 2020  A": 100},.      
+00006350: 2020 7469 6d65 7374 616d 703d 7469 6d65    timestamp=time
+00006360: 7374 616d 702c 0a20 2020 2029 0a20 2020  stamp,.    ).   
+00006370: 2061 7373 6572 7420 2249 6e74 6572 6e61   assert "Interna
+00006380: 6c20 6578 6365 7074 696f 6e20 696e 2047  l exception in G
+00006390: 616e 7472 7920 636c 6965 6e74 2220 696e  antry client" in
+000063a0: 2063 6170 6c6f 672e 7465 7874 0a20 2020   caplog.text.   
+000063b0: 2061 7373 6572 7420 2254 7970 6545 7272   assert "TypeErr
+000063c0: 6f72 3a22 2069 6e20 6361 706c 6f67 2e74  or:" in caplog.t
+000063d0: 6578 740a 0a0a 4070 7974 6573 742e 6d61  ext...@pytest.ma
+000063e0: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
+000063f0: 2020 2020 5b22 7361 6d70 6c65 5f72 6174      ["sample_rat
+00006400: 6522 2c20 2273 616d 706c 6522 2c20 2265  e", "sample", "e
+00006410: 7870 6563 7465 6422 5d2c 0a20 2020 205b  xpected"],.    [
+00006420: 0a20 2020 2020 2020 2028 312c 2030 2e39  .        (1, 0.9
+00006430: 2c20 3129 2c0a 2020 2020 2020 2020 2830  , 1),.        (0
+00006440: 2c20 302e 392c 2030 292c 0a20 2020 2020  , 0.9, 0),.     
+00006450: 2020 2028 302e 352c 2030 2e34 2c20 3129     (0.5, 0.4, 1)
+00006460: 2c0a 2020 2020 2020 2020 2830 2e35 2c20  ,.        (0.5, 
+00006470: 302e 352c 2031 292c 0a20 2020 2020 2020  0.5, 1),.       
+00006480: 2028 302e 352c 2030 2e35 312c 2030 292c   (0.5, 0.51, 0),
+00006490: 0a20 2020 205d 2c0a 290a 6465 6620 7465  .    ],.).def te
+000064a0: 7374 5f6c 6f67 5f72 6563 6f72 645f 7361  st_log_record_sa
+000064b0: 6d70 6c65 5f72 6174 6528 7361 6d70 6c65  mple_rate(sample
+000064c0: 5f72 6174 652c 2073 616d 706c 652c 2065  _rate, sample, e
+000064d0: 7870 6563 7465 642c 2063 6c69 5f6f 626a  xpected, cli_obj
+000064e0: 293a 0a20 2020 2077 6974 6820 6d6f 636b  ):.    with mock
+000064f0: 2e70 6174 6368 2822 7261 6e64 6f6d 2e72  .patch("random.r
+00006500: 616e 646f 6d22 2c20 7265 7475 726e 5f76  andom", return_v
+00006510: 616c 7565 3d73 616d 706c 6529 3a0a 2020  alue=sample):.  
+00006520: 2020 2020 2020 636c 695f 6f62 6a2e 6c6f        cli_obj.lo
+00006530: 675f 7265 636f 7264 280a 2020 2020 2020  g_record(.      
+00006540: 2020 2020 2020 6170 706c 6963 6174 696f        applicatio
+00006550: 6e3d 2266 6f6f 6261 7222 2c0a 2020 2020  n="foobar",.    
+00006560: 2020 2020 2020 2020 696e 7075 7473 3d7b          inputs={
+00006570: 2241 223a 2031 3030 7d2c 0a20 2020 2020  "A": 100},.     
+00006580: 2020 2020 2020 206f 7574 7075 7473 3d7b         outputs={
+00006590: 2242 223a 2031 3030 7d2c 0a20 2020 2020  "B": 100},.     
+000065a0: 2020 2020 2020 2073 616d 706c 655f 7261         sample_ra
+000065b0: 7465 3d73 616d 706c 655f 7261 7465 2c0a  te=sample_rate,.
+000065c0: 2020 2020 2020 2020 290a 0a20 2020 2061          )..    a
+000065d0: 7373 6572 7420 6c65 6e28 636c 695f 6f62  ssert len(cli_ob
+000065e0: 6a2e 6c6f 675f 7374 6f72 652e 6c6f 6773  j.log_store.logs
+000065f0: 2920 3d3d 2065 7870 6563 7465 640a 0a0a  ) == expected...
+00006600: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
+00006610: 616d 6574 7269 7a65 280a 2020 2020 5b22  ametrize(.    ["
+00006620: 7361 6d70 6c65 5f72 6174 6522 2c20 2273  sample_rate", "s
+00006630: 616d 706c 6522 2c20 2265 7870 6563 7465  ample", "expecte
+00006640: 6422 5d2c 0a20 2020 205b 0a20 2020 2020  d"],.    [.     
+00006650: 2020 2028 312c 2030 2e39 2c20 3129 2c0a     (1, 0.9, 1),.
+00006660: 2020 2020 2020 2020 2830 2c20 302e 392c          (0, 0.9,
+00006670: 2030 292c 0a20 2020 2020 2020 2028 302e   0),.        (0.
+00006680: 352c 2030 2e34 2c20 3129 2c0a 2020 2020  5, 0.4, 1),.    
+00006690: 2020 2020 2830 2e35 2c20 302e 352c 2031      (0.5, 0.5, 1
+000066a0: 292c 0a20 2020 2020 2020 2028 302e 352c  ),.        (0.5,
+000066b0: 2030 2e35 312c 2030 292c 0a20 2020 205d   0.51, 0),.    ]
+000066c0: 2c0a 290a 6465 6620 7465 7374 5f73 696e  ,.).def test_sin
+000066d0: 676c 655f 6c6f 675f 7265 636f 7264 5f73  gle_log_record_s
+000066e0: 616d 706c 655f 7261 7465 2873 616d 706c  ample_rate(sampl
+000066f0: 655f 7261 7465 2c20 7361 6d70 6c65 2c20  e_rate, sample, 
+00006700: 6578 7065 6374 6564 2c20 636c 695f 6f62  expected, cli_ob
+00006710: 6a29 3a0a 2020 2020 7769 7468 206d 6f63  j):.    with moc
+00006720: 6b2e 7061 7463 6828 2272 616e 646f 6d2e  k.patch("random.
+00006730: 7261 6e64 6f6d 222c 2072 6574 7572 6e5f  random", return_
+00006740: 7661 6c75 653d 7361 6d70 6c65 293a 0a20  value=sample):. 
+00006750: 2020 2020 2020 2063 6c69 5f6f 626a 2e73         cli_obj.s
+00006760: 696e 676c 655f 6c6f 675f 7265 636f 7264  ingle_log_record
+00006770: 280a 2020 2020 2020 2020 2020 2020 6170  (.            ap
+00006780: 706c 6963 6174 696f 6e3d 2266 6f6f 6261  plication="fooba
+00006790: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
+000067a0: 696e 7075 7473 3d7b 2241 223a 2031 3030  inputs={"A": 100
+000067b0: 7d2c 0a20 2020 2020 2020 2020 2020 206f  },.            o
+000067c0: 7574 7075 7473 3d7b 2242 223a 2031 3030  utputs={"B": 100
+000067d0: 7d2c 0a20 2020 2020 2020 2020 2020 2073  },.            s
+000067e0: 616d 706c 655f 7261 7465 3d73 616d 706c  ample_rate=sampl
+000067f0: 655f 7261 7465 2c0a 2020 2020 2020 2020  e_rate,.        
+00006800: 290a 0a20 2020 2061 7373 6572 7420 6c65  )..    assert le
+00006810: 6e28 636c 695f 6f62 6a2e 6c6f 675f 7374  n(cli_obj.log_st
+00006820: 6f72 652e 6c6f 6773 2920 3d3d 2065 7870  ore.logs) == exp
+00006830: 6563 7465 640a 0a0a 4066 7265 657a 655f  ected...@freeze_
+00006840: 7469 6d65 2843 5552 5245 4e54 5f54 494d  time(CURRENT_TIM
+00006850: 4529 0a40 7079 7465 7374 2e6d 6172 6b2e  E).@pytest.mark.
+00006860: 7061 7261 6d65 7472 697a 6528 2274 6167  parametrize("tag
+00006870: 7322 2c20 5b7b 2265 6e76 223a 2022 6f76  s", [{"env": "ov
+00006880: 6572 7772 6974 655f 656e 7622 7d2c 207b  erwrite_env"}, {
+00006890: 7d2c 204e 6f6e 655d 290a 4070 7974 6573  }, None]).@pytes
+000068a0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+000068b0: 7a65 2822 7469 6d65 7374 616d 7022 2c20  ze("timestamp", 
+000068c0: 5b4e 6f6e 652c 2053 4f4d 455f 5449 4d45  [None, SOME_TIME
+000068d0: 5d29 0a40 6d6f 636b 2e70 6174 6368 2822  ]).@mock.patch("
+000068e0: 6761 6e74 7279 2e6c 6f67 6765 722e 6576  gantry.logger.ev
+000068f0: 656e 745f 6275 696c 6465 722e 7575 6964  ent_builder.uuid
+00006900: 2e75 7569 6434 2229 0a64 6566 2074 6573  .uuid4").def tes
+00006910: 745f 6c6f 675f 7072 6564 6963 7469 6f6e  t_log_prediction
+00006920: 5f61 6e64 5f66 6565 6462 6163 6b5f 6576  _and_feedback_ev
+00006930: 656e 7428 6d6f 636b 5f75 7569 642c 2074  ent(mock_uuid, t
+00006940: 696d 6573 7461 6d70 2c20 7461 6773 2c20  imestamp, tags, 
+00006950: 636c 695f 6f62 6a29 3a0a 2020 2020 6d6f  cli_obj):.    mo
+00006960: 636b 5f75 7569 642e 7265 7475 726e 5f76  ck_uuid.return_v
+00006970: 616c 7565 203d 2022 3132 3334 3522 0a20  alue = "12345". 
+00006980: 2020 2061 7373 6572 7420 280a 2020 2020     assert (.    
+00006990: 2020 2020 636c 695f 6f62 6a2e 5f6c 6f67      cli_obj._log
+000069a0: 5f70 7265 6469 6374 696f 6e5f 616e 645f  _prediction_and_
+000069b0: 6665 6564 6261 636b 5f65 7665 6e74 280a  feedback_event(.
+000069c0: 2020 2020 2020 2020 2020 2020 6170 706c              appl
+000069d0: 6963 6174 696f 6e3d 2266 6f6f 6261 7222  ication="foobar"
+000069e0: 2c0a 2020 2020 2020 2020 2020 2020 7665  ,.            ve
+000069f0: 7273 696f 6e3d 2261 2e62 2e63 222c 0a20  rsion="a.b.c",. 
+00006a00: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+00006a10: 733d 7b22 4122 3a20 3130 307d 2c0a 2020  s={"A": 100},.  
+00006a20: 2020 2020 2020 2020 2020 6f75 7470 7574            output
+00006a30: 733d 7b22 7661 6c75 6522 3a20 2262 6172  s={"value": "bar
+00006a40: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
+00006a50: 6665 6564 6261 636b 3d7b 2276 616c 7565  feedback={"value
+00006a60: 223a 2022 706f 7461 746f 227d 2c0a 2020  ": "potato"},.  
+00006a70: 2020 2020 2020 2020 2020 6a6f 696e 5f6b            join_k
+00006a80: 6579 3d22 3132 3334 3536 3738 3930 222c  ey="1234567890",
+00006a90: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
+00006aa0: 6573 7461 6d70 3d74 696d 6573 7461 6d70  estamp=timestamp
+00006ab0: 2c0a 2020 2020 2020 2020 2020 2020 7461  ,.            ta
+00006ac0: 6773 3d74 6167 732c 0a20 2020 2020 2020  gs=tags,.       
+00006ad0: 2029 0a20 2020 2020 2020 203d 3d20 2231   ).        == "1
+00006ae0: 3233 3435 3637 3839 3022 0a20 2020 2029  234567890".    )
+00006af0: 0a0a 2020 2020 6173 7365 7274 2063 6c69  ..    assert cli
+00006b00: 5f6f 626a 2e6c 6f67 5f73 746f 7265 2e6c  _obj.log_store.l
+00006b10: 6f67 7320 3d3d 205b 0a20 2020 2020 2020  ogs == [.       
+00006b20: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00006b30: 6576 656e 7473 223a 205b 0a20 2020 2020  events": [.     
+00006b40: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+00006b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006b60: 2022 6261 7463 685f 6964 223a 204e 6f6e   "batch_id": Non
+00006b70: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00006b80: 2020 2020 2020 2022 6576 656e 745f 6964         "event_id
+00006b90: 223a 2022 3132 3334 3522 2c0a 2020 2020  ": "12345",.    
+00006ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006bb0: 2266 6565 6462 6163 6b22 3a20 7b22 7661  "feedback": {"va
+00006bc0: 6c75 6522 3a20 2270 6f74 6174 6f22 7d2c  lue": "potato"},
+00006bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006be0: 2020 2020 2022 696e 7075 7473 223a 207b       "inputs": {
+00006bf0: 2241 223a 2031 3030 7d2c 0a20 2020 2020  "A": 100},.     
+00006c00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00006c10: 6f75 7470 7574 7322 3a20 7b22 7661 6c75  outputs": {"valu
+00006c20: 6522 3a20 2262 6172 227d 2c0a 2020 2020  e": "bar"},.    
+00006c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c40: 2274 6167 7322 3a20 7461 6773 2069 6620  "tags": tags if 
+00006c50: 7461 6773 2069 7320 6e6f 7420 4e6f 6e65  tags is not None
+00006c60: 2065 6c73 6520 4e6f 6e65 2c0a 2020 2020   else None,.    
+00006c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c80: 2266 6565 6462 6163 6b5f 6964 223a 2022  "feedback_id": "
+00006c90: 3132 3334 3536 3738 3930 222c 0a20 2020  1234567890",.   
+00006ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006cb0: 2022 6c6f 675f 7469 6d65 7374 616d 7022   "log_timestamp"
+00006cc0: 3a20 4355 5252 454e 545f 5449 4d45 5f53  : CURRENT_TIME_S
+00006cd0: 5452 2c0a 2020 2020 2020 2020 2020 2020  TR,.            
+00006ce0: 2020 2020 2020 2020 226d 6574 6164 6174          "metadat
+00006cf0: 6122 3a20 7b0a 2020 2020 2020 2020 2020  a": {.          
+00006d00: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+00006d10: 6565 6462 6163 6b5f 7665 7273 696f 6e22  eedback_version"
+00006d20: 3a20 2261 2e62 2e63 222c 0a20 2020 2020  : "a.b.c",.     
+00006d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006d40: 2020 2022 6675 6e63 5f6e 616d 6522 3a20     "func_name": 
+00006d50: 2266 6f6f 6261 7222 2c0a 2020 2020 2020  "foobar",.      
+00006d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006d70: 2020 2276 6572 7369 6f6e 223a 2022 612e    "version": "a.
+00006d80: 622e 6322 2c0a 2020 2020 2020 2020 2020  b.c",.          
+00006d90: 2020 2020 2020 2020 2020 2020 2020 2269                "i
+00006da0: 676e 6f72 655f 696e 7075 7473 223a 204e  gnore_inputs": N
+00006db0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+00006dc0: 2020 2020 2020 2020 2020 2020 2022 6665               "fe
+00006dd0: 6564 6261 636b 5f6b 6579 7322 3a20 4e6f  edback_keys": No
+00006de0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+00006df0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+00006e00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00006e10: 7469 6d65 7374 616d 7022 3a20 534f 4d45  timestamp": SOME
+00006e20: 5f54 494d 455f 5354 5220 6966 2074 696d  _TIME_STR if tim
+00006e30: 6573 7461 6d70 2065 6c73 6520 4355 5252  estamp else CURR
+00006e40: 454e 545f 5449 4d45 5f53 5452 2c0a 2020  ENT_TIME_STR,.  
+00006e50: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
+00006e60: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
+00006e70: 2020 2020 2020 2020 2020 2022 6170 706c             "appl
+00006e80: 6963 6174 696f 6e22 3a20 2266 6f6f 6261  ication": "fooba
+00006e90: 7222 2c0a 2020 2020 2020 2020 7d2c 0a20  r",.        },. 
+00006ea0: 2020 205d 0a0a 0a40 7079 7465 7374 2e6d     ]...@pytest.m
+00006eb0: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+00006ec0: 0a20 2020 205b 226b 7761 7267 7322 2c20  .    ["kwargs", 
+00006ed0: 2265 7870 6563 7465 645f 636f 6d70 6174  "expected_compat
+00006ee0: 5f63 616c 6c22 5d2c 0a20 2020 205b 0a20  _call"],.    [. 
+00006ef0: 2020 2020 2020 2028 7b22 6665 6564 6261         ({"feedba
+00006f00: 636b 5f6b 6579 7322 3a20 5b22 4122 5d7d  ck_keys": ["A"]}
+00006f10: 2c20 5b7b 2241 223a 2031 3030 7d2c 204e  , [{"A": 100}, N
+00006f20: 6f6e 652c 205b 2241 225d 2c20 4e6f 6e65  one, ["A"], None
+00006f30: 5d29 2c0a 2020 2020 2020 2020 287b 2266  ]),.        ({"f
+00006f40: 6565 6462 6163 6b5f 6964 223a 2022 3132  eedback_id": "12
+00006f50: 3334 3522 7d2c 205b 7b22 4122 3a20 3130  345"}, [{"A": 10
+00006f60: 307d 2c20 2231 3233 3435 222c 204e 6f6e  0}, "12345", Non
+00006f70: 652c 204e 6f6e 655d 292c 0a20 2020 2020  e, None]),.     
+00006f80: 2020 2028 7b22 6a6f 696e 5f6b 6579 223a     ({"join_key":
+00006f90: 2022 3534 3332 3122 7d2c 205b 7b22 4122   "54321"}, [{"A"
+00006fa0: 3a20 3130 307d 2c20 4e6f 6e65 2c20 4e6f  : 100}, None, No
+00006fb0: 6e65 2c20 2235 3433 3231 225d 292c 0a20  ne, "54321"]),. 
+00006fc0: 2020 205d 2c0a 290a 406d 6f63 6b2e 7061     ],.).@mock.pa
+00006fd0: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
+00006fe0: 6572 2e63 6c69 656e 742e 5f72 6573 6f6c  er.client._resol
+00006ff0: 7665 5f6a 6f69 6e5f 6b65 7922 2c20 7265  ve_join_key", re
+00007000: 7475 726e 5f76 616c 7565 3d22 3132 3334  turn_value="1234
+00007010: 3536 3738 3930 2229 0a40 6d6f 636b 2e70  567890").@mock.p
+00007020: 6174 6368 280a 2020 2020 2267 616e 7472  atch(.    "gantr
+00007030: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
+00007040: 4761 6e74 7279 2e5f 6c6f 675f 7072 6564  Gantry._log_pred
+00007050: 6963 7469 6f6e 5f61 6e64 5f66 6565 6462  iction_and_feedb
+00007060: 6163 6b5f 6576 656e 7422 2c20 7265 7475  ack_event", retu
+00007070: 726e 5f76 616c 7565 3d22 666f 6f62 6172  rn_value="foobar
+00007080: 3132 3334 3522 0a29 0a40 6d6f 636b 2e70  12345".).@mock.p
+00007090: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
+000070a0: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
+000070b0: 792e 5f6c 6f67 5f70 7265 6469 6374 696f  y._log_predictio
+000070c0: 6e5f 6576 656e 7422 290a 406d 6f63 6b2e  n_event").@mock.
+000070d0: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
+000070e0: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
+000070f0: 7279 2e5f 6c6f 675f 6665 6564 6261 636b  ry._log_feedback
+00007100: 5f65 7665 6e74 2229 0a64 6566 2074 6573  _event").def tes
+00007110: 745f 6c6f 675f 7265 636f 7264 5f70 7265  t_log_record_pre
+00007120: 645f 616e 645f 6665 6564 6261 636b 280a  d_and_feedback(.
+00007130: 2020 2020 6d6f 636b 5f66 6565 6462 6163      mock_feedbac
+00007140: 6b2c 0a20 2020 206d 6f63 6b5f 7072 6564  k,.    mock_pred
+00007150: 2c0a 2020 2020 6d6f 636b 5f70 7265 645f  ,.    mock_pred_
+00007160: 616e 645f 6665 6564 6261 636b 2c0a 2020  and_feedback,.  
+00007170: 2020 6d6f 636b 5f67 6574 5f72 6563 6f72    mock_get_recor
+00007180: 642c 0a20 2020 206b 7761 7267 732c 0a20  d,.    kwargs,. 
+00007190: 2020 2065 7870 6563 7465 645f 636f 6d70     expected_comp
+000071a0: 6174 5f63 616c 6c2c 0a20 2020 2063 6c69  at_call,.    cli
+000071b0: 5f6f 626a 2c0a 293a 0a20 2020 2061 7373  _obj,.):.    ass
+000071c0: 6572 7420 280a 2020 2020 2020 2020 636c  ert (.        cl
+000071d0: 695f 6f62 6a2e 6c6f 675f 7265 636f 7264  i_obj.log_record
+000071e0: 280a 2020 2020 2020 2020 2020 2020 6170  (.            ap
+000071f0: 706c 6963 6174 696f 6e3d 2266 6f6f 6261  plication="fooba
+00007200: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
+00007210: 7665 7273 696f 6e3d 2232 2e30 2e31 222c  version="2.0.1",
+00007220: 0a20 2020 2020 2020 2020 2020 2069 6e70  .            inp
+00007230: 7574 733d 7b22 4122 3a20 3130 307d 2c0a  uts={"A": 100},.
+00007240: 2020 2020 2020 2020 2020 2020 6f75 7470              outp
+00007250: 7574 733d 7b22 4222 3a20 3330 307d 2c0a  uts={"B": 300},.
+00007260: 2020 2020 2020 2020 2020 2020 6665 6564              feed
+00007270: 6261 636b 3d7b 2241 223a 2032 3030 7d2c  back={"A": 200},
+00007280: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
+00007290: 6573 7461 6d70 3d4e 6f6e 652c 0a20 2020  estamp=None,.   
+000072a0: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
+000072b0: 732c 0a20 2020 2020 2020 2029 0a20 2020  s,.        ).   
+000072c0: 2020 2020 203d 3d20 2266 6f6f 6261 7231       == "foobar1
+000072d0: 3233 3435 220a 2020 2020 290a 0a20 2020  2345".    )..   
+000072e0: 206d 6f63 6b5f 7072 6564 5f61 6e64 5f66   mock_pred_and_f
+000072f0: 6565 6462 6163 6b2e 6173 7365 7274 5f63  eedback.assert_c
+00007300: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
+00007310: 0a20 2020 2020 2020 2061 7070 6c69 6361  .        applica
+00007320: 7469 6f6e 3d22 666f 6f62 6172 222c 0a20  tion="foobar",. 
+00007330: 2020 2020 2020 2076 6572 7369 6f6e 3d22         version="
+00007340: 322e 302e 3122 2c0a 2020 2020 2020 2020  2.0.1",.        
+00007350: 696e 7075 7473 3d7b 2241 223a 2031 3030  inputs={"A": 100
+00007360: 7d2c 0a20 2020 2020 2020 206f 7574 7075  },.        outpu
+00007370: 7473 3d7b 2242 223a 2033 3030 7d2c 0a20  ts={"B": 300},. 
+00007380: 2020 2020 2020 2066 6565 6462 6163 6b3d         feedback=
+00007390: 7b22 4122 3a20 3230 307d 2c0a 2020 2020  {"A": 200},.    
+000073a0: 2020 2020 6a6f 696e 5f6b 6579 3d22 3132      join_key="12
+000073b0: 3334 3536 3738 3930 222c 0a20 2020 2020  34567890",.     
+000073c0: 2020 2069 676e 6f72 655f 696e 7075 7473     ignore_inputs
+000073d0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2074  =None,.        t
+000073e0: 696d 6573 7461 6d70 3d4e 6f6e 652c 0a20  imestamp=None,. 
+000073f0: 2020 2020 2020 2074 6167 733d 7b22 656e         tags={"en
+00007400: 7622 3a20 2274 6573 7422 7d2c 0a20 2020  v": "test"},.   
+00007410: 2029 0a20 2020 206d 6f63 6b5f 7072 6564   ).    mock_pred
+00007420: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
+00007430: 6564 2829 0a20 2020 206d 6f63 6b5f 6665  ed().    mock_fe
+00007440: 6564 6261 636b 2e61 7373 6572 745f 6e6f  edback.assert_no
+00007450: 745f 6361 6c6c 6564 2829 0a0a 2020 2020  t_called()..    
+00007460: 6d6f 636b 5f67 6574 5f72 6563 6f72 642e  mock_get_record.
+00007470: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
+00007480: 6365 5f77 6974 6828 2a65 7870 6563 7465  ce_with(*expecte
+00007490: 645f 636f 6d70 6174 5f63 616c 6c29 0a0a  d_compat_call)..
+000074a0: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
+000074b0: 7261 6d65 7472 697a 6528 0a20 2020 205b  rametrize(.    [
+000074c0: 226b 7761 7267 7322 2c20 2265 7870 6563  "kwargs", "expec
+000074d0: 7465 645f 636f 6d70 6174 5f63 616c 6c22  ted_compat_call"
+000074e0: 5d2c 0a20 2020 205b 0a20 2020 2020 2020  ],.    [.       
+000074f0: 2028 7b22 6a6f 696e 5f6b 6579 7322 3a20   ({"join_keys": 
+00007500: 2235 3433 3231 227d 2c20 5b7b 2241 223a  "54321"}, [{"A":
+00007510: 2031 3030 7d2c 204e 6f6e 652c 204e 6f6e   100}, None, Non
+00007520: 652c 2022 3534 3332 3122 5d29 2c0a 2020  e, "54321"]),.  
+00007530: 2020 5d2c 0a29 0a40 6d6f 636b 2e70 6174    ],.).@mock.pat
+00007540: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
+00007550: 722e 636c 6965 6e74 2e5f 7265 736f 6c76  r.client._resolv
+00007560: 655f 6a6f 696e 5f6b 6579 222c 2072 6574  e_join_key", ret
+00007570: 7572 6e5f 7661 6c75 653d 2231 3233 3435  urn_value="12345
+00007580: 3637 3839 3022 290a 406d 6f63 6b2e 7061  67890").@mock.pa
+00007590: 7463 6828 0a20 2020 2022 6761 6e74 7279  tch(.    "gantry
+000075a0: 2e6c 6f67 6765 722e 636c 6965 6e74 2e47  .logger.client.G
+000075b0: 616e 7472 792e 5f6c 6f67 5f70 7265 6469  antry._log_predi
+000075c0: 6374 696f 6e5f 616e 645f 6665 6564 6261  ction_and_feedba
+000075d0: 636b 5f65 7665 6e74 222c 2072 6574 7572  ck_event", retur
+000075e0: 6e5f 7661 6c75 653d 2266 6f6f 6261 7231  n_value="foobar1
+000075f0: 3233 3435 220a 290a 406d 6f63 6b2e 7061  2345".).@mock.pa
+00007600: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
+00007610: 6572 2e63 6c69 656e 742e 4761 6e74 7279  er.client.Gantry
+00007620: 2e5f 6c6f 675f 7072 6564 6963 7469 6f6e  ._log_prediction
+00007630: 5f65 7665 6e74 2229 0a40 6d6f 636b 2e70  _event").@mock.p
+00007640: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
+00007650: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
+00007660: 792e 5f6c 6f67 5f66 6565 6462 6163 6b5f  y._log_feedback_
+00007670: 6576 656e 7422 290a 6465 6620 7465 7374  event").def test
+00007680: 5f73 696e 676c 655f 6c6f 675f 7072 6564  _single_log_pred
+00007690: 5f61 6e64 5f66 6565 6462 6163 6b28 0a20  _and_feedback(. 
+000076a0: 2020 206d 6f63 6b5f 6665 6564 6261 636b     mock_feedback
+000076b0: 2c0a 2020 2020 6d6f 636b 5f70 7265 642c  ,.    mock_pred,
+000076c0: 0a20 2020 206d 6f63 6b5f 7072 6564 5f61  .    mock_pred_a
+000076d0: 6e64 5f66 6565 6462 6163 6b2c 0a20 2020  nd_feedback,.   
+000076e0: 206d 6f63 6b5f 6765 745f 7265 636f 7264   mock_get_record
+000076f0: 2c0a 2020 2020 6b77 6172 6773 2c0a 2020  ,.    kwargs,.  
+00007700: 2020 6578 7065 6374 6564 5f63 6f6d 7061    expected_compa
+00007710: 745f 6361 6c6c 2c0a 2020 2020 636c 695f  t_call,.    cli_
+00007720: 6f62 6a2c 0a29 3a0a 2020 2020 6173 7365  obj,.):.    asse
+00007730: 7274 2028 0a20 2020 2020 2020 2063 6c69  rt (.        cli
+00007740: 5f6f 626a 2e6c 6f67 280a 2020 2020 2020  _obj.log(.      
+00007750: 2020 2020 2020 6170 706c 6963 6174 696f        applicatio
+00007760: 6e3d 2266 6f6f 6261 7222 2c0a 2020 2020  n="foobar",.    
+00007770: 2020 2020 2020 2020 7665 7273 696f 6e3d          version=
+00007780: 2232 2e30 2e31 222c 0a20 2020 2020 2020  "2.0.1",.       
+00007790: 2020 2020 2069 6e70 7574 733d 7b22 4122       inputs={"A"
+000077a0: 3a20 3130 307d 2c0a 2020 2020 2020 2020  : 100},.        
+000077b0: 2020 2020 6f75 7470 7574 733d 7b22 4222      outputs={"B"
+000077c0: 3a20 3330 307d 2c0a 2020 2020 2020 2020  : 300},.        
+000077d0: 2020 2020 6665 6564 6261 636b 733d 7b22      feedbacks={"
+000077e0: 4122 3a20 3230 307d 2c0a 2020 2020 2020  A": 200},.      
+000077f0: 2020 2020 2020 7469 6d65 7374 616d 7073        timestamps
+00007800: 3d4e 6f6e 652c 0a20 2020 2020 2020 2020  =None,.         
+00007810: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
+00007820: 2020 2020 2029 0a20 2020 2020 2020 203d       ).        =
+00007830: 3d20 2266 6f6f 6261 7231 3233 3435 220a  = "foobar12345".
+00007840: 2020 2020 290a 0a20 2020 206d 6f63 6b5f      )..    mock_
+00007850: 7072 6564 5f61 6e64 5f66 6565 6462 6163  pred_and_feedbac
+00007860: 6b2e 6173 7365 7274 5f63 616c 6c65 645f  k.assert_called_
+00007870: 6f6e 6365 5f77 6974 6828 0a20 2020 2020  once_with(.     
+00007880: 2020 2061 7070 6c69 6361 7469 6f6e 3d22     application="
+00007890: 666f 6f62 6172 222c 0a20 2020 2020 2020  foobar",.       
+000078a0: 2076 6572 7369 6f6e 3d22 322e 302e 3122   version="2.0.1"
+000078b0: 2c0a 2020 2020 2020 2020 696e 7075 7473  ,.        inputs
+000078c0: 3d7b 2241 223a 2031 3030 7d2c 0a20 2020  ={"A": 100},.   
+000078d0: 2020 2020 206f 7574 7075 7473 3d7b 2242       outputs={"B
+000078e0: 223a 2033 3030 7d2c 0a20 2020 2020 2020  ": 300},.       
+000078f0: 2066 6565 6462 6163 6b3d 7b22 4122 3a20   feedback={"A": 
+00007900: 3230 307d 2c0a 2020 2020 2020 2020 6a6f  200},.        jo
+00007910: 696e 5f6b 6579 3d22 3132 3334 3536 3738  in_key="12345678
+00007920: 3930 222c 0a20 2020 2020 2020 2069 676e  90",.        ign
+00007930: 6f72 655f 696e 7075 7473 3d4e 6f6e 652c  ore_inputs=None,
+00007940: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
+00007950: 6d70 3d4e 6f6e 652c 0a20 2020 2020 2020  mp=None,.       
+00007960: 2074 6167 733d 7b22 656e 7622 3a20 2274   tags={"env": "t
+00007970: 6573 7422 7d2c 0a20 2020 2029 0a20 2020  est"},.    ).   
+00007980: 206d 6f63 6b5f 7072 6564 2e61 7373 6572   mock_pred.asser
+00007990: 745f 6e6f 745f 6361 6c6c 6564 2829 0a20  t_not_called(). 
+000079a0: 2020 206d 6f63 6b5f 6665 6564 6261 636b     mock_feedback
+000079b0: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
+000079c0: 6564 2829 0a0a 2020 2020 6d6f 636b 5f67  ed()..    mock_g
+000079d0: 6574 5f72 6563 6f72 642e 6173 7365 7274  et_record.assert
+000079e0: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+000079f0: 6828 2a65 7870 6563 7465 645f 636f 6d70  h(*expected_comp
+00007a00: 6174 5f63 616c 6c29 0a0a 0a40 7079 7465  at_call)...@pyte
+00007a10: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
+00007a20: 697a 6528 0a20 2020 205b 226b 7761 7267  ize(.    ["kwarg
+00007a30: 7322 2c20 2265 7870 6563 7465 645f 636f  s", "expected_co
+00007a40: 6d70 6174 5f63 616c 6c22 5d2c 0a20 2020  mpat_call"],.   
+00007a50: 205b 0a20 2020 2020 2020 2028 7b22 6665   [.        ({"fe
+00007a60: 6564 6261 636b 5f6b 6579 7322 3a20 5b22  edback_keys": ["
+00007a70: 4122 5d7d 2c20 5b7b 2241 223a 2031 3030  A"]}, [{"A": 100
+00007a80: 7d2c 204e 6f6e 652c 205b 2241 225d 2c20  }, None, ["A"], 
+00007a90: 4e6f 6e65 5d29 2c0a 2020 2020 2020 2020  None]),.        
+00007aa0: 287b 2266 6565 6462 6163 6b5f 6964 223a  ({"feedback_id":
+00007ab0: 2022 3132 3334 3522 7d2c 205b 7b22 4122   "12345"}, [{"A"
+00007ac0: 3a20 3130 307d 2c20 2231 3233 3435 222c  : 100}, "12345",
+00007ad0: 204e 6f6e 652c 204e 6f6e 655d 292c 0a20   None, None]),. 
+00007ae0: 2020 2020 2020 2028 7b22 6a6f 696e 5f6b         ({"join_k
+00007af0: 6579 223a 2022 3534 3332 3122 7d2c 205b  ey": "54321"}, [
+00007b00: 7b22 4122 3a20 3130 307d 2c20 4e6f 6e65  {"A": 100}, None
+00007b10: 2c20 4e6f 6e65 2c20 2235 3433 3231 225d  , None, "54321"]
+00007b20: 292c 0a20 2020 205d 2c0a 290a 406d 6f63  ),.    ],.).@moc
+00007b30: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
+00007b40: 6c6f 6767 6572 2e63 6c69 656e 742e 5f72  logger.client._r
+00007b50: 6573 6f6c 7665 5f6a 6f69 6e5f 6b65 7922  esolve_join_key"
+00007b60: 2c20 7265 7475 726e 5f76 616c 7565 3d22  , return_value="
+00007b70: 3132 3334 3536 3738 3930 2229 0a40 6d6f  1234567890").@mo
+00007b80: 636b 2e70 6174 6368 280a 2020 2020 2267  ck.patch(.    "g
+00007b90: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
+00007ba0: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
+00007bb0: 7072 6564 6963 7469 6f6e 5f61 6e64 5f66  prediction_and_f
+00007bc0: 6565 6462 6163 6b5f 6576 656e 7422 2c20  eedback_event", 
+00007bd0: 7265 7475 726e 5f76 616c 7565 3d22 666f  return_value="fo
+00007be0: 6f62 6172 3132 3334 3522 0a29 0a40 6d6f  obar12345".).@mo
+00007bf0: 636b 2e70 6174 6368 2822 6761 6e74 7279  ck.patch("gantry
+00007c00: 2e6c 6f67 6765 722e 636c 6965 6e74 2e47  .logger.client.G
+00007c10: 616e 7472 792e 5f6c 6f67 5f70 7265 6469  antry._log_predi
+00007c20: 6374 696f 6e5f 6576 656e 7422 290a 406d  ction_event").@m
+00007c30: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
+00007c40: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
+00007c50: 4761 6e74 7279 2e5f 6c6f 675f 6665 6564  Gantry._log_feed
+00007c60: 6261 636b 5f65 7665 6e74 2229 0a64 6566  back_event").def
+00007c70: 2074 6573 745f 7369 6e67 6c65 5f6c 6f67   test_single_log
+00007c80: 5f72 6563 6f72 645f 7072 6564 5f61 6e64  _record_pred_and
+00007c90: 5f66 6565 6462 6163 6b28 0a20 2020 206d  _feedback(.    m
+00007ca0: 6f63 6b5f 6665 6564 6261 636b 2c0a 2020  ock_feedback,.  
+00007cb0: 2020 6d6f 636b 5f70 7265 642c 0a20 2020    mock_pred,.   
+00007cc0: 206d 6f63 6b5f 7072 6564 5f61 6e64 5f66   mock_pred_and_f
+00007cd0: 6565 6462 6163 6b2c 0a20 2020 206d 6f63  eedback,.    moc
+00007ce0: 6b5f 6765 745f 7265 636f 7264 2c0a 2020  k_get_record,.  
+00007cf0: 2020 6b77 6172 6773 2c0a 2020 2020 6578    kwargs,.    ex
+00007d00: 7065 6374 6564 5f63 6f6d 7061 745f 6361  pected_compat_ca
+00007d10: 6c6c 2c0a 2020 2020 636c 695f 6f62 6a2c  ll,.    cli_obj,
+00007d20: 0a29 3a0a 2020 2020 6173 7365 7274 2028  .):.    assert (
+00007d30: 0a20 2020 2020 2020 2063 6c69 5f6f 626a  .        cli_obj
+00007d40: 2e73 696e 676c 655f 6c6f 675f 7265 636f  .single_log_reco
+00007d50: 7264 280a 2020 2020 2020 2020 2020 2020  rd(.            
+00007d60: 6170 706c 6963 6174 696f 6e3d 2266 6f6f  application="foo
+00007d70: 6261 7222 2c0a 2020 2020 2020 2020 2020  bar",.          
+00007d80: 2020 7665 7273 696f 6e3d 2232 2e30 2e31    version="2.0.1
+00007d90: 222c 0a20 2020 2020 2020 2020 2020 2069  ",.            i
+00007da0: 6e70 7574 733d 7b22 4122 3a20 3130 307d  nputs={"A": 100}
+00007db0: 2c0a 2020 2020 2020 2020 2020 2020 6f75  ,.            ou
+00007dc0: 7470 7574 733d 7b22 4222 3a20 3330 307d  tputs={"B": 300}
+00007dd0: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
+00007de0: 6564 6261 636b 3d7b 2241 223a 2032 3030  edback={"A": 200
+00007df0: 7d2c 0a20 2020 2020 2020 2020 2020 2074  },.            t
+00007e00: 696d 6573 7461 6d70 3d4e 6f6e 652c 0a20  imestamp=None,. 
+00007e10: 2020 2020 2020 2020 2020 202a 2a6b 7761             **kwa
+00007e20: 7267 732c 0a20 2020 2020 2020 2029 0a20  rgs,.        ). 
+00007e30: 2020 2020 2020 203d 3d20 2266 6f6f 6261         == "fooba
+00007e40: 7231 3233 3435 220a 2020 2020 290a 0a20  r12345".    ).. 
+00007e50: 2020 206d 6f63 6b5f 7072 6564 5f61 6e64     mock_pred_and
+00007e60: 5f66 6565 6462 6163 6b2e 6173 7365 7274  _feedback.assert
+00007e70: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+00007e80: 6828 0a20 2020 2020 2020 2061 7070 6c69  h(.        appli
+00007e90: 6361 7469 6f6e 3d22 666f 6f62 6172 222c  cation="foobar",
+00007ea0: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
+00007eb0: 3d22 322e 302e 3122 2c0a 2020 2020 2020  ="2.0.1",.      
+00007ec0: 2020 696e 7075 7473 3d7b 2241 223a 2031    inputs={"A": 1
+00007ed0: 3030 7d2c 0a20 2020 2020 2020 206f 7574  00},.        out
+00007ee0: 7075 7473 3d7b 2242 223a 2033 3030 7d2c  puts={"B": 300},
+00007ef0: 0a20 2020 2020 2020 2066 6565 6462 6163  .        feedbac
+00007f00: 6b3d 7b22 4122 3a20 3230 307d 2c0a 2020  k={"A": 200},.  
+00007f10: 2020 2020 2020 6a6f 696e 5f6b 6579 3d22        join_key="
+00007f20: 3132 3334 3536 3738 3930 222c 0a20 2020  1234567890",.   
+00007f30: 2020 2020 2069 676e 6f72 655f 696e 7075       ignore_inpu
+00007f40: 7473 3d4e 6f6e 652c 0a20 2020 2020 2020  ts=None,.       
+00007f50: 2074 696d 6573 7461 6d70 3d4e 6f6e 652c   timestamp=None,
+00007f60: 0a20 2020 2020 2020 2074 6167 733d 7b22  .        tags={"
+00007f70: 656e 7622 3a20 2274 6573 7422 7d2c 0a20  env": "test"},. 
+00007f80: 2020 2029 0a20 2020 206d 6f63 6b5f 7072     ).    mock_pr
+00007f90: 6564 2e61 7373 6572 745f 6e6f 745f 6361  ed.assert_not_ca
+00007fa0: 6c6c 6564 2829 0a20 2020 206d 6f63 6b5f  lled().    mock_
+00007fb0: 6665 6564 6261 636b 2e61 7373 6572 745f  feedback.assert_
+00007fc0: 6e6f 745f 6361 6c6c 6564 2829 0a0a 2020  not_called()..  
+00007fd0: 2020 6d6f 636b 5f67 6574 5f72 6563 6f72    mock_get_recor
+00007fe0: 642e 6173 7365 7274 5f63 616c 6c65 645f  d.assert_called_
+00007ff0: 6f6e 6365 5f77 6974 6828 2a65 7870 6563  once_with(*expec
+00008000: 7465 645f 636f 6d70 6174 5f63 616c 6c29  ted_compat_call)
+00008010: 0a0a 0a40 7079 7465 7374 2e6d 6172 6b2e  ...@pytest.mark.
+00008020: 7061 7261 6d65 7472 697a 6528 0a20 2020  parametrize(.   
+00008030: 205b 226b 7761 7267 7322 2c20 2265 7870   ["kwargs", "exp
+00008040: 6563 7465 645f 636f 6d70 6174 5f63 616c  ected_compat_cal
+00008050: 6c22 5d2c 0a20 2020 205b 0a20 2020 2020  l"],.    [.     
+00008060: 2020 2028 7b22 6665 6564 6261 636b 5f6b     ({"feedback_k
+00008070: 6579 7322 3a20 5b22 4122 5d7d 2c20 5b7b  eys": ["A"]}, [{
+00008080: 2241 223a 2031 3030 7d2c 204e 6f6e 652c  "A": 100}, None,
+00008090: 205b 2241 225d 2c20 4e6f 6e65 5d29 2c0a   ["A"], None]),.
+000080a0: 2020 2020 2020 2020 287b 2266 6565 6462          ({"feedb
+000080b0: 6163 6b5f 6964 223a 2022 3132 3334 3522  ack_id": "12345"
+000080c0: 7d2c 205b 7b22 4122 3a20 3130 307d 2c20  }, [{"A": 100}, 
+000080d0: 2231 3233 3435 222c 204e 6f6e 652c 204e  "12345", None, N
+000080e0: 6f6e 655d 292c 0a20 2020 2020 2020 2028  one]),.        (
+000080f0: 7b22 6a6f 696e 5f6b 6579 223a 2022 3534  {"join_key": "54
+00008100: 3332 3122 7d2c 205b 7b22 4122 3a20 3130  321"}, [{"A": 10
+00008110: 307d 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20  0}, None, None, 
+00008120: 2235 3433 3231 225d 292c 0a20 2020 205d  "54321"]),.    ]
+00008130: 2c0a 290a 4070 7974 6573 742e 6d61 726b  ,.).@pytest.mark
+00008140: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
+00008150: 2020 2274 6573 745f 6665 6564 6261 636b    "test_feedback
+00008160: 222c 0a20 2020 205b 4e6f 6e65 2c20 7b7d  ",.    [None, {}
+00008170: 5d2c 0a29 0a40 6d6f 636b 2e70 6174 6368  ],.).@mock.patch
+00008180: 2822 6761 6e74 7279 2e6c 6f67 6765 722e  ("gantry.logger.
+00008190: 636c 6965 6e74 2e5f 7265 736f 6c76 655f  client._resolve_
+000081a0: 6a6f 696e 5f6b 6579 222c 2072 6574 7572  join_key", retur
+000081b0: 6e5f 7661 6c75 653d 2231 3233 3435 3637  n_value="1234567
+000081c0: 3839 3022 290a 406d 6f63 6b2e 7061 7463  890").@mock.patc
+000081d0: 6828 2267 616e 7472 792e 6c6f 6767 6572  h("gantry.logger
+000081e0: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
+000081f0: 6c6f 675f 7072 6564 6963 7469 6f6e 5f61  log_prediction_a
+00008200: 6e64 5f66 6565 6462 6163 6b5f 6576 656e  nd_feedback_even
+00008210: 7422 290a 406d 6f63 6b2e 7061 7463 6828  t").@mock.patch(
+00008220: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
+00008230: 6c69 656e 742e 4761 6e74 7279 2e5f 6c6f  lient.Gantry._lo
+00008240: 675f 7072 6564 6963 7469 6f6e 5f65 7665  g_prediction_eve
+00008250: 6e74 222c 2072 6574 7572 6e5f 7661 6c75  nt", return_valu
+00008260: 653d 2266 6f6f 6261 7231 3233 3435 2229  e="foobar12345")
+00008270: 0a40 6d6f 636b 2e70 6174 6368 2822 6761  .@mock.patch("ga
+00008280: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
+00008290: 6e74 2e47 616e 7472 792e 5f6c 6f67 5f66  nt.Gantry._log_f
+000082a0: 6565 6462 6163 6b5f 6576 656e 7422 290a  eedback_event").
+000082b0: 6465 6620 7465 7374 5f6c 6f67 5f72 6563  def test_log_rec
+000082c0: 6f72 645f 7072 6564 5f6f 6e6c 7928 0a20  ord_pred_only(. 
+000082d0: 2020 206d 6f63 6b5f 6665 6564 6261 636b     mock_feedback
+000082e0: 2c0a 2020 2020 6d6f 636b 5f70 7265 642c  ,.    mock_pred,
+000082f0: 0a20 2020 206d 6f63 6b5f 7072 6564 5f61  .    mock_pred_a
+00008300: 6e64 5f66 6565 6462 6163 6b2c 0a20 2020  nd_feedback,.   
+00008310: 206d 6f63 6b5f 6765 745f 7265 636f 7264   mock_get_record
+00008320: 2c0a 2020 2020 7465 7374 5f66 6565 6462  ,.    test_feedb
+00008330: 6163 6b2c 0a20 2020 206b 7761 7267 732c  ack,.    kwargs,
+00008340: 0a20 2020 2065 7870 6563 7465 645f 636f  .    expected_co
+00008350: 6d70 6174 5f63 616c 6c2c 0a20 2020 2063  mpat_call,.    c
+00008360: 6c69 5f6f 626a 2c0a 293a 0a20 2020 2061  li_obj,.):.    a
+00008370: 7373 6572 7420 280a 2020 2020 2020 2020  ssert (.        
+00008380: 636c 695f 6f62 6a2e 6c6f 675f 7265 636f  cli_obj.log_reco
+00008390: 7264 280a 2020 2020 2020 2020 2020 2020  rd(.            
+000083a0: 6170 706c 6963 6174 696f 6e3d 2266 6f6f  application="foo
+000083b0: 6261 7222 2c0a 2020 2020 2020 2020 2020  bar",.          
+000083c0: 2020 7665 7273 696f 6e3d 2232 2e30 2e31    version="2.0.1
+000083d0: 222c 0a20 2020 2020 2020 2020 2020 2069  ",.            i
+000083e0: 6e70 7574 733d 7b22 4122 3a20 3130 307d  nputs={"A": 100}
+000083f0: 2c0a 2020 2020 2020 2020 2020 2020 6f75  ,.            ou
+00008400: 7470 7574 733d 7b22 4222 3a20 3330 307d  tputs={"B": 300}
+00008410: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
+00008420: 6564 6261 636b 3d74 6573 745f 6665 6564  edback=test_feed
+00008430: 6261 636b 2c0a 2020 2020 2020 2020 2020  back,.          
+00008440: 2020 7469 6d65 7374 616d 703d 4e6f 6e65    timestamp=None
+00008450: 2c0a 2020 2020 2020 2020 2020 2020 2a2a  ,.            **
+00008460: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+00008470: 290a 2020 2020 2020 2020 3d3d 2022 666f  ).        == "fo
+00008480: 6f62 6172 3132 3334 3522 0a20 2020 2029  obar12345".    )
+00008490: 0a0a 2020 2020 6d6f 636b 5f70 7265 645f  ..    mock_pred_
+000084a0: 616e 645f 6665 6564 6261 636b 2e61 7373  and_feedback.ass
+000084b0: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
+000084c0: 0a20 2020 206d 6f63 6b5f 7072 6564 2e61  .    mock_pred.a
+000084d0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+000084e0: 655f 7769 7468 280a 2020 2020 2020 2020  e_with(.        
+000084f0: 6170 706c 6963 6174 696f 6e3d 2266 6f6f  application="foo
+00008500: 6261 7222 2c0a 2020 2020 2020 2020 696e  bar",.        in
+00008510: 7075 7473 3d7b 2241 223a 2031 3030 7d2c  puts={"A": 100},
+00008520: 0a20 2020 2020 2020 206f 7574 7075 7473  .        outputs
+00008530: 3d7b 2242 223a 2033 3030 7d2c 0a20 2020  ={"B": 300},.   
+00008540: 2020 2020 2076 6572 7369 6f6e 3d22 322e       version="2.
+00008550: 302e 3122 2c0a 2020 2020 2020 2020 6a6f  0.1",.        jo
+00008560: 696e 5f6b 6579 3d22 3132 3334 3536 3738  in_key="12345678
+00008570: 3930 222c 0a20 2020 2020 2020 2069 676e  90",.        ign
+00008580: 6f72 655f 696e 7075 7473 3d4e 6f6e 652c  ore_inputs=None,
+00008590: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
+000085a0: 6d70 3d4e 6f6e 652c 0a20 2020 2020 2020  mp=None,.       
+000085b0: 2074 6167 733d 7b22 656e 7622 3a20 2274   tags={"env": "t
+000085c0: 6573 7422 7d2c 0a20 2020 2029 0a20 2020  est"},.    ).   
+000085d0: 206d 6f63 6b5f 6665 6564 6261 636b 2e61   mock_feedback.a
+000085e0: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
+000085f0: 2829 0a0a 2020 2020 6d6f 636b 5f67 6574  ()..    mock_get
+00008600: 5f72 6563 6f72 642e 6173 7365 7274 5f63  _record.assert_c
+00008610: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
+00008620: 2a65 7870 6563 7465 645f 636f 6d70 6174  *expected_compat
+00008630: 5f63 616c 6c29 0a0a 0a40 7079 7465 7374  _call)...@pytest
+00008640: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
+00008650: 6528 0a20 2020 205b 226b 7761 7267 7322  e(.    ["kwargs"
+00008660: 2c20 2265 7870 6563 7465 645f 636f 6d70  , "expected_comp
+00008670: 6174 5f63 616c 6c22 5d2c 0a20 2020 205b  at_call"],.    [
+00008680: 0a20 2020 2020 2020 2028 7b22 6665 6564  .        ({"feed
+00008690: 6261 636b 5f6b 6579 7322 3a20 5b22 4122  back_keys": ["A"
+000086a0: 5d7d 2c20 5b7b 2241 223a 2031 3030 7d2c  ]}, [{"A": 100},
+000086b0: 204e 6f6e 652c 205b 2241 225d 2c20 4e6f   None, ["A"], No
+000086c0: 6e65 5d29 2c0a 2020 2020 2020 2020 287b  ne]),.        ({
+000086d0: 2266 6565 6462 6163 6b5f 6964 223a 2022  "feedback_id": "
+000086e0: 3132 3334 3522 7d2c 205b 7b22 4122 3a20  12345"}, [{"A": 
+000086f0: 3130 307d 2c20 2231 3233 3435 222c 204e  100}, "12345", N
+00008700: 6f6e 652c 204e 6f6e 655d 292c 0a20 2020  one, None]),.   
+00008710: 2020 2020 2028 7b22 6a6f 696e 5f6b 6579       ({"join_key
+00008720: 223a 2022 3534 3332 3122 7d2c 205b 7b22  ": "54321"}, [{"
+00008730: 4122 3a20 3130 307d 2c20 4e6f 6e65 2c20  A": 100}, None, 
+00008740: 4e6f 6e65 2c20 2235 3433 3231 225d 292c  None, "54321"]),
+00008750: 0a20 2020 205d 2c0a 290a 4070 7974 6573  .    ],.).@pytes
+00008760: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+00008770: 7a65 280a 2020 2020 2274 6573 745f 6665  ze(.    "test_fe
+00008780: 6564 6261 636b 222c 0a20 2020 205b 4e6f  edback",.    [No
+00008790: 6e65 2c20 7b7d 5d2c 0a29 0a40 6d6f 636b  ne, {}],.).@mock
+000087a0: 2e70 6174 6368 2822 6761 6e74 7279 2e6c  .patch("gantry.l
+000087b0: 6f67 6765 722e 636c 6965 6e74 2e5f 7265  ogger.client._re
+000087c0: 736f 6c76 655f 6a6f 696e 5f6b 6579 222c  solve_join_key",
+000087d0: 2072 6574 7572 6e5f 7661 6c75 653d 2231   return_value="1
+000087e0: 3233 3435 3637 3839 3022 290a 406d 6f63  234567890").@moc
+000087f0: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
+00008800: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
+00008810: 6e74 7279 2e5f 6c6f 675f 7072 6564 6963  ntry._log_predic
+00008820: 7469 6f6e 5f61 6e64 5f66 6565 6462 6163  tion_and_feedbac
+00008830: 6b5f 6576 656e 7422 290a 406d 6f63 6b2e  k_event").@mock.
+00008840: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
+00008850: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
+00008860: 7279 2e5f 6c6f 675f 7072 6564 6963 7469  ry._log_predicti
+00008870: 6f6e 5f65 7665 6e74 222c 2072 6574 7572  on_event", retur
+00008880: 6e5f 7661 6c75 653d 2266 6f6f 6261 7231  n_value="foobar1
+00008890: 3233 3435 2229 0a40 6d6f 636b 2e70 6174  2345").@mock.pat
+000088a0: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
+000088b0: 722e 636c 6965 6e74 2e47 616e 7472 792e  r.client.Gantry.
+000088c0: 5f6c 6f67 5f66 6565 6462 6163 6b5f 6576  _log_feedback_ev
+000088d0: 656e 7422 290a 6465 6620 7465 7374 5f73  ent").def test_s
+000088e0: 696e 676c 655f 6c6f 675f 7265 636f 7264  ingle_log_record
+000088f0: 5f70 7265 645f 6f6e 6c79 280a 2020 2020  _pred_only(.    
+00008900: 6d6f 636b 5f66 6565 6462 6163 6b2c 0a20  mock_feedback,. 
+00008910: 2020 206d 6f63 6b5f 7072 6564 2c0a 2020     mock_pred,.  
+00008920: 2020 6d6f 636b 5f70 7265 645f 616e 645f    mock_pred_and_
+00008930: 6665 6564 6261 636b 2c0a 2020 2020 6d6f  feedback,.    mo
+00008940: 636b 5f67 6574 5f72 6563 6f72 642c 0a20  ck_get_record,. 
+00008950: 2020 2074 6573 745f 6665 6564 6261 636b     test_feedback
+00008960: 2c0a 2020 2020 6b77 6172 6773 2c0a 2020  ,.    kwargs,.  
+00008970: 2020 6578 7065 6374 6564 5f63 6f6d 7061    expected_compa
+00008980: 745f 6361 6c6c 2c0a 2020 2020 636c 695f  t_call,.    cli_
+00008990: 6f62 6a2c 0a29 3a0a 2020 2020 6173 7365  obj,.):.    asse
+000089a0: 7274 2028 0a20 2020 2020 2020 2063 6c69  rt (.        cli
+000089b0: 5f6f 626a 2e73 696e 676c 655f 6c6f 675f  _obj.single_log_
+000089c0: 7265 636f 7264 280a 2020 2020 2020 2020  record(.        
+000089d0: 2020 2020 6170 706c 6963 6174 696f 6e3d      application=
+000089e0: 2266 6f6f 6261 7222 2c0a 2020 2020 2020  "foobar",.      
+000089f0: 2020 2020 2020 7665 7273 696f 6e3d 2232        version="2
+00008a00: 2e30 2e31 222c 0a20 2020 2020 2020 2020  .0.1",.         
+00008a10: 2020 2069 6e70 7574 733d 7b22 4122 3a20     inputs={"A": 
+00008a20: 3130 307d 2c0a 2020 2020 2020 2020 2020  100},.          
+00008a30: 2020 6f75 7470 7574 733d 7b22 4222 3a20    outputs={"B": 
+00008a40: 3330 307d 2c0a 2020 2020 2020 2020 2020  300},.          
+00008a50: 2020 6665 6564 6261 636b 3d74 6573 745f    feedback=test_
+00008a60: 6665 6564 6261 636b 2c0a 2020 2020 2020  feedback,.      
+00008a70: 2020 2020 2020 7469 6d65 7374 616d 703d        timestamp=
+00008a80: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+00008a90: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
+00008aa0: 2020 2020 290a 2020 2020 2020 2020 3d3d      ).        ==
+00008ab0: 2022 666f 6f62 6172 3132 3334 3522 0a20   "foobar12345". 
+00008ac0: 2020 2029 0a0a 2020 2020 6d6f 636b 5f70     )..    mock_p
+00008ad0: 7265 645f 616e 645f 6665 6564 6261 636b  red_and_feedback
+00008ae0: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
+00008af0: 6564 2829 0a20 2020 206d 6f63 6b5f 7072  ed().    mock_pr
+00008b00: 6564 2e61 7373 6572 745f 6361 6c6c 6564  ed.assert_called
+00008b10: 5f6f 6e63 655f 7769 7468 280a 2020 2020  _once_with(.    
+00008b20: 2020 2020 6170 706c 6963 6174 696f 6e3d      application=
+00008b30: 2266 6f6f 6261 7222 2c0a 2020 2020 2020  "foobar",.      
+00008b40: 2020 696e 7075 7473 3d7b 2241 223a 2031    inputs={"A": 1
+00008b50: 3030 7d2c 0a20 2020 2020 2020 206f 7574  00},.        out
+00008b60: 7075 7473 3d7b 2242 223a 2033 3030 7d2c  puts={"B": 300},
+00008b70: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
+00008b80: 3d22 322e 302e 3122 2c0a 2020 2020 2020  ="2.0.1",.      
+00008b90: 2020 6a6f 696e 5f6b 6579 3d22 3132 3334    join_key="1234
+00008ba0: 3536 3738 3930 222c 0a20 2020 2020 2020  567890",.       
+00008bb0: 2069 676e 6f72 655f 696e 7075 7473 3d4e   ignore_inputs=N
+00008bc0: 6f6e 652c 0a20 2020 2020 2020 2074 696d  one,.        tim
+00008bd0: 6573 7461 6d70 3d4e 6f6e 652c 0a20 2020  estamp=None,.   
+00008be0: 2020 2020 2074 6167 733d 7b22 656e 7622       tags={"env"
+00008bf0: 3a20 2274 6573 7422 7d2c 0a20 2020 2029  : "test"},.    )
+00008c00: 0a20 2020 206d 6f63 6b5f 6665 6564 6261  .    mock_feedba
+00008c10: 636b 2e61 7373 6572 745f 6e6f 745f 6361  ck.assert_not_ca
+00008c20: 6c6c 6564 2829 0a0a 2020 2020 6d6f 636b  lled()..    mock
+00008c30: 5f67 6574 5f72 6563 6f72 642e 6173 7365  _get_record.asse
+00008c40: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+00008c50: 6974 6828 2a65 7870 6563 7465 645f 636f  ith(*expected_co
+00008c60: 6d70 6174 5f63 616c 6c29 0a0a 0a40 7079  mpat_call)...@py
+00008c70: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
+00008c80: 7472 697a 6528 0a20 2020 205b 226b 7761  trize(.    ["kwa
+00008c90: 7267 7322 2c20 2265 7870 6563 7465 645f  rgs", "expected_
+00008ca0: 636f 6d70 6174 5f63 616c 6c22 5d2c 0a20  compat_call"],. 
+00008cb0: 2020 205b 0a20 2020 2020 2020 2028 7b22     [.        ({"
+00008cc0: 6665 6564 6261 636b 5f6b 6579 7322 3a20  feedback_keys": 
+00008cd0: 5b22 4122 5d7d 2c20 5b4e 6f6e 652c 204e  ["A"]}, [None, N
+00008ce0: 6f6e 652c 205b 2241 225d 2c20 4e6f 6e65  one, ["A"], None
+00008cf0: 5d29 2c0a 2020 2020 2020 2020 287b 2266  ]),.        ({"f
+00008d00: 6565 6462 6163 6b5f 6964 223a 2022 3132  eedback_id": "12
+00008d10: 3334 3522 7d2c 205b 4e6f 6e65 2c20 2231  345"}, [None, "1
+00008d20: 3233 3435 222c 204e 6f6e 652c 204e 6f6e  2345", None, Non
+00008d30: 655d 292c 0a20 2020 2020 2020 2028 7b22  e]),.        ({"
+00008d40: 6a6f 696e 5f6b 6579 223a 2022 3534 3332  join_key": "5432
+00008d50: 3122 7d2c 205b 4e6f 6e65 2c20 4e6f 6e65  1"}, [None, None
+00008d60: 2c20 4e6f 6e65 2c20 2235 3433 3231 225d  , None, "54321"]
+00008d70: 292c 0a20 2020 205d 2c0a 290a 4070 7974  ),.    ],.).@pyt
+00008d80: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
+00008d90: 7269 7a65 280a 2020 2020 2274 6573 745f  rize(.    "test_
+00008da0: 6f75 7470 7574 222c 0a20 2020 205b 4e6f  output",.    [No
+00008db0: 6e65 2c20 7b7d 5d2c 0a29 0a40 7079 7465  ne, {}],.).@pyte
+00008dc0: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
+00008dd0: 697a 6528 0a20 2020 2022 7465 7374 5f69  ize(.    "test_i
+00008de0: 6e70 7574 222c 0a20 2020 205b 4e6f 6e65  nput",.    [None
+00008df0: 2c20 7b7d 5d2c 0a29 0a40 6d6f 636b 2e70  , {}],.).@mock.p
+00008e00: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
+00008e10: 6765 722e 636c 6965 6e74 2e5f 7265 736f  ger.client._reso
+00008e20: 6c76 655f 6a6f 696e 5f6b 6579 222c 2072  lve_join_key", r
+00008e30: 6574 7572 6e5f 7661 6c75 653d 2231 3233  eturn_value="123
+00008e40: 3435 3637 3839 3022 290a 406d 6f63 6b2e  4567890").@mock.
+00008e50: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
+00008e60: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
+00008e70: 7279 2e5f 6c6f 675f 7072 6564 6963 7469  ry._log_predicti
+00008e80: 6f6e 5f61 6e64 5f66 6565 6462 6163 6b5f  on_and_feedback_
+00008e90: 6576 656e 7422 290a 406d 6f63 6b2e 7061  event").@mock.pa
+00008ea0: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
+00008eb0: 6572 2e63 6c69 656e 742e 4761 6e74 7279  er.client.Gantry
+00008ec0: 2e5f 6c6f 675f 7072 6564 6963 7469 6f6e  ._log_prediction
+00008ed0: 5f65 7665 6e74 2229 0a40 6d6f 636b 2e70  _event").@mock.p
+00008ee0: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
+00008ef0: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
+00008f00: 792e 5f6c 6f67 5f66 6565 6462 6163 6b5f  y._log_feedback_
+00008f10: 6576 656e 7422 2c20 7265 7475 726e 5f76  event", return_v
+00008f20: 616c 7565 3d22 666f 6f62 6172 3132 3334  alue="foobar1234
+00008f30: 3522 290a 6465 6620 7465 7374 5f6c 6f67  5").def test_log
+00008f40: 5f72 6563 6f72 645f 6665 6564 6261 636b  _record_feedback
+00008f50: 5f6f 6e6c 7928 0a20 2020 206d 6f63 6b5f  _only(.    mock_
+00008f60: 6665 6564 6261 636b 2c0a 2020 2020 6d6f  feedback,.    mo
+00008f70: 636b 5f70 7265 642c 0a20 2020 206d 6f63  ck_pred,.    moc
+00008f80: 6b5f 7072 6564 5f61 6e64 5f66 6565 6462  k_pred_and_feedb
+00008f90: 6163 6b2c 0a20 2020 206d 6f63 6b5f 6765  ack,.    mock_ge
+00008fa0: 745f 7265 636f 7264 2c0a 2020 2020 7465  t_record,.    te
+00008fb0: 7374 5f69 6e70 7574 2c0a 2020 2020 7465  st_input,.    te
+00008fc0: 7374 5f6f 7574 7075 742c 0a20 2020 206b  st_output,.    k
+00008fd0: 7761 7267 732c 0a20 2020 2065 7870 6563  wargs,.    expec
+00008fe0: 7465 645f 636f 6d70 6174 5f63 616c 6c2c  ted_compat_call,
+00008ff0: 0a20 2020 2063 6c69 5f6f 626a 2c0a 293a  .    cli_obj,.):
+00009000: 0a20 2020 2023 2048 6163 6b20 7468 6520  .    # Hack the 
+00009010: 7061 7261 6d65 7472 697a 6564 2076 616c  parametrized val
+00009020: 7565 2077 6974 6820 7468 6520 6f74 6865  ue with the othe
+00009030: 7220 7061 7261 6d65 7472 697a 6564 2066  r parametrized f
+00009040: 6978 7475 7265 0a20 2020 2065 7870 6563  ixture.    expec
+00009050: 7465 645f 636f 6d70 6174 5f63 616c 6c5b  ted_compat_call[
+00009060: 305d 203d 2074 6573 745f 696e 7075 740a  0] = test_input.
+00009070: 0a20 2020 2061 7373 6572 7420 280a 2020  .    assert (.  
+00009080: 2020 2020 2020 636c 695f 6f62 6a2e 6c6f        cli_obj.lo
+00009090: 675f 7265 636f 7264 280a 2020 2020 2020  g_record(.      
+000090a0: 2020 2020 2020 6170 706c 6963 6174 696f        applicatio
+000090b0: 6e3d 2266 6f6f 6261 7222 2c0a 2020 2020  n="foobar",.    
+000090c0: 2020 2020 2020 2020 7665 7273 696f 6e3d          version=
+000090d0: 2232 2e30 2e31 222c 0a20 2020 2020 2020  "2.0.1",.       
+000090e0: 2020 2020 2069 6e70 7574 733d 7465 7374       inputs=test
+000090f0: 5f69 6e70 7574 2c0a 2020 2020 2020 2020  _input,.        
+00009100: 2020 2020 6f75 7470 7574 733d 7465 7374      outputs=test
+00009110: 5f6f 7574 7075 742c 0a20 2020 2020 2020  _output,.       
+00009120: 2020 2020 2066 6565 6462 6163 6b3d 7b22       feedback={"
+00009130: 4122 3a20 3230 307d 2c0a 2020 2020 2020  A": 200},.      
+00009140: 2020 2020 2020 7469 6d65 7374 616d 703d        timestamp=
+00009150: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+00009160: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
+00009170: 2020 2020 290a 2020 2020 2020 2020 3d3d      ).        ==
+00009180: 2022 666f 6f62 6172 3132 3334 3522 0a20   "foobar12345". 
+00009190: 2020 2029 0a0a 2020 2020 6d6f 636b 5f70     )..    mock_p
+000091a0: 7265 645f 616e 645f 6665 6564 6261 636b  red_and_feedback
+000091b0: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
+000091c0: 6564 2829 0a20 2020 206d 6f63 6b5f 7072  ed().    mock_pr
+000091d0: 6564 2e61 7373 6572 745f 6e6f 745f 6361  ed.assert_not_ca
+000091e0: 6c6c 6564 2829 0a20 2020 206d 6f63 6b5f  lled().    mock_
+000091f0: 6665 6564 6261 636b 2e61 7373 6572 745f  feedback.assert_
+00009200: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
+00009210: 280a 2020 2020 2020 2020 6170 706c 6963  (.        applic
+00009220: 6174 696f 6e3d 2266 6f6f 6261 7222 2c0a  ation="foobar",.
+00009230: 2020 2020 2020 2020 6a6f 696e 5f6b 6579          join_key
+00009240: 3d22 3132 3334 3536 3738 3930 222c 0a20  ="1234567890",. 
+00009250: 2020 2020 2020 2066 6565 6462 6163 6b3d         feedback=
+00009260: 7b22 4122 3a20 3230 307d 2c0a 2020 2020  {"A": 200},.    
+00009270: 2020 2020 6665 6564 6261 636b 5f76 6572      feedback_ver
+00009280: 7369 6f6e 3d22 322e 302e 3122 2c0a 2020  sion="2.0.1",.  
+00009290: 2020 2020 2020 7469 6d65 7374 616d 703d        timestamp=
+000092a0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7461  None,.        ta
+000092b0: 6773 3d7b 2265 6e76 223a 2022 7465 7374  gs={"env": "test
+000092c0: 227d 2c0a 2020 2020 290a 0a20 2020 206d  "},.    )..    m
+000092d0: 6f63 6b5f 6765 745f 7265 636f 7264 2e61  ock_get_record.a
+000092e0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+000092f0: 655f 7769 7468 282a 6578 7065 6374 6564  e_with(*expected
+00009300: 5f63 6f6d 7061 745f 6361 6c6c 290a 0a0a  _compat_call)...
+00009310: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
+00009320: 616d 6574 7269 7a65 280a 2020 2020 5b22  ametrize(.    ["
+00009330: 6b77 6172 6773 222c 2022 6578 7065 6374  kwargs", "expect
+00009340: 6564 5f63 6f6d 7061 745f 6361 6c6c 225d  ed_compat_call"]
+00009350: 2c0a 2020 2020 5b0a 2020 2020 2020 2020  ,.    [.        
+00009360: 287b 2266 6565 6462 6163 6b5f 6b65 7973  ({"feedback_keys
+00009370: 223a 205b 2241 225d 7d2c 205b 4e6f 6e65  ": ["A"]}, [None
+00009380: 2c20 4e6f 6e65 2c20 5b22 4122 5d2c 204e  , None, ["A"], N
+00009390: 6f6e 655d 292c 0a20 2020 2020 2020 2028  one]),.        (
+000093a0: 7b22 6665 6564 6261 636b 5f69 6422 3a20  {"feedback_id": 
+000093b0: 2231 3233 3435 227d 2c20 5b4e 6f6e 652c  "12345"}, [None,
+000093c0: 2022 3132 3334 3522 2c20 4e6f 6e65 2c20   "12345", None, 
+000093d0: 4e6f 6e65 5d29 2c0a 2020 2020 2020 2020  None]),.        
+000093e0: 287b 226a 6f69 6e5f 6b65 7922 3a20 2235  ({"join_key": "5
+000093f0: 3433 3231 227d 2c20 5b4e 6f6e 652c 204e  4321"}, [None, N
+00009400: 6f6e 652c 204e 6f6e 652c 2022 3534 3332  one, None, "5432
+00009410: 3122 5d29 2c0a 2020 2020 5d2c 0a29 0a40  1"]),.    ],.).@
+00009420: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+00009430: 6d65 7472 697a 6528 0a20 2020 2022 7465  metrize(.    "te
+00009440: 7374 5f6f 7574 7075 7422 2c0a 2020 2020  st_output",.    
+00009450: 5b4e 6f6e 652c 207b 7d5d 2c0a 290a 4070  [None, {}],.).@p
+00009460: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+00009470: 6574 7269 7a65 280a 2020 2020 2274 6573  etrize(.    "tes
+00009480: 745f 696e 7075 7422 2c0a 2020 2020 5b4e  t_input",.    [N
+00009490: 6f6e 652c 207b 7d5d 2c0a 290a 406d 6f63  one, {}],.).@moc
+000094a0: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
+000094b0: 6c6f 6767 6572 2e63 6c69 656e 742e 5f72  logger.client._r
+000094c0: 6573 6f6c 7665 5f6a 6f69 6e5f 6b65 7922  esolve_join_key"
+000094d0: 2c20 7265 7475 726e 5f76 616c 7565 3d22  , return_value="
+000094e0: 3132 3334 3536 3738 3930 2229 0a40 6d6f  1234567890").@mo
+000094f0: 636b 2e70 6174 6368 2822 6761 6e74 7279  ck.patch("gantry
+00009500: 2e6c 6f67 6765 722e 636c 6965 6e74 2e47  .logger.client.G
+00009510: 616e 7472 792e 5f6c 6f67 5f70 7265 6469  antry._log_predi
+00009520: 6374 696f 6e5f 616e 645f 6665 6564 6261  ction_and_feedba
+00009530: 636b 5f65 7665 6e74 2229 0a40 6d6f 636b  ck_event").@mock
+00009540: 2e70 6174 6368 2822 6761 6e74 7279 2e6c  .patch("gantry.l
+00009550: 6f67 6765 722e 636c 6965 6e74 2e47 616e  ogger.client.Gan
+00009560: 7472 792e 5f6c 6f67 5f70 7265 6469 6374  try._log_predict
+00009570: 696f 6e5f 6576 656e 7422 290a 406d 6f63  ion_event").@moc
+00009580: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
+00009590: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
+000095a0: 6e74 7279 2e5f 6c6f 675f 6665 6564 6261  ntry._log_feedba
+000095b0: 636b 5f65 7665 6e74 222c 2072 6574 7572  ck_event", retur
+000095c0: 6e5f 7661 6c75 653d 2266 6f6f 6261 7231  n_value="foobar1
+000095d0: 3233 3435 2229 0a64 6566 2074 6573 745f  2345").def test_
+000095e0: 7369 6e67 6c65 5f6c 6f67 5f72 6563 6f72  single_log_recor
+000095f0: 645f 6665 6564 6261 636b 5f6f 6e6c 7928  d_feedback_only(
+00009600: 0a20 2020 206d 6f63 6b5f 6665 6564 6261  .    mock_feedba
+00009610: 636b 2c0a 2020 2020 6d6f 636b 5f70 7265  ck,.    mock_pre
+00009620: 642c 0a20 2020 206d 6f63 6b5f 7072 6564  d,.    mock_pred
+00009630: 5f61 6e64 5f66 6565 6462 6163 6b2c 0a20  _and_feedback,. 
+00009640: 2020 206d 6f63 6b5f 6765 745f 7265 636f     mock_get_reco
+00009650: 7264 2c0a 2020 2020 7465 7374 5f69 6e70  rd,.    test_inp
+00009660: 7574 2c0a 2020 2020 7465 7374 5f6f 7574  ut,.    test_out
+00009670: 7075 742c 0a20 2020 206b 7761 7267 732c  put,.    kwargs,
+00009680: 0a20 2020 2065 7870 6563 7465 645f 636f  .    expected_co
+00009690: 6d70 6174 5f63 616c 6c2c 0a20 2020 2063  mpat_call,.    c
+000096a0: 6c69 5f6f 626a 2c0a 293a 0a20 2020 2023  li_obj,.):.    #
+000096b0: 2048 6163 6b20 7468 6520 7061 7261 6d65   Hack the parame
+000096c0: 7472 697a 6564 2076 616c 7565 2077 6974  trized value wit
+000096d0: 6820 7468 6520 6f74 6865 7220 7061 7261  h the other para
+000096e0: 6d65 7472 697a 6564 2066 6978 7475 7265  metrized fixture
+000096f0: 0a20 2020 2065 7870 6563 7465 645f 636f  .    expected_co
+00009700: 6d70 6174 5f63 616c 6c5b 305d 203d 2074  mpat_call[0] = t
+00009710: 6573 745f 696e 7075 740a 0a20 2020 2061  est_input..    a
+00009720: 7373 6572 7420 280a 2020 2020 2020 2020  ssert (.        
+00009730: 636c 695f 6f62 6a2e 7369 6e67 6c65 5f6c  cli_obj.single_l
+00009740: 6f67 5f72 6563 6f72 6428 0a20 2020 2020  og_record(.     
+00009750: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
+00009760: 6f6e 3d22 666f 6f62 6172 222c 0a20 2020  on="foobar",.   
+00009770: 2020 2020 2020 2020 2076 6572 7369 6f6e           version
+00009780: 3d22 322e 302e 3122 2c0a 2020 2020 2020  ="2.0.1",.      
+00009790: 2020 2020 2020 696e 7075 7473 3d74 6573        inputs=tes
+000097a0: 745f 696e 7075 742c 0a20 2020 2020 2020  t_input,.       
+000097b0: 2020 2020 206f 7574 7075 7473 3d74 6573       outputs=tes
+000097c0: 745f 6f75 7470 7574 2c0a 2020 2020 2020  t_output,.      
+000097d0: 2020 2020 2020 6665 6564 6261 636b 3d7b        feedback={
+000097e0: 2241 223a 2032 3030 7d2c 0a20 2020 2020  "A": 200},.     
+000097f0: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
+00009800: 3d4e 6f6e 652c 0a20 2020 2020 2020 2020  =None,.         
+00009810: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
+00009820: 2020 2020 2029 0a20 2020 2020 2020 203d       ).        =
+00009830: 3d20 2266 6f6f 6261 7231 3233 3435 220a  = "foobar12345".
+00009840: 2020 2020 290a 0a20 2020 206d 6f63 6b5f      )..    mock_
+00009850: 7072 6564 5f61 6e64 5f66 6565 6462 6163  pred_and_feedbac
+00009860: 6b2e 6173 7365 7274 5f6e 6f74 5f63 616c  k.assert_not_cal
+00009870: 6c65 6428 290a 2020 2020 6d6f 636b 5f70  led().    mock_p
+00009880: 7265 642e 6173 7365 7274 5f6e 6f74 5f63  red.assert_not_c
+00009890: 616c 6c65 6428 290a 2020 2020 6d6f 636b  alled().    mock
+000098a0: 5f66 6565 6462 6163 6b2e 6173 7365 7274  _feedback.assert
+000098b0: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+000098c0: 6828 0a20 2020 2020 2020 2061 7070 6c69  h(.        appli
+000098d0: 6361 7469 6f6e 3d22 666f 6f62 6172 222c  cation="foobar",
+000098e0: 0a20 2020 2020 2020 206a 6f69 6e5f 6b65  .        join_ke
+000098f0: 793d 2231 3233 3435 3637 3839 3022 2c0a  y="1234567890",.
+00009900: 2020 2020 2020 2020 6665 6564 6261 636b          feedback
+00009910: 3d7b 2241 223a 2032 3030 7d2c 0a20 2020  ={"A": 200},.   
+00009920: 2020 2020 2066 6565 6462 6163 6b5f 7665       feedback_ve
+00009930: 7273 696f 6e3d 2232 2e30 2e31 222c 0a20  rsion="2.0.1",. 
+00009940: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
+00009950: 3d4e 6f6e 652c 0a20 2020 2020 2020 2074  =None,.        t
+00009960: 6167 733d 7b22 656e 7622 3a20 2274 6573  ags={"env": "tes
+00009970: 7422 7d2c 0a20 2020 2029 0a0a 2020 2020  t"},.    )..    
+00009980: 6d6f 636b 5f67 6574 5f72 6563 6f72 642e  mock_get_record.
+00009990: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
+000099a0: 6365 5f77 6974 6828 2a65 7870 6563 7465  ce_with(*expecte
+000099b0: 645f 636f 6d70 6174 5f63 616c 6c29 0a0a  d_compat_call)..
+000099c0: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
+000099d0: 7261 6d65 7472 697a 6528 0a20 2020 2022  rametrize(.    "
+000099e0: 7465 7374 5f6f 7574 7075 7422 2c0a 2020  test_output",.  
+000099f0: 2020 5b4e 6f6e 652c 207b 7d5d 2c0a 290a    [None, {}],.).
+00009a00: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
+00009a10: 616d 6574 7269 7a65 280a 2020 2020 2274  ametrize(.    "t
+00009a20: 6573 745f 696e 7075 7422 2c0a 2020 2020  est_input",.    
+00009a30: 5b4e 6f6e 652c 207b 7d5d 2c0a 290a 406d  [None, {}],.).@m
+00009a40: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
+00009a50: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
+00009a60: 4761 6e74 7279 2e5f 6c6f 675f 7072 6564  Gantry._log_pred
+00009a70: 6963 7469 6f6e 5f61 6e64 5f66 6565 6462  iction_and_feedb
+00009a80: 6163 6b5f 6576 656e 7422 290a 406d 6f63  ack_event").@moc
+00009a90: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
+00009aa0: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
+00009ab0: 6e74 7279 2e5f 6c6f 675f 7072 6564 6963  ntry._log_predic
+00009ac0: 7469 6f6e 5f65 7665 6e74 2229 0a40 6d6f  tion_event").@mo
+00009ad0: 636b 2e70 6174 6368 2822 6761 6e74 7279  ck.patch("gantry
+00009ae0: 2e6c 6f67 6765 722e 636c 6965 6e74 2e47  .logger.client.G
+00009af0: 616e 7472 792e 5f6c 6f67 5f66 6565 6462  antry._log_feedb
+00009b00: 6163 6b5f 6576 656e 7422 290a 6465 6620  ack_event").def 
+00009b10: 7465 7374 5f6c 6f67 5f72 6563 6f72 645f  test_log_record_
+00009b20: 6665 6564 6261 636b 5f6e 6f5f 6b65 795f  feedback_no_key_
+00009b30: 6572 726f 7228 0a20 2020 206d 6f63 6b5f  error(.    mock_
+00009b40: 6665 6564 6261 636b 2c20 6d6f 636b 5f70  feedback, mock_p
+00009b50: 7265 642c 206d 6f63 6b5f 7072 6564 5f61  red, mock_pred_a
+00009b60: 6e64 5f66 6565 6462 6163 6b2c 2074 6573  nd_feedback, tes
+00009b70: 745f 696e 7075 742c 2074 6573 745f 6f75  t_input, test_ou
+00009b80: 7470 7574 2c20 636c 695f 6f62 6a0a 293a  tput, cli_obj.):
+00009b90: 0a20 2020 2063 6c69 5f6f 626a 2e6c 6f67  .    cli_obj.log
+00009ba0: 5f72 6563 6f72 6428 0a20 2020 2020 2020  _record(.       
+00009bb0: 2061 7070 6c69 6361 7469 6f6e 3d22 666f   application="fo
+00009bc0: 6f62 6172 222c 0a20 2020 2020 2020 2076  obar",.        v
+00009bd0: 6572 7369 6f6e 3d22 322e 302e 3122 2c0a  ersion="2.0.1",.
+00009be0: 2020 2020 2020 2020 696e 7075 7473 3d74          inputs=t
+00009bf0: 6573 745f 696e 7075 742c 0a20 2020 2020  est_input,.     
+00009c00: 2020 206f 7574 7075 7473 3d74 6573 745f     outputs=test_
+00009c10: 6f75 7470 7574 2c0a 2020 2020 2020 2020  output,.        
+00009c20: 6665 6564 6261 636b 3d7b 2241 223a 2032  feedback={"A": 2
+00009c30: 3030 7d2c 0a20 2020 2020 2020 2074 696d  00},.        tim
+00009c40: 6573 7461 6d70 3d4e 6f6e 652c 0a20 2020  estamp=None,.   
+00009c50: 2020 2020 2066 6565 6462 6163 6b5f 6b65       feedback_ke
+00009c60: 7973 3d4e 6f6e 652c 0a20 2020 2020 2020  ys=None,.       
+00009c70: 2066 6565 6462 6163 6b5f 6964 3d4e 6f6e   feedback_id=Non
+00009c80: 652c 0a20 2020 2020 2020 206a 6f69 6e5f  e,.        join_
+00009c90: 6b65 793d 4e6f 6e65 2c0a 2020 2020 290a  key=None,.    ).
+00009ca0: 0a20 2020 206d 6f63 6b5f 7072 6564 5f61  .    mock_pred_a
+00009cb0: 6e64 5f66 6565 6462 6163 6b2e 6173 7365  nd_feedback.asse
+00009cc0: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
+00009cd0: 2020 2020 6d6f 636b 5f70 7265 642e 6173      mock_pred.as
+00009ce0: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
+00009cf0: 290a 2020 2020 6d6f 636b 5f66 6565 6462  ).    mock_feedb
+00009d00: 6163 6b2e 6173 7365 7274 5f6e 6f74 5f63  ack.assert_not_c
+00009d10: 616c 6c65 6428 290a 0a0a 4070 7974 6573  alled()...@pytes
+00009d20: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+00009d30: 7a65 280a 2020 2020 226b 7761 7267 7322  ze(.    "kwargs"
+00009d40: 2c0a 2020 2020 5b0a 2020 2020 2020 2020  ,.    [.        
+00009d50: 7b22 6665 6564 6261 636b 5f6b 6579 7322  {"feedback_keys"
+00009d60: 3a20 5b22 4122 5d7d 2c0a 2020 2020 2020  : ["A"]},.      
+00009d70: 2020 7b22 6665 6564 6261 636b 5f69 6422    {"feedback_id"
+00009d80: 3a20 2231 3233 3435 227d 2c0a 2020 2020  : "12345"},.    
+00009d90: 2020 2020 7b22 6a6f 696e 5f6b 6579 223a      {"join_key":
+00009da0: 2022 3534 3332 3122 7d2c 0a20 2020 205d   "54321"},.    ]
+00009db0: 2c0a 290a 4070 7974 6573 742e 6d61 726b  ,.).@pytest.mark
+00009dc0: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
+00009dd0: 2020 2274 6573 745f 696e 7075 7422 2c0a    "test_input",.
+00009de0: 2020 2020 5b4e 6f6e 652c 207b 7d5d 2c0a      [None, {}],.
+00009df0: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
+00009e00: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
+00009e10: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
+00009e20: 7072 6564 6963 7469 6f6e 5f61 6e64 5f66  prediction_and_f
+00009e30: 6565 6462 6163 6b5f 6576 656e 7422 290a  eedback_event").
+00009e40: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
+00009e50: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
+00009e60: 742e 4761 6e74 7279 2e5f 6c6f 675f 7072  t.Gantry._log_pr
+00009e70: 6564 6963 7469 6f6e 5f65 7665 6e74 2229  ediction_event")
+00009e80: 0a40 6d6f 636b 2e70 6174 6368 2822 6761  .@mock.patch("ga
+00009e90: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
+00009ea0: 6e74 2e47 616e 7472 792e 5f6c 6f67 5f66  nt.Gantry._log_f
+00009eb0: 6565 6462 6163 6b5f 6576 656e 7422 290a  eedback_event").
+00009ec0: 6465 6620 7465 7374 5f6c 6f67 5f72 6563  def test_log_rec
+00009ed0: 6f72 645f 6e6f 5f64 6174 6128 0a20 2020  ord_no_data(.   
+00009ee0: 206d 6f63 6b5f 6665 6564 6261 636b 2c20   mock_feedback, 
+00009ef0: 6d6f 636b 5f70 7265 642c 206d 6f63 6b5f  mock_pred, mock_
+00009f00: 7072 6564 5f61 6e64 5f66 6565 6462 6163  pred_and_feedbac
+00009f10: 6b2c 2074 6573 745f 696e 7075 742c 206b  k, test_input, k
+00009f20: 7761 7267 732c 2063 6c69 5f6f 626a 0a29  wargs, cli_obj.)
+00009f30: 3a0a 2020 2020 636c 695f 6f62 6a2e 6c6f  :.    cli_obj.lo
+00009f40: 675f 7265 636f 7264 280a 2020 2020 2020  g_record(.      
+00009f50: 2020 6170 706c 6963 6174 696f 6e3d 2266    application="f
+00009f60: 6f6f 6261 7222 2c0a 2020 2020 2020 2020  oobar",.        
+00009f70: 7665 7273 696f 6e3d 2232 2e30 2e31 222c  version="2.0.1",
+00009f80: 0a20 2020 2020 2020 2069 6e70 7574 733d  .        inputs=
+00009f90: 7465 7374 5f69 6e70 7574 2c0a 2020 2020  test_input,.    
+00009fa0: 2020 2020 6f75 7470 7574 733d 7b22 4222      outputs={"B"
+00009fb0: 3a20 3130 307d 2c0a 2020 2020 2020 2020  : 100},.        
+00009fc0: 6665 6564 6261 636b 3d4e 6f6e 652c 0a20  feedback=None,. 
+00009fd0: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
+00009fe0: 3d4e 6f6e 652c 0a20 2020 2020 2020 202a  =None,.        *
+00009ff0: 2a6b 7761 7267 732c 0a20 2020 2029 0a0a  *kwargs,.    )..
+0000a000: 2020 2020 6d6f 636b 5f70 7265 645f 616e      mock_pred_an
+0000a010: 645f 6665 6564 6261 636b 2e61 7373 6572  d_feedback.asser
+0000a020: 745f 6e6f 745f 6361 6c6c 6564 2829 0a20  t_not_called(). 
+0000a030: 2020 206d 6f63 6b5f 7072 6564 2e61 7373     mock_pred.ass
+0000a040: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
+0000a050: 0a20 2020 206d 6f63 6b5f 6665 6564 6261  .    mock_feedba
+0000a060: 636b 2e61 7373 6572 745f 6e6f 745f 6361  ck.assert_not_ca
+0000a070: 6c6c 6564 2829 0a0a 0a40 7079 7465 7374  lled()...@pytest
+0000a080: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
+0000a090: 6528 0a20 2020 2022 6b77 6172 6773 222c  e(.    "kwargs",
+0000a0a0: 0a20 2020 205b 0a20 2020 2020 2020 207b  .    [.        {
+0000a0b0: 2266 6565 6462 6163 6b5f 6b65 7973 223a  "feedback_keys":
+0000a0c0: 205b 2241 225d 7d2c 0a20 2020 2020 2020   ["A"]},.       
+0000a0d0: 207b 2266 6565 6462 6163 6b5f 6964 223a   {"feedback_id":
+0000a0e0: 2022 3132 3334 3522 7d2c 0a20 2020 2020   "12345"},.     
+0000a0f0: 2020 207b 226a 6f69 6e5f 6b65 7922 3a20     {"join_key": 
+0000a100: 2235 3433 3231 227d 2c0a 2020 2020 5d2c  "54321"},.    ],
+0000a110: 0a29 0a40 7079 7465 7374 2e6d 6172 6b2e  .).@pytest.mark.
+0000a120: 7061 7261 6d65 7472 697a 6528 2266 6565  parametrize("fee
+0000a130: 6462 6163 6b22 2c20 5b4e 6f6e 652c 207b  dback", [None, {
+0000a140: 7d2c 207b 2242 223a 2032 3030 7d5d 290a  }, {"B": 200}]).
+0000a150: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
+0000a160: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
+0000a170: 742e 4761 6e74 7279 2e5f 6c6f 675f 7072  t.Gantry._log_pr
+0000a180: 6564 6963 7469 6f6e 5f61 6e64 5f66 6565  ediction_and_fee
+0000a190: 6462 6163 6b5f 6576 656e 7422 290a 406d  dback_event").@m
+0000a1a0: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
+0000a1b0: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
+0000a1c0: 4761 6e74 7279 2e5f 6c6f 675f 7072 6564  Gantry._log_pred
+0000a1d0: 6963 7469 6f6e 5f65 7665 6e74 2229 0a40  iction_event").@
+0000a1e0: 6d6f 636b 2e70 6174 6368 2822 6761 6e74  mock.patch("gant
+0000a1f0: 7279 2e6c 6f67 6765 722e 636c 6965 6e74  ry.logger.client
+0000a200: 2e47 616e 7472 792e 5f6c 6f67 5f66 6565  .Gantry._log_fee
+0000a210: 6462 6163 6b5f 6576 656e 7422 290a 6465  dback_event").de
+0000a220: 6620 7465 7374 5f6c 6f67 5f72 6563 6f72  f test_log_recor
+0000a230: 645f 696e 636f 6d70 6c65 7465 5f70 7265  d_incomplete_pre
+0000a240: 6473 280a 2020 2020 6d6f 636b 5f66 6565  ds(.    mock_fee
+0000a250: 6462 6163 6b2c 206d 6f63 6b5f 7072 6564  dback, mock_pred
+0000a260: 2c20 6d6f 636b 5f70 7265 645f 616e 645f  , mock_pred_and_
+0000a270: 6665 6564 6261 636b 2c20 6665 6564 6261  feedback, feedba
+0000a280: 636b 2c20 6b77 6172 6773 2c20 636c 695f  ck, kwargs, cli_
+0000a290: 6f62 6a0a 293a 0a20 2020 2063 6c69 5f6f  obj.):.    cli_o
+0000a2a0: 626a 2e6c 6f67 5f72 6563 6f72 6428 0a20  bj.log_record(. 
+0000a2b0: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
+0000a2c0: 6f6e 3d22 666f 6f62 6172 222c 0a20 2020  on="foobar",.   
+0000a2d0: 2020 2020 2076 6572 7369 6f6e 3d22 322e       version="2.
+0000a2e0: 302e 3122 2c0a 2020 2020 2020 2020 696e  0.1",.        in
+0000a2f0: 7075 7473 3d7b 7d2c 0a20 2020 2020 2020  puts={},.       
+0000a300: 206f 7574 7075 7473 3d7b 2242 223a 2031   outputs={"B": 1
+0000a310: 3030 7d2c 0a20 2020 2020 2020 2066 6565  00},.        fee
+0000a320: 6462 6163 6b3d 6665 6564 6261 636b 2c0a  dback=feedback,.
+0000a330: 2020 2020 2020 2020 7469 6d65 7374 616d          timestam
+0000a340: 703d 4e6f 6e65 2c0a 2020 2020 2020 2020  p=None,.        
+0000a350: 2a2a 6b77 6172 6773 2c0a 2020 2020 290a  **kwargs,.    ).
+0000a360: 0a20 2020 206d 6f63 6b5f 7072 6564 5f61  .    mock_pred_a
+0000a370: 6e64 5f66 6565 6462 6163 6b2e 6173 7365  nd_feedback.asse
+0000a380: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
+0000a390: 2020 2020 6d6f 636b 5f70 7265 642e 6173      mock_pred.as
+0000a3a0: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
+0000a3b0: 290a 2020 2020 6d6f 636b 5f66 6565 6462  ).    mock_feedb
+0000a3c0: 6163 6b2e 6173 7365 7274 5f6e 6f74 5f63  ack.assert_not_c
+0000a3d0: 616c 6c65 6428 290a 0a0a 2320 544f 444f  alled()...# TODO
+0000a3e0: 202d 3e20 6164 6420 6e70 2e6e 6461 7272   -> add np.ndarr
+0000a3f0: 6179 7320 6173 2070 6f73 7369 626c 6520  ays as possible 
+0000a400: 6665 6564 6261 636b 7320 7661 6c75 6573  feedbacks values
+0000a410: 0a40 6672 6565 7a65 5f74 696d 6528 4355  .@freeze_time(CU
+0000a420: 5252 454e 545f 5449 4d45 290a 4070 7974  RRENT_TIME).@pyt
+0000a430: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
+0000a440: 7269 7a65 280a 2020 2020 2274 6167 7322  rize(.    "tags"
+0000a450: 2c20 5b5b 7b22 656e 7622 3a20 226f 7665  , [[{"env": "ove
+0000a460: 7277 7269 7465 5f65 6e76 227d 2c20 7b22  rwrite_env"}, {"
+0000a470: 656e 7622 3a20 226f 7665 7277 7269 7465  env": "overwrite
+0000a480: 5f65 6e76 5f32 227d 5d2c 205b 7b7d 5d20  _env_2"}], [{}] 
+0000a490: 2a20 322c 204e 6f6e 655d 0a29 0a40 7079  * 2, None].).@py
+0000a4a0: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
+0000a4b0: 7472 697a 6528 2273 6f72 7422 2c20 5b46  trize("sort", [F
+0000a4c0: 616c 7365 2c20 5472 7565 5d29 0a40 7079  alse, True]).@py
+0000a4d0: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
+0000a4e0: 7472 697a 6528 0a20 2020 2022 7469 6d65  trize(.    "time
+0000a4f0: 7374 616d 7073 222c 205b 7064 2e44 6174  stamps", [pd.Dat
+0000a500: 6574 696d 6549 6e64 6578 285b 414e 4f54  etimeIndex([ANOT
+0000a510: 4845 525f 5449 4d45 2c20 534f 4d45 5f54  HER_TIME, SOME_T
+0000a520: 494d 455d 292c 205b 414e 4f54 4845 525f  IME]), [ANOTHER_
+0000a530: 5449 4d45 2c20 534f 4d45 5f54 494d 455d  TIME, SOME_TIME]
+0000a540: 2c20 4e6f 6e65 5d0a 290a 4070 7974 6573  , None].).@pytes
+0000a550: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+0000a560: 7a65 280a 2020 2020 2266 6565 6462 6163  ze(.    "feedbac
+0000a570: 6b73 222c 0a20 2020 205b 0a20 2020 2020  ks",.    [.     
+0000a580: 2020 205b 7b31 3030 3a20 2273 6f6d 652d     [{100: "some-
+0000a590: 7661 6c75 6522 7d2c 207b 3130 303a 2022  value"}, {100: "
+0000a5a0: 736f 6d65 2d6f 7468 6572 2d76 616c 7565  some-other-value
+0000a5b0: 227d 5d2c 0a20 2020 205d 2c0a 290a 406d  "}],.    ],.).@m
+0000a5c0: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
+0000a5d0: 792e 6c6f 6767 6572 2e65 7665 6e74 5f62  y.logger.event_b
+0000a5e0: 7569 6c64 6572 2e75 7569 642e 7575 6964  uilder.uuid.uuid
+0000a5f0: 3422 290a 6465 6620 7465 7374 5f6c 6f67  4").def test_log
+0000a600: 5f66 6565 6462 6163 6b5f 6576 656e 7473  _feedback_events
+0000a610: 286d 6f63 6b5f 7575 6964 2c20 6665 6564  (mock_uuid, feed
+0000a620: 6261 636b 732c 2074 696d 6573 7461 6d70  backs, timestamp
+0000a630: 732c 2073 6f72 742c 2074 6167 732c 2063  s, sort, tags, c
+0000a640: 6c69 5f6f 626a 293a 0a20 2020 206d 6f63  li_obj):.    moc
+0000a650: 6b5f 7575 6964 2e72 6574 7572 6e5f 7661  k_uuid.return_va
+0000a660: 6c75 6520 3d20 2241 4243 4431 3233 3422  lue = "ABCD1234"
+0000a670: 0a0a 2020 2020 6173 7365 7274 2063 6c69  ..    assert cli
+0000a680: 5f6f 626a 2e5f 6c6f 675f 6665 6564 6261  _obj._log_feedba
+0000a690: 636b 5f65 7665 6e74 7328 0a20 2020 2020  ck_events(.     
+0000a6a0: 2020 2061 7070 6c69 6361 7469 6f6e 3d22     application="
+0000a6b0: 666f 6f62 6172 222c 0a20 2020 2020 2020  foobar",.       
+0000a6c0: 2066 6565 6462 6163 6b73 3d66 6565 6462   feedbacks=feedb
+0000a6d0: 6163 6b73 2c0a 2020 2020 2020 2020 6a6f  acks,.        jo
+0000a6e0: 696e 5f6b 6579 733d 5b22 3132 3334 3522  in_keys=["12345"
+0000a6f0: 2c20 2236 3738 3930 225d 2c0a 2020 2020  , "67890"],.    
+0000a700: 2020 2020 6665 6564 6261 636b 5f76 6572      feedback_ver
+0000a710: 7369 6f6e 3d31 302c 0a20 2020 2020 2020  sion=10,.       
+0000a720: 2074 696d 6573 7461 6d70 733d 7469 6d65   timestamps=time
+0000a730: 7374 616d 7073 2c0a 2020 2020 2020 2020  stamps,.        
+0000a740: 736f 7274 5f6f 6e5f 7469 6d65 7374 616d  sort_on_timestam
+0000a750: 703d 736f 7274 2c0a 2020 2020 2020 2020  p=sort,.        
+0000a760: 6173 5f62 6174 6368 3d46 616c 7365 2c0a  as_batch=False,.
+0000a770: 2020 2020 2020 2020 7461 6773 3d74 6167          tags=tag
+0000a780: 732c 0a20 2020 2029 203d 3d20 284e 6f6e  s,.    ) == (Non
+0000a790: 652c 205b 2231 3233 3435 222c 2022 3637  e, ["12345", "67
+0000a7a0: 3839 3022 5d29 0a20 2020 2065 7665 6e74  890"]).    event
+0000a7b0: 7320 3d20 5b0a 2020 2020 2020 2020 7b0a  s = [.        {.
+0000a7c0: 2020 2020 2020 2020 2020 2020 2262 6174              "bat
+0000a7d0: 6368 5f69 6422 3a20 4e6f 6e65 2c0a 2020  ch_id": None,.  
+0000a7e0: 2020 2020 2020 2020 2020 2265 7665 6e74            "event
+0000a7f0: 5f69 6422 3a20 2241 4243 4431 3233 3422  _id": "ABCD1234"
+0000a800: 2c0a 2020 2020 2020 2020 2020 2020 2266  ,.            "f
+0000a810: 6565 6462 6163 6b22 3a20 7b31 3030 3a20  eedback": {100: 
+0000a820: 2273 6f6d 652d 6f74 6865 722d 7661 6c75  "some-other-valu
+0000a830: 6522 7d2c 0a20 2020 2020 2020 2020 2020  e"},.           
+0000a840: 2022 6665 6564 6261 636b 5f69 6422 3a20   "feedback_id": 
+0000a850: 2236 3738 3930 222c 0a20 2020 2020 2020  "67890",.       
+0000a860: 2020 2020 2022 6c6f 675f 7469 6d65 7374       "log_timest
+0000a870: 616d 7022 3a20 4355 5252 454e 545f 5449  amp": CURRENT_TI
+0000a880: 4d45 5f53 5452 2c0a 2020 2020 2020 2020  ME_STR,.        
+0000a890: 2020 2020 226d 6574 6164 6174 6122 3a20      "metadata": 
+0000a8a0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0000a8b0: 2020 2266 6565 6462 6163 6b5f 7665 7273    "feedback_vers
+0000a8c0: 696f 6e22 3a20 3130 2c0a 2020 2020 2020  ion": 10,.      
+0000a8d0: 2020 2020 2020 2020 2020 2266 756e 635f            "func_
+0000a8e0: 6e61 6d65 223a 2022 666f 6f62 6172 222c  name": "foobar",
+0000a8f0: 0a20 2020 2020 2020 2020 2020 207d 2c0a  .            },.
+0000a900: 2020 2020 2020 2020 2020 2020 2274 696d              "tim
+0000a910: 6573 7461 6d70 223a 2053 4f4d 455f 5449  estamp": SOME_TI
+0000a920: 4d45 5f53 5452 2069 6620 7469 6d65 7374  ME_STR if timest
+0000a930: 616d 7073 2069 7320 6e6f 7420 4e6f 6e65  amps is not None
+0000a940: 2065 6c73 6520 4355 5252 454e 545f 5449   else CURRENT_TI
+0000a950: 4d45 5f53 5452 2c0a 2020 2020 2020 2020  ME_STR,.        
+0000a960: 7d2c 0a20 2020 2020 2020 207b 0a20 2020  },.        {.   
+0000a970: 2020 2020 2020 2020 2022 6261 7463 685f           "batch_
+0000a980: 6964 223a 204e 6f6e 652c 0a20 2020 2020  id": None,.     
+0000a990: 2020 2020 2020 2022 6576 656e 745f 6964         "event_id
+0000a9a0: 223a 2022 4142 4344 3132 3334 222c 0a20  ": "ABCD1234",. 
+0000a9b0: 2020 2020 2020 2020 2020 2022 6665 6564             "feed
+0000a9c0: 6261 636b 223a 207b 3130 303a 2022 736f  back": {100: "so
+0000a9d0: 6d65 2d76 616c 7565 227d 2c0a 2020 2020  me-value"},.    
+0000a9e0: 2020 2020 2020 2020 2266 6565 6462 6163          "feedbac
+0000a9f0: 6b5f 6964 223a 2022 3132 3334 3522 2c0a  k_id": "12345",.
+0000aa00: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
+0000aa10: 5f74 696d 6573 7461 6d70 223a 2043 5552  _timestamp": CUR
+0000aa20: 5245 4e54 5f54 494d 455f 5354 522c 0a20  RENT_TIME_STR,. 
+0000aa30: 2020 2020 2020 2020 2020 2022 6d65 7461             "meta
+0000aa40: 6461 7461 223a 207b 0a20 2020 2020 2020  data": {.       
+0000aa50: 2020 2020 2020 2020 2022 6665 6564 6261           "feedba
+0000aa60: 636b 5f76 6572 7369 6f6e 223a 2031 302c  ck_version": 10,
+0000aa70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000aa80: 2022 6675 6e63 5f6e 616d 6522 3a20 2266   "func_name": "f
+0000aa90: 6f6f 6261 7222 2c0a 2020 2020 2020 2020  oobar",.        
+0000aaa0: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+0000aab0: 2020 2022 7469 6d65 7374 616d 7022 3a20     "timestamp": 
+0000aac0: 414e 4f54 4845 525f 5449 4d45 5f53 5452  ANOTHER_TIME_STR
+0000aad0: 2069 6620 7469 6d65 7374 616d 7073 2069   if timestamps i
+0000aae0: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
+0000aaf0: 4355 5252 454e 545f 5449 4d45 5f53 5452  CURRENT_TIME_STR
+0000ab00: 2c0a 2020 2020 2020 2020 7d2c 0a20 2020  ,.        },.   
+0000ab10: 205d 0a0a 2020 2020 6966 2074 696d 6573   ]..    if times
+0000ab20: 7461 6d70 7320 6973 206e 6f74 204e 6f6e  tamps is not Non
+0000ab30: 653a 0a20 2020 2020 2020 2065 7870 6563  e:.        expec
+0000ab40: 7465 645f 6576 656e 7473 203d 205b 6576  ted_events = [ev
+0000ab50: 656e 7473 5b31 5d2c 2065 7665 6e74 735b  ents[1], events[
+0000ab60: 305d 5d20 6966 206e 6f74 2073 6f72 7420  0]] if not sort 
+0000ab70: 656c 7365 205b 6576 656e 7473 5b30 5d2c  else [events[0],
+0000ab80: 2065 7665 6e74 735b 315d 5d0a 2020 2020   events[1]].    
+0000ab90: 656c 7365 3a0a 2020 2020 2020 2020 6578  else:.        ex
+0000aba0: 7065 6374 6564 5f65 7665 6e74 7320 3d20  pected_events = 
+0000abb0: 5b65 7665 6e74 735b 315d 2c20 6576 656e  [events[1], even
+0000abc0: 7473 5b30 5d5d 0a0a 2020 2020 6173 7365  ts[0]]..    asse
+0000abd0: 7274 2063 6c69 5f6f 626a 2e6c 6f67 5f73  rt cli_obj.log_s
+0000abe0: 746f 7265 2e6c 6f67 7320 3d3d 205b 0a20  tore.logs == [. 
+0000abf0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+0000ac00: 2020 2020 2022 6576 656e 7473 223a 2065       "events": e
+0000ac10: 7870 6563 7465 645f 6576 656e 7473 2c0a  xpected_events,.
+0000ac20: 2020 2020 2020 2020 2020 2020 2261 7070              "app
+0000ac30: 6c69 6361 7469 6f6e 223a 2022 666f 6f62  lication": "foob
+0000ac40: 6172 222c 0a20 2020 2020 2020 207d 0a20  ar",.        }. 
+0000ac50: 2020 205d 0a0a 0a23 2054 4f44 4f20 2d3e     ]...# TODO ->
+0000ac60: 2061 6464 206e 702e 6e64 6172 7261 7973   add np.ndarrays
+0000ac70: 2061 7320 706f 7373 6962 6c65 2069 6e70   as possible inp
+0000ac80: 7574 732f 6f75 7470 7574 7320 7661 6c75  uts/outputs valu
+0000ac90: 6573 0a40 6672 6565 7a65 5f74 696d 6528  es.@freeze_time(
+0000aca0: 4355 5252 454e 545f 5449 4d45 290a 4070  CURRENT_TIME).@p
+0000acb0: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+0000acc0: 6574 7269 7a65 280a 2020 2020 2274 6167  etrize(.    "tag
+0000acd0: 7322 2c20 5b5b 7b22 656e 7622 3a20 226f  s", [[{"env": "o
+0000ace0: 7665 7277 7269 7465 5f65 6e76 227d 2c20  verwrite_env"}, 
+0000acf0: 7b22 656e 7622 3a20 226f 7665 7277 7269  {"env": "overwri
+0000ad00: 7465 5f65 6e76 5f32 227d 5d2c 205b 7b7d  te_env_2"}], [{}
+0000ad10: 5d20 2a20 322c 204e 6f6e 655d 0a29 0a40  ] * 2, None].).@
+0000ad20: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+0000ad30: 6d65 7472 697a 6528 2273 6f72 7422 2c20  metrize("sort", 
+0000ad40: 5b46 616c 7365 2c20 5472 7565 5d29 0a40  [False, True]).@
+0000ad50: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+0000ad60: 6d65 7472 697a 6528 0a20 2020 2022 7469  metrize(.    "ti
+0000ad70: 6d65 7374 616d 7073 222c 205b 7064 2e44  mestamps", [pd.D
+0000ad80: 6174 6574 696d 6549 6e64 6578 285b 414e  atetimeIndex([AN
+0000ad90: 4f54 4845 525f 5449 4d45 2c20 534f 4d45  OTHER_TIME, SOME
+0000ada0: 5f54 494d 455d 292c 205b 414e 4f54 4845  _TIME]), [ANOTHE
+0000adb0: 525f 5449 4d45 2c20 534f 4d45 5f54 494d  R_TIME, SOME_TIM
+0000adc0: 455d 2c20 4e6f 6e65 5d0a 290a 4070 7974  E], None].).@pyt
+0000add0: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
+0000ade0: 7269 7a65 280a 2020 2020 226f 7574 7075  rize(.    "outpu
+0000adf0: 7473 222c 0a20 2020 205b 0a20 2020 2020  ts",.    [.     
+0000ae00: 2020 205b 7b22 4322 3a20 3330 307d 2c20     [{"C": 300}, 
+0000ae10: 7b22 4322 3a20 3330 337d 5d2c 0a20 2020  {"C": 303}],.   
+0000ae20: 205d 2c0a 290a 4070 7974 6573 742e 6d61   ],.).@pytest.ma
+0000ae30: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
+0000ae40: 2020 2020 2269 6e70 7574 7322 2c0a 2020      "inputs",.  
+0000ae50: 2020 5b0a 2020 2020 2020 2020 5b7b 2241    [.        [{"A
+0000ae60: 223a 2031 3030 2c20 2242 223a 2032 3030  ": 100, "B": 200
+0000ae70: 7d2c 207b 2241 223a 2031 3031 2c20 2242  }, {"A": 101, "B
+0000ae80: 223a 2032 3032 7d5d 2c0a 2020 2020 5d2c  ": 202}],.    ],
+0000ae90: 0a29 0a40 6d6f 636b 2e70 6174 6368 2822  .).@mock.patch("
+0000aea0: 6761 6e74 7279 2e6c 6f67 6765 722e 6576  gantry.logger.ev
+0000aeb0: 656e 745f 6275 696c 6465 722e 7575 6964  ent_builder.uuid
+0000aec0: 2e75 7569 6434 2229 0a64 6566 2074 6573  .uuid4").def tes
+0000aed0: 745f 6c6f 675f 7072 6564 6963 7469 6f6e  t_log_prediction
+0000aee0: 5f65 7665 6e74 7328 6d6f 636b 5f75 7569  _events(mock_uui
+0000aef0: 642c 2069 6e70 7574 732c 206f 7574 7075  d, inputs, outpu
+0000af00: 7473 2c20 7469 6d65 7374 616d 7073 2c20  ts, timestamps, 
+0000af10: 736f 7274 2c20 7461 6773 2c20 636c 695f  sort, tags, cli_
+0000af20: 6f62 6a29 3a0a 2020 2020 6d6f 636b 5f75  obj):.    mock_u
+0000af30: 7569 642e 7265 7475 726e 5f76 616c 7565  uid.return_value
+0000af40: 203d 2022 4142 4344 3132 3334 220a 2020   = "ABCD1234".  
+0000af50: 2020 6173 7365 7274 2063 6c69 5f6f 626a    assert cli_obj
+0000af60: 2e5f 6c6f 675f 7072 6564 6963 7469 6f6e  ._log_prediction
+0000af70: 5f65 7665 6e74 7328 0a20 2020 2020 2020  _events(.       
+0000af80: 2061 7070 6c69 6361 7469 6f6e 3d22 666f   application="fo
+0000af90: 6f62 6172 222c 0a20 2020 2020 2020 2069  obar",.        i
+0000afa0: 6e70 7574 733d 696e 7075 7473 2c0a 2020  nputs=inputs,.  
+0000afb0: 2020 2020 2020 6f75 7470 7574 733d 6f75        outputs=ou
+0000afc0: 7470 7574 732c 0a20 2020 2020 2020 206a  tputs,.        j
+0000afd0: 6f69 6e5f 6b65 7973 3d5b 2231 3233 3435  oin_keys=["12345
+0000afe0: 222c 2022 3637 3839 3022 5d2c 0a20 2020  ", "67890"],.   
+0000aff0: 2020 2020 2069 676e 6f72 655f 696e 7075       ignore_inpu
+0000b000: 7473 3d5b 2242 225d 2c0a 2020 2020 2020  ts=["B"],.      
+0000b010: 2020 7665 7273 696f 6e3d 3130 2c0a 2020    version=10,.  
+0000b020: 2020 2020 2020 7469 6d65 7374 616d 7073        timestamps
+0000b030: 3d74 696d 6573 7461 6d70 732c 0a20 2020  =timestamps,.   
+0000b040: 2020 2020 2073 6f72 745f 6f6e 5f74 696d       sort_on_tim
+0000b050: 6573 7461 6d70 3d73 6f72 742c 0a20 2020  estamp=sort,.   
+0000b060: 2020 2020 2061 735f 6261 7463 683d 4661       as_batch=Fa
+0000b070: 6c73 652c 0a20 2020 2020 2020 2074 6167  lse,.        tag
+0000b080: 733d 7461 6773 2c0a 2020 2020 2920 3d3d  s=tags,.    ) ==
+0000b090: 2028 4e6f 6e65 2c20 5b22 3132 3334 3522   (None, ["12345"
+0000b0a0: 2c20 2236 3738 3930 225d 290a 0a20 2020  , "67890"])..   
+0000b0b0: 2065 7665 6e74 7320 3d20 5b0a 2020 2020   events = [.    
+0000b0c0: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+0000b0d0: 2020 2262 6174 6368 5f69 6422 3a20 4e6f    "batch_id": No
+0000b0e0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+0000b0f0: 2265 7665 6e74 5f69 6422 3a20 2241 4243  "event_id": "ABC
+0000b100: 4431 3233 3422 2c0a 2020 2020 2020 2020  D1234",.        
+0000b110: 2020 2020 2266 6565 6462 6163 6b5f 6964      "feedback_id
+0000b120: 223a 2022 3637 3839 3022 2c0a 2020 2020  ": "67890",.    
+0000b130: 2020 2020 2020 2020 2269 6e70 7574 7322          "inputs"
+0000b140: 3a20 7b22 4122 3a20 3130 317d 2c0a 2020  : {"A": 101},.  
+0000b150: 2020 2020 2020 2020 2020 226c 6f67 5f74            "log_t
+0000b160: 696d 6573 7461 6d70 223a 2043 5552 5245  imestamp": CURRE
+0000b170: 4e54 5f54 494d 455f 5354 522c 0a20 2020  NT_TIME_STR,.   
+0000b180: 2020 2020 2020 2020 2022 6d65 7461 6461           "metada
+0000b190: 7461 223a 207b 0a20 2020 2020 2020 2020  ta": {.         
+0000b1a0: 2020 2020 2020 2022 6665 6564 6261 636b         "feedback
+0000b1b0: 5f6b 6579 7322 3a20 4e6f 6e65 2c0a 2020  _keys": None,.  
+0000b1c0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+0000b1d0: 756e 635f 6e61 6d65 223a 2022 666f 6f62  unc_name": "foob
+0000b1e0: 6172 222c 0a20 2020 2020 2020 2020 2020  ar",.           
+0000b1f0: 2020 2020 2022 6967 6e6f 7265 5f69 6e70       "ignore_inp
+0000b200: 7574 7322 3a20 5b22 4222 5d2c 0a20 2020  uts": ["B"],.   
+0000b210: 2020 2020 2020 2020 2020 2020 2022 7665               "ve
+0000b220: 7273 696f 6e22 3a20 3130 2c0a 2020 2020  rsion": 10,.    
+0000b230: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+0000b240: 2020 2020 2020 2022 6f75 7470 7574 7322         "outputs"
+0000b250: 3a20 7b22 4322 3a20 3330 337d 2c0a 2020  : {"C": 303},.  
+0000b260: 2020 2020 2020 2020 2020 2274 6167 7322            "tags"
+0000b270: 3a20 7461 6773 5b31 5d20 6966 2074 6167  : tags[1] if tag
+0000b280: 7320 656c 7365 204e 6f6e 652c 0a20 2020  s else None,.   
+0000b290: 2020 2020 2020 2020 2022 7469 6d65 7374           "timest
+0000b2a0: 616d 7022 3a20 534f 4d45 5f54 494d 455f  amp": SOME_TIME_
+0000b2b0: 5354 5220 6966 2074 696d 6573 7461 6d70  STR if timestamp
+0000b2c0: 7320 6973 206e 6f74 204e 6f6e 6520 656c  s is not None el
+0000b2d0: 7365 2043 5552 5245 4e54 5f54 494d 455f  se CURRENT_TIME_
+0000b2e0: 5354 522c 0a20 2020 2020 2020 207d 2c0a  STR,.        },.
+0000b2f0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+0000b300: 2020 2020 2020 2262 6174 6368 5f69 6422        "batch_id"
+0000b310: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
+0000b320: 2020 2020 2265 7665 6e74 5f69 6422 3a20      "event_id": 
+0000b330: 2241 4243 4431 3233 3422 2c0a 2020 2020  "ABCD1234",.    
+0000b340: 2020 2020 2020 2020 2266 6565 6462 6163          "feedbac
+0000b350: 6b5f 6964 223a 2022 3132 3334 3522 2c0a  k_id": "12345",.
+0000b360: 2020 2020 2020 2020 2020 2020 2269 6e70              "inp
+0000b370: 7574 7322 3a20 7b22 4122 3a20 3130 307d  uts": {"A": 100}
+0000b380: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
+0000b390: 6f67 5f74 696d 6573 7461 6d70 223a 2043  og_timestamp": C
+0000b3a0: 5552 5245 4e54 5f54 494d 455f 5354 522c  URRENT_TIME_STR,
+0000b3b0: 0a20 2020 2020 2020 2020 2020 2022 6d65  .            "me
+0000b3c0: 7461 6461 7461 223a 207b 0a20 2020 2020  tadata": {.     
+0000b3d0: 2020 2020 2020 2020 2020 2022 6665 6564             "feed
+0000b3e0: 6261 636b 5f6b 6579 7322 3a20 4e6f 6e65  back_keys": None
+0000b3f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000b400: 2020 2266 756e 635f 6e61 6d65 223a 2022    "func_name": "
+0000b410: 666f 6f62 6172 222c 0a20 2020 2020 2020  foobar",.       
+0000b420: 2020 2020 2020 2020 2022 6967 6e6f 7265           "ignore
+0000b430: 5f69 6e70 7574 7322 3a20 5b22 4222 5d2c  _inputs": ["B"],
+0000b440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b450: 2022 7665 7273 696f 6e22 3a20 3130 2c0a   "version": 10,.
+0000b460: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+0000b470: 2020 2020 2020 2020 2020 2022 6f75 7470             "outp
+0000b480: 7574 7322 3a20 7b22 4322 3a20 3330 307d  uts": {"C": 300}
+0000b490: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+0000b4a0: 6167 7322 3a20 7461 6773 5b30 5d20 6966  ags": tags[0] if
+0000b4b0: 2074 6167 7320 656c 7365 204e 6f6e 652c   tags else None,
+0000b4c0: 0a20 2020 2020 2020 2020 2020 2022 7469  .            "ti
+0000b4d0: 6d65 7374 616d 7022 3a20 414e 4f54 4845  mestamp": ANOTHE
+0000b4e0: 525f 5449 4d45 5f53 5452 2069 6620 7469  R_TIME_STR if ti
+0000b4f0: 6d65 7374 616d 7073 2069 7320 6e6f 7420  mestamps is not 
+0000b500: 4e6f 6e65 2065 6c73 6520 4355 5252 454e  None else CURREN
+0000b510: 545f 5449 4d45 5f53 5452 2c0a 2020 2020  T_TIME_STR,.    
+0000b520: 2020 2020 7d2c 0a20 2020 205d 0a0a 2020      },.    ]..  
+0000b530: 2020 6966 2074 696d 6573 7461 6d70 7320    if timestamps 
+0000b540: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0000b550: 2020 2020 2065 7870 6563 7465 645f 6576       expected_ev
+0000b560: 656e 7473 203d 205b 6576 656e 7473 5b31  ents = [events[1
+0000b570: 5d2c 2065 7665 6e74 735b 305d 5d20 6966  ], events[0]] if
+0000b580: 206e 6f74 2073 6f72 7420 656c 7365 205b   not sort else [
+0000b590: 6576 656e 7473 5b30 5d2c 2065 7665 6e74  events[0], event
+0000b5a0: 735b 315d 5d0a 2020 2020 656c 7365 3a0a  s[1]].    else:.
+0000b5b0: 2020 2020 2020 2020 6578 7065 6374 6564          expected
+0000b5c0: 5f65 7665 6e74 7320 3d20 5b65 7665 6e74  _events = [event
+0000b5d0: 735b 315d 2c20 6576 656e 7473 5b30 5d5d  s[1], events[0]]
+0000b5e0: 0a0a 2020 2020 6173 7365 7274 2063 6c69  ..    assert cli
+0000b5f0: 5f6f 626a 2e6c 6f67 5f73 746f 7265 2e6c  _obj.log_store.l
+0000b600: 6f67 7320 3d3d 205b 0a20 2020 2020 2020  ogs == [.       
+0000b610: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+0000b620: 6576 656e 7473 223a 2065 7870 6563 7465  events": expecte
+0000b630: 645f 6576 656e 7473 2c0a 2020 2020 2020  d_events,.      
+0000b640: 2020 2020 2020 2261 7070 6c69 6361 7469        "applicati
+0000b650: 6f6e 223a 2022 666f 6f62 6172 222c 0a20  on": "foobar",. 
+0000b660: 2020 2020 2020 207d 0a20 2020 205d 0a0a         }.    ]..
+0000b670: 0a23 2054 4f44 4f20 2d3e 2072 6561 6464  .# TODO -> readd
+0000b680: 2074 6865 2061 735f 6261 7463 683d 5472   the as_batch=Tr
+0000b690: 7565 2074 6573 7473 0a0a 0a40 6672 6565  ue tests...@free
+0000b6a0: 7a65 5f74 696d 6528 4355 5252 454e 545f  ze_time(CURRENT_
+0000b6b0: 5449 4d45 290a 4070 7974 6573 742e 6d61  TIME).@pytest.ma
+0000b6c0: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
+0000b6d0: 2020 2020 2274 6167 7322 2c20 5b5b 7b22      "tags", [[{"
+0000b6e0: 656e 7622 3a20 226f 7665 7277 7269 7465  env": "overwrite
+0000b6f0: 5f65 6e76 227d 2c20 7b22 656e 7622 3a20  _env"}, {"env": 
+0000b700: 226f 7665 7277 7269 7465 5f65 6e76 5f32  "overwrite_env_2
+0000b710: 227d 5d2c 205b 7b7d 5d20 2a20 322c 204e  "}], [{}] * 2, N
+0000b720: 6f6e 655d 0a29 0a40 7079 7465 7374 2e6d  one].).@pytest.m
+0000b730: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+0000b740: 0a20 2020 2022 7469 6d65 7374 616d 7073  .    "timestamps
+0000b750: 222c 205b 4e6f 6e65 2c20 7064 2e44 6174  ", [None, pd.Dat
+0000b760: 6574 696d 6549 6e64 6578 285b 414e 4f54  etimeIndex([ANOT
+0000b770: 4845 525f 5449 4d45 2c20 534f 4d45 5f54  HER_TIME, SOME_T
+0000b780: 494d 455d 292c 205b 414e 4f54 4845 525f  IME]), [ANOTHER_
+0000b790: 5449 4d45 2c20 534f 4d45 5f54 494d 455d  TIME, SOME_TIME]
+0000b7a0: 5d0a 290a 4070 7974 6573 742e 6d61 726b  ].).@pytest.mark
+0000b7b0: 2e70 6172 616d 6574 7269 7a65 2822 736f  .parametrize("so
+0000b7c0: 7274 222c 205b 4661 6c73 652c 2054 7275  rt", [False, Tru
+0000b7d0: 655d 290a 4070 7974 6573 742e 6d61 726b  e]).@pytest.mark
+0000b7e0: 2e70 6172 616d 6574 7269 7a65 2822 7665  .parametrize("ve
+0000b7f0: 7273 696f 6e22 2c20 5b22 3022 2c20 302c  rsion", ["0", 0,
+0000b800: 204e 6f6e 655d 290a 4070 7974 6573 742e   None]).@pytest.
+0000b810: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
+0000b820: 2822 6173 5f62 6174 6368 222c 205b 4661  ("as_batch", [Fa
+0000b830: 6c73 652c 2054 7275 655d 290a 4070 7974  lse, True]).@pyt
+0000b840: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
+0000b850: 7269 7a65 280a 2020 2020 2274 6573 745f  rize(.    "test_
+0000b860: 6665 6564 6261 636b 7322 2c0a 2020 2020  feedbacks",.    
+0000b870: 5b0a 2020 2020 2020 2020 5b7b 2241 223a  [.        [{"A":
+0000b880: 2032 3030 7d2c 207b 2241 223a 2032 3031   200}, {"A": 201
+0000b890: 7d5d 2c0a 2020 2020 5d2c 0a29 0a40 7079  }],.    ],.).@py
+0000b8a0: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
+0000b8b0: 7472 697a 6528 0a20 2020 2022 7465 7374  trize(.    "test
+0000b8c0: 5f6f 7574 7075 7473 222c 0a20 2020 205b  _outputs",.    [
+0000b8d0: 0a20 2020 2020 2020 205b 7b22 4222 3a20  .        [{"B": 
+0000b8e0: 3330 307d 2c20 7b22 4222 3a20 3330 317d  300}, {"B": 301}
+0000b8f0: 5d2c 0a20 2020 205d 2c0a 290a 4070 7974  ],.    ],.).@pyt
+0000b900: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
+0000b910: 7269 7a65 280a 2020 2020 2274 6573 745f  rize(.    "test_
+0000b920: 696e 7075 7473 222c 0a20 2020 205b 0a20  inputs",.    [. 
+0000b930: 2020 2020 2020 205b 7b22 4122 3a20 3130         [{"A": 10
+0000b940: 307d 2c20 7b22 4122 3a20 3130 317d 5d2c  0}, {"A": 101}],
+0000b950: 0a20 2020 205d 2c0a 290a 406d 6f63 6b2e  .    ],.).@mock.
+0000b960: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
+0000b970: 6767 6572 2e65 7665 6e74 5f62 7569 6c64  gger.event_build
+0000b980: 6572 2e75 7569 642e 7575 6964 3422 290a  er.uuid.uuid4").
+0000b990: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
+0000b9a0: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
+0000b9b0: 742e 4761 6e74 7279 2e5f 7570 6c6f 6164  t.Gantry._upload
+0000b9c0: 5f64 6174 615f 6173 5f62 6174 6368 2229  _data_as_batch")
+0000b9d0: 0a64 6566 2074 6573 745f 6c6f 675f 7072  .def test_log_pr
+0000b9e0: 6564 6963 7469 6f6e 5f61 6e64 5f66 6565  ediction_and_fee
+0000b9f0: 6462 6163 6b5f 6576 656e 7473 280a 2020  dback_events(.  
+0000ba00: 2020 6d6f 636b 5f75 706c 6f61 645f 6461    mock_upload_da
+0000ba10: 7461 5f61 735f 6261 7463 682c 0a20 2020  ta_as_batch,.   
+0000ba20: 206d 6f63 6b5f 7575 6964 2c0a 2020 2020   mock_uuid,.    
+0000ba30: 7465 7374 5f69 6e70 7574 732c 0a20 2020  test_inputs,.   
+0000ba40: 2074 6573 745f 6f75 7470 7574 732c 0a20   test_outputs,. 
+0000ba50: 2020 2074 6573 745f 6665 6564 6261 636b     test_feedback
+0000ba60: 732c 0a20 2020 2061 735f 6261 7463 682c  s,.    as_batch,
+0000ba70: 0a20 2020 2076 6572 7369 6f6e 2c0a 2020  .    version,.  
+0000ba80: 2020 736f 7274 2c0a 2020 2020 7469 6d65    sort,.    time
+0000ba90: 7374 616d 7073 2c0a 2020 2020 7461 6773  stamps,.    tags
+0000baa0: 2c0a 2020 2020 636c 695f 6f62 6a2c 0a20  ,.    cli_obj,. 
+0000bab0: 2020 206c 6f67 5f73 746f 7265 2c0a 293a     log_store,.):
+0000bac0: 0a20 2020 206d 6f63 6b5f 7570 6c6f 6164  .    mock_upload
+0000bad0: 5f64 6174 615f 6173 5f62 6174 6368 2e72  _data_as_batch.r
+0000bae0: 6574 7572 6e5f 7661 6c75 6520 3d20 4e6f  eturn_value = No
+0000baf0: 6e65 0a20 2020 206d 6f63 6b5f 7575 6964  ne.    mock_uuid
+0000bb00: 2e73 6964 655f 6566 6665 6374 203d 205b  .side_effect = [
+0000bb10: 2241 4243 4431 222c 2022 4142 4344 3222  "ABCD1", "ABCD2"
+0000bb20: 2c20 2241 4243 4433 222c 2022 4142 4344  , "ABCD3", "ABCD
+0000bb30: 3422 5d0a 2020 2020 636c 695f 6f62 6a2e  4"].    cli_obj.
+0000bb40: 5f6c 6f67 5f70 7265 6469 6374 696f 6e5f  _log_prediction_
+0000bb50: 616e 645f 6665 6564 6261 636b 5f65 7665  and_feedback_eve
+0000bb60: 6e74 7328 0a20 2020 2020 2020 2061 7070  nts(.        app
+0000bb70: 6c69 6361 7469 6f6e 3d22 666f 6f62 6172  lication="foobar
+0000bb80: 222c 0a20 2020 2020 2020 2076 6572 7369  ",.        versi
+0000bb90: 6f6e 3d76 6572 7369 6f6e 2c0a 2020 2020  on=version,.    
+0000bba0: 2020 2020 696e 7075 7473 3d74 6573 745f      inputs=test_
+0000bbb0: 696e 7075 7473 2c0a 2020 2020 2020 2020  inputs,.        
+0000bbc0: 6f75 7470 7574 733d 7465 7374 5f6f 7574  outputs=test_out
+0000bbd0: 7075 7473 2c0a 2020 2020 2020 2020 6a6f  puts,.        jo
+0000bbe0: 696e 5f6b 6579 733d 5b22 3132 3334 3522  in_keys=["12345"
+0000bbf0: 2c20 2236 3738 3930 225d 2c0a 2020 2020  , "67890"],.    
+0000bc00: 2020 2020 6665 6564 6261 636b 733d 7465      feedbacks=te
+0000bc10: 7374 5f66 6565 6462 6163 6b73 2c0a 2020  st_feedbacks,.  
+0000bc20: 2020 2020 2020 7469 6d65 7374 616d 7073        timestamps
+0000bc30: 3d74 696d 6573 7461 6d70 732c 0a20 2020  =timestamps,.   
+0000bc40: 2020 2020 2073 6f72 745f 6f6e 5f74 696d       sort_on_tim
+0000bc50: 6573 7461 6d70 3d73 6f72 742c 0a20 2020  estamp=sort,.   
+0000bc60: 2020 2020 2061 735f 6261 7463 683d 6173       as_batch=as
+0000bc70: 5f62 6174 6368 2c0a 2020 2020 2020 2020  _batch,.        
+0000bc80: 7461 6773 3d74 6167 732c 0a20 2020 2029  tags=tags,.    )
+0000bc90: 0a0a 2020 2020 6576 656e 745f 3120 3d20  ..    event_1 = 
+0000bca0: 7b0a 2020 2020 2020 2020 2265 7665 6e74  {.        "event
+0000bcb0: 5f69 6422 3a20 2241 4243 4432 2220 6966  _id": "ABCD2" if
+0000bcc0: 206e 6f74 2028 736f 7274 2061 6e64 2074   not (sort and t
+0000bcd0: 696d 6573 7461 6d70 7320 6973 206e 6f74  imestamps is not
+0000bce0: 204e 6f6e 6529 2065 6c73 6520 2241 4243   None) else "ABC
+0000bcf0: 4434 222c 0a20 2020 2020 2020 2022 6c6f  D4",.        "lo
+0000bd00: 675f 7469 6d65 7374 616d 7022 3a20 4355  g_timestamp": CU
+0000bd10: 5252 454e 545f 5449 4d45 5f53 5452 2c0a  RRENT_TIME_STR,.
+0000bd20: 2020 2020 2020 2020 2274 696d 6573 7461          "timesta
+0000bd30: 6d70 223a 2041 4e4f 5448 4552 5f54 494d  mp": ANOTHER_TIM
+0000bd40: 455f 5354 5220 6966 2074 696d 6573 7461  E_STR if timesta
+0000bd50: 6d70 7320 6973 206e 6f74 204e 6f6e 6520  mps is not None 
+0000bd60: 656c 7365 2043 5552 5245 4e54 5f54 494d  else CURRENT_TIM
+0000bd70: 455f 5354 522c 0a20 2020 2020 2020 2022  E_STR,.        "
+0000bd80: 6d65 7461 6461 7461 223a 207b 0a20 2020  metadata": {.   
+0000bd90: 2020 2020 2020 2020 2022 6675 6e63 5f6e           "func_n
+0000bda0: 616d 6522 3a20 2266 6f6f 6261 7222 2c0a  ame": "foobar",.
+0000bdb0: 2020 2020 2020 2020 2020 2020 2276 6572              "ver
+0000bdc0: 7369 6f6e 223a 2076 6572 7369 6f6e 2c0a  sion": version,.
+0000bdd0: 2020 2020 2020 2020 2020 2020 2266 6565              "fee
+0000bde0: 6462 6163 6b5f 6b65 7973 223a 204e 6f6e  dback_keys": Non
+0000bdf0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+0000be00: 6967 6e6f 7265 5f69 6e70 7574 7322 3a20  ignore_inputs": 
+0000be10: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+0000be20: 2020 2266 6565 6462 6163 6b5f 7665 7273    "feedback_vers
+0000be30: 696f 6e22 3a20 7665 7273 696f 6e2c 0a20  ion": version,. 
+0000be40: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+0000be50: 2020 2269 6e70 7574 7322 3a20 7b22 4122    "inputs": {"A"
+0000be60: 3a20 3130 307d 2c0a 2020 2020 2020 2020  : 100},.        
+0000be70: 226f 7574 7075 7473 223a 207b 2242 223a  "outputs": {"B":
+0000be80: 2033 3030 7d2c 0a20 2020 2020 2020 2022   300},.        "
+0000be90: 6665 6564 6261 636b 5f69 6422 3a20 2231  feedback_id": "1
+0000bea0: 3233 3435 222c 0a20 2020 2020 2020 2022  2345",.        "
+0000beb0: 7461 6773 223a 2074 6167 735b 305d 2069  tags": tags[0] i
+0000bec0: 6620 7461 6773 2065 6c73 6520 4e6f 6e65  f tags else None
+0000bed0: 2c0a 2020 2020 2020 2020 2262 6174 6368  ,.        "batch
+0000bee0: 5f69 6422 3a20 4e6f 6e65 2c0a 2020 2020  _id": None,.    
+0000bef0: 2020 2020 2266 6565 6462 6163 6b22 3a20      "feedback": 
+0000bf00: 7b22 4122 3a20 3230 307d 2c0a 2020 2020  {"A": 200},.    
+0000bf10: 7d0a 0a20 2020 2065 7665 6e74 5f32 203d  }..    event_2 =
+0000bf20: 207b 0a20 2020 2020 2020 2022 6576 656e   {.        "even
+0000bf30: 745f 6964 223a 2022 4142 4344 3422 2069  t_id": "ABCD4" i
+0000bf40: 6620 6e6f 7420 2873 6f72 7420 616e 6420  f not (sort and 
+0000bf50: 7469 6d65 7374 616d 7073 2069 7320 6e6f  timestamps is no
+0000bf60: 7420 4e6f 6e65 2920 656c 7365 2022 4142  t None) else "AB
+0000bf70: 4344 3222 2c0a 2020 2020 2020 2020 226c  CD2",.        "l
+0000bf80: 6f67 5f74 696d 6573 7461 6d70 223a 2043  og_timestamp": C
+0000bf90: 5552 5245 4e54 5f54 494d 455f 5354 522c  URRENT_TIME_STR,
+0000bfa0: 0a20 2020 2020 2020 2022 7469 6d65 7374  .        "timest
+0000bfb0: 616d 7022 3a20 534f 4d45 5f54 494d 455f  amp": SOME_TIME_
+0000bfc0: 5354 5220 6966 2074 696d 6573 7461 6d70  STR if timestamp
+0000bfd0: 7320 6973 206e 6f74 204e 6f6e 6520 656c  s is not None el
+0000bfe0: 7365 2043 5552 5245 4e54 5f54 494d 455f  se CURRENT_TIME_
+0000bff0: 5354 522c 0a20 2020 2020 2020 2022 6d65  STR,.        "me
+0000c000: 7461 6461 7461 223a 207b 0a20 2020 2020  tadata": {.     
+0000c010: 2020 2020 2020 2022 6675 6e63 5f6e 616d         "func_nam
+0000c020: 6522 3a20 2266 6f6f 6261 7222 2c0a 2020  e": "foobar",.  
+0000c030: 2020 2020 2020 2020 2020 2276 6572 7369            "versi
+0000c040: 6f6e 223a 2076 6572 7369 6f6e 2c0a 2020  on": version,.  
+0000c050: 2020 2020 2020 2020 2020 2266 6565 6462            "feedb
+0000c060: 6163 6b5f 6b65 7973 223a 204e 6f6e 652c  ack_keys": None,
+0000c070: 0a20 2020 2020 2020 2020 2020 2022 6967  .            "ig
+0000c080: 6e6f 7265 5f69 6e70 7574 7322 3a20 4e6f  nore_inputs": No
+0000c090: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+0000c0a0: 2266 6565 6462 6163 6b5f 7665 7273 696f  "feedback_versio
+0000c0b0: 6e22 3a20 7665 7273 696f 6e2c 0a20 2020  n": version,.   
+0000c0c0: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
+0000c0d0: 2269 6e70 7574 7322 3a20 7b22 4122 3a20  "inputs": {"A": 
+0000c0e0: 3130 317d 2c0a 2020 2020 2020 2020 226f  101},.        "o
+0000c0f0: 7574 7075 7473 223a 207b 2242 223a 2033  utputs": {"B": 3
+0000c100: 3031 7d2c 0a20 2020 2020 2020 2022 6665  01},.        "fe
+0000c110: 6564 6261 636b 5f69 6422 3a20 2236 3738  edback_id": "678
+0000c120: 3930 222c 0a20 2020 2020 2020 2022 7461  90",.        "ta
+0000c130: 6773 223a 2074 6167 735b 315d 2069 6620  gs": tags[1] if 
+0000c140: 7461 6773 2065 6c73 6520 4e6f 6e65 2c0a  tags else None,.
+0000c150: 2020 2020 2020 2020 2262 6174 6368 5f69          "batch_i
+0000c160: 6422 3a20 4e6f 6e65 2c0a 2020 2020 2020  d": None,.      
+0000c170: 2020 2266 6565 6462 6163 6b22 3a20 7b22    "feedback": {"
+0000c180: 4122 3a20 3230 317d 2c0a 2020 2020 7d0a  A": 201},.    }.
+0000c190: 0a20 2020 2069 6620 6173 5f62 6174 6368  .    if as_batch
+0000c1a0: 3a0a 2020 2020 2020 2020 6d6f 636b 5f75  :.        mock_u
+0000c1b0: 706c 6f61 645f 6461 7461 5f61 735f 6261  pload_data_as_ba
+0000c1c0: 7463 682e 6173 7365 7274 5f63 616c 6c65  tch.assert_calle
+0000c1d0: 645f 6f6e 6365 5f77 6974 6828 0a20 2020  d_once_with(.   
+0000c1e0: 2020 2020 2020 2020 2022 666f 6f62 6172           "foobar
+0000c1f0: 222c 0a20 2020 2020 2020 2020 2020 2076  ",.            v
+0000c200: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
+0000c210: 2020 2020 5b65 7665 6e74 5f31 2c20 6576      [event_1, ev
+0000c220: 656e 745f 325d 2069 6620 6e6f 7420 2873  ent_2] if not (s
+0000c230: 6f72 7420 616e 6420 7469 6d65 7374 616d  ort and timestam
+0000c240: 7073 2069 7320 6e6f 7420 4e6f 6e65 2920  ps is not None) 
+0000c250: 656c 7365 205b 6576 656e 745f 322c 2065  else [event_2, e
+0000c260: 7665 6e74 5f31 5d2c 0a20 2020 2020 2020  vent_1],.       
+0000c270: 2020 2020 2042 6174 6368 5479 7065 2e52       BatchType.R
+0000c280: 4543 4f52 442c 0a20 2020 2020 2020 2029  ECORD,.        )
+0000c290: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+0000c2a0: 2020 2061 7373 6572 7420 6c6f 675f 7374     assert log_st
+0000c2b0: 6f72 652e 6c6f 6773 203d 3d20 5b0a 2020  ore.logs == [.  
+0000c2c0: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
+0000c2d0: 2020 2020 2020 2020 2020 2020 2265 7665              "eve
+0000c2e0: 6e74 7322 3a20 5b65 7665 6e74 5f31 2c20  nts": [event_1, 
+0000c2f0: 6576 656e 745f 325d 0a20 2020 2020 2020  event_2].       
+0000c300: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0000c310: 2873 6f72 7420 616e 6420 7469 6d65 7374  (sort and timest
+0000c320: 616d 7073 2069 7320 6e6f 7420 4e6f 6e65  amps is not None
+0000c330: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000c340: 2020 656c 7365 205b 6576 656e 745f 322c    else [event_2,
+0000c350: 2065 7665 6e74 5f31 5d2c 0a20 2020 2020   event_1],.     
+0000c360: 2020 2020 2020 2020 2020 2022 6170 706c             "appl
+0000c370: 6963 6174 696f 6e22 3a20 2266 6f6f 6261  ication": "fooba
+0000c380: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
+0000c390: 7d2c 0a20 2020 2020 2020 205d 0a20 2020  },.        ].   
+0000c3a0: 2020 2020 206d 6f63 6b5f 7570 6c6f 6164       mock_upload
+0000c3b0: 5f64 6174 615f 6173 5f62 6174 6368 2e61  _data_as_batch.a
+0000c3c0: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
+0000c3d0: 2829 0a0a 0a40 6672 6565 7a65 5f74 696d  ()...@freeze_tim
+0000c3e0: 6528 4355 5252 454e 545f 5449 4d45 290a  e(CURRENT_TIME).
+0000c3f0: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
+0000c400: 616d 6574 7269 7a65 2822 7461 6773 222c  ametrize("tags",
+0000c410: 205b 7b22 656e 7622 3a20 226f 7665 7277   [{"env": "overw
+0000c420: 7269 7465 5f65 6e76 227d 2c20 7b7d 2c20  rite_env"}, {}, 
+0000c430: 4e6f 6e65 5d29 0a40 7079 7465 7374 2e6d  None]).@pytest.m
+0000c440: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+0000c450: 0a20 2020 2022 7469 6d65 7374 616d 7073  .    "timestamps
+0000c460: 222c 205b 4e6f 6e65 2c20 7064 2e44 6174  ", [None, pd.Dat
+0000c470: 6574 696d 6549 6e64 6578 285b 414e 4f54  etimeIndex([ANOT
+0000c480: 4845 525f 5449 4d45 2c20 534f 4d45 5f54  HER_TIME, SOME_T
+0000c490: 494d 455d 292c 205b 414e 4f54 4845 525f  IME]), [ANOTHER_
+0000c4a0: 5449 4d45 2c20 534f 4d45 5f54 494d 455d  TIME, SOME_TIME]
+0000c4b0: 5d0a 290a 4070 7974 6573 742e 6d61 726b  ].).@pytest.mark
+0000c4c0: 2e70 6172 616d 6574 7269 7a65 2822 736f  .parametrize("so
+0000c4d0: 7274 222c 205b 4661 6c73 652c 2054 7275  rt", [False, Tru
+0000c4e0: 655d 290a 4070 7974 6573 742e 6d61 726b  e]).@pytest.mark
+0000c4f0: 2e70 6172 616d 6574 7269 7a65 2822 7665  .parametrize("ve
+0000c500: 7273 696f 6e22 2c20 5b22 3022 2c20 302c  rsion", ["0", 0,
+0000c510: 204e 6f6e 655d 290a 406d 6f63 6b2e 7061   None]).@mock.pa
+0000c520: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
+0000c530: 6572 2e65 7665 6e74 5f62 7569 6c64 6572  er.event_builder
+0000c540: 2e75 7569 642e 7575 6964 3422 290a 406d  .uuid.uuid4").@m
+0000c550: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
+0000c560: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
+0000c570: 4761 6e74 7279 2e5f 6861 6e64 6c65 5f75  Gantry._handle_u
+0000c580: 706c 6f61 6422 290a 6465 6620 7465 7374  pload").def test
+0000c590: 5f5f 7570 6c6f 6164 5f64 6174 615f 6173  __upload_data_as
+0000c5a0: 5f62 6174 6368 280a 2020 2020 6d6f 636b  _batch(.    mock
+0000c5b0: 5f68 616e 646c 655f 7570 6c6f 6164 2c0a  _handle_upload,.
+0000c5c0: 2020 2020 6d6f 636b 5f75 7569 642c 0a20      mock_uuid,. 
+0000c5d0: 2020 2076 6572 7369 6f6e 2c0a 2020 2020     version,.    
+0000c5e0: 736f 7274 2c0a 2020 2020 7469 6d65 7374  sort,.    timest
+0000c5f0: 616d 7073 2c0a 2020 2020 7461 6773 2c0a  amps,.    tags,.
+0000c600: 2020 2020 636c 695f 6f62 6a2c 0a29 3a0a      cli_obj,.):.
+0000c610: 2020 2020 6d6f 636b 5f75 7569 642e 7369      mock_uuid.si
+0000c620: 6465 5f65 6666 6563 7420 3d20 5b22 3122  de_effect = ["1"
+0000c630: 5d0a 2020 2020 6578 7065 6374 6564 5f74  ].    expected_t
+0000c640: 6167 7320 3d20 7461 6773 2069 6620 7461  ags = tags if ta
+0000c650: 6773 2065 6c73 6520 7b22 656e 7622 3a20  gs else {"env": 
+0000c660: 2274 6573 7422 7d0a 2020 2020 6576 656e  "test"}.    even
+0000c670: 745f 3120 3d20 7b0a 2020 2020 2020 2020  t_1 = {.        
+0000c680: 2265 7665 6e74 5f69 6422 3a20 2241 4243  "event_id": "ABC
+0000c690: 4432 2220 6966 206e 6f74 2028 736f 7274  D2" if not (sort
+0000c6a0: 2061 6e64 2074 696d 6573 7461 6d70 7320   and timestamps 
+0000c6b0: 6973 206e 6f74 204e 6f6e 6529 2065 6c73  is not None) els
+0000c6c0: 6520 2241 4243 4434 222c 0a20 2020 2020  e "ABCD4",.     
+0000c6d0: 2020 2022 6c6f 675f 7469 6d65 7374 616d     "log_timestam
+0000c6e0: 7022 3a20 4355 5252 454e 545f 5449 4d45  p": CURRENT_TIME
+0000c6f0: 5f53 5452 2c0a 2020 2020 2020 2020 2274  _STR,.        "t
+0000c700: 696d 6573 7461 6d70 223a 2041 4e4f 5448  imestamp": ANOTH
+0000c710: 4552 5f54 494d 455f 5354 5220 6966 2074  ER_TIME_STR if t
+0000c720: 696d 6573 7461 6d70 7320 6973 206e 6f74  imestamps is not
+0000c730: 204e 6f6e 6520 656c 7365 2043 5552 5245   None else CURRE
+0000c740: 4e54 5f54 494d 455f 5354 522c 0a20 2020  NT_TIME_STR,.   
+0000c750: 2020 2020 2022 6d65 7461 6461 7461 223a       "metadata":
+0000c760: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+0000c770: 6675 6e63 5f6e 616d 6522 3a20 2266 6f6f  func_name": "foo
+0000c780: 6261 7222 2c0a 2020 2020 2020 2020 2020  bar",.          
+0000c790: 2020 2276 6572 7369 6f6e 223a 2076 6572    "version": ver
+0000c7a0: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
+0000c7b0: 2020 2266 6565 6462 6163 6b5f 6b65 7973    "feedback_keys
+0000c7c0: 223a 205b 2241 225d 2c0a 2020 2020 2020  ": ["A"],.      
+0000c7d0: 2020 2020 2020 2269 676e 6f72 655f 696e        "ignore_in
+0000c7e0: 7075 7473 223a 204e 6f6e 652c 0a20 2020  puts": None,.   
+0000c7f0: 2020 2020 2020 2020 2022 7072 6f76 6964           "provid
+0000c800: 6564 5f66 6565 6462 6163 6b5f 6964 223a  ed_feedback_id":
+0000c810: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+0000c820: 2020 2022 6665 6564 6261 636b 5f76 6572     "feedback_ver
+0000c830: 7369 6f6e 223a 2076 6572 7369 6f6e 2c0a  sion": version,.
+0000c840: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+0000c850: 2020 2022 696e 7075 7473 223a 207b 2241     "inputs": {"A
+0000c860: 223a 2031 3030 7d2c 0a20 2020 2020 2020  ": 100},.       
+0000c870: 2022 6f75 7470 7574 7322 3a20 7b22 4222   "outputs": {"B"
+0000c880: 3a20 3330 307d 2c0a 2020 2020 2020 2020  : 300},.        
+0000c890: 2266 6565 6462 6163 6b5f 6964 223a 2022  "feedback_id": "
+0000c8a0: 3564 6431 3436 3135 6566 6562 3264 3038  5dd14615efeb2d08
+0000c8b0: 3665 3531 3965 6433 3565 6664 3366 3733  6e519ed35efd3f73
+0000c8c0: 222c 0a20 2020 2020 2020 2022 7461 6773  ",.        "tags
+0000c8d0: 223a 2065 7870 6563 7465 645f 7461 6773  ": expected_tags
+0000c8e0: 2c0a 2020 2020 2020 2020 2262 6174 6368  ,.        "batch
+0000c8f0: 5f69 6422 3a20 4e6f 6e65 2c0a 2020 2020  _id": None,.    
+0000c900: 2020 2020 2266 6565 6462 6163 6b5f 6964      "feedback_id
+0000c910: 5f69 6e70 7574 7322 3a20 7b22 4122 3a20  _inputs": {"A": 
+0000c920: 3130 307d 2c0a 2020 2020 2020 2020 2266  100},.        "f
+0000c930: 6565 6462 6163 6b22 3a20 7b22 4122 3a20  eedback": {"A": 
+0000c940: 3230 307d 2c0a 2020 2020 7d0a 2020 2020  200},.    }.    
+0000c950: 6576 656e 745f 3220 3d20 7b0a 2020 2020  event_2 = {.    
+0000c960: 2020 2020 2265 7665 6e74 5f69 6422 3a20      "event_id": 
+0000c970: 2241 4243 4434 2220 6966 206e 6f74 2028  "ABCD4" if not (
+0000c980: 736f 7274 2061 6e64 2074 696d 6573 7461  sort and timesta
+0000c990: 6d70 7320 6973 206e 6f74 204e 6f6e 6529  mps is not None)
+0000c9a0: 2065 6c73 6520 2241 4243 4432 222c 0a20   else "ABCD2",. 
+0000c9b0: 2020 2020 2020 2022 6c6f 675f 7469 6d65         "log_time
+0000c9c0: 7374 616d 7022 3a20 4355 5252 454e 545f  stamp": CURRENT_
+0000c9d0: 5449 4d45 5f53 5452 2c0a 2020 2020 2020  TIME_STR,.      
+0000c9e0: 2020 2274 696d 6573 7461 6d70 223a 2053    "timestamp": S
+0000c9f0: 4f4d 455f 5449 4d45 5f53 5452 2069 6620  OME_TIME_STR if 
+0000ca00: 7469 6d65 7374 616d 7073 2069 7320 6e6f  timestamps is no
+0000ca10: 7420 4e6f 6e65 2065 6c73 6520 4355 5252  t None else CURR
+0000ca20: 454e 545f 5449 4d45 5f53 5452 2c0a 2020  ENT_TIME_STR,.  
+0000ca30: 2020 2020 2020 226d 6574 6164 6174 6122        "metadata"
+0000ca40: 3a20 7b0a 2020 2020 2020 2020 2020 2020  : {.            
+0000ca50: 2266 756e 635f 6e61 6d65 223a 2022 666f  "func_name": "fo
+0000ca60: 6f62 6172 222c 0a20 2020 2020 2020 2020  obar",.         
+0000ca70: 2020 2022 7665 7273 696f 6e22 3a20 7665     "version": ve
+0000ca80: 7273 696f 6e2c 0a20 2020 2020 2020 2020  rsion,.         
+0000ca90: 2020 2022 6665 6564 6261 636b 5f6b 6579     "feedback_key
+0000caa0: 7322 3a20 5b22 4122 5d2c 0a20 2020 2020  s": ["A"],.     
+0000cab0: 2020 2020 2020 2022 6967 6e6f 7265 5f69         "ignore_i
+0000cac0: 6e70 7574 7322 3a20 4e6f 6e65 2c0a 2020  nputs": None,.  
+0000cad0: 2020 2020 2020 2020 2020 2270 726f 7669            "provi
+0000cae0: 6465 645f 6665 6564 6261 636b 5f69 6422  ded_feedback_id"
+0000caf0: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
+0000cb00: 2020 2020 2266 6565 6462 6163 6b5f 7665      "feedback_ve
+0000cb10: 7273 696f 6e22 3a20 7665 7273 696f 6e2c  rsion": version,
+0000cb20: 0a20 2020 2020 2020 207d 2c0a 2020 2020  .        },.    
+0000cb30: 2020 2020 2269 6e70 7574 7322 3a20 7b22      "inputs": {"
+0000cb40: 4122 3a20 3130 317d 2c0a 2020 2020 2020  A": 101},.      
+0000cb50: 2020 226f 7574 7075 7473 223a 207b 2242    "outputs": {"B
+0000cb60: 223a 2033 3031 7d2c 0a20 2020 2020 2020  ": 301},.       
+0000cb70: 2022 6665 6564 6261 636b 5f69 6422 3a20   "feedback_id": 
+0000cb80: 2239 6533 3239 3239 3365 3032 3264 3663  "9e329293e022d6c
+0000cb90: 6461 6166 6465 6334 3962 3566 3466 6564  daafdec49b5f4fed
+0000cba0: 6322 2c0a 2020 2020 2020 2020 2274 6167  c",.        "tag
+0000cbb0: 7322 3a20 6578 7065 6374 6564 5f74 6167  s": expected_tag
+0000cbc0: 732c 0a20 2020 2020 2020 2022 6261 7463  s,.        "batc
+0000cbd0: 685f 6964 223a 204e 6f6e 652c 0a20 2020  h_id": None,.   
+0000cbe0: 2020 2020 2022 6665 6564 6261 636b 5f69       "feedback_i
+0000cbf0: 645f 696e 7075 7473 223a 207b 2241 223a  d_inputs": {"A":
+0000cc00: 2031 3031 7d2c 0a20 2020 2020 2020 2022   101},.        "
+0000cc10: 6665 6564 6261 636b 223a 207b 2241 223a  feedback": {"A":
+0000cc20: 2032 3031 7d2c 0a20 2020 207d 0a20 2020   201},.    }.   
+0000cc30: 2065 7665 6e74 7320 3d20 5b65 7665 6e74   events = [event
+0000cc40: 5f31 2c20 6576 656e 745f 325d 0a0a 2020  _1, event_2]..  
+0000cc50: 2020 636c 695f 6f62 6a2e 5f75 706c 6f61    cli_obj._uploa
+0000cc60: 645f 6461 7461 5f61 735f 6261 7463 6828  d_data_as_batch(
+0000cc70: 2274 6573 745f 6170 7022 2c20 7665 7273  "test_app", vers
+0000cc80: 696f 6e2c 2065 7665 6e74 732c 2042 6174  ion, events, Bat
+0000cc90: 6368 5479 7065 2e52 4543 4f52 4429 0a0a  chType.RECORD)..
+0000cca0: 2020 2020 6d6f 636b 5f68 616e 646c 655f      mock_handle_
+0000ccb0: 7570 6c6f 6164 2e61 7373 6572 745f 6361  upload.assert_ca
+0000ccc0: 6c6c 6564 5f6f 6e63 655f 7769 7468 280a  lled_once_with(.
+0000ccd0: 2020 2020 2020 2020 6d6f 636b 2e41 4e59          mock.ANY
+0000cce0: 2c0a 2020 2020 2020 2020 4461 7461 4c69  ,.        DataLi
+0000ccf0: 6e6b 280a 2020 2020 2020 2020 2020 2020  nk(.            
+0000cd00: 6170 706c 6963 6174 696f 6e3d 2274 6573  application="tes
+0000cd10: 745f 6170 7022 2c0a 2020 2020 2020 2020  t_app",.        
+0000cd20: 2020 2020 7665 7273 696f 6e3d 7374 7228      version=str(
+0000cd30: 7665 7273 696f 6e29 2069 6620 7665 7273  version) if vers
+0000cd40: 696f 6e20 6973 206e 6f74 204e 6f6e 6520  ion is not None 
+0000cd50: 656c 7365 2076 6572 7369 6f6e 2c0a 2020  else version,.  
+0000cd60: 2020 2020 2020 2020 2020 6669 6c65 5f74            file_t
+0000cd70: 7970 653d 5570 6c6f 6164 4669 6c65 5479  ype=UploadFileTy
+0000cd80: 7065 2e45 5645 4e54 532c 0a20 2020 2020  pe.EVENTS,.     
+0000cd90: 2020 2020 2020 2062 6174 6368 5f74 7970         batch_typ
+0000cda0: 653d 4261 7463 6854 7970 652e 5245 434f  e=BatchType.RECO
+0000cdb0: 5244 2c0a 2020 2020 2020 2020 2020 2020  RD,.            
+0000cdc0: 6c6f 675f 7469 6d65 7374 616d 703d 4355  log_timestamp=CU
+0000cdd0: 5252 454e 545f 5449 4d45 2e69 736f 666f  RRENT_TIME.isofo
+0000cde0: 726d 6174 2829 2c0a 2020 2020 2020 2020  rmat(),.        
+0000cdf0: 2020 2020 6e75 6d5f 6576 656e 7473 3d32      num_events=2
+0000ce00: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
+0000ce10: 2020 2020 206d 6f63 6b2e 414e 592c 0a20       mock.ANY,. 
+0000ce20: 2020 2020 2020 2022 7465 7374 5f61 7070         "test_app
+0000ce30: 5f31 222c 0a20 2020 2029 0a0a 0a40 6d6f  _1",.    )...@mo
+0000ce40: 636b 2e70 6174 6368 2822 6761 6e74 7279  ck.patch("gantry
+0000ce50: 2e6c 6f67 6765 722e 636c 6965 6e74 2e47  .logger.client.G
+0000ce60: 616e 7472 792e 5f67 656e 6572 6174 655f  antry._generate_
+0000ce70: 7072 6564 6963 7469 6f6e 5f61 6e64 5f66  prediction_and_f
+0000ce80: 6565 6462 6163 6b5f 6576 656e 7473 2229  eedback_events")
+0000ce90: 0a64 6566 2074 6573 745f 6765 6e65 7261  .def test_genera
+0000cea0: 7465 5f72 6563 6f72 6473 5f70 7265 6473  te_records_preds
+0000ceb0: 5f61 6e64 5f66 6565 6462 6163 6b5f 7365  _and_feedback_se
+0000cec0: 7269 6573 5f63 6f65 7263 6564 280a 2020  ries_coerced(.  
+0000ced0: 2020 6d6f 636b 5f67 656e 6572 6174 655f    mock_generate_
+0000cee0: 7072 6564 735f 616e 645f 6665 6564 6261  preds_and_feedba
+0000cef0: 636b 2c0a 2020 2020 636c 695f 6f62 6a2c  ck,.    cli_obj,
+0000cf00: 0a29 3a0a 2020 2020 6578 7065 6374 6564  .):.    expected
+0000cf10: 5f69 6e70 7574 7320 3d20 7064 2e53 6572  _inputs = pd.Ser
+0000cf20: 6965 7328 5b32 3030 2c20 3230 315d 290a  ies([200, 201]).
+0000cf30: 2020 2020 6578 7065 6374 6564 5f6f 7574      expected_out
+0000cf40: 7075 7473 203d 2070 642e 5365 7269 6573  puts = pd.Series
+0000cf50: 285b 3330 302c 2033 3031 5d29 0a20 2020  ([300, 301]).   
+0000cf60: 2065 7870 6563 7465 645f 6665 6564 6261   expected_feedba
+0000cf70: 636b 7320 3d20 7064 2e53 6572 6965 7328  cks = pd.Series(
+0000cf80: 5b31 3030 2c20 3130 315d 290a 2020 2020  [100, 101]).    
+0000cf90: 6170 706c 6963 6174 696f 6e20 3d20 2274  application = "t
+0000cfa0: 6573 745f 6170 7022 0a0a 2020 2020 636c  est_app"..    cl
+0000cfb0: 695f 6f62 6a2e 6765 6e65 7261 7465 5f72  i_obj.generate_r
+0000cfc0: 6563 6f72 6473 280a 2020 2020 2020 2020  ecords(.        
+0000cfd0: 6170 706c 6963 6174 696f 6e3d 6170 706c  application=appl
+0000cfe0: 6963 6174 696f 6e2c 0a20 2020 2020 2020  ication,.       
+0000cff0: 2069 6e70 7574 733d 6578 7065 6374 6564   inputs=expected
+0000d000: 5f69 6e70 7574 732c 0a20 2020 2020 2020  _inputs,.       
+0000d010: 206f 7574 7075 7473 3d65 7870 6563 7465   outputs=expecte
+0000d020: 645f 6f75 7470 7574 732c 0a20 2020 2020  d_outputs,.     
+0000d030: 2020 2066 6565 6462 6163 6b73 3d65 7870     feedbacks=exp
+0000d040: 6563 7465 645f 6665 6564 6261 636b 732c  ected_feedbacks,
+0000d050: 0a20 2020 2029 0a0a 2020 2020 646f 776e  .    )..    down
+0000d060: 7374 7265 616d 5f6b 7761 7267 7320 3d20  stream_kwargs = 
+0000d070: 6d6f 636b 5f67 656e 6572 6174 655f 7072  mock_generate_pr
+0000d080: 6564 735f 616e 645f 6665 6564 6261 636b  eds_and_feedback
+0000d090: 2e63 616c 6c5f 6172 6773 2e6b 7761 7267  .call_args.kwarg
+0000d0a0: 730a 2020 2020 6163 7475 616c 5f69 6e70  s.    actual_inp
+0000d0b0: 7574 7320 3d20 646f 776e 7374 7265 616d  uts = downstream
+0000d0c0: 5f6b 7761 7267 735b 2269 6e70 7574 7322  _kwargs["inputs"
+0000d0d0: 5d0a 2020 2020 6163 7475 616c 5f6f 7574  ].    actual_out
+0000d0e0: 7075 7473 203d 2064 6f77 6e73 7472 6561  puts = downstrea
+0000d0f0: 6d5f 6b77 6172 6773 5b22 6f75 7470 7574  m_kwargs["output
+0000d100: 7322 5d0a 2020 2020 6163 7475 616c 5f66  s"].    actual_f
+0000d110: 6565 6462 6163 6b73 203d 2064 6f77 6e73  eedbacks = downs
+0000d120: 7472 6561 6d5f 6b77 6172 6773 5b22 6665  tream_kwargs["fe
+0000d130: 6564 6261 636b 7322 5d0a 2020 2020 6173  edbacks"].    as
+0000d140: 7365 7274 2061 6374 7561 6c5f 696e 7075  sert actual_inpu
+0000d150: 7473 203d 3d20 5b7b 303a 2032 3030 7d2c  ts == [{0: 200},
+0000d160: 207b 303a 2032 3031 7d5d 0a20 2020 2061   {0: 201}].    a
+0000d170: 7373 6572 7420 6163 7475 616c 5f6f 7574  ssert actual_out
+0000d180: 7075 7473 203d 3d20 5b7b 303a 2033 3030  puts == [{0: 300
+0000d190: 7d2c 207b 303a 2033 3031 7d5d 0a20 2020  }, {0: 301}].   
+0000d1a0: 2061 7373 6572 7420 6163 7475 616c 5f66   assert actual_f
+0000d1b0: 6565 6462 6163 6b73 203d 3d20 5b7b 303a  eedbacks == [{0:
+0000d1c0: 2031 3030 7d2c 207b 303a 2031 3031 7d5d   100}, {0: 101}]
+0000d1d0: 0a0a 0a40 6d6f 636b 2e70 6174 6368 2822  ...@mock.patch("
+0000d1e0: 6761 6e74 7279 2e6c 6f67 6765 722e 636c  gantry.logger.cl
+0000d1f0: 6965 6e74 2e47 616e 7472 792e 5f6c 6f67  ient.Gantry._log
+0000d200: 5f70 7265 6469 6374 696f 6e5f 616e 645f  _prediction_and_
+0000d210: 6665 6564 6261 636b 5f65 7665 6e74 7322  feedback_events"
+0000d220: 290a 6465 6620 7465 7374 5f6c 6f67 5f72  ).def test_log_r
+0000d230: 6563 6f72 6473 5f70 7265 6473 5f61 6e64  ecords_preds_and
+0000d240: 5f66 6565 6462 6163 6b5f 7365 7269 6573  _feedback_series
+0000d250: 5f63 6f65 7263 6564 280a 2020 2020 6d6f  _coerced(.    mo
+0000d260: 636b 5f70 7265 6473 5f61 6e64 5f66 6565  ck_preds_and_fee
+0000d270: 6462 6163 6b2c 0a20 2020 2063 6c69 5f6f  dback,.    cli_o
+0000d280: 626a 2c0a 293a 0a20 2020 2065 7870 6563  bj,.):.    expec
+0000d290: 7465 645f 696e 7075 7473 203d 2070 642e  ted_inputs = pd.
+0000d2a0: 5365 7269 6573 285b 3230 302c 2032 3031  Series([200, 201
+0000d2b0: 5d29 0a20 2020 2065 7870 6563 7465 645f  ]).    expected_
+0000d2c0: 6f75 7470 7574 7320 3d20 7064 2e53 6572  outputs = pd.Ser
+0000d2d0: 6965 7328 5b33 3030 2c20 3330 315d 290a  ies([300, 301]).
+0000d2e0: 2020 2020 6578 7065 6374 6564 5f66 6565      expected_fee
+0000d2f0: 6462 6163 6b73 203d 2070 642e 5365 7269  dbacks = pd.Seri
+0000d300: 6573 285b 3130 302c 2031 3031 5d29 0a20  es([100, 101]). 
+0000d310: 2020 2061 7070 6c69 6361 7469 6f6e 203d     application =
+0000d320: 2022 7465 7374 5f61 7070 220a 0a20 2020   "test_app"..   
+0000d330: 2063 6c69 5f6f 626a 2e6c 6f67 5f72 6563   cli_obj.log_rec
+0000d340: 6f72 6473 280a 2020 2020 2020 2020 6170  ords(.        ap
+0000d350: 706c 6963 6174 696f 6e3d 6170 706c 6963  plication=applic
+0000d360: 6174 696f 6e2c 0a20 2020 2020 2020 2069  ation,.        i
+0000d370: 6e70 7574 733d 6578 7065 6374 6564 5f69  nputs=expected_i
+0000d380: 6e70 7574 732c 0a20 2020 2020 2020 206f  nputs,.        o
+0000d390: 7574 7075 7473 3d65 7870 6563 7465 645f  utputs=expected_
+0000d3a0: 6f75 7470 7574 732c 0a20 2020 2020 2020  outputs,.       
+0000d3b0: 2066 6565 6462 6163 6b73 3d65 7870 6563   feedbacks=expec
+0000d3c0: 7465 645f 6665 6564 6261 636b 732c 0a20  ted_feedbacks,. 
+0000d3d0: 2020 2029 0a0a 2020 2020 646f 776e 7374     )..    downst
+0000d3e0: 7265 616d 5f6b 7761 7267 7320 3d20 6d6f  ream_kwargs = mo
+0000d3f0: 636b 5f70 7265 6473 5f61 6e64 5f66 6565  ck_preds_and_fee
+0000d400: 6462 6163 6b2e 6361 6c6c 5f61 7267 732e  dback.call_args.
+0000d410: 6b77 6172 6773 0a20 2020 2061 6374 7561  kwargs.    actua
+0000d420: 6c5f 696e 7075 7473 203d 2064 6f77 6e73  l_inputs = downs
+0000d430: 7472 6561 6d5f 6b77 6172 6773 5b22 696e  tream_kwargs["in
+0000d440: 7075 7473 225d 0a20 2020 2061 6374 7561  puts"].    actua
+0000d450: 6c5f 6f75 7470 7574 7320 3d20 646f 776e  l_outputs = down
+0000d460: 7374 7265 616d 5f6b 7761 7267 735b 226f  stream_kwargs["o
+0000d470: 7574 7075 7473 225d 0a20 2020 2061 6374  utputs"].    act
+0000d480: 7561 6c5f 6665 6564 6261 636b 7320 3d20  ual_feedbacks = 
+0000d490: 646f 776e 7374 7265 616d 5f6b 7761 7267  downstream_kwarg
+0000d4a0: 735b 2266 6565 6462 6163 6b73 225d 0a20  s["feedbacks"]. 
+0000d4b0: 2020 2061 7373 6572 7420 6163 7475 616c     assert actual
+0000d4c0: 5f69 6e70 7574 7320 3d3d 205b 7b30 3a20  _inputs == [{0: 
+0000d4d0: 3230 307d 2c20 7b30 3a20 3230 317d 5d0a  200}, {0: 201}].
+0000d4e0: 2020 2020 6173 7365 7274 2061 6374 7561      assert actua
+0000d4f0: 6c5f 6f75 7470 7574 7320 3d3d 205b 7b30  l_outputs == [{0
+0000d500: 3a20 3330 307d 2c20 7b30 3a20 3330 317d  : 300}, {0: 301}
+0000d510: 5d0a 2020 2020 6173 7365 7274 2061 6374  ].    assert act
+0000d520: 7561 6c5f 6665 6564 6261 636b 7320 3d3d  ual_feedbacks ==
+0000d530: 205b 7b30 3a20 3130 307d 2c20 7b30 3a20   [{0: 100}, {0: 
+0000d540: 3130 317d 5d0a 0a0a 406d 6f63 6b2e 7061  101}]...@mock.pa
+0000d550: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
+0000d560: 6572 2e63 6c69 656e 742e 4761 6e74 7279  er.client.Gantry
+0000d570: 2e5f 6c6f 675f 7072 6564 6963 7469 6f6e  ._log_prediction
+0000d580: 5f61 6e64 5f66 6565 6462 6163 6b5f 6576  _and_feedback_ev
+0000d590: 656e 7473 2229 0a64 6566 2074 6573 745f  ents").def test_
+0000d5a0: 7369 6e67 6c65 5f6c 6f67 5f72 6563 6f72  single_log_recor
+0000d5b0: 6473 5f70 7265 6473 5f61 6e64 5f66 6565  ds_preds_and_fee
+0000d5c0: 6462 6163 6b5f 7365 7269 6573 5f63 6f65  dback_series_coe
+0000d5d0: 7263 6564 280a 2020 2020 6d6f 636b 5f70  rced(.    mock_p
+0000d5e0: 7265 6473 5f61 6e64 5f66 6565 6462 6163  reds_and_feedbac
+0000d5f0: 6b2c 0a20 2020 2063 6c69 5f6f 626a 2c0a  k,.    cli_obj,.
+0000d600: 293a 0a20 2020 2065 7870 6563 7465 645f  ):.    expected_
+0000d610: 696e 7075 7473 203d 2070 642e 5365 7269  inputs = pd.Seri
+0000d620: 6573 285b 3230 302c 2032 3031 5d29 0a20  es([200, 201]). 
+0000d630: 2020 2065 7870 6563 7465 645f 6f75 7470     expected_outp
+0000d640: 7574 7320 3d20 7064 2e53 6572 6965 7328  uts = pd.Series(
+0000d650: 5b33 3030 2c20 3330 315d 290a 2020 2020  [300, 301]).    
+0000d660: 6578 7065 6374 6564 5f66 6565 6462 6163  expected_feedbac
+0000d670: 6b73 203d 2070 642e 5365 7269 6573 285b  ks = pd.Series([
+0000d680: 3130 302c 2031 3031 5d29 0a20 2020 2061  100, 101]).    a
+0000d690: 7070 6c69 6361 7469 6f6e 203d 2022 7465  pplication = "te
+0000d6a0: 7374 5f61 7070 220a 0a20 2020 2063 6c69  st_app"..    cli
+0000d6b0: 5f6f 626a 2e73 696e 676c 655f 6c6f 675f  _obj.single_log_
+0000d6c0: 7265 636f 7264 7328 0a20 2020 2020 2020  records(.       
+0000d6d0: 2061 7070 6c69 6361 7469 6f6e 3d61 7070   application=app
+0000d6e0: 6c69 6361 7469 6f6e 2c0a 2020 2020 2020  lication,.      
+0000d6f0: 2020 696e 7075 7473 3d65 7870 6563 7465    inputs=expecte
+0000d700: 645f 696e 7075 7473 2c0a 2020 2020 2020  d_inputs,.      
+0000d710: 2020 6f75 7470 7574 733d 6578 7065 6374    outputs=expect
+0000d720: 6564 5f6f 7574 7075 7473 2c0a 2020 2020  ed_outputs,.    
+0000d730: 2020 2020 6665 6564 6261 636b 733d 6578      feedbacks=ex
+0000d740: 7065 6374 6564 5f66 6565 6462 6163 6b73  pected_feedbacks
+0000d750: 2c0a 2020 2020 290a 0a20 2020 2064 6f77  ,.    )..    dow
+0000d760: 6e73 7472 6561 6d5f 6b77 6172 6773 203d  nstream_kwargs =
+0000d770: 206d 6f63 6b5f 7072 6564 735f 616e 645f   mock_preds_and_
+0000d780: 6665 6564 6261 636b 2e63 616c 6c5f 6172  feedback.call_ar
+0000d790: 6773 2e6b 7761 7267 730a 2020 2020 6163  gs.kwargs.    ac
+0000d7a0: 7475 616c 5f69 6e70 7574 7320 3d20 646f  tual_inputs = do
+0000d7b0: 776e 7374 7265 616d 5f6b 7761 7267 735b  wnstream_kwargs[
+0000d7c0: 2269 6e70 7574 7322 5d0a 2020 2020 6163  "inputs"].    ac
+0000d7d0: 7475 616c 5f6f 7574 7075 7473 203d 2064  tual_outputs = d
+0000d7e0: 6f77 6e73 7472 6561 6d5f 6b77 6172 6773  ownstream_kwargs
+0000d7f0: 5b22 6f75 7470 7574 7322 5d0a 2020 2020  ["outputs"].    
+0000d800: 6163 7475 616c 5f66 6565 6462 6163 6b73  actual_feedbacks
+0000d810: 203d 2064 6f77 6e73 7472 6561 6d5f 6b77   = downstream_kw
+0000d820: 6172 6773 5b22 6665 6564 6261 636b 7322  args["feedbacks"
+0000d830: 5d0a 2020 2020 6173 7365 7274 2061 6374  ].    assert act
+0000d840: 7561 6c5f 696e 7075 7473 203d 3d20 5b7b  ual_inputs == [{
+0000d850: 303a 2032 3030 7d2c 207b 303a 2032 3031  0: 200}, {0: 201
+0000d860: 7d5d 0a20 2020 2061 7373 6572 7420 6163  }].    assert ac
+0000d870: 7475 616c 5f6f 7574 7075 7473 203d 3d20  tual_outputs == 
+0000d880: 5b7b 303a 2033 3030 7d2c 207b 303a 2033  [{0: 300}, {0: 3
+0000d890: 3031 7d5d 0a20 2020 2061 7373 6572 7420  01}].    assert 
+0000d8a0: 6163 7475 616c 5f66 6565 6462 6163 6b73  actual_feedbacks
+0000d8b0: 203d 3d20 5b7b 303a 2031 3030 7d2c 207b   == [{0: 100}, {
+0000d8c0: 303a 2031 3031 7d5d 0a0a 0a40 7079 7465  0: 101}]...@pyte
+0000d8d0: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
+0000d8e0: 697a 6528 0a20 2020 2022 7465 7374 5f74  ize(.    "test_t
+0000d8f0: 696d 6573 7461 6d70 732c 2074 6573 745f  imestamps, test_
+0000d900: 7469 6d65 7374 616d 7073 5f6c 6973 7422  timestamps_list"
+0000d910: 2c0a 2020 2020 5b0a 2020 2020 2020 2020  ,.    [.        
+0000d920: 284e 6f6e 652c 204e 6f6e 6529 2c0a 2020  (None, None),.  
+0000d930: 2020 2020 2020 285b 4355 5252 454e 545f        ([CURRENT_
+0000d940: 5449 4d45 5d20 2a20 322c 205b 4355 5252  TIME] * 2, [CURR
+0000d950: 454e 545f 5449 4d45 5d20 2a20 3229 2c0a  ENT_TIME] * 2),.
+0000d960: 2020 2020 2020 2020 286e 702e 6172 7261          (np.arra
+0000d970: 7928 5b43 5552 5245 4e54 5f54 494d 455d  y([CURRENT_TIME]
+0000d980: 202a 2032 292c 205b 4355 5252 454e 545f   * 2), [CURRENT_
+0000d990: 5449 4d45 5d20 2a20 3229 2c0a 2020 2020  TIME] * 2),.    
+0000d9a0: 5d2c 0a29 0a40 7079 7465 7374 2e6d 6172  ],.).@pytest.mar
+0000d9b0: 6b2e 7061 7261 6d65 7472 697a 6528 0a20  k.parametrize(. 
+0000d9c0: 2020 2028 2274 6573 745f 696e 7075 7473     ("test_inputs
+0000d9d0: 222c 2022 7465 7374 5f6f 7574 7075 7473  ", "test_outputs
+0000d9e0: 222c 2022 7465 7374 5f66 6565 6462 6163  ", "test_feedbac
+0000d9f0: 6b73 2229 2c0a 2020 2020 5445 5354 5f49  ks"),.    TEST_I
+0000da00: 4e50 5554 535f 4f55 5450 5554 535f 4645  NPUTS_OUTPUTS_FE
+0000da10: 4544 4241 434b 532c 0a29 0a40 7079 7465  EDBACKS,.).@pyte
+0000da20: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
+0000da30: 697a 6528 2276 6572 7369 6f6e 222c 205b  ize("version", [
+0000da40: 4e6f 6e65 2c20 3130 2c20 2231 2e32 2e33  None, 10, "1.2.3
+0000da50: 225d 290a 4070 7974 6573 742e 6d61 726b  "]).@pytest.mark
+0000da60: 2e70 6172 616d 6574 7269 7a65 2822 7461  .parametrize("ta
+0000da70: 6773 2c20 726f 775f 7461 6773 2c20 676c  gs, row_tags, gl
+0000da80: 6f62 616c 5f74 6167 732c 2065 7870 6563  obal_tags, expec
+0000da90: 7465 645f 7461 6773 5f70 6172 616d 222c  ted_tags_param",
+0000daa0: 2054 4553 545f 5441 4753 290a 4070 7974   TEST_TAGS).@pyt
+0000dab0: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
+0000dac0: 7269 7a65 280a 2020 2020 226b 7761 7267  rize(.    "kwarg
+0000dad0: 7322 2c0a 2020 2020 5b0a 2020 2020 2020  s",.    [.      
+0000dae0: 2020 7b22 6665 6564 6261 636b 5f6b 6579    {"feedback_key
+0000daf0: 7322 3a20 5b22 4122 5d7d 2c0a 2020 2020  s": ["A"]},.    
+0000db00: 2020 2020 7b22 6665 6564 6261 636b 5f69      {"feedback_i
+0000db10: 6473 223a 205b 2231 3233 3435 222c 2022  ds": ["12345", "
+0000db20: 3637 3839 3022 5d7d 2c0a 2020 2020 2020  67890"]},.      
+0000db30: 2020 7b22 6a6f 696e 5f6b 6579 7322 3a20    {"join_keys": 
+0000db40: 5b22 3534 3332 3122 2c20 2236 3738 3930  ["54321", "67890
+0000db50: 225d 7d2c 0a20 2020 2020 2020 207b 226a  "]},.        {"j
+0000db60: 6f69 6e5f 6b65 7973 223a 2070 642e 5365  oin_keys": pd.Se
+0000db70: 7269 6573 285b 2235 3433 3231 222c 2022  ries(["54321", "
+0000db80: 3637 3839 3022 5d29 7d2c 0a20 2020 2020  67890"])},.     
+0000db90: 2020 207b 7d2c 0a20 2020 205d 2c0a 290a     {},.    ],.).
+0000dba0: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
+0000dbb0: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
+0000dbc0: 742e 5f72 6573 6f6c 7665 5f6a 6f69 6e5f  t._resolve_join_
+0000dbd0: 6b65 7973 2229 0a40 6d6f 636b 2e70 6174  keys").@mock.pat
+0000dbe0: 6368 280a 2020 2020 2267 616e 7472 792e  ch(.    "gantry.
+0000dbf0: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
+0000dc00: 6e74 7279 2e5f 6c6f 675f 7072 6564 6963  ntry._log_predic
+0000dc10: 7469 6f6e 5f61 6e64 5f66 6565 6462 6163  tion_and_feedbac
+0000dc20: 6b5f 6576 656e 7473 222c 0a20 2020 2072  k_events",.    r
+0000dc30: 6574 7572 6e5f 7661 6c75 653d 284e 6f6e  eturn_value=(Non
+0000dc40: 652c 205b 2231 3233 3435 222c 2022 3637  e, ["12345", "67
+0000dc50: 3839 3022 5d29 2c0a 290a 406d 6f63 6b2e  890"]),.).@mock.
+0000dc60: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
+0000dc70: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
+0000dc80: 7279 2e5f 6c6f 675f 7072 6564 6963 7469  ry._log_predicti
+0000dc90: 6f6e 5f65 7665 6e74 7322 290a 406d 6f63  on_events").@moc
+0000dca0: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
+0000dcb0: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
+0000dcc0: 6e74 7279 2e5f 6c6f 675f 6665 6564 6261  ntry._log_feedba
+0000dcd0: 636b 5f65 7665 6e74 7322 290a 406d 6f63  ck_events").@moc
+0000dce0: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
+0000dcf0: 6c6f 6767 6572 2e63 6c69 656e 742e 5f73  logger.client._s
+0000dd00: 616d 706c 655f 7265 636f 7264 7322 2c20  ample_records", 
+0000dd10: 7369 6465 5f65 6666 6563 743d 636c 6965  side_effect=clie
+0000dd20: 6e74 2e5f 7361 6d70 6c65 5f72 6563 6f72  nt._sample_recor
+0000dd30: 6473 290a 406d 6f63 6b2e 7061 7463 6828  ds).@mock.patch(
+0000dd40: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
+0000dd50: 6c69 656e 742e 5f64 6566 6175 6c74 5f6a  lient._default_j
+0000dd60: 6f69 6e5f 6b65 795f 6765 6e22 290a 6465  oin_key_gen").de
+0000dd70: 6620 7465 7374 5f73 696e 676c 655f 6c6f  f test_single_lo
+0000dd80: 675f 7265 636f 7264 735f 7072 6564 735f  g_records_preds_
+0000dd90: 616e 645f 6665 6564 6261 636b 280a 2020  and_feedback(.  
+0000dda0: 2020 6d6f 636b 5f6a 6f69 6e5f 6b65 795f    mock_join_key_
+0000ddb0: 6765 6e2c 0a20 2020 206d 6f63 6b5f 7361  gen,.    mock_sa
+0000ddc0: 6d70 6c65 5f72 6563 6f72 6473 2c0a 2020  mple_records,.  
+0000ddd0: 2020 6d6f 636b 5f66 6565 6462 6163 6b2c    mock_feedback,
+0000dde0: 0a20 2020 206d 6f63 6b5f 7072 6564 732c  .    mock_preds,
+0000ddf0: 0a20 2020 206d 6f63 6b5f 7072 6564 735f  .    mock_preds_
+0000de00: 616e 645f 6665 6564 6261 636b 2c0a 2020  and_feedback,.  
+0000de10: 2020 6d6f 636b 5f72 6573 6f6c 7665 5f6a    mock_resolve_j
+0000de20: 6f69 6e5f 6b65 7973 2c0a 2020 2020 6b77  oin_keys,.    kw
+0000de30: 6172 6773 2c0a 2020 2020 7665 7273 696f  args,.    versio
+0000de40: 6e2c 0a20 2020 2074 6167 732c 0a20 2020  n,.    tags,.   
+0000de50: 2072 6f77 5f74 6167 732c 0a20 2020 2067   row_tags,.    g
+0000de60: 6c6f 6261 6c5f 7461 6773 2c0a 2020 2020  lobal_tags,.    
+0000de70: 6578 7065 6374 6564 5f74 6167 735f 7061  expected_tags_pa
+0000de80: 7261 6d2c 0a20 2020 2074 6573 745f 7469  ram,.    test_ti
+0000de90: 6d65 7374 616d 7073 2c0a 2020 2020 7465  mestamps,.    te
+0000dea0: 7374 5f74 696d 6573 7461 6d70 735f 6c69  st_timestamps_li
+0000deb0: 7374 2c0a 2020 2020 7465 7374 5f69 6e70  st,.    test_inp
+0000dec0: 7574 732c 0a20 2020 2074 6573 745f 6f75  uts,.    test_ou
+0000ded0: 7470 7574 732c 0a20 2020 2074 6573 745f  tputs,.    test_
+0000dee0: 6665 6564 6261 636b 732c 0a20 2020 2063  feedbacks,.    c
+0000def0: 6c69 5f6f 626a 2c0a 293a 0a20 2020 206d  li_obj,.):.    m
+0000df00: 6f63 6b5f 6a6f 696e 5f6b 6579 5f67 656e  ock_join_key_gen
+0000df10: 2e73 6964 655f 6566 6665 6374 203d 205b  .side_effect = [
+0000df20: 2236 3738 3930 222c 2022 3132 3334 3522  "67890", "12345"
+0000df30: 5d0a 2020 2020 6d6f 636b 5f72 6573 6f6c  ].    mock_resol
+0000df40: 7665 5f6a 6f69 6e5f 6b65 7973 2e72 6574  ve_join_keys.ret
+0000df50: 7572 6e5f 7661 6c75 6520 3d20 5b22 3132  urn_value = ["12
+0000df60: 3334 3522 2c20 2236 3738 3930 225d 2069  345", "67890"] i
+0000df70: 6620 6b77 6172 6773 2065 6c73 6520 4e6f  f kwargs else No
+0000df80: 6e65 0a20 2020 2061 7373 6572 7420 636c  ne.    assert cl
+0000df90: 695f 6f62 6a2e 7369 6e67 6c65 5f6c 6f67  i_obj.single_log
+0000dfa0: 5f72 6563 6f72 6473 280a 2020 2020 2020  _records(.      
+0000dfb0: 2020 6170 706c 6963 6174 696f 6e3d 2266    application="f
+0000dfc0: 6f6f 6261 7222 2c0a 2020 2020 2020 2020  oobar",.        
+0000dfd0: 7665 7273 696f 6e3d 7665 7273 696f 6e2c  version=version,
+0000dfe0: 0a20 2020 2020 2020 2069 6e70 7574 733d  .        inputs=
+0000dff0: 7465 7374 5f69 6e70 7574 732c 0a20 2020  test_inputs,.   
+0000e000: 2020 2020 206f 7574 7075 7473 3d74 6573       outputs=tes
+0000e010: 745f 6f75 7470 7574 732c 0a20 2020 2020  t_outputs,.     
+0000e020: 2020 2066 6565 6462 6163 6b73 3d74 6573     feedbacks=tes
+0000e030: 745f 6665 6564 6261 636b 732c 0a20 2020  t_feedbacks,.   
+0000e040: 2020 2020 2074 696d 6573 7461 6d70 733d       timestamps=
+0000e050: 7465 7374 5f74 696d 6573 7461 6d70 732c  test_timestamps,
+0000e060: 0a20 2020 2020 2020 2073 6f72 745f 6f6e  .        sort_on
+0000e070: 5f74 696d 6573 7461 6d70 3d54 7275 652c  _timestamp=True,
+0000e080: 0a20 2020 2020 2020 2073 616d 706c 655f  .        sample_
+0000e090: 7261 7465 3d31 2c0a 2020 2020 2020 2020  rate=1,.        
+0000e0a0: 7461 6773 3d74 6167 732c 0a20 2020 2020  tags=tags,.     
+0000e0b0: 2020 2072 6f77 5f74 6167 733d 726f 775f     row_tags=row_
+0000e0c0: 7461 6773 2c0a 2020 2020 2020 2020 676c  tags,.        gl
+0000e0d0: 6f62 616c 5f74 6167 733d 676c 6f62 616c  obal_tags=global
+0000e0e0: 5f74 6167 732c 0a20 2020 2020 2020 202a  _tags,.        *
+0000e0f0: 2a6b 7761 7267 732c 0a20 2020 2029 203d  *kwargs,.    ) =
+0000e100: 3d20 284e 6f6e 652c 205b 2231 3233 3435  = (None, ["12345
+0000e110: 222c 2022 3637 3839 3022 5d29 0a0a 2020  ", "67890"])..  
+0000e120: 2020 6d6f 636b 5f70 7265 6473 5f61 6e64    mock_preds_and
+0000e130: 5f66 6565 6462 6163 6b2e 6173 7365 7274  _feedback.assert
+0000e140: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+0000e150: 6828 0a20 2020 2020 2020 2061 7070 6c69  h(.        appli
+0000e160: 6361 7469 6f6e 3d22 666f 6f62 6172 222c  cation="foobar",
+0000e170: 0a20 2020 2020 2020 2069 6e70 7574 733d  .        inputs=
+0000e180: 5b7b 2241 223a 2031 3030 7d2c 207b 2241  [{"A": 100}, {"A
+0000e190: 223a 2031 3031 7d5d 2c0a 2020 2020 2020  ": 101}],.      
+0000e1a0: 2020 6f75 7470 7574 733d 5b7b 2242 223a    outputs=[{"B":
+0000e1b0: 2033 3030 7d2c 207b 2242 223a 2033 3031   300}, {"B": 301
+0000e1c0: 7d5d 2c0a 2020 2020 2020 2020 6665 6564  }],.        feed
+0000e1d0: 6261 636b 733d 5b7b 2241 223a 2032 3030  backs=[{"A": 200
+0000e1e0: 7d2c 207b 2241 223a 2032 3031 7d5d 2c0a  }, {"A": 201}],.
+0000e1f0: 2020 2020 2020 2020 6a6f 696e 5f6b 6579          join_key
+0000e200: 733d 5b22 3132 3334 3522 2c20 2236 3738  s=["12345", "678
+0000e210: 3930 225d 2069 6620 6b77 6172 6773 2065  90"] if kwargs e
+0000e220: 6c73 6520 5b22 3637 3839 3022 2c20 2231  lse ["67890", "1
+0000e230: 3233 3435 225d 2c0a 2020 2020 2020 2020  2345"],.        
+0000e240: 7665 7273 696f 6e3d 7665 7273 696f 6e2c  version=version,
+0000e250: 0a20 2020 2020 2020 2069 676e 6f72 655f  .        ignore_
+0000e260: 696e 7075 7473 3d4e 6f6e 652c 0a20 2020  inputs=None,.   
+0000e270: 2020 2020 2074 696d 6573 7461 6d70 733d       timestamps=
+0000e280: 7465 7374 5f74 696d 6573 7461 6d70 735f  test_timestamps_
+0000e290: 6c69 7374 2c0a 2020 2020 2020 2020 736f  list,.        so
+0000e2a0: 7274 5f6f 6e5f 7469 6d65 7374 616d 703d  rt_on_timestamp=
+0000e2b0: 5472 7565 2c0a 2020 2020 2020 2020 6173  True,.        as
+0000e2c0: 5f62 6174 6368 3d46 616c 7365 2c0a 2020  _batch=False,.  
+0000e2d0: 2020 2020 2020 7461 6773 3d65 7870 6563        tags=expec
+0000e2e0: 7465 645f 7461 6773 5f70 6172 616d 2c0a  ted_tags_param,.
+0000e2f0: 2020 2020 290a 2020 2020 6d6f 636b 5f70      ).    mock_p
+0000e300: 7265 6473 2e61 7373 6572 745f 6e6f 745f  reds.assert_not_
+0000e310: 6361 6c6c 6564 2829 0a20 2020 206d 6f63  called().    moc
+0000e320: 6b5f 6665 6564 6261 636b 2e61 7373 6572  k_feedback.asser
+0000e330: 745f 6e6f 745f 6361 6c6c 6564 2829 0a0a  t_not_called()..
+0000e340: 2020 2020 6d6f 636b 5f73 616d 706c 655f      mock_sample_
+0000e350: 7265 636f 7264 732e 6173 7365 7274 5f63  records.assert_c
+0000e360: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
+0000e370: 0a20 2020 2020 2020 2032 2c0a 2020 2020  .        2,.    
+0000e380: 2020 2020 312c 0a20 2020 2020 2020 205b      1,.        [
+0000e390: 7b22 4122 3a20 3130 307d 2c20 7b22 4122  {"A": 100}, {"A"
+0000e3a0: 3a20 3130 317d 5d2c 0a20 2020 2020 2020  : 101}],.       
+0000e3b0: 205b 7b22 4222 3a20 3330 307d 2c20 7b22   [{"B": 300}, {"
+0000e3c0: 4222 3a20 3330 317d 5d2c 0a20 2020 2020  B": 301}],.     
+0000e3d0: 2020 205b 7b22 4122 3a20 3230 307d 2c20     [{"A": 200}, 
+0000e3e0: 7b22 4122 3a20 3230 317d 5d2c 0a20 2020  {"A": 201}],.   
+0000e3f0: 2020 2020 2063 6c69 656e 742e 5f72 6573       client._res
+0000e400: 6f6c 7665 5f6a 6f69 6e5f 6b65 7973 282a  olve_join_keys(*
+0000e410: 2a6b 7761 7267 7329 2c0a 2020 2020 2020  *kwargs),.      
+0000e420: 2020 7465 7374 5f74 696d 6573 7461 6d70    test_timestamp
+0000e430: 735f 6c69 7374 2c0a 2020 2020 2020 2020  s_list,.        
+0000e440: 6578 7065 6374 6564 5f74 6167 735f 7061  expected_tags_pa
+0000e450: 7261 6d2c 0a20 2020 2029 0a0a 2020 2020  ram,.    )..    
+0000e460: 6966 206b 7761 7267 733a 0a20 2020 2020  if kwargs:.     
+0000e470: 2020 206d 6f63 6b5f 6a6f 696e 5f6b 6579     mock_join_key
+0000e480: 5f67 656e 2e61 7373 6572 745f 6e6f 745f  _gen.assert_not_
+0000e490: 6361 6c6c 6564 2829 0a20 2020 2065 6c73  called().    els
+0000e4a0: 653a 0a20 2020 2020 2020 206d 6f63 6b5f  e:.        mock_
+0000e4b0: 6a6f 696e 5f6b 6579 5f67 656e 2e61 7373  join_key_gen.ass
+0000e4c0: 6572 745f 6361 6c6c 6564 2829 0a0a 0a40  ert_called()...@
+0000e4d0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+0000e4e0: 6d65 7472 697a 6528 0a20 2020 2022 7465  metrize(.    "te
+0000e4f0: 7374 5f74 696d 6573 7461 6d70 732c 2074  st_timestamps, t
+0000e500: 6573 745f 7469 6d65 7374 616d 7073 5f6c  est_timestamps_l
+0000e510: 6973 7422 2c0a 2020 2020 5b0a 2020 2020  ist",.    [.    
+0000e520: 2020 2020 284e 6f6e 652c 204e 6f6e 6529      (None, None)
+0000e530: 2c0a 2020 2020 2020 2020 285b 4355 5252  ,.        ([CURR
+0000e540: 454e 545f 5449 4d45 5d20 2a20 322c 205b  ENT_TIME] * 2, [
+0000e550: 4355 5252 454e 545f 5449 4d45 5d20 2a20  CURRENT_TIME] * 
+0000e560: 3229 2c0a 2020 2020 2020 2020 286e 702e  2),.        (np.
+0000e570: 6172 7261 7928 5b43 5552 5245 4e54 5f54  array([CURRENT_T
+0000e580: 494d 455d 202a 2032 292c 205b 4355 5252  IME] * 2), [CURR
+0000e590: 454e 545f 5449 4d45 5d20 2a20 3229 2c0a  ENT_TIME] * 2),.
+0000e5a0: 2020 2020 5d2c 0a29 0a40 7079 7465 7374      ],.).@pytest
+0000e5b0: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
+0000e5c0: 6528 0a20 2020 2028 2274 6573 745f 696e  e(.    ("test_in
+0000e5d0: 7075 7473 222c 2022 7465 7374 5f6f 7574  puts", "test_out
+0000e5e0: 7075 7473 222c 2022 7465 7374 5f66 6565  puts", "test_fee
+0000e5f0: 6462 6163 6b73 2229 2c0a 2020 2020 5445  dbacks"),.    TE
+0000e600: 5354 5f49 4e50 5554 535f 4f55 5450 5554  ST_INPUTS_OUTPUT
+0000e610: 535f 4645 4544 4241 434b 532c 0a29 0a40  S_FEEDBACKS,.).@
+0000e620: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+0000e630: 6d65 7472 697a 6528 2276 6572 7369 6f6e  metrize("version
+0000e640: 222c 205b 4e6f 6e65 2c20 3130 2c20 2231  ", [None, 10, "1
+0000e650: 2e32 2e33 225d 290a 4070 7974 6573 742e  .2.3"]).@pytest.
+0000e660: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
+0000e670: 2822 7461 6773 2c20 726f 775f 7461 6773  ("tags, row_tags
+0000e680: 2c20 676c 6f62 616c 5f74 6167 732c 2065  , global_tags, e
+0000e690: 7870 6563 7465 645f 7461 6773 5f70 6172  xpected_tags_par
+0000e6a0: 616d 222c 2054 4553 545f 5441 4753 290a  am", TEST_TAGS).
+0000e6b0: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
+0000e6c0: 616d 6574 7269 7a65 280a 2020 2020 226b  ametrize(.    "k
+0000e6d0: 7761 7267 7322 2c0a 2020 2020 5b0a 2020  wargs",.    [.  
+0000e6e0: 2020 2020 2020 7b22 6665 6564 6261 636b        {"feedback
+0000e6f0: 5f6b 6579 7322 3a20 5b22 4122 5d7d 2c0a  _keys": ["A"]},.
+0000e700: 2020 2020 2020 2020 7b22 6665 6564 6261          {"feedba
+0000e710: 636b 5f69 6473 223a 205b 2231 3233 3435  ck_ids": ["12345
+0000e720: 222c 2022 3637 3839 3022 5d7d 2c0a 2020  ", "67890"]},.  
+0000e730: 2020 2020 2020 7b22 6a6f 696e 5f6b 6579        {"join_key
+0000e740: 7322 3a20 5b22 3534 3332 3122 2c20 2236  s": ["54321", "6
+0000e750: 3738 3930 225d 7d2c 0a20 2020 2020 2020  7890"]},.       
+0000e760: 207b 226a 6f69 6e5f 6b65 7973 223a 2070   {"join_keys": p
+0000e770: 642e 5365 7269 6573 285b 2235 3433 3231  d.Series(["54321
+0000e780: 222c 2022 3637 3839 3022 5d29 7d2c 0a20  ", "67890"])},. 
+0000e790: 2020 2020 2020 207b 7d2c 0a20 2020 205d         {},.    ]
+0000e7a0: 2c0a 290a 406d 6f63 6b2e 7061 7463 6828  ,.).@mock.patch(
+0000e7b0: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
+0000e7c0: 6c69 656e 742e 5f72 6573 6f6c 7665 5f6a  lient._resolve_j
+0000e7d0: 6f69 6e5f 6b65 7973 2229 0a40 6d6f 636b  oin_keys").@mock
+0000e7e0: 2e70 6174 6368 280a 2020 2020 2267 616e  .patch(.    "gan
+0000e7f0: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
+0000e800: 742e 4761 6e74 7279 2e5f 6c6f 675f 7072  t.Gantry._log_pr
+0000e810: 6564 6963 7469 6f6e 5f61 6e64 5f66 6565  ediction_and_fee
+0000e820: 6462 6163 6b5f 6576 656e 7473 222c 0a20  dback_events",. 
+0000e830: 2020 2072 6574 7572 6e5f 7661 6c75 653d     return_value=
+0000e840: 284e 6f6e 652c 205b 2231 3233 3435 222c  (None, ["12345",
+0000e850: 2022 3637 3839 3022 5d29 2c0a 290a 406d   "67890"]),.).@m
+0000e860: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
+0000e870: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
+0000e880: 4761 6e74 7279 2e5f 6c6f 675f 7072 6564  Gantry._log_pred
+0000e890: 6963 7469 6f6e 5f65 7665 6e74 7322 290a  iction_events").
+0000e8a0: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
+0000e8b0: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
+0000e8c0: 742e 4761 6e74 7279 2e5f 6c6f 675f 6665  t.Gantry._log_fe
+0000e8d0: 6564 6261 636b 5f65 7665 6e74 7322 290a  edback_events").
+0000e8e0: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
+0000e8f0: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
+0000e900: 742e 5f73 616d 706c 655f 7265 636f 7264  t._sample_record
+0000e910: 7322 2c20 7369 6465 5f65 6666 6563 743d  s", side_effect=
+0000e920: 636c 6965 6e74 2e5f 7361 6d70 6c65 5f72  client._sample_r
+0000e930: 6563 6f72 6473 290a 406d 6f63 6b2e 7061  ecords).@mock.pa
+0000e940: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
+0000e950: 6572 2e63 6c69 656e 742e 5f64 6566 6175  er.client._defau
+0000e960: 6c74 5f6a 6f69 6e5f 6b65 795f 6765 6e22  lt_join_key_gen"
+0000e970: 290a 6465 6620 7465 7374 5f6c 6f67 5f72  ).def test_log_r
+0000e980: 6563 6f72 6473 5f70 7265 6473 5f61 6e64  ecords_preds_and
+0000e990: 5f66 6565 6462 6163 6b28 0a20 2020 206d  _feedback(.    m
+0000e9a0: 6f63 6b5f 6a6f 696e 5f6b 6579 5f67 656e  ock_join_key_gen
+0000e9b0: 2c0a 2020 2020 6d6f 636b 5f73 616d 706c  ,.    mock_sampl
+0000e9c0: 655f 7265 636f 7264 732c 0a20 2020 206d  e_records,.    m
+0000e9d0: 6f63 6b5f 6665 6564 6261 636b 2c0a 2020  ock_feedback,.  
+0000e9e0: 2020 6d6f 636b 5f70 7265 6473 2c0a 2020    mock_preds,.  
+0000e9f0: 2020 6d6f 636b 5f70 7265 6473 5f61 6e64    mock_preds_and
+0000ea00: 5f66 6565 6462 6163 6b2c 0a20 2020 206d  _feedback,.    m
+0000ea10: 6f63 6b5f 7265 736f 6c76 655f 6a6f 696e  ock_resolve_join
+0000ea20: 5f6b 6579 732c 0a20 2020 206b 7761 7267  _keys,.    kwarg
+0000ea30: 732c 0a20 2020 2076 6572 7369 6f6e 2c0a  s,.    version,.
+0000ea40: 2020 2020 7461 6773 2c0a 2020 2020 726f      tags,.    ro
+0000ea50: 775f 7461 6773 2c0a 2020 2020 676c 6f62  w_tags,.    glob
+0000ea60: 616c 5f74 6167 732c 0a20 2020 2065 7870  al_tags,.    exp
+0000ea70: 6563 7465 645f 7461 6773 5f70 6172 616d  ected_tags_param
+0000ea80: 2c0a 2020 2020 7465 7374 5f74 696d 6573  ,.    test_times
+0000ea90: 7461 6d70 732c 0a20 2020 2074 6573 745f  tamps,.    test_
+0000eaa0: 7469 6d65 7374 616d 7073 5f6c 6973 742c  timestamps_list,
+0000eab0: 0a20 2020 2074 6573 745f 696e 7075 7473  .    test_inputs
+0000eac0: 2c0a 2020 2020 7465 7374 5f6f 7574 7075  ,.    test_outpu
+0000ead0: 7473 2c0a 2020 2020 7465 7374 5f66 6565  ts,.    test_fee
+0000eae0: 6462 6163 6b73 2c0a 2020 2020 636c 695f  dbacks,.    cli_
+0000eaf0: 6f62 6a2c 0a29 3a0a 2020 2020 6d6f 636b  obj,.):.    mock
+0000eb00: 5f6a 6f69 6e5f 6b65 795f 6765 6e2e 7369  _join_key_gen.si
+0000eb10: 6465 5f65 6666 6563 7420 3d20 5b22 3637  de_effect = ["67
+0000eb20: 3839 3022 2c20 2231 3233 3435 225d 0a20  890", "12345"]. 
+0000eb30: 2020 206d 6f63 6b5f 7265 736f 6c76 655f     mock_resolve_
+0000eb40: 6a6f 696e 5f6b 6579 732e 7265 7475 726e  join_keys.return
+0000eb50: 5f76 616c 7565 203d 205b 2231 3233 3435  _value = ["12345
+0000eb60: 222c 2022 3637 3839 3022 5d20 6966 206b  ", "67890"] if k
+0000eb70: 7761 7267 7320 656c 7365 204e 6f6e 650a  wargs else None.
+0000eb80: 2020 2020 6173 7365 7274 2063 6c69 5f6f      assert cli_o
+0000eb90: 626a 2e6c 6f67 5f72 6563 6f72 6473 280a  bj.log_records(.
+0000eba0: 2020 2020 2020 2020 6170 706c 6963 6174          applicat
+0000ebb0: 696f 6e3d 2266 6f6f 6261 7222 2c0a 2020  ion="foobar",.  
+0000ebc0: 2020 2020 2020 7665 7273 696f 6e3d 7665        version=ve
+0000ebd0: 7273 696f 6e2c 0a20 2020 2020 2020 2069  rsion,.        i
+0000ebe0: 6e70 7574 733d 7465 7374 5f69 6e70 7574  nputs=test_input
+0000ebf0: 732c 0a20 2020 2020 2020 206f 7574 7075  s,.        outpu
+0000ec00: 7473 3d74 6573 745f 6f75 7470 7574 732c  ts=test_outputs,
+0000ec10: 0a20 2020 2020 2020 2066 6565 6462 6163  .        feedbac
+0000ec20: 6b73 3d74 6573 745f 6665 6564 6261 636b  ks=test_feedback
+0000ec30: 732c 0a20 2020 2020 2020 2074 696d 6573  s,.        times
+0000ec40: 7461 6d70 733d 7465 7374 5f74 696d 6573  tamps=test_times
+0000ec50: 7461 6d70 732c 0a20 2020 2020 2020 2073  tamps,.        s
+0000ec60: 6f72 745f 6f6e 5f74 696d 6573 7461 6d70  ort_on_timestamp
+0000ec70: 3d54 7275 652c 0a20 2020 2020 2020 2073  =True,.        s
+0000ec80: 616d 706c 655f 7261 7465 3d31 2c0a 2020  ample_rate=1,.  
+0000ec90: 2020 2020 2020 7461 6773 3d74 6167 732c        tags=tags,
+0000eca0: 0a20 2020 2020 2020 2072 6f77 5f74 6167  .        row_tag
+0000ecb0: 733d 726f 775f 7461 6773 2c0a 2020 2020  s=row_tags,.    
+0000ecc0: 2020 2020 676c 6f62 616c 5f74 6167 733d      global_tags=
+0000ecd0: 676c 6f62 616c 5f74 6167 732c 0a20 2020  global_tags,.   
+0000ece0: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
+0000ecf0: 2020 2029 203d 3d20 284e 6f6e 652c 205b     ) == (None, [
+0000ed00: 2231 3233 3435 222c 2022 3637 3839 3022  "12345", "67890"
+0000ed10: 5d29 0a0a 2020 2020 6d6f 636b 5f70 7265  ])..    mock_pre
+0000ed20: 6473 5f61 6e64 5f66 6565 6462 6163 6b2e  ds_and_feedback.
+0000ed30: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
+0000ed40: 6365 5f77 6974 6828 0a20 2020 2020 2020  ce_with(.       
+0000ed50: 2061 7070 6c69 6361 7469 6f6e 3d22 666f   application="fo
+0000ed60: 6f62 6172 222c 0a20 2020 2020 2020 2069  obar",.        i
+0000ed70: 6e70 7574 733d 5b7b 2241 223a 2031 3030  nputs=[{"A": 100
+0000ed80: 7d2c 207b 2241 223a 2031 3031 7d5d 2c0a  }, {"A": 101}],.
+0000ed90: 2020 2020 2020 2020 6f75 7470 7574 733d          outputs=
+0000eda0: 5b7b 2242 223a 2033 3030 7d2c 207b 2242  [{"B": 300}, {"B
+0000edb0: 223a 2033 3031 7d5d 2c0a 2020 2020 2020  ": 301}],.      
+0000edc0: 2020 6665 6564 6261 636b 733d 5b7b 2241    feedbacks=[{"A
+0000edd0: 223a 2032 3030 7d2c 207b 2241 223a 2032  ": 200}, {"A": 2
+0000ede0: 3031 7d5d 2c0a 2020 2020 2020 2020 6a6f  01}],.        jo
+0000edf0: 696e 5f6b 6579 733d 5b22 3132 3334 3522  in_keys=["12345"
+0000ee00: 2c20 2236 3738 3930 225d 2069 6620 6b77  , "67890"] if kw
+0000ee10: 6172 6773 2065 6c73 6520 5b22 3637 3839  args else ["6789
+0000ee20: 3022 2c20 2231 3233 3435 225d 2c0a 2020  0", "12345"],.  
+0000ee30: 2020 2020 2020 7665 7273 696f 6e3d 7665        version=ve
+0000ee40: 7273 696f 6e2c 0a20 2020 2020 2020 2069  rsion,.        i
+0000ee50: 676e 6f72 655f 696e 7075 7473 3d4e 6f6e  gnore_inputs=Non
+0000ee60: 652c 0a20 2020 2020 2020 2074 696d 6573  e,.        times
+0000ee70: 7461 6d70 733d 7465 7374 5f74 696d 6573  tamps=test_times
+0000ee80: 7461 6d70 735f 6c69 7374 2c0a 2020 2020  tamps_list,.    
+0000ee90: 2020 2020 736f 7274 5f6f 6e5f 7469 6d65      sort_on_time
+0000eea0: 7374 616d 703d 5472 7565 2c0a 2020 2020  stamp=True,.    
+0000eeb0: 2020 2020 6173 5f62 6174 6368 3d46 616c      as_batch=Fal
+0000eec0: 7365 2c0a 2020 2020 2020 2020 7461 6773  se,.        tags
+0000eed0: 3d65 7870 6563 7465 645f 7461 6773 5f70  =expected_tags_p
+0000eee0: 6172 616d 2c0a 2020 2020 290a 2020 2020  aram,.    ).    
+0000eef0: 6d6f 636b 5f70 7265 6473 2e61 7373 6572  mock_preds.asser
+0000ef00: 745f 6e6f 745f 6361 6c6c 6564 2829 0a20  t_not_called(). 
+0000ef10: 2020 206d 6f63 6b5f 6665 6564 6261 636b     mock_feedback
+0000ef20: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
+0000ef30: 6564 2829 0a0a 2020 2020 6d6f 636b 5f73  ed()..    mock_s
+0000ef40: 616d 706c 655f 7265 636f 7264 732e 6173  ample_records.as
+0000ef50: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
+0000ef60: 5f77 6974 6828 0a20 2020 2020 2020 2032  _with(.        2
+0000ef70: 2c0a 2020 2020 2020 2020 312c 0a20 2020  ,.        1,.   
+0000ef80: 2020 2020 205b 7b22 4122 3a20 3130 307d       [{"A": 100}
+0000ef90: 2c20 7b22 4122 3a20 3130 317d 5d2c 0a20  , {"A": 101}],. 
+0000efa0: 2020 2020 2020 205b 7b22 4222 3a20 3330         [{"B": 30
+0000efb0: 307d 2c20 7b22 4222 3a20 3330 317d 5d2c  0}, {"B": 301}],
+0000efc0: 0a20 2020 2020 2020 205b 7b22 4122 3a20  .        [{"A": 
+0000efd0: 3230 307d 2c20 7b22 4122 3a20 3230 317d  200}, {"A": 201}
+0000efe0: 5d2c 0a20 2020 2020 2020 2063 6c69 656e  ],.        clien
+0000eff0: 742e 5f72 6573 6f6c 7665 5f6a 6f69 6e5f  t._resolve_join_
+0000f000: 6b65 7973 282a 2a6b 7761 7267 7329 2c0a  keys(**kwargs),.
+0000f010: 2020 2020 2020 2020 7465 7374 5f74 696d          test_tim
+0000f020: 6573 7461 6d70 735f 6c69 7374 2c0a 2020  estamps_list,.  
+0000f030: 2020 2020 2020 6578 7065 6374 6564 5f74        expected_t
+0000f040: 6167 735f 7061 7261 6d2c 0a20 2020 2029  ags_param,.    )
+0000f050: 0a0a 2020 2020 6966 206b 7761 7267 733a  ..    if kwargs:
+0000f060: 0a20 2020 2020 2020 206d 6f63 6b5f 6a6f  .        mock_jo
+0000f070: 696e 5f6b 6579 5f67 656e 2e61 7373 6572  in_key_gen.asser
+0000f080: 745f 6e6f 745f 6361 6c6c 6564 2829 0a20  t_not_called(). 
+0000f090: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000f0a0: 206d 6f63 6b5f 6a6f 696e 5f6b 6579 5f67   mock_join_key_g
+0000f0b0: 656e 2e61 7373 6572 745f 6361 6c6c 6564  en.assert_called
+0000f0c0: 2829 0a0a 0a40 7079 7465 7374 2e6d 6172  ()...@pytest.mar
+0000f0d0: 6b2e 7061 7261 6d65 7472 697a 6528 0a20  k.parametrize(. 
+0000f0e0: 2020 2022 7465 7374 5f74 696d 6573 7461     "test_timesta
+0000f0f0: 6d70 732c 2074 6573 745f 7469 6d65 7374  mps, test_timest
+0000f100: 616d 7073 5f6c 6973 7422 2c0a 2020 2020  amps_list",.    
+0000f110: 5b0a 2020 2020 2020 2020 284e 6f6e 652c  [.        (None,
+0000f120: 204e 6f6e 6529 2c0a 2020 2020 2020 2020   None),.        
+0000f130: 285b 4355 5252 454e 545f 5449 4d45 5d20  ([CURRENT_TIME] 
+0000f140: 2a20 322c 205b 4355 5252 454e 545f 5449  * 2, [CURRENT_TI
+0000f150: 4d45 5d20 2a20 3229 2c0a 2020 2020 2020  ME] * 2),.      
+0000f160: 2020 286e 702e 6172 7261 7928 5b43 5552    (np.array([CUR
+0000f170: 5245 4e54 5f54 494d 455d 202a 2032 292c  RENT_TIME] * 2),
+0000f180: 205b 4355 5252 454e 545f 5449 4d45 5d20   [CURRENT_TIME] 
+0000f190: 2a20 3229 2c0a 2020 2020 5d2c 0a29 0a40  * 2),.    ],.).@
+0000f1a0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+0000f1b0: 6d65 7472 697a 6528 0a20 2020 2028 2274  metrize(.    ("t
+0000f1c0: 6573 745f 696e 7075 7473 222c 2022 7465  est_inputs", "te
+0000f1d0: 7374 5f6f 7574 7075 7473 222c 2022 7465  st_outputs", "te
+0000f1e0: 7374 5f66 6565 6462 6163 6b73 2229 2c0a  st_feedbacks"),.
+0000f1f0: 2020 2020 5445 5354 5f49 4e50 5554 535f      TEST_INPUTS_
+0000f200: 4f55 5450 5554 535f 4645 4544 4241 434b  OUTPUTS_FEEDBACK
+0000f210: 532c 0a29 0a40 7079 7465 7374 2e6d 6172  S,.).@pytest.mar
+0000f220: 6b2e 7061 7261 6d65 7472 697a 6528 2276  k.parametrize("v
+0000f230: 6572 7369 6f6e 222c 205b 4e6f 6e65 2c20  ersion", [None, 
+0000f240: 3130 2c20 2231 2e32 2e33 225d 290a 4070  10, "1.2.3"]).@p
+0000f250: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+0000f260: 6574 7269 7a65 2822 7461 6773 2c20 726f  etrize("tags, ro
+0000f270: 775f 7461 6773 2c20 676c 6f62 616c 5f74  w_tags, global_t
+0000f280: 6167 732c 2065 7870 6563 7465 645f 7461  ags, expected_ta
+0000f290: 6773 5f70 6172 616d 222c 2054 4553 545f  gs_param", TEST_
+0000f2a0: 5441 4753 290a 4070 7974 6573 742e 6d61  TAGS).@pytest.ma
+0000f2b0: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
+0000f2c0: 2020 2020 226b 7761 7267 7322 2c0a 2020      "kwargs",.  
+0000f2d0: 2020 5b0a 2020 2020 2020 2020 7b22 6a6f    [.        {"jo
+0000f2e0: 696e 5f6b 6579 7322 3a20 5b22 3534 3332  in_keys": ["5432
+0000f2f0: 3122 2c20 2236 3738 3930 225d 7d2c 0a20  1", "67890"]},. 
+0000f300: 2020 2020 2020 207b 226a 6f69 6e5f 6b65         {"join_ke
+0000f310: 7973 223a 2070 642e 5365 7269 6573 285b  ys": pd.Series([
+0000f320: 2235 3433 3231 222c 2022 3637 3839 3022  "54321", "67890"
+0000f330: 5d29 7d2c 0a20 2020 2020 2020 207b 7d2c  ])},.        {},
+0000f340: 0a20 2020 205d 2c0a 290a 406d 6f63 6b2e  .    ],.).@mock.
+0000f350: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
+0000f360: 6767 6572 2e63 6c69 656e 742e 5f72 6573  gger.client._res
+0000f370: 6f6c 7665 5f6a 6f69 6e5f 6b65 7973 2229  olve_join_keys")
+0000f380: 0a40 6d6f 636b 2e70 6174 6368 280a 2020  .@mock.patch(.  
+0000f390: 2020 2267 616e 7472 792e 6c6f 6767 6572    "gantry.logger
+0000f3a0: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
+0000f3b0: 6765 6e65 7261 7465 5f70 7265 6469 6374  generate_predict
+0000f3c0: 696f 6e5f 616e 645f 6665 6564 6261 636b  ion_and_feedback
+0000f3d0: 5f65 7665 6e74 7322 2c0a 2020 2020 7265  _events",.    re
+0000f3e0: 7475 726e 5f76 616c 7565 3d28 5b7b 2265  turn_value=([{"e
+0000f3f0: 7665 6e74 223a 2022 706c 6163 655f 686f  vent": "place_ho
+0000f400: 6c64 6572 227d 5d2c 205b 2231 3233 3435  lder"}], ["12345
+0000f410: 222c 2022 3637 3839 3022 5d29 2c0a 290a  ", "67890"]),.).
+0000f420: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
+0000f430: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
+0000f440: 742e 4761 6e74 7279 2e5f 6765 6e65 7261  t.Gantry._genera
+0000f450: 7465 5f70 7265 6469 6374 696f 6e5f 6576  te_prediction_ev
+0000f460: 656e 7473 2229 0a40 6d6f 636b 2e70 6174  ents").@mock.pat
+0000f470: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
+0000f480: 722e 636c 6965 6e74 2e47 616e 7472 792e  r.client.Gantry.
+0000f490: 5f67 656e 6572 6174 655f 6665 6564 6261  _generate_feedba
+0000f4a0: 636b 5f65 7665 6e74 7322 290a 406d 6f63  ck_events").@moc
+0000f4b0: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
+0000f4c0: 6c6f 6767 6572 2e63 6c69 656e 742e 5f73  logger.client._s
+0000f4d0: 616d 706c 655f 7265 636f 7264 7322 2c20  ample_records", 
+0000f4e0: 7369 6465 5f65 6666 6563 743d 636c 6965  side_effect=clie
+0000f4f0: 6e74 2e5f 7361 6d70 6c65 5f72 6563 6f72  nt._sample_recor
+0000f500: 6473 290a 406d 6f63 6b2e 7061 7463 6828  ds).@mock.patch(
+0000f510: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
+0000f520: 6c69 656e 742e 5f64 6566 6175 6c74 5f6a  lient._default_j
+0000f530: 6f69 6e5f 6b65 795f 6765 6e22 290a 6465  oin_key_gen").de
+0000f540: 6620 7465 7374 5f67 656e 6572 6174 655f  f test_generate_
+0000f550: 7265 636f 7264 735f 7072 6564 735f 616e  records_preds_an
+0000f560: 645f 6665 6564 6261 636b 280a 2020 2020  d_feedback(.    
+0000f570: 6d6f 636b 5f6a 6f69 6e5f 6b65 795f 6765  mock_join_key_ge
+0000f580: 6e2c 0a20 2020 206d 6f63 6b5f 7361 6d70  n,.    mock_samp
+0000f590: 6c65 5f72 6563 6f72 6473 2c0a 2020 2020  le_records,.    
+0000f5a0: 6d6f 636b 5f67 656e 6572 6174 655f 6665  mock_generate_fe
+0000f5b0: 6564 6261 636b 2c0a 2020 2020 6d6f 636b  edback,.    mock
+0000f5c0: 5f67 656e 6572 6174 655f 7072 6564 732c  _generate_preds,
+0000f5d0: 0a20 2020 206d 6f63 6b5f 6765 6e65 7261  .    mock_genera
+0000f5e0: 7465 5f70 7265 6473 5f61 6e64 5f66 6565  te_preds_and_fee
+0000f5f0: 6462 6163 6b2c 0a20 2020 206d 6f63 6b5f  dback,.    mock_
+0000f600: 7265 736f 6c76 655f 6a6f 696e 5f6b 6579  resolve_join_key
+0000f610: 732c 0a20 2020 206b 7761 7267 732c 0a20  s,.    kwargs,. 
+0000f620: 2020 2076 6572 7369 6f6e 2c0a 2020 2020     version,.    
+0000f630: 7461 6773 2c0a 2020 2020 726f 775f 7461  tags,.    row_ta
+0000f640: 6773 2c0a 2020 2020 676c 6f62 616c 5f74  gs,.    global_t
+0000f650: 6167 732c 0a20 2020 2065 7870 6563 7465  ags,.    expecte
+0000f660: 645f 7461 6773 5f70 6172 616d 2c0a 2020  d_tags_param,.  
+0000f670: 2020 7465 7374 5f74 696d 6573 7461 6d70    test_timestamp
+0000f680: 732c 0a20 2020 2074 6573 745f 7469 6d65  s,.    test_time
+0000f690: 7374 616d 7073 5f6c 6973 742c 0a20 2020  stamps_list,.   
+0000f6a0: 2074 6573 745f 696e 7075 7473 2c0a 2020   test_inputs,.  
+0000f6b0: 2020 7465 7374 5f6f 7574 7075 7473 2c0a    test_outputs,.
+0000f6c0: 2020 2020 7465 7374 5f66 6565 6462 6163      test_feedbac
+0000f6d0: 6b73 2c0a 2020 2020 636c 695f 6f62 6a2c  ks,.    cli_obj,
+0000f6e0: 0a29 3a0a 2020 2020 6966 2069 7369 6e73  .):.    if isins
+0000f6f0: 7461 6e63 6528 7461 6773 2c20 6c69 7374  tance(tags, list
+0000f700: 293a 0a20 2020 2020 2020 2070 7974 6573  ):.        pytes
+0000f710: 742e 736b 6970 2822 5468 6973 2074 6573  t.skip("This tes
+0000f720: 7420 6973 206e 6f74 2061 7070 6c69 6361  t is not applica
+0000f730: 626c 6520 746f 206c 6973 7420 7461 6773  ble to list tags
+0000f740: 2229 0a0a 2020 2020 6d6f 636b 5f6a 6f69  ")..    mock_joi
+0000f750: 6e5f 6b65 795f 6765 6e2e 7369 6465 5f65  n_key_gen.side_e
+0000f760: 6666 6563 7420 3d20 5b22 3637 3839 3022  ffect = ["67890"
+0000f770: 2c20 2231 3233 3435 225d 0a20 2020 206d  , "12345"].    m
+0000f780: 6f63 6b5f 7265 736f 6c76 655f 6a6f 696e  ock_resolve_join
+0000f790: 5f6b 6579 732e 7265 7475 726e 5f76 616c  _keys.return_val
+0000f7a0: 7565 203d 205b 2231 3233 3435 222c 2022  ue = ["12345", "
+0000f7b0: 3637 3839 3022 5d20 6966 206b 7761 7267  67890"] if kwarg
+0000f7c0: 7320 656c 7365 204e 6f6e 650a 2020 2020  s else None.    
+0000f7d0: 7275 6e5f 6964 203d 2073 7472 2875 7569  run_id = str(uui
+0000f7e0: 642e 7575 6964 3428 2929 0a20 2020 2072  d.uuid4()).    r
+0000f7f0: 756e 5f74 6167 7320 3d20 4e6f 6e65 0a20  un_tags = None. 
+0000f800: 2020 2069 6620 7461 6773 2061 6e64 2067     if tags and g
+0000f810: 6c6f 6261 6c5f 7461 6773 3a0a 2020 2020  lobal_tags:.    
+0000f820: 2020 2020 7275 6e5f 7461 6773 203d 207b      run_tags = {
+0000f830: 2a2a 7461 6773 2c20 2a2a 676c 6f62 616c  **tags, **global
+0000f840: 5f74 6167 737d 0a20 2020 2065 6c69 6620  _tags}.    elif 
+0000f850: 7461 6773 3a0a 2020 2020 2020 2020 7275  tags:.        ru
+0000f860: 6e5f 7461 6773 203d 2074 6167 730a 2020  n_tags = tags.  
+0000f870: 2020 656c 6966 2067 6c6f 6261 6c5f 7461    elif global_ta
+0000f880: 6773 3a0a 2020 2020 2020 2020 7275 6e5f  gs:.        run_
+0000f890: 7461 6773 203d 2067 6c6f 6261 6c5f 7461  tags = global_ta
+0000f8a0: 6773 0a20 2020 2061 7373 6572 7420 636c  gs.    assert cl
+0000f8b0: 695f 6f62 6a2e 6c6f 6728 0a20 2020 2020  i_obj.log(.     
+0000f8c0: 2020 2061 7070 6c69 6361 7469 6f6e 3d22     application="
+0000f8d0: 666f 6f62 6172 222c 0a20 2020 2020 2020  foobar",.       
+0000f8e0: 2076 6572 7369 6f6e 3d76 6572 7369 6f6e   version=version
+0000f8f0: 2c0a 2020 2020 2020 2020 696e 7075 7473  ,.        inputs
+0000f900: 3d74 6573 745f 696e 7075 7473 2c0a 2020  =test_inputs,.  
+0000f910: 2020 2020 2020 6f75 7470 7574 733d 7465        outputs=te
+0000f920: 7374 5f6f 7574 7075 7473 2c0a 2020 2020  st_outputs,.    
+0000f930: 2020 2020 6665 6564 6261 636b 733d 7465      feedbacks=te
+0000f940: 7374 5f66 6565 6462 6163 6b73 2c0a 2020  st_feedbacks,.  
+0000f950: 2020 2020 2020 7469 6d65 7374 616d 7073        timestamps
+0000f960: 3d74 6573 745f 7469 6d65 7374 616d 7073  =test_timestamps
+0000f970: 2c0a 2020 2020 2020 2020 736f 7274 5f6f  ,.        sort_o
+0000f980: 6e5f 7469 6d65 7374 616d 703d 5472 7565  n_timestamp=True
+0000f990: 2c0a 2020 2020 2020 2020 7361 6d70 6c65  ,.        sample
+0000f9a0: 5f72 6174 653d 312c 0a20 2020 2020 2020  _rate=1,.       
+0000f9b0: 2072 756e 5f74 6167 733d 7275 6e5f 7461   run_tags=run_ta
+0000f9c0: 6773 2c0a 2020 2020 2020 2020 726f 775f  gs,.        row_
+0000f9d0: 7461 6773 3d72 6f77 5f74 6167 732c 0a20  tags=row_tags,. 
+0000f9e0: 2020 2020 2020 2072 756e 5f69 643d 7275         run_id=ru
+0000f9f0: 6e5f 6964 2c0a 2020 2020 2020 2020 2a2a  n_id,.        **
+0000fa00: 6b77 6172 6773 2c0a 2020 2020 2920 3d3d  kwargs,.    ) ==
+0000fa10: 205b 7b22 6576 656e 7422 3a20 2270 6c61   [{"event": "pla
+0000fa20: 6365 5f68 6f6c 6465 7222 7d5d 0a0a 2020  ce_holder"}]..  
+0000fa30: 2020 6d6f 636b 5f67 656e 6572 6174 655f    mock_generate_
+0000fa40: 7072 6564 735f 616e 645f 6665 6564 6261  preds_and_feedba
+0000fa50: 636b 2e61 7373 6572 745f 6361 6c6c 6564  ck.assert_called
+0000fa60: 5f6f 6e63 655f 7769 7468 280a 2020 2020  _once_with(.    
+0000fa70: 2020 2020 6170 706c 6963 6174 696f 6e3d      application=
+0000fa80: 2266 6f6f 6261 7222 2c0a 2020 2020 2020  "foobar",.      
+0000fa90: 2020 696e 7075 7473 3d5b 7b22 4122 3a20    inputs=[{"A": 
+0000faa0: 3130 307d 2c20 7b22 4122 3a20 3130 317d  100}, {"A": 101}
+0000fab0: 5d2c 0a20 2020 2020 2020 206f 7574 7075  ],.        outpu
+0000fac0: 7473 3d5b 7b22 4222 3a20 3330 307d 2c20  ts=[{"B": 300}, 
+0000fad0: 7b22 4222 3a20 3330 317d 5d2c 0a20 2020  {"B": 301}],.   
+0000fae0: 2020 2020 2066 6565 6462 6163 6b73 3d5b       feedbacks=[
+0000faf0: 7b22 4122 3a20 3230 307d 2c20 7b22 4122  {"A": 200}, {"A"
+0000fb00: 3a20 3230 317d 5d2c 0a20 2020 2020 2020  : 201}],.       
+0000fb10: 206a 6f69 6e5f 6b65 7973 3d5b 2231 3233   join_keys=["123
+0000fb20: 3435 222c 2022 3637 3839 3022 5d20 6966  45", "67890"] if
+0000fb30: 206b 7761 7267 7320 656c 7365 205b 2236   kwargs else ["6
+0000fb40: 3738 3930 222c 2022 3132 3334 3522 5d2c  7890", "12345"],
+0000fb50: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
+0000fb60: 3d76 6572 7369 6f6e 2c0a 2020 2020 2020  =version,.      
+0000fb70: 2020 6967 6e6f 7265 5f69 6e70 7574 733d    ignore_inputs=
+0000fb80: 4e6f 6e65 2c0a 2020 2020 2020 2020 7469  None,.        ti
+0000fb90: 6d65 7374 616d 7073 3d74 6573 745f 7469  mestamps=test_ti
+0000fba0: 6d65 7374 616d 7073 5f6c 6973 742c 0a20  mestamps_list,. 
+0000fbb0: 2020 2020 2020 2073 6f72 745f 6f6e 5f74         sort_on_t
+0000fbc0: 696d 6573 7461 6d70 3d54 7275 652c 0a20  imestamp=True,. 
+0000fbd0: 2020 2020 2020 2072 756e 5f69 643d 7275         run_id=ru
+0000fbe0: 6e5f 6964 2c0a 2020 2020 2020 2020 7461  n_id,.        ta
+0000fbf0: 6773 3d65 7870 6563 7465 645f 7461 6773  gs=expected_tags
+0000fc00: 5f70 6172 616d 2c0a 2020 2020 290a 2020  _param,.    ).  
+0000fc10: 2020 6d6f 636b 5f67 656e 6572 6174 655f    mock_generate_
+0000fc20: 7072 6564 732e 6173 7365 7274 5f6e 6f74  preds.assert_not
+0000fc30: 5f63 616c 6c65 6428 290a 2020 2020 6d6f  _called().    mo
+0000fc40: 636b 5f67 656e 6572 6174 655f 6665 6564  ck_generate_feed
+0000fc50: 6261 636b 2e61 7373 6572 745f 6e6f 745f  back.assert_not_
+0000fc60: 6361 6c6c 6564 2829 0a0a 2020 2020 6d6f  called()..    mo
+0000fc70: 636b 5f73 616d 706c 655f 7265 636f 7264  ck_sample_record
+0000fc80: 732e 6173 7365 7274 5f63 616c 6c65 645f  s.assert_called_
+0000fc90: 6f6e 6365 5f77 6974 6828 0a20 2020 2020  once_with(.     
+0000fca0: 2020 2032 2c0a 2020 2020 2020 2020 312c     2,.        1,
+0000fcb0: 0a20 2020 2020 2020 205b 7b22 4122 3a20  .        [{"A": 
+0000fcc0: 3130 307d 2c20 7b22 4122 3a20 3130 317d  100}, {"A": 101}
+0000fcd0: 5d2c 0a20 2020 2020 2020 205b 7b22 4222  ],.        [{"B"
+0000fce0: 3a20 3330 307d 2c20 7b22 4222 3a20 3330  : 300}, {"B": 30
+0000fcf0: 317d 5d2c 0a20 2020 2020 2020 205b 7b22  1}],.        [{"
+0000fd00: 4122 3a20 3230 307d 2c20 7b22 4122 3a20  A": 200}, {"A": 
+0000fd10: 3230 317d 5d2c 0a20 2020 2020 2020 2063  201}],.        c
+0000fd20: 6c69 656e 742e 5f72 6573 6f6c 7665 5f6a  lient._resolve_j
+0000fd30: 6f69 6e5f 6b65 7973 282a 2a6b 7761 7267  oin_keys(**kwarg
+0000fd40: 7329 2c0a 2020 2020 2020 2020 7465 7374  s),.        test
+0000fd50: 5f74 696d 6573 7461 6d70 735f 6c69 7374  _timestamps_list
+0000fd60: 2c0a 2020 2020 2020 2020 6578 7065 6374  ,.        expect
+0000fd70: 6564 5f74 6167 735f 7061 7261 6d2c 0a20  ed_tags_param,. 
+0000fd80: 2020 2029 0a0a 2020 2020 6966 206b 7761     )..    if kwa
+0000fd90: 7267 733a 0a20 2020 2020 2020 206d 6f63  rgs:.        moc
+0000fda0: 6b5f 6a6f 696e 5f6b 6579 5f67 656e 2e61  k_join_key_gen.a
+0000fdb0: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
+0000fdc0: 2829 0a20 2020 2065 6c73 653a 0a20 2020  ().    else:.   
+0000fdd0: 2020 2020 206d 6f63 6b5f 6a6f 696e 5f6b       mock_join_k
+0000fde0: 6579 5f67 656e 2e61 7373 6572 745f 6361  ey_gen.assert_ca
+0000fdf0: 6c6c 6564 2829 0a0a 0a40 7079 7465 7374  lled()...@pytest
+0000fe00: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
+0000fe10: 6528 0a20 2020 2022 7465 7374 5f74 696d  e(.    "test_tim
+0000fe20: 6573 7461 6d70 732c 2074 6573 745f 7469  estamps, test_ti
+0000fe30: 6d65 7374 616d 7073 5f6c 6973 7422 2c0a  mestamps_list",.
+0000fe40: 2020 2020 5b0a 2020 2020 2020 2020 284e      [.        (N
+0000fe50: 6f6e 652c 204e 6f6e 6529 2c0a 2020 2020  one, None),.    
+0000fe60: 2020 2020 285b 4355 5252 454e 545f 5449      ([CURRENT_TI
+0000fe70: 4d45 5d20 2a20 322c 205b 4355 5252 454e  ME] * 2, [CURREN
+0000fe80: 545f 5449 4d45 5d20 2a20 3229 2c0a 2020  T_TIME] * 2),.  
+0000fe90: 2020 2020 2020 286e 702e 6172 7261 7928        (np.array(
+0000fea0: 5b43 5552 5245 4e54 5f54 494d 455d 202a  [CURRENT_TIME] *
+0000feb0: 2032 292c 205b 4355 5252 454e 545f 5449   2), [CURRENT_TI
+0000fec0: 4d45 5d20 2a20 3229 2c0a 2020 2020 5d2c  ME] * 2),.    ],
+0000fed0: 0a29 0a40 7079 7465 7374 2e6d 6172 6b2e  .).@pytest.mark.
+0000fee0: 7061 7261 6d65 7472 697a 6528 0a20 2020  parametrize(.   
+0000fef0: 2028 2274 6573 745f 696e 7075 7473 222c   ("test_inputs",
+0000ff00: 2022 7465 7374 5f6f 7574 7075 7473 222c   "test_outputs",
+0000ff10: 2022 7465 7374 5f66 6565 6462 6163 6b73   "test_feedbacks
+0000ff20: 2229 2c0a 2020 2020 5445 5354 5f49 4e50  "),.    TEST_INP
+0000ff30: 5554 535f 4f55 5450 5554 535f 4645 4544  UTS_OUTPUTS_FEED
+0000ff40: 4241 434b 532c 0a29 0a40 7079 7465 7374  BACKS,.).@pytest
+0000ff50: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
+0000ff60: 6528 2276 6572 7369 6f6e 222c 205b 4e6f  e("version", [No
+0000ff70: 6e65 2c20 3130 2c20 2231 2e32 2e33 225d  ne, 10, "1.2.3"]
+0000ff80: 290a 4070 7974 6573 742e 6d61 726b 2e70  ).@pytest.mark.p
+0000ff90: 6172 616d 6574 7269 7a65 2822 7461 6773  arametrize("tags
+0000ffa0: 2c20 726f 775f 7461 6773 2c20 676c 6f62  , row_tags, glob
+0000ffb0: 616c 5f74 6167 732c 2065 7870 6563 7465  al_tags, expecte
+0000ffc0: 645f 7461 6773 5f70 6172 616d 222c 2054  d_tags_param", T
+0000ffd0: 4553 545f 5441 4753 290a 4070 7974 6573  EST_TAGS).@pytes
+0000ffe0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+0000fff0: 7a65 280a 2020 2020 226b 7761 7267 7322  ze(.    "kwargs"
+00010000: 2c0a 2020 2020 5b0a 2020 2020 2020 2020  ,.    [.        
+00010010: 7b22 6a6f 696e 5f6b 6579 7322 3a20 5b22  {"join_keys": ["
+00010020: 3534 3332 3122 2c20 2236 3738 3930 225d  54321", "67890"]
+00010030: 7d2c 0a20 2020 2020 2020 207b 226a 6f69  },.        {"joi
+00010040: 6e5f 6b65 7973 223a 2070 642e 5365 7269  n_keys": pd.Seri
+00010050: 6573 285b 2235 3433 3231 222c 2022 3637  es(["54321", "67
+00010060: 3839 3022 5d29 7d2c 0a20 2020 2020 2020  890"])},.       
+00010070: 207b 7d2c 0a20 2020 205d 2c0a 290a 406d   {},.    ],.).@m
+00010080: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
+00010090: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
+000100a0: 5f72 6573 6f6c 7665 5f6a 6f69 6e5f 6b65  _resolve_join_ke
+000100b0: 7973 2229 0a40 6d6f 636b 2e70 6174 6368  ys").@mock.patch
+000100c0: 280a 2020 2020 2267 616e 7472 792e 6c6f  (.    "gantry.lo
+000100d0: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
+000100e0: 7279 2e5f 6c6f 675f 7072 6564 6963 7469  ry._log_predicti
+000100f0: 6f6e 5f61 6e64 5f66 6565 6462 6163 6b5f  on_and_feedback_
+00010100: 6576 656e 7473 222c 0a20 2020 2072 6574  events",.    ret
+00010110: 7572 6e5f 7661 6c75 653d 284e 6f6e 652c  urn_value=(None,
+00010120: 205b 2231 3233 3435 222c 2022 3637 3839   ["12345", "6789
+00010130: 3022 5d29 2c0a 290a 406d 6f63 6b2e 7061  0"]),.).@mock.pa
+00010140: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
+00010150: 6572 2e63 6c69 656e 742e 4761 6e74 7279  er.client.Gantry
+00010160: 2e5f 6c6f 675f 7072 6564 6963 7469 6f6e  ._log_prediction
+00010170: 5f65 7665 6e74 7322 290a 406d 6f63 6b2e  _events").@mock.
+00010180: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
+00010190: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
+000101a0: 7279 2e5f 6c6f 675f 6665 6564 6261 636b  ry._log_feedback
+000101b0: 5f65 7665 6e74 7322 290a 406d 6f63 6b2e  _events").@mock.
+000101c0: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
+000101d0: 6767 6572 2e63 6c69 656e 742e 5f73 616d  gger.client._sam
+000101e0: 706c 655f 7265 636f 7264 7322 2c20 7369  ple_records", si
+000101f0: 6465 5f65 6666 6563 743d 636c 6965 6e74  de_effect=client
+00010200: 2e5f 7361 6d70 6c65 5f72 6563 6f72 6473  ._sample_records
+00010210: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
+00010220: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
+00010230: 656e 742e 5f64 6566 6175 6c74 5f6a 6f69  ent._default_joi
+00010240: 6e5f 6b65 795f 6765 6e22 290a 6465 6620  n_key_gen").def 
+00010250: 7465 7374 5f73 696e 676c 655f 6c6f 675f  test_single_log_
+00010260: 7072 6564 735f 616e 645f 6665 6564 6261  preds_and_feedba
+00010270: 636b 280a 2020 2020 6d6f 636b 5f6a 6f69  ck(.    mock_joi
+00010280: 6e5f 6b65 795f 6765 6e2c 0a20 2020 206d  n_key_gen,.    m
+00010290: 6f63 6b5f 7361 6d70 6c65 5f72 6563 6f72  ock_sample_recor
+000102a0: 6473 2c0a 2020 2020 6d6f 636b 5f6c 6f67  ds,.    mock_log
+000102b0: 5f66 6565 6462 6163 6b2c 0a20 2020 206d  _feedback,.    m
+000102c0: 6f63 6b5f 6c6f 675f 7072 6564 732c 0a20  ock_log_preds,. 
+000102d0: 2020 206d 6f63 6b5f 6c6f 675f 7072 6564     mock_log_pred
+000102e0: 735f 616e 645f 6665 6564 6261 636b 2c0a  s_and_feedback,.
+000102f0: 2020 2020 6d6f 636b 5f72 6573 6f6c 7665      mock_resolve
+00010300: 5f6a 6f69 6e5f 6b65 7973 2c0a 2020 2020  _join_keys,.    
+00010310: 6b77 6172 6773 2c0a 2020 2020 7665 7273  kwargs,.    vers
+00010320: 696f 6e2c 0a20 2020 2074 6167 732c 0a20  ion,.    tags,. 
+00010330: 2020 2072 6f77 5f74 6167 732c 0a20 2020     row_tags,.   
+00010340: 2067 6c6f 6261 6c5f 7461 6773 2c0a 2020   global_tags,.  
+00010350: 2020 6578 7065 6374 6564 5f74 6167 735f    expected_tags_
+00010360: 7061 7261 6d2c 0a20 2020 2074 6573 745f  param,.    test_
+00010370: 7469 6d65 7374 616d 7073 2c0a 2020 2020  timestamps,.    
+00010380: 7465 7374 5f74 696d 6573 7461 6d70 735f  test_timestamps_
+00010390: 6c69 7374 2c0a 2020 2020 7465 7374 5f69  list,.    test_i
+000103a0: 6e70 7574 732c 0a20 2020 2074 6573 745f  nputs,.    test_
+000103b0: 6f75 7470 7574 732c 0a20 2020 2074 6573  outputs,.    tes
+000103c0: 745f 6665 6564 6261 636b 732c 0a20 2020  t_feedbacks,.   
+000103d0: 2063 6c69 5f6f 626a 2c0a 293a 0a20 2020   cli_obj,.):.   
+000103e0: 206d 6f63 6b5f 6a6f 696e 5f6b 6579 5f67   mock_join_key_g
+000103f0: 656e 2e73 6964 655f 6566 6665 6374 203d  en.side_effect =
+00010400: 205b 2236 3738 3930 222c 2022 3132 3334   ["67890", "1234
+00010410: 3522 5d0a 2020 2020 6d6f 636b 5f72 6573  5"].    mock_res
+00010420: 6f6c 7665 5f6a 6f69 6e5f 6b65 7973 2e72  olve_join_keys.r
+00010430: 6574 7572 6e5f 7661 6c75 6520 3d20 5b22  eturn_value = ["
+00010440: 3132 3334 3522 2c20 2236 3738 3930 225d  12345", "67890"]
+00010450: 2069 6620 6b77 6172 6773 2065 6c73 6520   if kwargs else 
+00010460: 4e6f 6e65 0a20 2020 2063 6c69 5f6f 626a  None.    cli_obj
+00010470: 2e6c 6f67 280a 2020 2020 2020 2020 6170  .log(.        ap
+00010480: 706c 6963 6174 696f 6e3d 2266 6f6f 6261  plication="fooba
+00010490: 7222 2c0a 2020 2020 2020 2020 7665 7273  r",.        vers
+000104a0: 696f 6e3d 7665 7273 696f 6e2c 0a20 2020  ion=version,.   
+000104b0: 2020 2020 2069 6e70 7574 733d 7465 7374       inputs=test
+000104c0: 5f69 6e70 7574 732c 0a20 2020 2020 2020  _inputs,.       
+000104d0: 206f 7574 7075 7473 3d74 6573 745f 6f75   outputs=test_ou
+000104e0: 7470 7574 732c 0a20 2020 2020 2020 2066  tputs,.        f
+000104f0: 6565 6462 6163 6b73 3d74 6573 745f 6665  eedbacks=test_fe
+00010500: 6564 6261 636b 732c 0a20 2020 2020 2020  edbacks,.       
+00010510: 2074 696d 6573 7461 6d70 733d 7465 7374   timestamps=test
+00010520: 5f74 696d 6573 7461 6d70 732c 0a20 2020  _timestamps,.   
+00010530: 2020 2020 2073 6f72 745f 6f6e 5f74 696d       sort_on_tim
+00010540: 6573 7461 6d70 3d54 7275 652c 0a20 2020  estamp=True,.   
+00010550: 2020 2020 2073 616d 706c 655f 7261 7465       sample_rate
+00010560: 3d31 2c0a 2020 2020 2020 2020 676c 6f62  =1,.        glob
+00010570: 616c 5f74 6167 733d 676c 6f62 616c 5f74  al_tags=global_t
+00010580: 6167 732c 0a20 2020 2020 2020 2074 6167  ags,.        tag
+00010590: 733d 7461 6773 2c0a 2020 2020 2020 2020  s=tags,.        
+000105a0: 726f 775f 7461 6773 3d72 6f77 5f74 6167  row_tags=row_tag
+000105b0: 732c 0a20 2020 2020 2020 202a 2a6b 7761  s,.        **kwa
+000105c0: 7267 732c 0a20 2020 2029 0a0a 2020 2020  rgs,.    )..    
+000105d0: 6d6f 636b 5f6c 6f67 5f70 7265 6473 5f61  mock_log_preds_a
+000105e0: 6e64 5f66 6565 6462 6163 6b2e 6173 7365  nd_feedback.asse
+000105f0: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+00010600: 6974 6828 0a20 2020 2020 2020 2061 7070  ith(.        app
+00010610: 6c69 6361 7469 6f6e 3d22 666f 6f62 6172  lication="foobar
+00010620: 222c 0a20 2020 2020 2020 2069 6e70 7574  ",.        input
+00010630: 733d 5b7b 2241 223a 2031 3030 7d2c 207b  s=[{"A": 100}, {
+00010640: 2241 223a 2031 3031 7d5d 2c0a 2020 2020  "A": 101}],.    
+00010650: 2020 2020 6f75 7470 7574 733d 5b7b 2242      outputs=[{"B
+00010660: 223a 2033 3030 7d2c 207b 2242 223a 2033  ": 300}, {"B": 3
+00010670: 3031 7d5d 2c0a 2020 2020 2020 2020 6665  01}],.        fe
+00010680: 6564 6261 636b 733d 5b7b 2241 223a 2032  edbacks=[{"A": 2
+00010690: 3030 7d2c 207b 2241 223a 2032 3031 7d5d  00}, {"A": 201}]
+000106a0: 2c0a 2020 2020 2020 2020 6a6f 696e 5f6b  ,.        join_k
+000106b0: 6579 733d 5b22 3132 3334 3522 2c20 2236  eys=["12345", "6
+000106c0: 3738 3930 225d 2069 6620 6b77 6172 6773  7890"] if kwargs
+000106d0: 2065 6c73 6520 5b22 3637 3839 3022 2c20   else ["67890", 
+000106e0: 2231 3233 3435 225d 2c0a 2020 2020 2020  "12345"],.      
+000106f0: 2020 7665 7273 696f 6e3d 7665 7273 696f    version=versio
+00010700: 6e2c 0a20 2020 2020 2020 2069 676e 6f72  n,.        ignor
+00010710: 655f 696e 7075 7473 3d4e 6f6e 652c 0a20  e_inputs=None,. 
+00010720: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
+00010730: 733d 7465 7374 5f74 696d 6573 7461 6d70  s=test_timestamp
+00010740: 735f 6c69 7374 2c0a 2020 2020 2020 2020  s_list,.        
+00010750: 736f 7274 5f6f 6e5f 7469 6d65 7374 616d  sort_on_timestam
+00010760: 703d 5472 7565 2c0a 2020 2020 2020 2020  p=True,.        
+00010770: 7461 6773 3d65 7870 6563 7465 645f 7461  tags=expected_ta
+00010780: 6773 5f70 6172 616d 2c0a 2020 2020 2020  gs_param,.      
+00010790: 2020 6173 5f62 6174 6368 3d46 616c 7365    as_batch=False
+000107a0: 2c0a 2020 2020 290a 2020 2020 6d6f 636b  ,.    ).    mock
+000107b0: 5f6c 6f67 5f70 7265 6473 2e61 7373 6572  _log_preds.asser
+000107c0: 745f 6e6f 745f 6361 6c6c 6564 2829 0a20  t_not_called(). 
+000107d0: 2020 206d 6f63 6b5f 6c6f 675f 6665 6564     mock_log_feed
+000107e0: 6261 636b 2e61 7373 6572 745f 6e6f 745f  back.assert_not_
+000107f0: 6361 6c6c 6564 2829 0a0a 2020 2020 6d6f  called()..    mo
+00010800: 636b 5f73 616d 706c 655f 7265 636f 7264  ck_sample_record
+00010810: 732e 6173 7365 7274 5f63 616c 6c65 645f  s.assert_called_
+00010820: 6f6e 6365 5f77 6974 6828 0a20 2020 2020  once_with(.     
+00010830: 2020 2032 2c0a 2020 2020 2020 2020 312c     2,.        1,
+00010840: 0a20 2020 2020 2020 205b 7b22 4122 3a20  .        [{"A": 
+00010850: 3130 307d 2c20 7b22 4122 3a20 3130 317d  100}, {"A": 101}
+00010860: 5d2c 0a20 2020 2020 2020 205b 7b22 4222  ],.        [{"B"
+00010870: 3a20 3330 307d 2c20 7b22 4222 3a20 3330  : 300}, {"B": 30
+00010880: 317d 5d2c 0a20 2020 2020 2020 205b 7b22  1}],.        [{"
+00010890: 4122 3a20 3230 307d 2c20 7b22 4122 3a20  A": 200}, {"A": 
+000108a0: 3230 317d 5d2c 0a20 2020 2020 2020 2063  201}],.        c
+000108b0: 6c69 656e 742e 5f72 6573 6f6c 7665 5f6a  lient._resolve_j
+000108c0: 6f69 6e5f 6b65 7973 282a 2a6b 7761 7267  oin_keys(**kwarg
+000108d0: 7329 2c0a 2020 2020 2020 2020 7465 7374  s),.        test
+000108e0: 5f74 696d 6573 7461 6d70 735f 6c69 7374  _timestamps_list
+000108f0: 2c0a 2020 2020 2020 2020 6578 7065 6374  ,.        expect
+00010900: 6564 5f74 6167 735f 7061 7261 6d2c 0a20  ed_tags_param,. 
+00010910: 2020 2029 0a0a 2020 2020 6966 206b 7761     )..    if kwa
+00010920: 7267 733a 0a20 2020 2020 2020 206d 6f63  rgs:.        moc
+00010930: 6b5f 6a6f 696e 5f6b 6579 5f67 656e 2e61  k_join_key_gen.a
+00010940: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
+00010950: 2829 0a20 2020 2065 6c73 653a 0a20 2020  ().    else:.   
+00010960: 2020 2020 206d 6f63 6b5f 6a6f 696e 5f6b       mock_join_k
+00010970: 6579 5f67 656e 2e61 7373 6572 745f 6361  ey_gen.assert_ca
+00010980: 6c6c 6564 2829 0a0a 0a40 7079 7465 7374  lled()...@pytest
+00010990: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
+000109a0: 6528 0a20 2020 2022 696e 7075 7473 2c20  e(.    "inputs, 
+000109b0: 6f75 7470 7574 732c 2066 6565 6462 6163  outputs, feedbac
+000109c0: 6b73 222c 0a20 2020 205b 0a20 2020 2020  ks",.    [.     
+000109d0: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
+000109e0: 206e 702e 6172 7261 7928 5b32 3030 2c20   np.array([200, 
+000109f0: 3230 315d 292c 0a20 2020 2020 2020 2020  201]),.         
+00010a00: 2020 205b 7b22 4222 3a20 3230 307d 2c20     [{"B": 200}, 
+00010a10: 7b22 4222 3a20 3230 317d 5d2c 0a20 2020  {"B": 201}],.   
+00010a20: 2020 2020 2020 2020 205b 7b22 4122 3a20           [{"A": 
+00010a30: 3230 307d 2c20 7b22 4122 3a20 3230 317d  200}, {"A": 201}
+00010a40: 5d2c 0a20 2020 2020 2020 2029 2c0a 2020  ],.        ),.  
+00010a50: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
+00010a60: 2020 2020 6e70 2e61 7272 6179 285b 3230      np.array([20
+00010a70: 302c 2032 3031 5d29 2c0a 2020 2020 2020  0, 201]),.      
+00010a80: 2020 2020 2020 5b7b 2242 223a 2032 3030        [{"B": 200
+00010a90: 7d2c 207b 2242 223a 2032 3031 7d5d 2c0a  }, {"B": 201}],.
+00010aa0: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
+00010ab0: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
+00010ac0: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
+00010ad0: 2020 206e 702e 6172 7261 7928 5b32 3030     np.array([200
+00010ae0: 2c20 3230 315d 292c 0a20 2020 2020 2020  , 201]),.       
+00010af0: 2020 2020 206e 702e 6172 7261 7928 5b32       np.array([2
+00010b00: 3030 2c20 3230 315d 292c 0a20 2020 2020  00, 201]),.     
+00010b10: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
+00010b20: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+00010b30: 280a 2020 2020 2020 2020 2020 2020 5b7b  (.            [{
+00010b40: 2242 223a 2032 3030 7d2c 207b 2242 223a  "B": 200}, {"B":
+00010b50: 2032 3031 7d5d 2c0a 2020 2020 2020 2020   201}],.        
+00010b60: 2020 2020 6e70 2e61 7272 6179 285b 3230      np.array([20
+00010b70: 302c 2032 3031 5d29 2c0a 2020 2020 2020  0, 201]),.      
+00010b80: 2020 2020 2020 5b7b 2241 223a 2032 3030        [{"A": 200
+00010b90: 7d2c 207b 2241 223a 2032 3031 7d5d 2c0a  }, {"A": 201}],.
+00010ba0: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+00010bb0: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
+00010bc0: 205b 7b22 4222 3a20 3230 307d 2c20 7b22   [{"B": 200}, {"
+00010bd0: 4222 3a20 3230 317d 5d2c 0a20 2020 2020  B": 201}],.     
+00010be0: 2020 2020 2020 205b 7b22 4122 3a20 3230         [{"A": 20
+00010bf0: 307d 2c20 7b22 4122 3a20 3230 317d 5d2c  0}, {"A": 201}],
+00010c00: 0a20 2020 2020 2020 2020 2020 206e 702e  .            np.
+00010c10: 6172 7261 7928 5b32 3030 2c20 3230 315d  array([200, 201]
+00010c20: 292c 0a20 2020 2020 2020 2029 2c0a 2020  ),.        ),.  
+00010c30: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
+00010c40: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
+00010c50: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
+00010c60: 2020 2020 2020 2020 6e70 2e61 7272 6179          np.array
+00010c70: 285b 3230 302c 2032 3031 5d29 2c0a 2020  ([200, 201]),.  
+00010c80: 2020 2020 2020 292c 0a20 2020 205d 2c0a        ),.    ],.
+00010c90: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
+00010ca0: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
+00010cb0: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
+00010cc0: 7072 6564 6963 7469 6f6e 5f61 6e64 5f66  prediction_and_f
+00010cd0: 6565 6462 6163 6b5f 6576 656e 7473 2229  eedback_events")
+00010ce0: 0a40 6d6f 636b 2e70 6174 6368 2822 6761  .@mock.patch("ga
+00010cf0: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
+00010d00: 6e74 2e47 616e 7472 792e 5f6c 6f67 5f70  nt.Gantry._log_p
+00010d10: 7265 6469 6374 696f 6e5f 6576 656e 7473  rediction_events
+00010d20: 2229 0a40 6d6f 636b 2e70 6174 6368 2822  ").@mock.patch("
+00010d30: 6761 6e74 7279 2e6c 6f67 6765 722e 636c  gantry.logger.cl
+00010d40: 6965 6e74 2e47 616e 7472 792e 5f6c 6f67  ient.Gantry._log
+00010d50: 5f66 6565 6462 6163 6b5f 6576 656e 7473  _feedback_events
+00010d60: 2229 0a64 6566 2074 6573 745f 6c6f 675f  ").def test_log_
+00010d70: 7265 636f 7264 735f 7072 6564 735f 616e  records_preds_an
+00010d80: 645f 6665 6564 6261 636b 5f77 726f 6e67  d_feedback_wrong
+00010d90: 5f6e 705f 6172 7261 7928 0a20 2020 206d  _np_array(.    m
+00010da0: 6f63 6b5f 6665 6564 6261 636b 2c0a 2020  ock_feedback,.  
+00010db0: 2020 6d6f 636b 5f70 7265 6473 2c0a 2020    mock_preds,.  
+00010dc0: 2020 6d6f 636b 5f70 7265 6473 5f61 6e64    mock_preds_and
+00010dd0: 5f66 6565 6462 6163 6b2c 0a20 2020 2069  _feedback,.    i
+00010de0: 6e70 7574 732c 0a20 2020 206f 7574 7075  nputs,.    outpu
+00010df0: 7473 2c0a 2020 2020 6665 6564 6261 636b  ts,.    feedback
+00010e00: 732c 0a20 2020 2063 6c69 5f6f 626a 2c0a  s,.    cli_obj,.
+00010e10: 293a 0a20 2020 2061 7373 6572 7420 280a  ):.    assert (.
+00010e20: 2020 2020 2020 2020 636c 695f 6f62 6a2e          cli_obj.
+00010e30: 6c6f 675f 7265 636f 7264 7328 0a20 2020  log_records(.   
+00010e40: 2020 2020 2020 2020 2061 7070 6c69 6361           applica
+00010e50: 7469 6f6e 3d22 666f 6f62 6172 222c 0a20  tion="foobar",. 
+00010e60: 2020 2020 2020 2020 2020 2076 6572 7369             versi
+00010e70: 6f6e 3d22 312e 322e 3322 2c0a 2020 2020  on="1.2.3",.    
+00010e80: 2020 2020 2020 2020 696e 7075 7473 3d69          inputs=i
+00010e90: 6e70 7574 732c 0a20 2020 2020 2020 2020  nputs,.         
+00010ea0: 2020 206f 7574 7075 7473 3d6f 7574 7075     outputs=outpu
+00010eb0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+00010ec0: 6665 6564 6261 636b 733d 6665 6564 6261  feedbacks=feedba
+00010ed0: 636b 732c 0a20 2020 2020 2020 2020 2020  cks,.           
+00010ee0: 2074 696d 6573 7461 6d70 733d 4e6f 6e65   timestamps=None
+00010ef0: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
+00010f00: 7274 5f6f 6e5f 7469 6d65 7374 616d 703d  rt_on_timestamp=
+00010f10: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+00010f20: 2020 7361 6d70 6c65 5f72 6174 653d 312c    sample_rate=1,
+00010f30: 0a20 2020 2020 2020 2020 2020 206a 6f69  .            joi
+00010f40: 6e5f 6b65 7973 3d5b 2266 6f6f 6261 7222  n_keys=["foobar"
+00010f50: 2c20 2262 6172 6261 7a22 5d2c 0a20 2020  , "barbaz"],.   
+00010f60: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
+00010f70: 7320 4e6f 6e65 0a20 2020 2029 0a20 2020  s None.    ).   
+00010f80: 206d 6f63 6b5f 7072 6564 735f 616e 645f   mock_preds_and_
+00010f90: 6665 6564 6261 636b 2e61 7373 6572 745f  feedback.assert_
+00010fa0: 6e6f 745f 6361 6c6c 6564 2829 0a20 2020  not_called().   
+00010fb0: 206d 6f63 6b5f 7072 6564 732e 6173 7365   mock_preds.asse
+00010fc0: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
+00010fd0: 2020 2020 6d6f 636b 5f66 6565 6462 6163      mock_feedbac
+00010fe0: 6b2e 6173 7365 7274 5f6e 6f74 5f63 616c  k.assert_not_cal
+00010ff0: 6c65 6428 290a 0a0a 4070 7974 6573 742e  led()...@pytest.
+00011000: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
+00011010: 280a 2020 2020 2269 6e70 7574 732c 206f  (.    "inputs, o
+00011020: 7574 7075 7473 2c20 6665 6564 6261 636b  utputs, feedback
+00011030: 7322 2c0a 2020 2020 5b0a 2020 2020 2020  s",.    [.      
+00011040: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
+00011050: 6e70 2e61 7272 6179 285b 3230 302c 2032  np.array([200, 2
+00011060: 3031 5d29 2c0a 2020 2020 2020 2020 2020  01]),.          
+00011070: 2020 5b7b 2242 223a 2032 3030 7d2c 207b    [{"B": 200}, {
+00011080: 2242 223a 2032 3031 7d5d 2c0a 2020 2020  "B": 201}],.    
+00011090: 2020 2020 2020 2020 5b7b 2241 223a 2032          [{"A": 2
+000110a0: 3030 7d2c 207b 2241 223a 2032 3031 7d5d  00}, {"A": 201}]
+000110b0: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
+000110c0: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
+000110d0: 2020 206e 702e 6172 7261 7928 5b32 3030     np.array([200
+000110e0: 2c20 3230 315d 292c 0a20 2020 2020 2020  , 201]),.       
+000110f0: 2020 2020 205b 7b22 4222 3a20 3230 307d       [{"B": 200}
+00011100: 2c20 7b22 4222 3a20 3230 317d 5d2c 0a20  , {"B": 201}],. 
+00011110: 2020 2020 2020 2020 2020 204e 6f6e 652c             None,
+00011120: 0a20 2020 2020 2020 2029 2c0a 2020 2020  .        ),.    
+00011130: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
+00011140: 2020 6e70 2e61 7272 6179 285b 3230 302c    np.array([200,
+00011150: 2032 3031 5d29 2c0a 2020 2020 2020 2020   201]),.        
+00011160: 2020 2020 6e70 2e61 7272 6179 285b 3230      np.array([20
+00011170: 302c 2032 3031 5d29 2c0a 2020 2020 2020  0, 201]),.      
+00011180: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
+00011190: 2020 2020 292c 0a20 2020 2020 2020 2028      ),.        (
+000111a0: 0a20 2020 2020 2020 2020 2020 205b 7b22  .            [{"
+000111b0: 4222 3a20 3230 307d 2c20 7b22 4222 3a20  B": 200}, {"B": 
+000111c0: 3230 317d 5d2c 0a20 2020 2020 2020 2020  201}],.         
+000111d0: 2020 206e 702e 6172 7261 7928 5b32 3030     np.array([200
+000111e0: 2c20 3230 315d 292c 0a20 2020 2020 2020  , 201]),.       
+000111f0: 2020 2020 205b 7b22 4122 3a20 3230 307d       [{"A": 200}
+00011200: 2c20 7b22 4122 3a20 3230 317d 5d2c 0a20  , {"A": 201}],. 
+00011210: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+00011220: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
+00011230: 5b7b 2242 223a 2032 3030 7d2c 207b 2242  [{"B": 200}, {"B
+00011240: 223a 2032 3031 7d5d 2c0a 2020 2020 2020  ": 201}],.      
+00011250: 2020 2020 2020 5b7b 2241 223a 2032 3030        [{"A": 200
+00011260: 7d2c 207b 2241 223a 2032 3031 7d5d 2c0a  }, {"A": 201}],.
+00011270: 2020 2020 2020 2020 2020 2020 6e70 2e61              np.a
+00011280: 7272 6179 285b 3230 302c 2032 3031 5d29  rray([200, 201])
+00011290: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
+000112a0: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
+000112b0: 2020 204e 6f6e 652c 0a20 2020 2020 2020     None,.       
+000112c0: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
+000112d0: 2020 2020 2020 206e 702e 6172 7261 7928         np.array(
+000112e0: 5b32 3030 2c20 3230 315d 292c 0a20 2020  [200, 201]),.   
+000112f0: 2020 2020 2029 2c0a 2020 2020 5d2c 0a29       ),.    ],.)
+00011300: 0a40 6d6f 636b 2e70 6174 6368 2822 6761  .@mock.patch("ga
+00011310: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
+00011320: 6e74 2e47 616e 7472 792e 5f67 656e 6572  nt.Gantry._gener
+00011330: 6174 655f 7072 6564 6963 7469 6f6e 5f61  ate_prediction_a
+00011340: 6e64 5f66 6565 6462 6163 6b5f 6576 656e  nd_feedback_even
+00011350: 7473 2229 0a40 6d6f 636b 2e70 6174 6368  ts").@mock.patch
+00011360: 2822 6761 6e74 7279 2e6c 6f67 6765 722e  ("gantry.logger.
+00011370: 636c 6965 6e74 2e47 616e 7472 792e 5f67  client.Gantry._g
+00011380: 656e 6572 6174 655f 7072 6564 6963 7469  enerate_predicti
+00011390: 6f6e 5f65 7665 6e74 7322 290a 406d 6f63  on_events").@moc
+000113a0: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
+000113b0: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
+000113c0: 6e74 7279 2e5f 6765 6e65 7261 7465 5f66  ntry._generate_f
+000113d0: 6565 6462 6163 6b5f 6576 656e 7473 2229  eedback_events")
+000113e0: 0a64 6566 2074 6573 745f 6765 6e65 7261  .def test_genera
+000113f0: 7465 5f72 6563 6f72 6473 5f70 7265 6473  te_records_preds
+00011400: 5f61 6e64 5f66 6565 6462 6163 6b5f 7772  _and_feedback_wr
+00011410: 6f6e 675f 6e70 5f61 7272 6179 280a 2020  ong_np_array(.  
+00011420: 2020 6d6f 636b 5f67 656e 6572 6174 655f    mock_generate_
+00011430: 6665 6564 6261 636b 2c0a 2020 2020 6d6f  feedback,.    mo
+00011440: 636b 5f67 656e 6572 6174 655f 7072 6564  ck_generate_pred
+00011450: 732c 0a20 2020 206d 6f63 6b5f 6765 6e65  s,.    mock_gene
+00011460: 7261 7465 5f70 7265 6473 5f61 6e64 5f66  rate_preds_and_f
+00011470: 6565 6462 6163 6b2c 0a20 2020 2069 6e70  eedback,.    inp
+00011480: 7574 732c 0a20 2020 206f 7574 7075 7473  uts,.    outputs
+00011490: 2c0a 2020 2020 6665 6564 6261 636b 732c  ,.    feedbacks,
+000114a0: 0a20 2020 2063 6c69 5f6f 626a 2c0a 293a  .    cli_obj,.):
+000114b0: 0a20 2020 2061 7373 6572 7420 280a 2020  .    assert (.  
+000114c0: 2020 2020 2020 636c 695f 6f62 6a2e 6765        cli_obj.ge
+000114d0: 6e65 7261 7465 5f72 6563 6f72 6473 280a  nerate_records(.
+000114e0: 2020 2020 2020 2020 2020 2020 6170 706c              appl
+000114f0: 6963 6174 696f 6e3d 2266 6f6f 6261 7222  ication="foobar"
+00011500: 2c0a 2020 2020 2020 2020 2020 2020 7665  ,.            ve
+00011510: 7273 696f 6e3d 2231 2e32 2e33 222c 0a20  rsion="1.2.3",. 
+00011520: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+00011530: 733d 696e 7075 7473 2c0a 2020 2020 2020  s=inputs,.      
+00011540: 2020 2020 2020 6f75 7470 7574 733d 6f75        outputs=ou
+00011550: 7470 7574 732c 0a20 2020 2020 2020 2020  tputs,.         
+00011560: 2020 2066 6565 6462 6163 6b73 3d66 6565     feedbacks=fee
+00011570: 6462 6163 6b73 2c0a 2020 2020 2020 2020  dbacks,.        
+00011580: 2020 2020 7469 6d65 7374 616d 7073 3d4e      timestamps=N
+00011590: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+000115a0: 2073 6f72 745f 6f6e 5f74 696d 6573 7461   sort_on_timesta
+000115b0: 6d70 3d54 7275 652c 0a20 2020 2020 2020  mp=True,.       
+000115c0: 2020 2020 2073 616d 706c 655f 7261 7465       sample_rate
+000115d0: 3d31 2c0a 2020 2020 2020 2020 2020 2020  =1,.            
+000115e0: 6a6f 696e 5f6b 6579 733d 5b22 666f 6f62  join_keys=["foob
+000115f0: 6172 222c 2022 6261 7262 617a 225d 2c0a  ar", "barbaz"],.
+00011600: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00011610: 2020 6973 204e 6f6e 650a 2020 2020 290a    is None.    ).
+00011620: 2020 2020 6d6f 636b 5f67 656e 6572 6174      mock_generat
+00011630: 655f 7072 6564 735f 616e 645f 6665 6564  e_preds_and_feed
+00011640: 6261 636b 2e61 7373 6572 745f 6e6f 745f  back.assert_not_
+00011650: 6361 6c6c 6564 2829 0a20 2020 206d 6f63  called().    moc
+00011660: 6b5f 6765 6e65 7261 7465 5f70 7265 6473  k_generate_preds
+00011670: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
+00011680: 6564 2829 0a20 2020 206d 6f63 6b5f 6765  ed().    mock_ge
+00011690: 6e65 7261 7465 5f66 6565 6462 6163 6b2e  nerate_feedback.
+000116a0: 6173 7365 7274 5f6e 6f74 5f63 616c 6c65  assert_not_calle
+000116b0: 6428 290a 0a0a 4070 7974 6573 742e 6d61  d()...@pytest.ma
+000116c0: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
+000116d0: 2020 2020 2274 696d 6573 7461 6d70 7322      "timestamps"
+000116e0: 2c0a 2020 2020 5b0a 2020 2020 2020 2020  ,.    [.        
+000116f0: 6e70 2e61 7272 6179 285b 3230 302c 2032  np.array([200, 2
+00011700: 3031 5d29 2c0a 2020 2020 2020 2020 6e70  01]),.        np
+00011710: 2e61 7272 6179 285b 3230 302c 2043 5552  .array([200, CUR
+00011720: 5245 4e54 5f54 494d 455d 292c 0a20 2020  RENT_TIME]),.   
+00011730: 205d 2c0a 290a 406d 6f63 6b2e 7061 7463   ],.).@mock.patc
+00011740: 6828 2267 616e 7472 792e 6c6f 6767 6572  h("gantry.logger
+00011750: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
+00011760: 6c6f 675f 7072 6564 6963 7469 6f6e 5f61  log_prediction_a
+00011770: 6e64 5f66 6565 6462 6163 6b5f 6576 656e  nd_feedback_even
+00011780: 7473 2229 0a40 6d6f 636b 2e70 6174 6368  ts").@mock.patch
+00011790: 2822 6761 6e74 7279 2e6c 6f67 6765 722e  ("gantry.logger.
+000117a0: 636c 6965 6e74 2e47 616e 7472 792e 5f6c  client.Gantry._l
+000117b0: 6f67 5f70 7265 6469 6374 696f 6e5f 6576  og_prediction_ev
+000117c0: 656e 7473 2229 0a40 6d6f 636b 2e70 6174  ents").@mock.pat
+000117d0: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
+000117e0: 722e 636c 6965 6e74 2e47 616e 7472 792e  r.client.Gantry.
+000117f0: 5f6c 6f67 5f66 6565 6462 6163 6b5f 6576  _log_feedback_ev
+00011800: 656e 7473 2229 0a64 6566 2074 6573 745f  ents").def test_
+00011810: 6c6f 675f 7265 636f 7264 735f 7072 6564  log_records_pred
+00011820: 735f 616e 645f 6665 6564 6261 636b 5f77  s_and_feedback_w
+00011830: 726f 6e67 5f74 696d 6573 7461 6d70 7328  rong_timestamps(
+00011840: 0a20 2020 206d 6f63 6b5f 6665 6564 6261  .    mock_feedba
+00011850: 636b 2c0a 2020 2020 6d6f 636b 5f70 7265  ck,.    mock_pre
+00011860: 6473 2c0a 2020 2020 6d6f 636b 5f70 7265  ds,.    mock_pre
+00011870: 6473 5f61 6e64 5f66 6565 6462 6163 6b2c  ds_and_feedback,
+00011880: 0a20 2020 2074 696d 6573 7461 6d70 732c  .    timestamps,
+00011890: 0a20 2020 2063 6c69 5f6f 626a 2c0a 293a  .    cli_obj,.):
+000118a0: 0a20 2020 2061 7373 6572 7420 280a 2020  .    assert (.  
+000118b0: 2020 2020 2020 636c 695f 6f62 6a2e 6c6f        cli_obj.lo
+000118c0: 675f 7265 636f 7264 7328 0a20 2020 2020  g_records(.     
+000118d0: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
+000118e0: 6f6e 3d22 666f 6f62 6172 222c 0a20 2020  on="foobar",.   
+000118f0: 2020 2020 2020 2020 2076 6572 7369 6f6e           version
+00011900: 3d22 312e 322e 3322 2c0a 2020 2020 2020  ="1.2.3",.      
+00011910: 2020 2020 2020 696e 7075 7473 3d5b 7b22        inputs=[{"
+00011920: 666f 6f22 3a20 2262 6172 227d 2c20 7b22  foo": "bar"}, {"
+00011930: 666f 6f22 3a20 2262 617a 227d 5d2c 0a20  foo": "baz"}],. 
+00011940: 2020 2020 2020 2020 2020 206f 7574 7075             outpu
+00011950: 7473 3d5b 7b22 666f 6f22 3a20 2262 6172  ts=[{"foo": "bar
+00011960: 227d 2c20 7b22 666f 6f22 3a20 2262 617a  "}, {"foo": "baz
+00011970: 227d 5d2c 0a20 2020 2020 2020 2020 2020  "}],.           
+00011980: 2066 6565 6462 6163 6b73 3d4e 6f6e 652c   feedbacks=None,
+00011990: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
+000119a0: 6573 7461 6d70 733d 7469 6d65 7374 616d  estamps=timestam
+000119b0: 7073 2c0a 2020 2020 2020 2020 2020 2020  ps,.            
+000119c0: 736f 7274 5f6f 6e5f 7469 6d65 7374 616d  sort_on_timestam
+000119d0: 703d 5472 7565 2c0a 2020 2020 2020 2020  p=True,.        
+000119e0: 2020 2020 7361 6d70 6c65 5f72 6174 653d      sample_rate=
+000119f0: 312c 0a20 2020 2020 2020 2020 2020 206a  1,.            j
+00011a00: 6f69 6e5f 6b65 7973 3d5b 2266 6f6f 6261  oin_keys=["fooba
+00011a10: 7222 2c20 2262 6172 6261 7a22 5d2c 0a20  r", "barbaz"],. 
+00011a20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00011a30: 2069 7320 4e6f 6e65 0a20 2020 2029 0a20   is None.    ). 
+00011a40: 2020 206d 6f63 6b5f 7072 6564 735f 616e     mock_preds_an
+00011a50: 645f 6665 6564 6261 636b 2e61 7373 6572  d_feedback.asser
+00011a60: 745f 6e6f 745f 6361 6c6c 6564 2829 0a20  t_not_called(). 
+00011a70: 2020 206d 6f63 6b5f 7072 6564 732e 6173     mock_preds.as
+00011a80: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
+00011a90: 290a 2020 2020 6d6f 636b 5f66 6565 6462  ).    mock_feedb
+00011aa0: 6163 6b2e 6173 7365 7274 5f6e 6f74 5f63  ack.assert_not_c
+00011ab0: 616c 6c65 6428 290a 0a0a 4070 7974 6573  alled()...@pytes
+00011ac0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+00011ad0: 7a65 280a 2020 2020 2274 696d 6573 7461  ze(.    "timesta
+00011ae0: 6d70 7322 2c0a 2020 2020 5b0a 2020 2020  mps",.    [.    
+00011af0: 2020 2020 6e70 2e61 7272 6179 285b 3230      np.array([20
+00011b00: 302c 2032 3031 5d29 2c0a 2020 2020 2020  0, 201]),.      
+00011b10: 2020 6e70 2e61 7272 6179 285b 3230 302c    np.array([200,
+00011b20: 2043 5552 5245 4e54 5f54 494d 455d 292c   CURRENT_TIME]),
+00011b30: 0a20 2020 205d 2c0a 290a 406d 6f63 6b2e  .    ],.).@mock.
+00011b40: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
+00011b50: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
+00011b60: 7279 2e5f 6765 6e65 7261 7465 5f70 7265  ry._generate_pre
+00011b70: 6469 6374 696f 6e5f 616e 645f 6665 6564  diction_and_feed
+00011b80: 6261 636b 5f65 7665 6e74 7322 290a 406d  back_events").@m
+00011b90: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
+00011ba0: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
+00011bb0: 4761 6e74 7279 2e5f 6765 6e65 7261 7465  Gantry._generate
+00011bc0: 5f70 7265 6469 6374 696f 6e5f 6576 656e  _prediction_even
+00011bd0: 7473 2229 0a40 6d6f 636b 2e70 6174 6368  ts").@mock.patch
+00011be0: 2822 6761 6e74 7279 2e6c 6f67 6765 722e  ("gantry.logger.
+00011bf0: 636c 6965 6e74 2e47 616e 7472 792e 5f67  client.Gantry._g
+00011c00: 656e 6572 6174 655f 6665 6564 6261 636b  enerate_feedback
+00011c10: 5f65 7665 6e74 7322 290a 6465 6620 7465  _events").def te
+00011c20: 7374 5f67 656e 6572 6174 655f 7265 636f  st_generate_reco
+00011c30: 7264 735f 7072 6564 735f 616e 645f 6665  rds_preds_and_fe
+00011c40: 6564 6261 636b 5f77 726f 6e67 5f74 696d  edback_wrong_tim
+00011c50: 6573 7461 6d70 7328 0a20 2020 206d 6f63  estamps(.    moc
+00011c60: 6b5f 6765 6e65 7261 7465 5f66 6565 6462  k_generate_feedb
+00011c70: 6163 6b2c 0a20 2020 206d 6f63 6b5f 6765  ack,.    mock_ge
+00011c80: 6e65 7261 7465 5f70 7265 6473 2c0a 2020  nerate_preds,.  
+00011c90: 2020 6d6f 636b 5f67 656e 6572 6174 655f    mock_generate_
+00011ca0: 7072 6564 735f 616e 645f 6665 6564 6261  preds_and_feedba
+00011cb0: 636b 2c0a 2020 2020 7469 6d65 7374 616d  ck,.    timestam
+00011cc0: 7073 2c0a 2020 2020 636c 695f 6f62 6a2c  ps,.    cli_obj,
+00011cd0: 0a29 3a0a 2020 2020 6173 7365 7274 2028  .):.    assert (
+00011ce0: 0a20 2020 2020 2020 2063 6c69 5f6f 626a  .        cli_obj
+00011cf0: 2e67 656e 6572 6174 655f 7265 636f 7264  .generate_record
+00011d00: 7328 0a20 2020 2020 2020 2020 2020 2061  s(.            a
+00011d10: 7070 6c69 6361 7469 6f6e 3d22 666f 6f62  pplication="foob
+00011d20: 6172 222c 0a20 2020 2020 2020 2020 2020  ar",.           
+00011d30: 2076 6572 7369 6f6e 3d22 312e 322e 3322   version="1.2.3"
+00011d40: 2c0a 2020 2020 2020 2020 2020 2020 696e  ,.            in
+00011d50: 7075 7473 3d5b 7b22 666f 6f22 3a20 2262  puts=[{"foo": "b
+00011d60: 6172 227d 2c20 7b22 666f 6f22 3a20 2262  ar"}, {"foo": "b
+00011d70: 617a 227d 5d2c 0a20 2020 2020 2020 2020  az"}],.         
+00011d80: 2020 206f 7574 7075 7473 3d5b 7b22 666f     outputs=[{"fo
+00011d90: 6f22 3a20 2262 6172 227d 2c20 7b22 666f  o": "bar"}, {"fo
+00011da0: 6f22 3a20 2262 617a 227d 5d2c 0a20 2020  o": "baz"}],.   
+00011db0: 2020 2020 2020 2020 2066 6565 6462 6163           feedbac
+00011dc0: 6b73 3d4e 6f6e 652c 0a20 2020 2020 2020  ks=None,.       
+00011dd0: 2020 2020 2074 696d 6573 7461 6d70 733d       timestamps=
+00011de0: 7469 6d65 7374 616d 7073 2c0a 2020 2020  timestamps,.    
+00011df0: 2020 2020 2020 2020 736f 7274 5f6f 6e5f          sort_on_
+00011e00: 7469 6d65 7374 616d 703d 5472 7565 2c0a  timestamp=True,.
+00011e10: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+00011e20: 6c65 5f72 6174 653d 312c 0a20 2020 2020  le_rate=1,.     
+00011e30: 2020 2020 2020 206a 6f69 6e5f 6b65 7973         join_keys
+00011e40: 3d5b 2266 6f6f 6261 7222 2c20 2262 6172  =["foobar", "bar
+00011e50: 6261 7a22 5d2c 0a20 2020 2020 2020 2029  baz"],.        )
+00011e60: 0a20 2020 2020 2020 2069 7320 4e6f 6e65  .        is None
+00011e70: 0a20 2020 2029 0a20 2020 206d 6f63 6b5f  .    ).    mock_
+00011e80: 6765 6e65 7261 7465 5f70 7265 6473 5f61  generate_preds_a
+00011e90: 6e64 5f66 6565 6462 6163 6b2e 6173 7365  nd_feedback.asse
+00011ea0: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
+00011eb0: 2020 2020 6d6f 636b 5f67 656e 6572 6174      mock_generat
+00011ec0: 655f 7072 6564 732e 6173 7365 7274 5f6e  e_preds.assert_n
+00011ed0: 6f74 5f63 616c 6c65 6428 290a 2020 2020  ot_called().    
+00011ee0: 6d6f 636b 5f67 656e 6572 6174 655f 6665  mock_generate_fe
+00011ef0: 6564 6261 636b 2e61 7373 6572 745f 6e6f  edback.assert_no
+00011f00: 745f 6361 6c6c 6564 2829 0a0a 0a40 7079  t_called()...@py
+00011f10: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
+00011f20: 7472 697a 6528 226a 6f69 6e5f 6b65 7973  trize("join_keys
+00011f30: 222c 205b 5b31 2c20 322c 2033 5d2c 2070  ", [[1, 2, 3], p
+00011f40: 642e 5365 7269 6573 285b 312c 2032 2c20  d.Series([1, 2, 
+00011f50: 335d 295d 290a 406d 6f63 6b2e 7061 7463  3])]).@mock.patc
+00011f60: 6828 2267 616e 7472 792e 6c6f 6767 6572  h("gantry.logger
+00011f70: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
+00011f80: 6c6f 675f 7072 6564 6963 7469 6f6e 5f61  log_prediction_a
+00011f90: 6e64 5f66 6565 6462 6163 6b5f 6576 656e  nd_feedback_even
+00011fa0: 7473 2229 0a40 6d6f 636b 2e70 6174 6368  ts").@mock.patch
+00011fb0: 2822 6761 6e74 7279 2e6c 6f67 6765 722e  ("gantry.logger.
+00011fc0: 636c 6965 6e74 2e47 616e 7472 792e 5f6c  client.Gantry._l
+00011fd0: 6f67 5f70 7265 6469 6374 696f 6e5f 6576  og_prediction_ev
+00011fe0: 656e 7473 2229 0a40 6d6f 636b 2e70 6174  ents").@mock.pat
+00011ff0: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
+00012000: 722e 636c 6965 6e74 2e47 616e 7472 792e  r.client.Gantry.
+00012010: 5f6c 6f67 5f66 6565 6462 6163 6b5f 6576  _log_feedback_ev
+00012020: 656e 7473 2229 0a64 6566 2074 6573 745f  ents").def test_
+00012030: 6c6f 675f 7265 636f 7264 735f 7072 6564  log_records_pred
+00012040: 735f 616e 645f 6665 6564 6261 636b 5f77  s_and_feedback_w
+00012050: 726f 6e67 5f6a 6f69 6e5f 6b65 7973 280a  rong_join_keys(.
+00012060: 2020 2020 6d6f 636b 5f66 6565 6462 6163      mock_feedbac
+00012070: 6b2c 0a20 2020 206d 6f63 6b5f 7072 6564  k,.    mock_pred
+00012080: 732c 0a20 2020 206d 6f63 6b5f 7072 6564  s,.    mock_pred
+00012090: 735f 616e 645f 6665 6564 6261 636b 2c0a  s_and_feedback,.
+000120a0: 2020 2020 6a6f 696e 5f6b 6579 732c 0a20      join_keys,. 
+000120b0: 2020 2063 6c69 5f6f 626a 2c0a 293a 0a20     cli_obj,.):. 
+000120c0: 2020 2061 7373 6572 7420 280a 2020 2020     assert (.    
+000120d0: 2020 2020 636c 695f 6f62 6a2e 6c6f 675f      cli_obj.log_
+000120e0: 7265 636f 7264 7328 0a20 2020 2020 2020  records(.       
+000120f0: 2020 2020 2061 7070 6c69 6361 7469 6f6e       application
+00012100: 3d22 666f 6f62 6172 222c 0a20 2020 2020  ="foobar",.     
+00012110: 2020 2020 2020 2076 6572 7369 6f6e 3d22         version="
+00012120: 312e 322e 3322 2c0a 2020 2020 2020 2020  1.2.3",.        
+00012130: 2020 2020 696e 7075 7473 3d5b 7b22 4122      inputs=[{"A"
+00012140: 3a20 3230 307d 2c20 7b22 4122 3a20 3230  : 200}, {"A": 20
+00012150: 317d 5d2c 0a20 2020 2020 2020 2020 2020  1}],.           
+00012160: 206f 7574 7075 7473 3d5b 7b22 4222 3a20   outputs=[{"B": 
+00012170: 3230 307d 2c20 7b22 4222 3a20 3230 317d  200}, {"B": 201}
+00012180: 5d2c 0a20 2020 2020 2020 2020 2020 2066  ],.            f
+00012190: 6565 6462 6163 6b73 3d5b 7b22 4322 3a20  eedbacks=[{"C": 
+000121a0: 3230 307d 2c20 7b22 4322 3a20 3230 317d  200}, {"C": 201}
+000121b0: 5d2c 0a20 2020 2020 2020 2020 2020 2074  ],.            t
+000121c0: 696d 6573 7461 6d70 733d 4e6f 6e65 2c0a  imestamps=None,.
+000121d0: 2020 2020 2020 2020 2020 2020 736f 7274              sort
+000121e0: 5f6f 6e5f 7469 6d65 7374 616d 703d 5472  _on_timestamp=Tr
+000121f0: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
+00012200: 7361 6d70 6c65 5f72 6174 653d 312c 0a20  sample_rate=1,. 
+00012210: 2020 2020 2020 2020 2020 206a 6f69 6e5f             join_
+00012220: 6b65 7973 3d6a 6f69 6e5f 6b65 7973 2c0a  keys=join_keys,.
+00012230: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00012240: 2020 6973 204e 6f6e 650a 2020 2020 290a    is None.    ).
+00012250: 2020 2020 6d6f 636b 5f70 7265 6473 5f61      mock_preds_a
+00012260: 6e64 5f66 6565 6462 6163 6b2e 6173 7365  nd_feedback.asse
+00012270: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
+00012280: 2020 2020 6d6f 636b 5f70 7265 6473 2e61      mock_preds.a
+00012290: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
+000122a0: 2829 0a20 2020 206d 6f63 6b5f 6665 6564  ().    mock_feed
+000122b0: 6261 636b 2e61 7373 6572 745f 6e6f 745f  back.assert_not_
+000122c0: 6361 6c6c 6564 2829 0a0a 0a40 7079 7465  called()...@pyte
+000122d0: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
+000122e0: 697a 6528 226a 6f69 6e5f 6b65 7973 222c  ize("join_keys",
+000122f0: 205b 5b31 2c20 322c 2033 5d2c 2070 642e   [[1, 2, 3], pd.
+00012300: 5365 7269 6573 285b 312c 2032 2c20 335d  Series([1, 2, 3]
+00012310: 295d 290a 406d 6f63 6b2e 7061 7463 6828  )]).@mock.patch(
+00012320: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
+00012330: 6c69 656e 742e 4761 6e74 7279 2e5f 6765  lient.Gantry._ge
+00012340: 6e65 7261 7465 5f70 7265 6469 6374 696f  nerate_predictio
+00012350: 6e5f 616e 645f 6665 6564 6261 636b 5f65  n_and_feedback_e
+00012360: 7665 6e74 7322 290a 406d 6f63 6b2e 7061  vents").@mock.pa
+00012370: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
+00012380: 6572 2e63 6c69 656e 742e 4761 6e74 7279  er.client.Gantry
+00012390: 2e5f 6765 6e65 7261 7465 5f70 7265 6469  ._generate_predi
+000123a0: 6374 696f 6e5f 6576 656e 7473 2229 0a40  ction_events").@
+000123b0: 6d6f 636b 2e70 6174 6368 2822 6761 6e74  mock.patch("gant
+000123c0: 7279 2e6c 6f67 6765 722e 636c 6965 6e74  ry.logger.client
+000123d0: 2e47 616e 7472 792e 5f67 656e 6572 6174  .Gantry._generat
+000123e0: 655f 6665 6564 6261 636b 5f65 7665 6e74  e_feedback_event
+000123f0: 7322 290a 6465 6620 7465 7374 5f67 656e  s").def test_gen
+00012400: 6572 6174 655f 7265 636f 7264 735f 7072  erate_records_pr
+00012410: 6564 735f 616e 645f 6665 6564 6261 636b  eds_and_feedback
+00012420: 5f77 726f 6e67 5f6a 6f69 6e5f 6b65 7973  _wrong_join_keys
+00012430: 280a 2020 2020 6d6f 636b 5f67 656e 6572  (.    mock_gener
+00012440: 6174 655f 6665 6564 6261 636b 2c0a 2020  ate_feedback,.  
+00012450: 2020 6d6f 636b 5f67 656e 6572 6174 655f    mock_generate_
+00012460: 7072 6564 732c 0a20 2020 206d 6f63 6b5f  preds,.    mock_
+00012470: 6765 6e65 7261 7465 5f70 7265 6473 5f61  generate_preds_a
+00012480: 6e64 5f66 6565 6462 6163 6b2c 0a20 2020  nd_feedback,.   
+00012490: 206a 6f69 6e5f 6b65 7973 2c0a 2020 2020   join_keys,.    
+000124a0: 636c 695f 6f62 6a2c 0a29 3a0a 2020 2020  cli_obj,.):.    
+000124b0: 6173 7365 7274 2028 0a20 2020 2020 2020  assert (.       
+000124c0: 2063 6c69 5f6f 626a 2e67 656e 6572 6174   cli_obj.generat
+000124d0: 655f 7265 636f 7264 7328 0a20 2020 2020  e_records(.     
+000124e0: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
+000124f0: 6f6e 3d22 666f 6f62 6172 222c 0a20 2020  on="foobar",.   
+00012500: 2020 2020 2020 2020 2076 6572 7369 6f6e           version
+00012510: 3d22 312e 322e 3322 2c0a 2020 2020 2020  ="1.2.3",.      
+00012520: 2020 2020 2020 696e 7075 7473 3d5b 7b22        inputs=[{"
+00012530: 4122 3a20 3230 307d 2c20 7b22 4122 3a20  A": 200}, {"A": 
+00012540: 3230 317d 5d2c 0a20 2020 2020 2020 2020  201}],.         
+00012550: 2020 206f 7574 7075 7473 3d5b 7b22 4222     outputs=[{"B"
+00012560: 3a20 3230 307d 2c20 7b22 4222 3a20 3230  : 200}, {"B": 20
+00012570: 317d 5d2c 0a20 2020 2020 2020 2020 2020  1}],.           
+00012580: 2066 6565 6462 6163 6b73 3d5b 7b22 4322   feedbacks=[{"C"
+00012590: 3a20 3230 307d 2c20 7b22 4322 3a20 3230  : 200}, {"C": 20
+000125a0: 317d 5d2c 0a20 2020 2020 2020 2020 2020  1}],.           
+000125b0: 2074 696d 6573 7461 6d70 733d 4e6f 6e65   timestamps=None
+000125c0: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
+000125d0: 7274 5f6f 6e5f 7469 6d65 7374 616d 703d  rt_on_timestamp=
+000125e0: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+000125f0: 2020 7361 6d70 6c65 5f72 6174 653d 312c    sample_rate=1,
+00012600: 0a20 2020 2020 2020 2020 2020 206a 6f69  .            joi
+00012610: 6e5f 6b65 7973 3d6a 6f69 6e5f 6b65 7973  n_keys=join_keys
+00012620: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00012630: 2020 2020 6973 204e 6f6e 650a 2020 2020      is None.    
+00012640: 290a 2020 2020 6d6f 636b 5f67 656e 6572  ).    mock_gener
+00012650: 6174 655f 7072 6564 735f 616e 645f 6665  ate_preds_and_fe
+00012660: 6564 6261 636b 2e61 7373 6572 745f 6e6f  edback.assert_no
+00012670: 745f 6361 6c6c 6564 2829 0a20 2020 206d  t_called().    m
+00012680: 6f63 6b5f 6765 6e65 7261 7465 5f70 7265  ock_generate_pre
+00012690: 6473 2e61 7373 6572 745f 6e6f 745f 6361  ds.assert_not_ca
+000126a0: 6c6c 6564 2829 0a20 2020 206d 6f63 6b5f  lled().    mock_
+000126b0: 6765 6e65 7261 7465 5f66 6565 6462 6163  generate_feedbac
+000126c0: 6b2e 6173 7365 7274 5f6e 6f74 5f63 616c  k.assert_not_cal
+000126d0: 6c65 6428 290a 0a0a 4070 7974 6573 742e  led()...@pytest.
+000126e0: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
+000126f0: 280a 2020 2020 2274 6573 745f 7469 6d65  (.    "test_time
+00012700: 7374 616d 7073 2c20 7465 7374 5f74 696d  stamps, test_tim
+00012710: 6573 7461 6d70 735f 6c69 7374 222c 0a20  estamps_list",. 
+00012720: 2020 205b 0a20 2020 2020 2020 2028 4e6f     [.        (No
+00012730: 6e65 2c20 4e6f 6e65 292c 0a20 2020 2020  ne, None),.     
+00012740: 2020 2028 5b43 5552 5245 4e54 5f54 494d     ([CURRENT_TIM
+00012750: 455d 202a 2032 2c20 5b43 5552 5245 4e54  E] * 2, [CURRENT
+00012760: 5f54 494d 455d 202a 2032 292c 0a20 2020  _TIME] * 2),.   
+00012770: 2020 2020 2028 6e70 2e61 7272 6179 285b       (np.array([
+00012780: 4355 5252 454e 545f 5449 4d45 5d20 2a20  CURRENT_TIME] * 
+00012790: 3229 2c20 5b43 5552 5245 4e54 5f54 494d  2), [CURRENT_TIM
+000127a0: 455d 202a 2032 292c 0a20 2020 205d 2c0a  E] * 2),.    ],.
+000127b0: 290a 4070 7974 6573 742e 6d61 726b 2e70  ).@pytest.mark.p
+000127c0: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
+000127d0: 226b 7761 7267 7322 2c0a 2020 2020 5b0a  "kwargs",.    [.
+000127e0: 2020 2020 2020 2020 7b22 6665 6564 6261          {"feedba
+000127f0: 636b 5f6b 6579 7322 3a20 5b22 4122 5d7d  ck_keys": ["A"]}
+00012800: 2c0a 2020 2020 2020 2020 7b22 6665 6564  ,.        {"feed
+00012810: 6261 636b 5f69 6473 223a 205b 2231 3233  back_ids": ["123
+00012820: 3435 222c 2022 3637 3839 3022 5d7d 2c0a  45", "67890"]},.
+00012830: 2020 2020 2020 2020 7b22 6a6f 696e 5f6b          {"join_k
+00012840: 6579 7322 3a20 5b22 3534 3332 3122 2c20  eys": ["54321", 
+00012850: 2236 3738 3930 225d 7d2c 0a20 2020 2020  "67890"]},.     
+00012860: 2020 207b 226a 6f69 6e5f 6b65 7973 223a     {"join_keys":
+00012870: 2070 642e 5365 7269 6573 285b 2235 3433   pd.Series(["543
+00012880: 3231 222c 2022 3637 3839 3022 5d29 7d2c  21", "67890"])},
+00012890: 0a20 2020 2020 2020 207b 7d2c 0a20 2020  .        {},.   
+000128a0: 205d 2c0a 290a 4070 7974 6573 742e 6d61   ],.).@pytest.ma
+000128b0: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
+000128c0: 2020 2020 2822 7465 7374 5f6f 7574 7075      ("test_outpu
+000128d0: 7473 222c 2022 7465 7374 5f69 6e70 7574  ts", "test_input
+000128e0: 7322 292c 0a20 2020 206c 6973 7428 7a69  s"),.    list(zi
+000128f0: 7028 5445 5354 5f4f 5554 5055 5453 2c20  p(TEST_OUTPUTS, 
+00012900: 5445 5354 5f49 4e50 5554 5329 292c 0a29  TEST_INPUTS)),.)
+00012910: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
+00012920: 7261 6d65 7472 697a 6528 2276 6572 7369  rametrize("versi
+00012930: 6f6e 222c 205b 4e6f 6e65 2c20 3130 2c20  on", [None, 10, 
+00012940: 2231 2e32 2e33 225d 290a 4070 7974 6573  "1.2.3"]).@pytes
+00012950: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+00012960: 7a65 2822 7461 6773 2c20 726f 775f 7461  ze("tags, row_ta
+00012970: 6773 2c20 676c 6f62 616c 5f74 6167 732c  gs, global_tags,
+00012980: 2065 7870 6563 7465 645f 7461 6773 5f70   expected_tags_p
+00012990: 6172 616d 222c 2054 4553 545f 5441 4753  aram", TEST_TAGS
+000129a0: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
+000129b0: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
+000129c0: 656e 742e 5f72 6573 6f6c 7665 5f6a 6f69  ent._resolve_joi
+000129d0: 6e5f 6b65 7973 2229 0a40 6d6f 636b 2e70  n_keys").@mock.p
+000129e0: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
+000129f0: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
+00012a00: 792e 5f6c 6f67 5f70 7265 6469 6374 696f  y._log_predictio
+00012a10: 6e5f 616e 645f 6665 6564 6261 636b 5f65  n_and_feedback_e
+00012a20: 7665 6e74 7322 290a 406d 6f63 6b2e 7061  vents").@mock.pa
+00012a30: 7463 6828 0a20 2020 2022 6761 6e74 7279  tch(.    "gantry
+00012a40: 2e6c 6f67 6765 722e 636c 6965 6e74 2e47  .logger.client.G
+00012a50: 616e 7472 792e 5f6c 6f67 5f70 7265 6469  antry._log_predi
+00012a60: 6374 696f 6e5f 6576 656e 7473 222c 2072  ction_events", r
+00012a70: 6574 7572 6e5f 7661 6c75 653d 284e 6f6e  eturn_value=(Non
+00012a80: 652c 205b 2231 3233 3435 222c 2022 3637  e, ["12345", "67
+00012a90: 3839 3022 5d29 0a29 0a40 6d6f 636b 2e70  890"]).).@mock.p
+00012aa0: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
+00012ab0: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
+00012ac0: 792e 5f6c 6f67 5f66 6565 6462 6163 6b5f  y._log_feedback_
+00012ad0: 6576 656e 7473 2229 0a40 6d6f 636b 2e70  events").@mock.p
+00012ae0: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
+00012af0: 6765 722e 636c 6965 6e74 2e5f 7361 6d70  ger.client._samp
+00012b00: 6c65 5f72 6563 6f72 6473 222c 2073 6964  le_records", sid
+00012b10: 655f 6566 6665 6374 3d63 6c69 656e 742e  e_effect=client.
+00012b20: 5f73 616d 706c 655f 7265 636f 7264 7329  _sample_records)
+00012b30: 0a40 6d6f 636b 2e70 6174 6368 2822 6761  .@mock.patch("ga
+00012b40: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
+00012b50: 6e74 2e5f 6465 6661 756c 745f 6a6f 696e  nt._default_join
+00012b60: 5f6b 6579 5f67 656e 2229 0a64 6566 2074  _key_gen").def t
+00012b70: 6573 745f 6c6f 675f 7265 636f 7264 735f  est_log_records_
+00012b80: 7072 6564 735f 6f6e 6c79 280a 2020 2020  preds_only(.    
+00012b90: 6d6f 636b 5f6a 6f69 6e5f 6b65 795f 6765  mock_join_key_ge
+00012ba0: 6e2c 0a20 2020 206d 6f63 6b5f 7361 6d70  n,.    mock_samp
+00012bb0: 6c65 5f72 6563 6f72 6473 2c0a 2020 2020  le_records,.    
+00012bc0: 6d6f 636b 5f66 6565 6462 6163 6b2c 0a20  mock_feedback,. 
+00012bd0: 2020 206d 6f63 6b5f 7072 6564 732c 0a20     mock_preds,. 
+00012be0: 2020 206d 6f63 6b5f 7072 6564 735f 616e     mock_preds_an
+00012bf0: 645f 6665 6564 6261 636b 2c0a 2020 2020  d_feedback,.    
+00012c00: 6d6f 636b 5f72 6573 6f6c 7665 5f6a 6f69  mock_resolve_joi
+00012c10: 6e5f 6b65 7973 2c0a 2020 2020 7665 7273  n_keys,.    vers
+00012c20: 696f 6e2c 0a20 2020 2074 6167 732c 0a20  ion,.    tags,. 
+00012c30: 2020 2072 6f77 5f74 6167 732c 0a20 2020     row_tags,.   
+00012c40: 2067 6c6f 6261 6c5f 7461 6773 2c0a 2020   global_tags,.  
+00012c50: 2020 6578 7065 6374 6564 5f74 6167 735f    expected_tags_
+00012c60: 7061 7261 6d2c 0a20 2020 2074 6573 745f  param,.    test_
+00012c70: 7469 6d65 7374 616d 7073 2c0a 2020 2020  timestamps,.    
+00012c80: 7465 7374 5f74 696d 6573 7461 6d70 735f  test_timestamps_
+00012c90: 6c69 7374 2c0a 2020 2020 7465 7374 5f69  list,.    test_i
+00012ca0: 6e70 7574 732c 0a20 2020 2074 6573 745f  nputs,.    test_
+00012cb0: 6f75 7470 7574 732c 0a20 2020 206b 7761  outputs,.    kwa
+00012cc0: 7267 732c 0a20 2020 2063 6c69 5f6f 626a  rgs,.    cli_obj
+00012cd0: 2c0a 293a 0a20 2020 206d 6f63 6b5f 6a6f  ,.):.    mock_jo
+00012ce0: 696e 5f6b 6579 5f67 656e 2e73 6964 655f  in_key_gen.side_
+00012cf0: 6566 6665 6374 203d 205b 2236 3738 3930  effect = ["67890
+00012d00: 222c 2022 3132 3334 3522 5d0a 2020 2020  ", "12345"].    
+00012d10: 6d6f 636b 5f72 6573 6f6c 7665 5f6a 6f69  mock_resolve_joi
+00012d20: 6e5f 6b65 7973 2e72 6574 7572 6e5f 7661  n_keys.return_va
+00012d30: 6c75 6520 3d20 5b22 3132 3334 3522 2c20  lue = ["12345", 
+00012d40: 2236 3738 3930 225d 2069 6620 6b77 6172  "67890"] if kwar
+00012d50: 6773 2065 6c73 6520 4e6f 6e65 0a20 2020  gs else None.   
+00012d60: 2061 7373 6572 7420 636c 695f 6f62 6a2e   assert cli_obj.
+00012d70: 6c6f 675f 7265 636f 7264 7328 0a20 2020  log_records(.   
+00012d80: 2020 2020 2061 7070 6c69 6361 7469 6f6e       application
+00012d90: 3d22 666f 6f62 6172 222c 0a20 2020 2020  ="foobar",.     
+00012da0: 2020 2076 6572 7369 6f6e 3d76 6572 7369     version=versi
+00012db0: 6f6e 2c0a 2020 2020 2020 2020 696e 7075  on,.        inpu
+00012dc0: 7473 3d74 6573 745f 696e 7075 7473 2c0a  ts=test_inputs,.
+00012dd0: 2020 2020 2020 2020 6f75 7470 7574 733d          outputs=
+00012de0: 7465 7374 5f6f 7574 7075 7473 2c0a 2020  test_outputs,.  
+00012df0: 2020 2020 2020 6665 6564 6261 636b 733d        feedbacks=
+00012e00: 4e6f 6e65 2c0a 2020 2020 2020 2020 7469  None,.        ti
+00012e10: 6d65 7374 616d 7073 3d74 6573 745f 7469  mestamps=test_ti
+00012e20: 6d65 7374 616d 7073 2c0a 2020 2020 2020  mestamps,.      
+00012e30: 2020 736f 7274 5f6f 6e5f 7469 6d65 7374    sort_on_timest
+00012e40: 616d 703d 5472 7565 2c0a 2020 2020 2020  amp=True,.      
+00012e50: 2020 7461 6773 3d74 6167 732c 0a20 2020    tags=tags,.   
+00012e60: 2020 2020 2072 6f77 5f74 6167 733d 726f       row_tags=ro
+00012e70: 775f 7461 6773 2c0a 2020 2020 2020 2020  w_tags,.        
+00012e80: 676c 6f62 616c 5f74 6167 733d 676c 6f62  global_tags=glob
+00012e90: 616c 5f74 6167 732c 0a20 2020 2020 2020  al_tags,.       
+00012ea0: 202a 2a6b 7761 7267 732c 0a20 2020 2029   **kwargs,.    )
+00012eb0: 203d 3d20 284e 6f6e 652c 205b 2231 3233   == (None, ["123
+00012ec0: 3435 222c 2022 3637 3839 3022 5d29 0a0a  45", "67890"])..
+00012ed0: 2020 2020 6d6f 636b 5f70 7265 6473 5f61      mock_preds_a
+00012ee0: 6e64 5f66 6565 6462 6163 6b2e 6173 7365  nd_feedback.asse
+00012ef0: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
+00012f00: 2020 2020 6d6f 636b 5f70 7265 6473 2e61      mock_preds.a
+00012f10: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+00012f20: 655f 7769 7468 280a 2020 2020 2020 2020  e_with(.        
+00012f30: 6170 706c 6963 6174 696f 6e3d 2266 6f6f  application="foo
+00012f40: 6261 7222 2c0a 2020 2020 2020 2020 696e  bar",.        in
+00012f50: 7075 7473 3d5b 7b22 4122 3a20 3130 307d  puts=[{"A": 100}
+00012f60: 2c20 7b22 4122 3a20 3130 317d 5d2c 0a20  , {"A": 101}],. 
+00012f70: 2020 2020 2020 206f 7574 7075 7473 3d5b         outputs=[
+00012f80: 7b22 4222 3a20 3330 307d 2c20 7b22 4222  {"B": 300}, {"B"
+00012f90: 3a20 3330 317d 5d2c 0a20 2020 2020 2020  : 301}],.       
+00012fa0: 206a 6f69 6e5f 6b65 7973 3d5b 2231 3233   join_keys=["123
+00012fb0: 3435 222c 2022 3637 3839 3022 5d20 6966  45", "67890"] if
+00012fc0: 206b 7761 7267 7320 656c 7365 205b 2236   kwargs else ["6
+00012fd0: 3738 3930 222c 2022 3132 3334 3522 5d2c  7890", "12345"],
+00012fe0: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
+00012ff0: 3d76 6572 7369 6f6e 2c0a 2020 2020 2020  =version,.      
+00013000: 2020 6967 6e6f 7265 5f69 6e70 7574 733d    ignore_inputs=
+00013010: 4e6f 6e65 2c0a 2020 2020 2020 2020 7469  None,.        ti
+00013020: 6d65 7374 616d 7073 3d74 6573 745f 7469  mestamps=test_ti
+00013030: 6d65 7374 616d 7073 5f6c 6973 742c 0a20  mestamps_list,. 
+00013040: 2020 2020 2020 2073 6f72 745f 6f6e 5f74         sort_on_t
+00013050: 696d 6573 7461 6d70 3d54 7275 652c 0a20  imestamp=True,. 
+00013060: 2020 2020 2020 2061 735f 6261 7463 683d         as_batch=
+00013070: 4661 6c73 652c 0a20 2020 2020 2020 2074  False,.        t
+00013080: 6167 733d 6578 7065 6374 6564 5f74 6167  ags=expected_tag
+00013090: 735f 7061 7261 6d2c 0a20 2020 2029 0a20  s_param,.    ). 
+000130a0: 2020 206d 6f63 6b5f 6665 6564 6261 636b     mock_feedback
+000130b0: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
+000130c0: 6564 2829 0a0a 2020 2020 6d6f 636b 5f73  ed()..    mock_s
+000130d0: 616d 706c 655f 7265 636f 7264 732e 6173  ample_records.as
+000130e0: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
+000130f0: 5f77 6974 6828 0a20 2020 2020 2020 2032  _with(.        2
+00013100: 2c0a 2020 2020 2020 2020 312c 0a20 2020  ,.        1,.   
+00013110: 2020 2020 205b 7b22 4122 3a20 3130 307d       [{"A": 100}
+00013120: 2c20 7b22 4122 3a20 3130 317d 5d2c 0a20  , {"A": 101}],. 
+00013130: 2020 2020 2020 205b 7b22 4222 3a20 3330         [{"B": 30
+00013140: 307d 2c20 7b22 4222 3a20 3330 317d 5d2c  0}, {"B": 301}],
+00013150: 0a20 2020 2020 2020 204e 6f6e 652c 0a20  .        None,. 
+00013160: 2020 2020 2020 2063 6c69 656e 742e 5f72         client._r
+00013170: 6573 6f6c 7665 5f6a 6f69 6e5f 6b65 7973  esolve_join_keys
+00013180: 282a 2a6b 7761 7267 7329 2c0a 2020 2020  (**kwargs),.    
+00013190: 2020 2020 7465 7374 5f74 696d 6573 7461      test_timesta
+000131a0: 6d70 735f 6c69 7374 2c0a 2020 2020 2020  mps_list,.      
+000131b0: 2020 6578 7065 6374 6564 5f74 6167 735f    expected_tags_
+000131c0: 7061 7261 6d2c 0a20 2020 2029 0a0a 2020  param,.    )..  
+000131d0: 2020 6966 206b 7761 7267 733a 0a20 2020    if kwargs:.   
+000131e0: 2020 2020 206d 6f63 6b5f 6a6f 696e 5f6b       mock_join_k
+000131f0: 6579 5f67 656e 2e61 7373 6572 745f 6e6f  ey_gen.assert_no
+00013200: 745f 6361 6c6c 6564 2829 0a20 2020 2065  t_called().    e
+00013210: 6c73 653a 0a20 2020 2020 2020 206d 6f63  lse:.        moc
+00013220: 6b5f 6a6f 696e 5f6b 6579 5f67 656e 2e61  k_join_key_gen.a
+00013230: 7373 6572 745f 6361 6c6c 6564 2829 0a0a  ssert_called()..
+00013240: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
+00013250: 7261 6d65 7472 697a 6528 0a20 2020 2022  rametrize(.    "
+00013260: 7465 7374 5f74 696d 6573 7461 6d70 732c  test_timestamps,
+00013270: 2074 6573 745f 7469 6d65 7374 616d 7073   test_timestamps
+00013280: 5f6c 6973 7422 2c0a 2020 2020 5b0a 2020  _list",.    [.  
+00013290: 2020 2020 2020 284e 6f6e 652c 204e 6f6e        (None, Non
+000132a0: 6529 2c0a 2020 2020 2020 2020 285b 4355  e),.        ([CU
+000132b0: 5252 454e 545f 5449 4d45 5d20 2a20 322c  RRENT_TIME] * 2,
+000132c0: 205b 4355 5252 454e 545f 5449 4d45 5d20   [CURRENT_TIME] 
+000132d0: 2a20 3229 2c0a 2020 2020 2020 2020 286e  * 2),.        (n
+000132e0: 702e 6172 7261 7928 5b43 5552 5245 4e54  p.array([CURRENT
+000132f0: 5f54 494d 455d 202a 2032 292c 205b 4355  _TIME] * 2), [CU
+00013300: 5252 454e 545f 5449 4d45 5d20 2a20 3229  RRENT_TIME] * 2)
+00013310: 2c0a 2020 2020 5d2c 0a29 0a40 7079 7465  ,.    ],.).@pyte
+00013320: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
+00013330: 697a 6528 0a20 2020 2022 6b77 6172 6773  ize(.    "kwargs
+00013340: 222c 0a20 2020 205b 0a20 2020 2020 2020  ",.    [.       
+00013350: 207b 2266 6565 6462 6163 6b5f 6b65 7973   {"feedback_keys
+00013360: 223a 205b 2241 225d 7d2c 0a20 2020 2020  ": ["A"]},.     
+00013370: 2020 207b 2266 6565 6462 6163 6b5f 6964     {"feedback_id
+00013380: 7322 3a20 5b22 3132 3334 3522 2c20 2236  s": ["12345", "6
+00013390: 3738 3930 225d 7d2c 0a20 2020 2020 2020  7890"]},.       
+000133a0: 207b 226a 6f69 6e5f 6b65 7973 223a 205b   {"join_keys": [
+000133b0: 2235 3433 3231 222c 2022 3637 3839 3022  "54321", "67890"
+000133c0: 5d7d 2c0a 2020 2020 2020 2020 7b22 6a6f  ]},.        {"jo
+000133d0: 696e 5f6b 6579 7322 3a20 7064 2e53 6572  in_keys": pd.Ser
+000133e0: 6965 7328 5b22 3534 3332 3122 2c20 2236  ies(["54321", "6
+000133f0: 3738 3930 225d 297d 2c0a 2020 2020 2020  7890"])},.      
+00013400: 2020 7b7d 2c0a 2020 2020 5d2c 0a29 0a40    {},.    ],.).@
+00013410: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+00013420: 6d65 7472 697a 6528 0a20 2020 2028 2274  metrize(.    ("t
+00013430: 6573 745f 6f75 7470 7574 7322 2c20 2274  est_outputs", "t
+00013440: 6573 745f 696e 7075 7473 2229 2c0a 2020  est_inputs"),.  
+00013450: 2020 6c69 7374 287a 6970 2854 4553 545f    list(zip(TEST_
+00013460: 4f55 5450 5554 532c 2054 4553 545f 494e  OUTPUTS, TEST_IN
+00013470: 5055 5453 2929 2c0a 290a 4070 7974 6573  PUTS)),.).@pytes
+00013480: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+00013490: 7a65 2822 7665 7273 696f 6e22 2c20 5b4e  ze("version", [N
+000134a0: 6f6e 652c 2031 302c 2022 312e 322e 3322  one, 10, "1.2.3"
+000134b0: 5d29 0a40 7079 7465 7374 2e6d 6172 6b2e  ]).@pytest.mark.
+000134c0: 7061 7261 6d65 7472 697a 6528 2274 6167  parametrize("tag
+000134d0: 732c 2072 6f77 5f74 6167 732c 2067 6c6f  s, row_tags, glo
+000134e0: 6261 6c5f 7461 6773 2c20 6578 7065 6374  bal_tags, expect
+000134f0: 6564 5f74 6167 735f 7061 7261 6d22 2c20  ed_tags_param", 
+00013500: 5445 5354 5f54 4147 5329 0a40 6d6f 636b  TEST_TAGS).@mock
+00013510: 2e70 6174 6368 2822 6761 6e74 7279 2e6c  .patch("gantry.l
+00013520: 6f67 6765 722e 636c 6965 6e74 2e5f 7265  ogger.client._re
+00013530: 736f 6c76 655f 6a6f 696e 5f6b 6579 7322  solve_join_keys"
+00013540: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
+00013550: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
+00013560: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
+00013570: 7072 6564 6963 7469 6f6e 5f61 6e64 5f66  prediction_and_f
+00013580: 6565 6462 6163 6b5f 6576 656e 7473 2229  eedback_events")
+00013590: 0a40 6d6f 636b 2e70 6174 6368 280a 2020  .@mock.patch(.  
+000135a0: 2020 2267 616e 7472 792e 6c6f 6767 6572    "gantry.logger
+000135b0: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
+000135c0: 6c6f 675f 7072 6564 6963 7469 6f6e 5f65  log_prediction_e
+000135d0: 7665 6e74 7322 2c20 7265 7475 726e 5f76  vents", return_v
+000135e0: 616c 7565 3d28 4e6f 6e65 2c20 5b22 3132  alue=(None, ["12
+000135f0: 3334 3522 2c20 2236 3738 3930 225d 290a  345", "67890"]).
+00013600: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
+00013610: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
+00013620: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
+00013630: 6665 6564 6261 636b 5f65 7665 6e74 7322  feedback_events"
+00013640: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
+00013650: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
+00013660: 656e 742e 5f73 616d 706c 655f 7265 636f  ent._sample_reco
+00013670: 7264 7322 2c20 7369 6465 5f65 6666 6563  rds", side_effec
+00013680: 743d 636c 6965 6e74 2e5f 7361 6d70 6c65  t=client._sample
+00013690: 5f72 6563 6f72 6473 290a 406d 6f63 6b2e  _records).@mock.
+000136a0: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
+000136b0: 6767 6572 2e63 6c69 656e 742e 5f64 6566  gger.client._def
+000136c0: 6175 6c74 5f6a 6f69 6e5f 6b65 795f 6765  ault_join_key_ge
+000136d0: 6e22 290a 6465 6620 7465 7374 5f73 696e  n").def test_sin
+000136e0: 676c 655f 6c6f 675f 7265 636f 7264 735f  gle_log_records_
+000136f0: 7072 6564 735f 6f6e 6c79 280a 2020 2020  preds_only(.    
+00013700: 6d6f 636b 5f6a 6f69 6e5f 6b65 795f 6765  mock_join_key_ge
+00013710: 6e2c 0a20 2020 206d 6f63 6b5f 7361 6d70  n,.    mock_samp
+00013720: 6c65 5f72 6563 6f72 6473 2c0a 2020 2020  le_records,.    
+00013730: 6d6f 636b 5f66 6565 6462 6163 6b2c 0a20  mock_feedback,. 
+00013740: 2020 206d 6f63 6b5f 7072 6564 732c 0a20     mock_preds,. 
+00013750: 2020 206d 6f63 6b5f 7072 6564 735f 616e     mock_preds_an
+00013760: 645f 6665 6564 6261 636b 2c0a 2020 2020  d_feedback,.    
+00013770: 6d6f 636b 5f72 6573 6f6c 7665 5f6a 6f69  mock_resolve_joi
+00013780: 6e5f 6b65 7973 2c0a 2020 2020 7665 7273  n_keys,.    vers
+00013790: 696f 6e2c 0a20 2020 2074 6167 732c 0a20  ion,.    tags,. 
+000137a0: 2020 2072 6f77 5f74 6167 732c 0a20 2020     row_tags,.   
+000137b0: 2067 6c6f 6261 6c5f 7461 6773 2c0a 2020   global_tags,.  
+000137c0: 2020 6578 7065 6374 6564 5f74 6167 735f    expected_tags_
+000137d0: 7061 7261 6d2c 0a20 2020 2074 6573 745f  param,.    test_
+000137e0: 7469 6d65 7374 616d 7073 2c0a 2020 2020  timestamps,.    
+000137f0: 7465 7374 5f74 696d 6573 7461 6d70 735f  test_timestamps_
+00013800: 6c69 7374 2c0a 2020 2020 7465 7374 5f69  list,.    test_i
+00013810: 6e70 7574 732c 0a20 2020 2074 6573 745f  nputs,.    test_
+00013820: 6f75 7470 7574 732c 0a20 2020 206b 7761  outputs,.    kwa
+00013830: 7267 732c 0a20 2020 2063 6c69 5f6f 626a  rgs,.    cli_obj
+00013840: 2c0a 293a 0a20 2020 206d 6f63 6b5f 6a6f  ,.):.    mock_jo
+00013850: 696e 5f6b 6579 5f67 656e 2e73 6964 655f  in_key_gen.side_
+00013860: 6566 6665 6374 203d 205b 2236 3738 3930  effect = ["67890
+00013870: 222c 2022 3132 3334 3522 5d0a 2020 2020  ", "12345"].    
+00013880: 6d6f 636b 5f72 6573 6f6c 7665 5f6a 6f69  mock_resolve_joi
+00013890: 6e5f 6b65 7973 2e72 6574 7572 6e5f 7661  n_keys.return_va
+000138a0: 6c75 6520 3d20 5b22 3132 3334 3522 2c20  lue = ["12345", 
+000138b0: 2236 3738 3930 225d 2069 6620 6b77 6172  "67890"] if kwar
+000138c0: 6773 2065 6c73 6520 4e6f 6e65 0a20 2020  gs else None.   
+000138d0: 2061 7373 6572 7420 636c 695f 6f62 6a2e   assert cli_obj.
+000138e0: 7369 6e67 6c65 5f6c 6f67 5f72 6563 6f72  single_log_recor
+000138f0: 6473 280a 2020 2020 2020 2020 6170 706c  ds(.        appl
+00013900: 6963 6174 696f 6e3d 2266 6f6f 6261 7222  ication="foobar"
+00013910: 2c0a 2020 2020 2020 2020 7665 7273 696f  ,.        versio
+00013920: 6e3d 7665 7273 696f 6e2c 0a20 2020 2020  n=version,.     
+00013930: 2020 2069 6e70 7574 733d 7465 7374 5f69     inputs=test_i
+00013940: 6e70 7574 732c 0a20 2020 2020 2020 206f  nputs,.        o
+00013950: 7574 7075 7473 3d74 6573 745f 6f75 7470  utputs=test_outp
+00013960: 7574 732c 0a20 2020 2020 2020 2066 6565  uts,.        fee
+00013970: 6462 6163 6b73 3d4e 6f6e 652c 0a20 2020  dbacks=None,.   
+00013980: 2020 2020 2074 696d 6573 7461 6d70 733d       timestamps=
+00013990: 7465 7374 5f74 696d 6573 7461 6d70 732c  test_timestamps,
+000139a0: 0a20 2020 2020 2020 2073 6f72 745f 6f6e  .        sort_on
+000139b0: 5f74 696d 6573 7461 6d70 3d54 7275 652c  _timestamp=True,
+000139c0: 0a20 2020 2020 2020 2074 6167 733d 7461  .        tags=ta
+000139d0: 6773 2c0a 2020 2020 2020 2020 726f 775f  gs,.        row_
+000139e0: 7461 6773 3d72 6f77 5f74 6167 732c 0a20  tags=row_tags,. 
+000139f0: 2020 2020 2020 2067 6c6f 6261 6c5f 7461         global_ta
+00013a00: 6773 3d67 6c6f 6261 6c5f 7461 6773 2c0a  gs=global_tags,.
+00013a10: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
+00013a20: 2c0a 2020 2020 2920 3d3d 2028 4e6f 6e65  ,.    ) == (None
+00013a30: 2c20 5b22 3132 3334 3522 2c20 2236 3738  , ["12345", "678
+00013a40: 3930 225d 290a 0a20 2020 206d 6f63 6b5f  90"])..    mock_
+00013a50: 7072 6564 735f 616e 645f 6665 6564 6261  preds_and_feedba
+00013a60: 636b 2e61 7373 6572 745f 6e6f 745f 6361  ck.assert_not_ca
+00013a70: 6c6c 6564 2829 0a20 2020 206d 6f63 6b5f  lled().    mock_
+00013a80: 7072 6564 732e 6173 7365 7274 5f63 616c  preds.assert_cal
+00013a90: 6c65 645f 6f6e 6365 5f77 6974 6828 0a20  led_once_with(. 
+00013aa0: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
+00013ab0: 6f6e 3d22 666f 6f62 6172 222c 0a20 2020  on="foobar",.   
+00013ac0: 2020 2020 2069 6e70 7574 733d 5b7b 2241       inputs=[{"A
+00013ad0: 223a 2031 3030 7d2c 207b 2241 223a 2031  ": 100}, {"A": 1
+00013ae0: 3031 7d5d 2c0a 2020 2020 2020 2020 6f75  01}],.        ou
+00013af0: 7470 7574 733d 5b7b 2242 223a 2033 3030  tputs=[{"B": 300
+00013b00: 7d2c 207b 2242 223a 2033 3031 7d5d 2c0a  }, {"B": 301}],.
+00013b10: 2020 2020 2020 2020 6a6f 696e 5f6b 6579          join_key
+00013b20: 733d 5b22 3132 3334 3522 2c20 2236 3738  s=["12345", "678
+00013b30: 3930 225d 2069 6620 6b77 6172 6773 2065  90"] if kwargs e
+00013b40: 6c73 6520 5b22 3637 3839 3022 2c20 2231  lse ["67890", "1
+00013b50: 3233 3435 225d 2c0a 2020 2020 2020 2020  2345"],.        
+00013b60: 7665 7273 696f 6e3d 7665 7273 696f 6e2c  version=version,
+00013b70: 0a20 2020 2020 2020 2069 676e 6f72 655f  .        ignore_
+00013b80: 696e 7075 7473 3d4e 6f6e 652c 0a20 2020  inputs=None,.   
+00013b90: 2020 2020 2074 696d 6573 7461 6d70 733d       timestamps=
+00013ba0: 7465 7374 5f74 696d 6573 7461 6d70 735f  test_timestamps_
+00013bb0: 6c69 7374 2c0a 2020 2020 2020 2020 736f  list,.        so
+00013bc0: 7274 5f6f 6e5f 7469 6d65 7374 616d 703d  rt_on_timestamp=
+00013bd0: 5472 7565 2c0a 2020 2020 2020 2020 6173  True,.        as
+00013be0: 5f62 6174 6368 3d46 616c 7365 2c0a 2020  _batch=False,.  
+00013bf0: 2020 2020 2020 7461 6773 3d65 7870 6563        tags=expec
+00013c00: 7465 645f 7461 6773 5f70 6172 616d 2c0a  ted_tags_param,.
+00013c10: 2020 2020 290a 2020 2020 6d6f 636b 5f66      ).    mock_f
+00013c20: 6565 6462 6163 6b2e 6173 7365 7274 5f6e  eedback.assert_n
+00013c30: 6f74 5f63 616c 6c65 6428 290a 0a20 2020  ot_called()..   
+00013c40: 206d 6f63 6b5f 7361 6d70 6c65 5f72 6563   mock_sample_rec
+00013c50: 6f72 6473 2e61 7373 6572 745f 6361 6c6c  ords.assert_call
+00013c60: 6564 5f6f 6e63 655f 7769 7468 280a 2020  ed_once_with(.  
+00013c70: 2020 2020 2020 322c 0a20 2020 2020 2020        2,.       
+00013c80: 2031 2c0a 2020 2020 2020 2020 5b7b 2241   1,.        [{"A
+00013c90: 223a 2031 3030 7d2c 207b 2241 223a 2031  ": 100}, {"A": 1
+00013ca0: 3031 7d5d 2c0a 2020 2020 2020 2020 5b7b  01}],.        [{
+00013cb0: 2242 223a 2033 3030 7d2c 207b 2242 223a  "B": 300}, {"B":
+00013cc0: 2033 3031 7d5d 2c0a 2020 2020 2020 2020   301}],.        
+00013cd0: 4e6f 6e65 2c0a 2020 2020 2020 2020 636c  None,.        cl
+00013ce0: 6965 6e74 2e5f 7265 736f 6c76 655f 6a6f  ient._resolve_jo
+00013cf0: 696e 5f6b 6579 7328 2a2a 6b77 6172 6773  in_keys(**kwargs
+00013d00: 292c 0a20 2020 2020 2020 2074 6573 745f  ),.        test_
+00013d10: 7469 6d65 7374 616d 7073 5f6c 6973 742c  timestamps_list,
+00013d20: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+00013d30: 645f 7461 6773 5f70 6172 616d 2c0a 2020  d_tags_param,.  
+00013d40: 2020 290a 0a20 2020 2069 6620 6b77 6172    )..    if kwar
+00013d50: 6773 3a0a 2020 2020 2020 2020 6d6f 636b  gs:.        mock
+00013d60: 5f6a 6f69 6e5f 6b65 795f 6765 6e2e 6173  _join_key_gen.as
+00013d70: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
+00013d80: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+00013d90: 2020 2020 6d6f 636b 5f6a 6f69 6e5f 6b65      mock_join_ke
+00013da0: 795f 6765 6e2e 6173 7365 7274 5f63 616c  y_gen.assert_cal
+00013db0: 6c65 6428 290a 0a0a 4070 7974 6573 742e  led()...@pytest.
+00013dc0: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
+00013dd0: 280a 2020 2020 2274 6573 745f 7469 6d65  (.    "test_time
+00013de0: 7374 616d 7073 2c20 7465 7374 5f74 696d  stamps, test_tim
+00013df0: 6573 7461 6d70 735f 6c69 7374 222c 0a20  estamps_list",. 
+00013e00: 2020 205b 0a20 2020 2020 2020 2028 4e6f     [.        (No
+00013e10: 6e65 2c20 4e6f 6e65 292c 0a20 2020 2020  ne, None),.     
+00013e20: 2020 2028 5b43 5552 5245 4e54 5f54 494d     ([CURRENT_TIM
+00013e30: 455d 202a 2032 2c20 5b43 5552 5245 4e54  E] * 2, [CURRENT
+00013e40: 5f54 494d 455d 202a 2032 292c 0a20 2020  _TIME] * 2),.   
+00013e50: 2020 2020 2028 6e70 2e61 7272 6179 285b       (np.array([
+00013e60: 4355 5252 454e 545f 5449 4d45 5d20 2a20  CURRENT_TIME] * 
+00013e70: 3229 2c20 5b43 5552 5245 4e54 5f54 494d  2), [CURRENT_TIM
+00013e80: 455d 202a 2032 292c 0a20 2020 205d 2c0a  E] * 2),.    ],.
+00013e90: 290a 4070 7974 6573 742e 6d61 726b 2e70  ).@pytest.mark.p
+00013ea0: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
+00013eb0: 226b 7761 7267 7322 2c0a 2020 2020 5b0a  "kwargs",.    [.
+00013ec0: 2020 2020 2020 2020 7b22 6a6f 696e 5f6b          {"join_k
+00013ed0: 6579 7322 3a20 5b22 3534 3332 3122 2c20  eys": ["54321", 
+00013ee0: 2236 3738 3930 225d 7d2c 0a20 2020 2020  "67890"]},.     
+00013ef0: 2020 207b 226a 6f69 6e5f 6b65 7973 223a     {"join_keys":
+00013f00: 2070 642e 5365 7269 6573 285b 2235 3433   pd.Series(["543
+00013f10: 3231 222c 2022 3637 3839 3022 5d29 7d2c  21", "67890"])},
+00013f20: 0a20 2020 2020 2020 207b 7d2c 0a20 2020  .        {},.   
+00013f30: 205d 2c0a 290a 4070 7974 6573 742e 6d61   ],.).@pytest.ma
+00013f40: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
+00013f50: 2020 2020 2822 7465 7374 5f6f 7574 7075      ("test_outpu
+00013f60: 7473 222c 2022 7465 7374 5f69 6e70 7574  ts", "test_input
+00013f70: 7322 292c 0a20 2020 206c 6973 7428 7a69  s"),.    list(zi
+00013f80: 7028 5445 5354 5f4f 5554 5055 5453 2c20  p(TEST_OUTPUTS, 
+00013f90: 5445 5354 5f49 4e50 5554 5329 292c 0a29  TEST_INPUTS)),.)
+00013fa0: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
+00013fb0: 7261 6d65 7472 697a 6528 2276 6572 7369  rametrize("versi
+00013fc0: 6f6e 222c 205b 4e6f 6e65 2c20 3130 2c20  on", [None, 10, 
+00013fd0: 2231 2e32 2e33 225d 290a 4070 7974 6573  "1.2.3"]).@pytes
+00013fe0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+00013ff0: 7a65 2822 7461 6773 2c20 726f 775f 7461  ze("tags, row_ta
+00014000: 6773 2c20 676c 6f62 616c 5f74 6167 732c  gs, global_tags,
+00014010: 2065 7870 6563 7465 645f 7461 6773 5f70   expected_tags_p
+00014020: 6172 616d 222c 2054 4553 545f 5441 4753  aram", TEST_TAGS
+00014030: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
+00014040: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
+00014050: 656e 742e 5f72 6573 6f6c 7665 5f6a 6f69  ent._resolve_joi
+00014060: 6e5f 6b65 7973 2229 0a40 6d6f 636b 2e70  n_keys").@mock.p
+00014070: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
+00014080: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
+00014090: 792e 5f67 656e 6572 6174 655f 7072 6564  y._generate_pred
+000140a0: 6963 7469 6f6e 5f61 6e64 5f66 6565 6462  iction_and_feedb
+000140b0: 6163 6b5f 6576 656e 7473 2229 0a40 6d6f  ack_events").@mo
+000140c0: 636b 2e70 6174 6368 280a 2020 2020 2267  ck.patch(.    "g
+000140d0: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
+000140e0: 656e 742e 4761 6e74 7279 2e5f 6765 6e65  ent.Gantry._gene
+000140f0: 7261 7465 5f70 7265 6469 6374 696f 6e5f  rate_prediction_
+00014100: 6576 656e 7473 222c 0a20 2020 2072 6574  events",.    ret
+00014110: 7572 6e5f 7661 6c75 653d 285b 7b22 6576  urn_value=([{"ev
+00014120: 656e 7422 3a20 2270 6c61 6365 5f68 6f6c  ent": "place_hol
+00014130: 6465 7222 7d5d 2c20 5b22 3132 3334 3522  der"}], ["12345"
+00014140: 2c20 2236 3738 3930 225d 292c 0a29 0a40  , "67890"]),.).@
+00014150: 6d6f 636b 2e70 6174 6368 2822 6761 6e74  mock.patch("gant
+00014160: 7279 2e6c 6f67 6765 722e 636c 6965 6e74  ry.logger.client
+00014170: 2e47 616e 7472 792e 5f67 656e 6572 6174  .Gantry._generat
+00014180: 655f 6665 6564 6261 636b 5f65 7665 6e74  e_feedback_event
+00014190: 7322 290a 406d 6f63 6b2e 7061 7463 6828  s").@mock.patch(
+000141a0: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
+000141b0: 6c69 656e 742e 5f73 616d 706c 655f 7265  lient._sample_re
+000141c0: 636f 7264 7322 2c20 7369 6465 5f65 6666  cords", side_eff
+000141d0: 6563 743d 636c 6965 6e74 2e5f 7361 6d70  ect=client._samp
+000141e0: 6c65 5f72 6563 6f72 6473 290a 406d 6f63  le_records).@moc
+000141f0: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
+00014200: 6c6f 6767 6572 2e63 6c69 656e 742e 5f64  logger.client._d
+00014210: 6566 6175 6c74 5f6a 6f69 6e5f 6b65 795f  efault_join_key_
+00014220: 6765 6e22 290a 6465 6620 7465 7374 5f67  gen").def test_g
+00014230: 656e 6572 6174 655f 7265 636f 7264 735f  enerate_records_
+00014240: 7072 6564 735f 6f6e 6c79 280a 2020 2020  preds_only(.    
+00014250: 6d6f 636b 5f6a 6f69 6e5f 6b65 795f 6765  mock_join_key_ge
+00014260: 6e2c 0a20 2020 206d 6f63 6b5f 7361 6d70  n,.    mock_samp
+00014270: 6c65 5f72 6563 6f72 6473 2c0a 2020 2020  le_records,.    
+00014280: 6d6f 636b 5f67 656e 6572 6174 655f 6665  mock_generate_fe
+00014290: 6564 6261 636b 2c0a 2020 2020 6d6f 636b  edback,.    mock
+000142a0: 5f67 656e 6572 6174 655f 7072 6564 732c  _generate_preds,
+000142b0: 0a20 2020 206d 6f63 6b5f 6765 6e65 7261  .    mock_genera
+000142c0: 7465 5f70 7265 6473 5f61 6e64 5f66 6565  te_preds_and_fee
+000142d0: 6462 6163 6b2c 0a20 2020 206d 6f63 6b5f  dback,.    mock_
+000142e0: 7265 736f 6c76 655f 6a6f 696e 5f6b 6579  resolve_join_key
+000142f0: 732c 0a20 2020 2076 6572 7369 6f6e 2c0a  s,.    version,.
+00014300: 2020 2020 7461 6773 2c0a 2020 2020 726f      tags,.    ro
+00014310: 775f 7461 6773 2c0a 2020 2020 676c 6f62  w_tags,.    glob
+00014320: 616c 5f74 6167 732c 0a20 2020 2065 7870  al_tags,.    exp
+00014330: 6563 7465 645f 7461 6773 5f70 6172 616d  ected_tags_param
+00014340: 2c0a 2020 2020 7465 7374 5f74 696d 6573  ,.    test_times
+00014350: 7461 6d70 732c 0a20 2020 2074 6573 745f  tamps,.    test_
+00014360: 7469 6d65 7374 616d 7073 5f6c 6973 742c  timestamps_list,
+00014370: 0a20 2020 2074 6573 745f 696e 7075 7473  .    test_inputs
+00014380: 2c0a 2020 2020 7465 7374 5f6f 7574 7075  ,.    test_outpu
+00014390: 7473 2c0a 2020 2020 6b77 6172 6773 2c0a  ts,.    kwargs,.
+000143a0: 2020 2020 636c 695f 6f62 6a2c 0a29 3a0a      cli_obj,.):.
+000143b0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000143c0: 6528 7461 6773 2c20 6c69 7374 293a 0a20  e(tags, list):. 
+000143d0: 2020 2020 2020 2070 7974 6573 742e 736b         pytest.sk
+000143e0: 6970 2822 5468 6973 2074 6573 7420 6973  ip("This test is
+000143f0: 206e 6f74 2061 7070 6c69 6361 626c 6520   not applicable 
+00014400: 746f 206c 6973 7420 7461 6773 2229 0a0a  to list tags")..
+00014410: 2020 2020 6d6f 636b 5f6a 6f69 6e5f 6b65      mock_join_ke
+00014420: 795f 6765 6e2e 7369 6465 5f65 6666 6563  y_gen.side_effec
+00014430: 7420 3d20 5b22 3637 3839 3022 2c20 2231  t = ["67890", "1
+00014440: 3233 3435 225d 0a20 2020 206d 6f63 6b5f  2345"].    mock_
+00014450: 7265 736f 6c76 655f 6a6f 696e 5f6b 6579  resolve_join_key
+00014460: 732e 7265 7475 726e 5f76 616c 7565 203d  s.return_value =
+00014470: 205b 2231 3233 3435 222c 2022 3637 3839   ["12345", "6789
+00014480: 3022 5d20 6966 206b 7761 7267 7320 656c  0"] if kwargs el
+00014490: 7365 204e 6f6e 650a 2020 2020 7275 6e5f  se None.    run_
+000144a0: 6964 203d 2073 7472 2875 7569 642e 7575  id = str(uuid.uu
+000144b0: 6964 3428 2929 0a20 2020 2072 756e 5f74  id4()).    run_t
+000144c0: 6167 7320 3d20 4e6f 6e65 0a20 2020 2069  ags = None.    i
+000144d0: 6620 7461 6773 2061 6e64 2067 6c6f 6261  f tags and globa
+000144e0: 6c5f 7461 6773 3a0a 2020 2020 2020 2020  l_tags:.        
+000144f0: 7275 6e5f 7461 6773 203d 207b 2a2a 7461  run_tags = {**ta
+00014500: 6773 2c20 2a2a 676c 6f62 616c 5f74 6167  gs, **global_tag
+00014510: 737d 0a20 2020 2065 6c69 6620 7461 6773  s}.    elif tags
+00014520: 3a0a 2020 2020 2020 2020 7275 6e5f 7461  :.        run_ta
+00014530: 6773 203d 2074 6167 730a 2020 2020 656c  gs = tags.    el
+00014540: 6966 2067 6c6f 6261 6c5f 7461 6773 3a0a  if global_tags:.
+00014550: 2020 2020 2020 2020 7275 6e5f 7461 6773          run_tags
+00014560: 203d 2067 6c6f 6261 6c5f 7461 6773 0a20   = global_tags. 
+00014570: 2020 2061 7373 6572 7420 636c 695f 6f62     assert cli_ob
+00014580: 6a2e 6c6f 6728 0a20 2020 2020 2020 2061  j.log(.        a
+00014590: 7070 6c69 6361 7469 6f6e 3d22 666f 6f62  pplication="foob
+000145a0: 6172 222c 0a20 2020 2020 2020 2076 6572  ar",.        ver
+000145b0: 7369 6f6e 3d76 6572 7369 6f6e 2c0a 2020  sion=version,.  
+000145c0: 2020 2020 2020 696e 7075 7473 3d74 6573        inputs=tes
+000145d0: 745f 696e 7075 7473 2c0a 2020 2020 2020  t_inputs,.      
+000145e0: 2020 6f75 7470 7574 733d 7465 7374 5f6f    outputs=test_o
+000145f0: 7574 7075 7473 2c0a 2020 2020 2020 2020  utputs,.        
+00014600: 6665 6564 6261 636b 733d 4e6f 6e65 2c0a  feedbacks=None,.
+00014610: 2020 2020 2020 2020 7469 6d65 7374 616d          timestam
+00014620: 7073 3d74 6573 745f 7469 6d65 7374 616d  ps=test_timestam
+00014630: 7073 2c0a 2020 2020 2020 2020 736f 7274  ps,.        sort
+00014640: 5f6f 6e5f 7469 6d65 7374 616d 703d 5472  _on_timestamp=Tr
+00014650: 7565 2c0a 2020 2020 2020 2020 7275 6e5f  ue,.        run_
+00014660: 7461 6773 3d72 756e 5f74 6167 732c 0a20  tags=run_tags,. 
+00014670: 2020 2020 2020 2072 6f77 5f74 6167 733d         row_tags=
+00014680: 726f 775f 7461 6773 2c0a 2020 2020 2020  row_tags,.      
+00014690: 2020 7275 6e5f 6964 3d72 756e 5f69 642c    run_id=run_id,
+000146a0: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
+000146b0: 732c 0a20 2020 2029 203d 3d20 5b7b 2265  s,.    ) == [{"e
+000146c0: 7665 6e74 223a 2022 706c 6163 655f 686f  vent": "place_ho
+000146d0: 6c64 6572 227d 5d0a 0a20 2020 206d 6f63  lder"}]..    moc
+000146e0: 6b5f 6765 6e65 7261 7465 5f70 7265 6473  k_generate_preds
+000146f0: 5f61 6e64 5f66 6565 6462 6163 6b2e 6173  _and_feedback.as
+00014700: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
+00014710: 290a 2020 2020 6d6f 636b 5f67 656e 6572  ).    mock_gener
+00014720: 6174 655f 7072 6564 732e 6173 7365 7274  ate_preds.assert
+00014730: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+00014740: 6828 0a20 2020 2020 2020 2061 7070 6c69  h(.        appli
+00014750: 6361 7469 6f6e 3d22 666f 6f62 6172 222c  cation="foobar",
+00014760: 0a20 2020 2020 2020 2069 6e70 7574 733d  .        inputs=
+00014770: 5b7b 2241 223a 2031 3030 7d2c 207b 2241  [{"A": 100}, {"A
+00014780: 223a 2031 3031 7d5d 2c0a 2020 2020 2020  ": 101}],.      
+00014790: 2020 6f75 7470 7574 733d 5b7b 2242 223a    outputs=[{"B":
+000147a0: 2033 3030 7d2c 207b 2242 223a 2033 3031   300}, {"B": 301
+000147b0: 7d5d 2c0a 2020 2020 2020 2020 6a6f 696e  }],.        join
+000147c0: 5f6b 6579 733d 5b22 3132 3334 3522 2c20  _keys=["12345", 
+000147d0: 2236 3738 3930 225d 2069 6620 6b77 6172  "67890"] if kwar
+000147e0: 6773 2065 6c73 6520 5b22 3637 3839 3022  gs else ["67890"
+000147f0: 2c20 2231 3233 3435 225d 2c0a 2020 2020  , "12345"],.    
+00014800: 2020 2020 7665 7273 696f 6e3d 7665 7273      version=vers
+00014810: 696f 6e2c 0a20 2020 2020 2020 2069 676e  ion,.        ign
+00014820: 6f72 655f 696e 7075 7473 3d4e 6f6e 652c  ore_inputs=None,
+00014830: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
+00014840: 6d70 733d 7465 7374 5f74 696d 6573 7461  mps=test_timesta
+00014850: 6d70 735f 6c69 7374 2c0a 2020 2020 2020  mps_list,.      
+00014860: 2020 736f 7274 5f6f 6e5f 7469 6d65 7374    sort_on_timest
+00014870: 616d 703d 5472 7565 2c0a 2020 2020 2020  amp=True,.      
+00014880: 2020 7275 6e5f 6964 3d72 756e 5f69 642c    run_id=run_id,
+00014890: 0a20 2020 2020 2020 2074 6167 733d 6578  .        tags=ex
+000148a0: 7065 6374 6564 5f74 6167 735f 7061 7261  pected_tags_para
+000148b0: 6d2c 0a20 2020 2029 0a20 2020 206d 6f63  m,.    ).    moc
+000148c0: 6b5f 6765 6e65 7261 7465 5f66 6565 6462  k_generate_feedb
+000148d0: 6163 6b2e 6173 7365 7274 5f6e 6f74 5f63  ack.assert_not_c
+000148e0: 616c 6c65 6428 290a 0a20 2020 206d 6f63  alled()..    moc
+000148f0: 6b5f 7361 6d70 6c65 5f72 6563 6f72 6473  k_sample_records
+00014900: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+00014910: 6e63 655f 7769 7468 280a 2020 2020 2020  nce_with(.      
+00014920: 2020 322c 0a20 2020 2020 2020 2031 2c0a    2,.        1,.
+00014930: 2020 2020 2020 2020 5b7b 2241 223a 2031          [{"A": 1
+00014940: 3030 7d2c 207b 2241 223a 2031 3031 7d5d  00}, {"A": 101}]
+00014950: 2c0a 2020 2020 2020 2020 5b7b 2242 223a  ,.        [{"B":
+00014960: 2033 3030 7d2c 207b 2242 223a 2033 3031   300}, {"B": 301
+00014970: 7d5d 2c0a 2020 2020 2020 2020 4e6f 6e65  }],.        None
+00014980: 2c0a 2020 2020 2020 2020 636c 6965 6e74  ,.        client
+00014990: 2e5f 7265 736f 6c76 655f 6a6f 696e 5f6b  ._resolve_join_k
+000149a0: 6579 7328 2a2a 6b77 6172 6773 292c 0a20  eys(**kwargs),. 
+000149b0: 2020 2020 2020 2074 6573 745f 7469 6d65         test_time
+000149c0: 7374 616d 7073 5f6c 6973 742c 0a20 2020  stamps_list,.   
+000149d0: 2020 2020 2065 7870 6563 7465 645f 7461       expected_ta
+000149e0: 6773 5f70 6172 616d 2c0a 2020 2020 290a  gs_param,.    ).
+000149f0: 0a20 2020 2069 6620 6b77 6172 6773 3a0a  .    if kwargs:.
+00014a00: 2020 2020 2020 2020 6d6f 636b 5f6a 6f69          mock_joi
+00014a10: 6e5f 6b65 795f 6765 6e2e 6173 7365 7274  n_key_gen.assert
+00014a20: 5f6e 6f74 5f63 616c 6c65 6428 290a 2020  _not_called().  
+00014a30: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00014a40: 6d6f 636b 5f6a 6f69 6e5f 6b65 795f 6765  mock_join_key_ge
+00014a50: 6e2e 6173 7365 7274 5f63 616c 6c65 6428  n.assert_called(
+00014a60: 290a 0a0a 4070 7974 6573 742e 6d61 726b  )...@pytest.mark
+00014a70: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
+00014a80: 2020 2274 6573 745f 7469 6d65 7374 616d    "test_timestam
+00014a90: 7073 2c20 7465 7374 5f74 696d 6573 7461  ps, test_timesta
+00014aa0: 6d70 735f 6c69 7374 222c 0a20 2020 205b  mps_list",.    [
+00014ab0: 0a20 2020 2020 2020 2028 4e6f 6e65 2c20  .        (None, 
+00014ac0: 4e6f 6e65 292c 0a20 2020 2020 2020 2028  None),.        (
+00014ad0: 5b43 5552 5245 4e54 5f54 494d 455d 202a  [CURRENT_TIME] *
+00014ae0: 2032 2c20 5b43 5552 5245 4e54 5f54 494d   2, [CURRENT_TIM
+00014af0: 455d 202a 2032 292c 0a20 2020 2020 2020  E] * 2),.       
+00014b00: 2028 6e70 2e61 7272 6179 285b 4355 5252   (np.array([CURR
+00014b10: 454e 545f 5449 4d45 5d20 2a20 3229 2c20  ENT_TIME] * 2), 
+00014b20: 5b43 5552 5245 4e54 5f54 494d 455d 202a  [CURRENT_TIME] *
+00014b30: 2032 292c 0a20 2020 205d 2c0a 290a 4070   2),.    ],.).@p
+00014b40: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+00014b50: 6574 7269 7a65 280a 2020 2020 226b 7761  etrize(.    "kwa
+00014b60: 7267 7322 2c0a 2020 2020 5b0a 2020 2020  rgs",.    [.    
+00014b70: 2020 2020 7b22 6665 6564 6261 636b 5f6b      {"feedback_k
+00014b80: 6579 7322 3a20 5b22 4122 5d7d 2c0a 2020  eys": ["A"]},.  
+00014b90: 2020 2020 2020 7b22 6665 6564 6261 636b        {"feedback
+00014ba0: 5f69 6473 223a 205b 2231 3233 3435 222c  _ids": ["12345",
+00014bb0: 2022 3637 3839 3022 5d7d 2c0a 2020 2020   "67890"]},.    
+00014bc0: 2020 2020 7b22 6a6f 696e 5f6b 6579 7322      {"join_keys"
+00014bd0: 3a20 5b22 3534 3332 3122 2c20 2236 3738  : ["54321", "678
+00014be0: 3930 225d 7d2c 0a20 2020 2020 2020 207b  90"]},.        {
+00014bf0: 226a 6f69 6e5f 6b65 7973 223a 2070 642e  "join_keys": pd.
+00014c00: 5365 7269 6573 285b 2235 3433 3231 222c  Series(["54321",
+00014c10: 2022 3637 3839 3022 5d29 7d2c 0a20 2020   "67890"])},.   
+00014c20: 205d 2c0a 290a 4070 7974 6573 742e 6d61   ],.).@pytest.ma
+00014c30: 726b 2e70 6172 616d 6574 7269 7a65 2822  rk.parametrize("
+00014c40: 7465 7374 5f66 6565 6462 6163 6b73 222c  test_feedbacks",
+00014c50: 2054 4553 545f 4645 4544 4241 434b 5329   TEST_FEEDBACKS)
+00014c60: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
+00014c70: 7261 6d65 7472 697a 6528 2276 6572 7369  rametrize("versi
+00014c80: 6f6e 222c 205b 4e6f 6e65 2c20 3130 2c20  on", [None, 10, 
+00014c90: 2231 2e32 2e33 225d 290a 4070 7974 6573  "1.2.3"]).@pytes
+00014ca0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+00014cb0: 7a65 2822 7461 6773 2c20 726f 775f 7461  ze("tags, row_ta
+00014cc0: 6773 2c20 676c 6f62 616c 5f74 6167 732c  gs, global_tags,
+00014cd0: 2065 7870 6563 7465 645f 7461 6773 5f70   expected_tags_p
+00014ce0: 6172 616d 222c 2054 4553 545f 5441 4753  aram", TEST_TAGS
+00014cf0: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
+00014d00: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
+00014d10: 656e 742e 5f72 6573 6f6c 7665 5f6a 6f69  ent._resolve_joi
+00014d20: 6e5f 6b65 7973 222c 2072 6574 7572 6e5f  n_keys", return_
+00014d30: 7661 6c75 653d 5b22 3132 3334 3522 2c20  value=["12345", 
+00014d40: 2235 3433 3231 225d 290a 406d 6f63 6b2e  "54321"]).@mock.
+00014d50: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
+00014d60: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
+00014d70: 7279 2e5f 6c6f 675f 7072 6564 6963 7469  ry._log_predicti
+00014d80: 6f6e 5f61 6e64 5f66 6565 6462 6163 6b5f  on_and_feedback_
+00014d90: 6576 656e 7473 2229 0a40 6d6f 636b 2e70  events").@mock.p
+00014da0: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
+00014db0: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
+00014dc0: 792e 5f6c 6f67 5f70 7265 6469 6374 696f  y._log_predictio
+00014dd0: 6e5f 6576 656e 7473 2229 0a40 6d6f 636b  n_events").@mock
+00014de0: 2e70 6174 6368 280a 2020 2020 2267 616e  .patch(.    "gan
+00014df0: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
+00014e00: 742e 4761 6e74 7279 2e5f 6c6f 675f 6665  t.Gantry._log_fe
+00014e10: 6564 6261 636b 5f65 7665 6e74 7322 2c20  edback_events", 
+00014e20: 7265 7475 726e 5f76 616c 7565 3d28 4e6f  return_value=(No
+00014e30: 6e65 2c20 5b22 3132 3334 3522 2c20 2236  ne, ["12345", "6
+00014e40: 3738 3930 225d 290a 290a 406d 6f63 6b2e  7890"]).).@mock.
+00014e50: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
+00014e60: 6767 6572 2e63 6c69 656e 742e 5f73 616d  gger.client._sam
+00014e70: 706c 655f 7265 636f 7264 7322 2c20 7369  ple_records", si
+00014e80: 6465 5f65 6666 6563 743d 636c 6965 6e74  de_effect=client
+00014e90: 2e5f 7361 6d70 6c65 5f72 6563 6f72 6473  ._sample_records
+00014ea0: 290a 6465 6620 7465 7374 5f6c 6f67 5f72  ).def test_log_r
+00014eb0: 6563 6f72 6473 5f66 6565 6462 6163 6b5f  ecords_feedback_
+00014ec0: 6f6e 6c79 280a 2020 2020 6d6f 636b 5f73  only(.    mock_s
+00014ed0: 616d 706c 655f 7265 636f 7264 732c 0a20  ample_records,. 
+00014ee0: 2020 206d 6f63 6b5f 6665 6564 6261 636b     mock_feedback
+00014ef0: 2c0a 2020 2020 6d6f 636b 5f70 7265 6473  ,.    mock_preds
+00014f00: 2c0a 2020 2020 6d6f 636b 5f70 7265 6473  ,.    mock_preds
+00014f10: 5f61 6e64 5f66 6565 6462 6163 6b2c 0a20  _and_feedback,. 
+00014f20: 2020 206d 6f63 6b5f 7265 736f 6c76 655f     mock_resolve_
+00014f30: 6a6f 696e 5f6b 6579 732c 0a20 2020 2076  join_keys,.    v
+00014f40: 6572 7369 6f6e 2c0a 2020 2020 7461 6773  ersion,.    tags
+00014f50: 2c0a 2020 2020 726f 775f 7461 6773 2c0a  ,.    row_tags,.
+00014f60: 2020 2020 676c 6f62 616c 5f74 6167 732c      global_tags,
+00014f70: 0a20 2020 2065 7870 6563 7465 645f 7461  .    expected_ta
+00014f80: 6773 5f70 6172 616d 2c0a 2020 2020 7465  gs_param,.    te
+00014f90: 7374 5f66 6565 6462 6163 6b73 2c0a 2020  st_feedbacks,.  
+00014fa0: 2020 7465 7374 5f74 696d 6573 7461 6d70    test_timestamp
+00014fb0: 732c 0a20 2020 2074 6573 745f 7469 6d65  s,.    test_time
+00014fc0: 7374 616d 7073 5f6c 6973 742c 0a20 2020  stamps_list,.   
+00014fd0: 206b 7761 7267 732c 0a20 2020 2063 6c69   kwargs,.    cli
+00014fe0: 5f6f 626a 2c0a 293a 0a20 2020 2061 7373  _obj,.):.    ass
+00014ff0: 6572 7420 636c 695f 6f62 6a2e 6c6f 675f  ert cli_obj.log_
+00015000: 7265 636f 7264 7328 0a20 2020 2020 2020  records(.       
+00015010: 2061 7070 6c69 6361 7469 6f6e 3d22 666f   application="fo
+00015020: 6f62 6172 222c 0a20 2020 2020 2020 2076  obar",.        v
+00015030: 6572 7369 6f6e 3d76 6572 7369 6f6e 2c0a  ersion=version,.
+00015040: 2020 2020 2020 2020 696e 7075 7473 3d4e          inputs=N
+00015050: 6f6e 652c 0a20 2020 2020 2020 206f 7574  one,.        out
+00015060: 7075 7473 3d4e 6f6e 652c 0a20 2020 2020  puts=None,.     
+00015070: 2020 2066 6565 6462 6163 6b73 3d74 6573     feedbacks=tes
+00015080: 745f 6665 6564 6261 636b 732c 0a20 2020  t_feedbacks,.   
+00015090: 2020 2020 2074 696d 6573 7461 6d70 733d       timestamps=
+000150a0: 7465 7374 5f74 696d 6573 7461 6d70 732c  test_timestamps,
+000150b0: 0a20 2020 2020 2020 2073 6f72 745f 6f6e  .        sort_on
+000150c0: 5f74 696d 6573 7461 6d70 3d54 7275 652c  _timestamp=True,
+000150d0: 0a20 2020 2020 2020 2074 6167 733d 7461  .        tags=ta
+000150e0: 6773 2c0a 2020 2020 2020 2020 726f 775f  gs,.        row_
+000150f0: 7461 6773 3d72 6f77 5f74 6167 732c 0a20  tags=row_tags,. 
+00015100: 2020 2020 2020 2067 6c6f 6261 6c5f 7461         global_ta
+00015110: 6773 3d67 6c6f 6261 6c5f 7461 6773 2c0a  gs=global_tags,.
+00015120: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
+00015130: 2c0a 2020 2020 2920 3d3d 2028 4e6f 6e65  ,.    ) == (None
+00015140: 2c20 5b22 3132 3334 3522 2c20 2236 3738  , ["12345", "678
+00015150: 3930 225d 290a 0a20 2020 206d 6f63 6b5f  90"])..    mock_
+00015160: 7072 6564 735f 616e 645f 6665 6564 6261  preds_and_feedba
+00015170: 636b 2e61 7373 6572 745f 6e6f 745f 6361  ck.assert_not_ca
+00015180: 6c6c 6564 2829 0a20 2020 206d 6f63 6b5f  lled().    mock_
+00015190: 7072 6564 732e 6173 7365 7274 5f6e 6f74  preds.assert_not
+000151a0: 5f63 616c 6c65 6428 290a 2020 2020 6d6f  _called().    mo
+000151b0: 636b 5f66 6565 6462 6163 6b2e 6173 7365  ck_feedback.asse
+000151c0: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+000151d0: 6974 6828 0a20 2020 2020 2020 2022 666f  ith(.        "fo
+000151e0: 6f62 6172 222c 0a20 2020 2020 2020 205b  obar",.        [
+000151f0: 7b22 4122 3a20 3230 307d 2c20 7b22 4122  {"A": 200}, {"A"
+00015200: 3a20 3230 317d 5d2c 0a20 2020 2020 2020  : 201}],.       
+00015210: 205b 2231 3233 3435 222c 2022 3534 3332   ["12345", "5432
+00015220: 3122 5d2c 0a20 2020 2020 2020 2076 6572  1"],.        ver
+00015230: 7369 6f6e 2c0a 2020 2020 2020 2020 7465  sion,.        te
+00015240: 7374 5f74 696d 6573 7461 6d70 735f 6c69  st_timestamps_li
+00015250: 7374 2c0a 2020 2020 2020 2020 5472 7565  st,.        True
+00015260: 2c0a 2020 2020 2020 2020 4661 6c73 652c  ,.        False,
+00015270: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+00015280: 645f 7461 6773 5f70 6172 616d 2c0a 2020  d_tags_param,.  
+00015290: 2020 290a 0a20 2020 206d 6f63 6b5f 7361    )..    mock_sa
+000152a0: 6d70 6c65 5f72 6563 6f72 6473 2e61 7373  mple_records.ass
+000152b0: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
+000152c0: 7769 7468 280a 2020 2020 2020 2020 322c  with(.        2,
+000152d0: 0a20 2020 2020 2020 2031 2c0a 2020 2020  .        1,.    
+000152e0: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
+000152f0: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
+00015300: 5b7b 2241 223a 2032 3030 7d2c 207b 2241  [{"A": 200}, {"A
+00015310: 223a 2032 3031 7d5d 2c0a 2020 2020 2020  ": 201}],.      
+00015320: 2020 636c 6965 6e74 2e5f 7265 736f 6c76    client._resolv
+00015330: 655f 6a6f 696e 5f6b 6579 7328 2a2a 6b77  e_join_keys(**kw
+00015340: 6172 6773 292c 0a20 2020 2020 2020 2074  args),.        t
+00015350: 6573 745f 7469 6d65 7374 616d 7073 5f6c  est_timestamps_l
+00015360: 6973 742c 0a20 2020 2020 2020 2065 7870  ist,.        exp
+00015370: 6563 7465 645f 7461 6773 5f70 6172 616d  ected_tags_param
+00015380: 2c0a 2020 2020 290a 0a0a 4070 7974 6573  ,.    )...@pytes
+00015390: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+000153a0: 7a65 280a 2020 2020 2274 6573 745f 7469  ze(.    "test_ti
+000153b0: 6d65 7374 616d 7073 2c20 7465 7374 5f74  mestamps, test_t
+000153c0: 696d 6573 7461 6d70 735f 6c69 7374 222c  imestamps_list",
+000153d0: 0a20 2020 205b 0a20 2020 2020 2020 2028  .    [.        (
+000153e0: 4e6f 6e65 2c20 4e6f 6e65 292c 0a20 2020  None, None),.   
+000153f0: 2020 2020 2028 5b43 5552 5245 4e54 5f54       ([CURRENT_T
+00015400: 494d 455d 202a 2032 2c20 5b43 5552 5245  IME] * 2, [CURRE
+00015410: 4e54 5f54 494d 455d 202a 2032 292c 0a20  NT_TIME] * 2),. 
+00015420: 2020 2020 2020 2028 6e70 2e61 7272 6179         (np.array
+00015430: 285b 4355 5252 454e 545f 5449 4d45 5d20  ([CURRENT_TIME] 
+00015440: 2a20 3229 2c20 5b43 5552 5245 4e54 5f54  * 2), [CURRENT_T
+00015450: 494d 455d 202a 2032 292c 0a20 2020 205d  IME] * 2),.    ]
+00015460: 2c0a 290a 4070 7974 6573 742e 6d61 726b  ,.).@pytest.mark
+00015470: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
+00015480: 2020 226b 7761 7267 7322 2c0a 2020 2020    "kwargs",.    
+00015490: 5b0a 2020 2020 2020 2020 7b22 6665 6564  [.        {"feed
+000154a0: 6261 636b 5f6b 6579 7322 3a20 5b22 4122  back_keys": ["A"
+000154b0: 5d7d 2c0a 2020 2020 2020 2020 7b22 6665  ]},.        {"fe
+000154c0: 6564 6261 636b 5f69 6473 223a 205b 2231  edback_ids": ["1
+000154d0: 3233 3435 222c 2022 3637 3839 3022 5d7d  2345", "67890"]}
+000154e0: 2c0a 2020 2020 2020 2020 7b22 6a6f 696e  ,.        {"join
+000154f0: 5f6b 6579 7322 3a20 5b22 3534 3332 3122  _keys": ["54321"
+00015500: 2c20 2236 3738 3930 225d 7d2c 0a20 2020  , "67890"]},.   
+00015510: 2020 2020 207b 226a 6f69 6e5f 6b65 7973       {"join_keys
+00015520: 223a 2070 642e 5365 7269 6573 285b 2235  ": pd.Series(["5
+00015530: 3433 3231 222c 2022 3637 3839 3022 5d29  4321", "67890"])
+00015540: 7d2c 0a20 2020 205d 2c0a 290a 4070 7974  },.    ],.).@pyt
+00015550: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
+00015560: 7269 7a65 2822 7465 7374 5f66 6565 6462  rize("test_feedb
+00015570: 6163 6b73 222c 2054 4553 545f 4645 4544  acks", TEST_FEED
+00015580: 4241 434b 5329 0a40 7079 7465 7374 2e6d  BACKS).@pytest.m
+00015590: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+000155a0: 2276 6572 7369 6f6e 222c 205b 4e6f 6e65  "version", [None
+000155b0: 2c20 3130 2c20 2231 2e32 2e33 225d 290a  , 10, "1.2.3"]).
+000155c0: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
+000155d0: 616d 6574 7269 7a65 2822 7461 6773 2c20  ametrize("tags, 
+000155e0: 726f 775f 7461 6773 2c20 676c 6f62 616c  row_tags, global
+000155f0: 5f74 6167 732c 2065 7870 6563 7465 645f  _tags, expected_
+00015600: 7461 6773 5f70 6172 616d 222c 2054 4553  tags_param", TES
+00015610: 545f 5441 4753 290a 406d 6f63 6b2e 7061  T_TAGS).@mock.pa
+00015620: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
+00015630: 6572 2e63 6c69 656e 742e 5f72 6573 6f6c  er.client._resol
+00015640: 7665 5f6a 6f69 6e5f 6b65 7973 222c 2072  ve_join_keys", r
+00015650: 6574 7572 6e5f 7661 6c75 653d 5b22 3132  eturn_value=["12
+00015660: 3334 3522 2c20 2235 3433 3231 225d 290a  345", "54321"]).
+00015670: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
+00015680: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
+00015690: 742e 4761 6e74 7279 2e5f 6c6f 675f 7072  t.Gantry._log_pr
+000156a0: 6564 6963 7469 6f6e 5f61 6e64 5f66 6565  ediction_and_fee
+000156b0: 6462 6163 6b5f 6576 656e 7473 2229 0a40  dback_events").@
+000156c0: 6d6f 636b 2e70 6174 6368 2822 6761 6e74  mock.patch("gant
+000156d0: 7279 2e6c 6f67 6765 722e 636c 6965 6e74  ry.logger.client
+000156e0: 2e47 616e 7472 792e 5f6c 6f67 5f70 7265  .Gantry._log_pre
+000156f0: 6469 6374 696f 6e5f 6576 656e 7473 2229  diction_events")
+00015700: 0a40 6d6f 636b 2e70 6174 6368 280a 2020  .@mock.patch(.  
+00015710: 2020 2267 616e 7472 792e 6c6f 6767 6572    "gantry.logger
+00015720: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
+00015730: 6c6f 675f 6665 6564 6261 636b 5f65 7665  log_feedback_eve
+00015740: 6e74 7322 2c20 7265 7475 726e 5f76 616c  nts", return_val
+00015750: 7565 3d28 4e6f 6e65 2c20 5b22 3132 3334  ue=(None, ["1234
+00015760: 3522 2c20 2236 3738 3930 225d 290a 290a  5", "67890"]).).
+00015770: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
+00015780: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
+00015790: 742e 5f73 616d 706c 655f 7265 636f 7264  t._sample_record
+000157a0: 7322 2c20 7369 6465 5f65 6666 6563 743d  s", side_effect=
+000157b0: 636c 6965 6e74 2e5f 7361 6d70 6c65 5f72  client._sample_r
+000157c0: 6563 6f72 6473 290a 6465 6620 7465 7374  ecords).def test
+000157d0: 5f73 696e 676c 655f 6c6f 675f 7265 636f  _single_log_reco
+000157e0: 7264 735f 6665 6564 6261 636b 5f6f 6e6c  rds_feedback_onl
+000157f0: 7928 0a20 2020 206d 6f63 6b5f 7361 6d70  y(.    mock_samp
+00015800: 6c65 5f72 6563 6f72 6473 2c0a 2020 2020  le_records,.    
+00015810: 6d6f 636b 5f66 6565 6462 6163 6b2c 0a20  mock_feedback,. 
+00015820: 2020 206d 6f63 6b5f 7072 6564 732c 0a20     mock_preds,. 
+00015830: 2020 206d 6f63 6b5f 7072 6564 735f 616e     mock_preds_an
+00015840: 645f 6665 6564 6261 636b 2c0a 2020 2020  d_feedback,.    
+00015850: 6d6f 636b 5f72 6573 6f6c 7665 5f6a 6f69  mock_resolve_joi
+00015860: 6e5f 6b65 7973 2c0a 2020 2020 7665 7273  n_keys,.    vers
+00015870: 696f 6e2c 0a20 2020 2074 6167 732c 0a20  ion,.    tags,. 
+00015880: 2020 2072 6f77 5f74 6167 732c 0a20 2020     row_tags,.   
+00015890: 2067 6c6f 6261 6c5f 7461 6773 2c0a 2020   global_tags,.  
+000158a0: 2020 6578 7065 6374 6564 5f74 6167 735f    expected_tags_
+000158b0: 7061 7261 6d2c 0a20 2020 2074 6573 745f  param,.    test_
+000158c0: 6665 6564 6261 636b 732c 0a20 2020 2074  feedbacks,.    t
+000158d0: 6573 745f 7469 6d65 7374 616d 7073 2c0a  est_timestamps,.
+000158e0: 2020 2020 7465 7374 5f74 696d 6573 7461      test_timesta
+000158f0: 6d70 735f 6c69 7374 2c0a 2020 2020 6b77  mps_list,.    kw
+00015900: 6172 6773 2c0a 2020 2020 636c 695f 6f62  args,.    cli_ob
+00015910: 6a2c 0a29 3a0a 2020 2020 6173 7365 7274  j,.):.    assert
+00015920: 2063 6c69 5f6f 626a 2e73 696e 676c 655f   cli_obj.single_
+00015930: 6c6f 675f 7265 636f 7264 7328 0a20 2020  log_records(.   
+00015940: 2020 2020 2061 7070 6c69 6361 7469 6f6e       application
+00015950: 3d22 666f 6f62 6172 222c 0a20 2020 2020  ="foobar",.     
+00015960: 2020 2076 6572 7369 6f6e 3d76 6572 7369     version=versi
+00015970: 6f6e 2c0a 2020 2020 2020 2020 696e 7075  on,.        inpu
+00015980: 7473 3d4e 6f6e 652c 0a20 2020 2020 2020  ts=None,.       
+00015990: 206f 7574 7075 7473 3d4e 6f6e 652c 0a20   outputs=None,. 
+000159a0: 2020 2020 2020 2066 6565 6462 6163 6b73         feedbacks
+000159b0: 3d74 6573 745f 6665 6564 6261 636b 732c  =test_feedbacks,
+000159c0: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
+000159d0: 6d70 733d 7465 7374 5f74 696d 6573 7461  mps=test_timesta
+000159e0: 6d70 732c 0a20 2020 2020 2020 2073 6f72  mps,.        sor
+000159f0: 745f 6f6e 5f74 696d 6573 7461 6d70 3d54  t_on_timestamp=T
+00015a00: 7275 652c 0a20 2020 2020 2020 2074 6167  rue,.        tag
+00015a10: 733d 7461 6773 2c0a 2020 2020 2020 2020  s=tags,.        
+00015a20: 726f 775f 7461 6773 3d72 6f77 5f74 6167  row_tags=row_tag
+00015a30: 732c 0a20 2020 2020 2020 2067 6c6f 6261  s,.        globa
+00015a40: 6c5f 7461 6773 3d67 6c6f 6261 6c5f 7461  l_tags=global_ta
+00015a50: 6773 2c0a 2020 2020 2020 2020 2a2a 6b77  gs,.        **kw
+00015a60: 6172 6773 2c0a 2020 2020 2920 3d3d 2028  args,.    ) == (
+00015a70: 4e6f 6e65 2c20 5b22 3132 3334 3522 2c20  None, ["12345", 
+00015a80: 2236 3738 3930 225d 290a 0a20 2020 206d  "67890"])..    m
+00015a90: 6f63 6b5f 7072 6564 735f 616e 645f 6665  ock_preds_and_fe
+00015aa0: 6564 6261 636b 2e61 7373 6572 745f 6e6f  edback.assert_no
+00015ab0: 745f 6361 6c6c 6564 2829 0a20 2020 206d  t_called().    m
+00015ac0: 6f63 6b5f 7072 6564 732e 6173 7365 7274  ock_preds.assert
+00015ad0: 5f6e 6f74 5f63 616c 6c65 6428 290a 2020  _not_called().  
+00015ae0: 2020 6d6f 636b 5f66 6565 6462 6163 6b2e    mock_feedback.
+00015af0: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
+00015b00: 6365 5f77 6974 6828 0a20 2020 2020 2020  ce_with(.       
+00015b10: 2061 7070 6c69 6361 7469 6f6e 3d22 666f   application="fo
+00015b20: 6f62 6172 222c 0a20 2020 2020 2020 2066  obar",.        f
+00015b30: 6565 6462 6163 6b73 3d5b 7b22 4122 3a20  eedbacks=[{"A": 
+00015b40: 3230 307d 2c20 7b22 4122 3a20 3230 317d  200}, {"A": 201}
+00015b50: 5d2c 0a20 2020 2020 2020 206a 6f69 6e5f  ],.        join_
+00015b60: 6b65 7973 3d5b 2231 3233 3435 222c 2022  keys=["12345", "
+00015b70: 3534 3332 3122 5d2c 0a20 2020 2020 2020  54321"],.       
+00015b80: 2066 6565 6462 6163 6b5f 7665 7273 696f   feedback_versio
+00015b90: 6e3d 7665 7273 696f 6e2c 0a20 2020 2020  n=version,.     
+00015ba0: 2020 2074 696d 6573 7461 6d70 733d 7465     timestamps=te
+00015bb0: 7374 5f74 696d 6573 7461 6d70 735f 6c69  st_timestamps_li
+00015bc0: 7374 2c0a 2020 2020 2020 2020 736f 7274  st,.        sort
+00015bd0: 5f6f 6e5f 7469 6d65 7374 616d 703d 5472  _on_timestamp=Tr
+00015be0: 7565 2c0a 2020 2020 2020 2020 6173 5f62  ue,.        as_b
+00015bf0: 6174 6368 3d46 616c 7365 2c0a 2020 2020  atch=False,.    
+00015c00: 2020 2020 7461 6773 3d65 7870 6563 7465      tags=expecte
+00015c10: 645f 7461 6773 5f70 6172 616d 2c0a 2020  d_tags_param,.  
+00015c20: 2020 290a 0a20 2020 206d 6f63 6b5f 7361    )..    mock_sa
+00015c30: 6d70 6c65 5f72 6563 6f72 6473 2e61 7373  mple_records.ass
+00015c40: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
+00015c50: 7769 7468 280a 2020 2020 2020 2020 322c  with(.        2,
+00015c60: 0a20 2020 2020 2020 2031 2c0a 2020 2020  .        1,.    
+00015c70: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
+00015c80: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
+00015c90: 5b7b 2241 223a 2032 3030 7d2c 207b 2241  [{"A": 200}, {"A
+00015ca0: 223a 2032 3031 7d5d 2c0a 2020 2020 2020  ": 201}],.      
+00015cb0: 2020 636c 6965 6e74 2e5f 7265 736f 6c76    client._resolv
+00015cc0: 655f 6a6f 696e 5f6b 6579 7328 2a2a 6b77  e_join_keys(**kw
+00015cd0: 6172 6773 292c 0a20 2020 2020 2020 2074  args),.        t
+00015ce0: 6573 745f 7469 6d65 7374 616d 7073 5f6c  est_timestamps_l
+00015cf0: 6973 742c 0a20 2020 2020 2020 2065 7870  ist,.        exp
+00015d00: 6563 7465 645f 7461 6773 5f70 6172 616d  ected_tags_param
+00015d10: 2c0a 2020 2020 290a 0a0a 4070 7974 6573  ,.    )...@pytes
+00015d20: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+00015d30: 7a65 280a 2020 2020 2274 6573 745f 7469  ze(.    "test_ti
+00015d40: 6d65 7374 616d 7073 2c20 7465 7374 5f74  mestamps, test_t
+00015d50: 696d 6573 7461 6d70 735f 6c69 7374 222c  imestamps_list",
+00015d60: 0a20 2020 205b 0a20 2020 2020 2020 2028  .    [.        (
+00015d70: 4e6f 6e65 2c20 4e6f 6e65 292c 0a20 2020  None, None),.   
+00015d80: 2020 2020 2028 5b43 5552 5245 4e54 5f54       ([CURRENT_T
+00015d90: 494d 455d 202a 2032 2c20 5b43 5552 5245  IME] * 2, [CURRE
+00015da0: 4e54 5f54 494d 455d 202a 2032 292c 0a20  NT_TIME] * 2),. 
+00015db0: 2020 2020 2020 2028 6e70 2e61 7272 6179         (np.array
+00015dc0: 285b 4355 5252 454e 545f 5449 4d45 5d20  ([CURRENT_TIME] 
+00015dd0: 2a20 3229 2c20 5b43 5552 5245 4e54 5f54  * 2), [CURRENT_T
+00015de0: 494d 455d 202a 2032 292c 0a20 2020 205d  IME] * 2),.    ]
+00015df0: 2c0a 290a 4070 7974 6573 742e 6d61 726b  ,.).@pytest.mark
+00015e00: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
+00015e10: 2020 226b 7761 7267 7322 2c0a 2020 2020    "kwargs",.    
+00015e20: 5b0a 2020 2020 2020 2020 7b22 6a6f 696e  [.        {"join
+00015e30: 5f6b 6579 7322 3a20 5b22 3534 3332 3122  _keys": ["54321"
+00015e40: 2c20 2236 3738 3930 225d 7d2c 0a20 2020  , "67890"]},.   
+00015e50: 2020 2020 207b 226a 6f69 6e5f 6b65 7973       {"join_keys
+00015e60: 223a 2070 642e 5365 7269 6573 285b 2235  ": pd.Series(["5
+00015e70: 3433 3231 222c 2022 3637 3839 3022 5d29  4321", "67890"])
+00015e80: 7d2c 0a20 2020 205d 2c0a 290a 4070 7974  },.    ],.).@pyt
+00015e90: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
+00015ea0: 7269 7a65 2822 7465 7374 5f66 6565 6462  rize("test_feedb
+00015eb0: 6163 6b73 222c 2054 4553 545f 4645 4544  acks", TEST_FEED
+00015ec0: 4241 434b 5329 0a40 7079 7465 7374 2e6d  BACKS).@pytest.m
+00015ed0: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+00015ee0: 2276 6572 7369 6f6e 222c 205b 4e6f 6e65  "version", [None
+00015ef0: 2c20 3130 2c20 2231 2e32 2e33 225d 290a  , 10, "1.2.3"]).
+00015f00: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
+00015f10: 616d 6574 7269 7a65 2822 7461 6773 2c20  ametrize("tags, 
+00015f20: 726f 775f 7461 6773 2c20 676c 6f62 616c  row_tags, global
+00015f30: 5f74 6167 732c 2065 7870 6563 7465 645f  _tags, expected_
+00015f40: 7461 6773 5f70 6172 616d 222c 2054 4553  tags_param", TES
+00015f50: 545f 5441 4753 290a 406d 6f63 6b2e 7061  T_TAGS).@mock.pa
+00015f60: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
+00015f70: 6572 2e63 6c69 656e 742e 5f72 6573 6f6c  er.client._resol
+00015f80: 7665 5f6a 6f69 6e5f 6b65 7973 222c 2072  ve_join_keys", r
+00015f90: 6574 7572 6e5f 7661 6c75 653d 5b22 3132  eturn_value=["12
+00015fa0: 3334 3522 2c20 2235 3433 3231 225d 290a  345", "54321"]).
+00015fb0: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
+00015fc0: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
+00015fd0: 742e 4761 6e74 7279 2e5f 6765 6e65 7261  t.Gantry._genera
+00015fe0: 7465 5f70 7265 6469 6374 696f 6e5f 616e  te_prediction_an
+00015ff0: 645f 6665 6564 6261 636b 5f65 7665 6e74  d_feedback_event
+00016000: 7322 290a 406d 6f63 6b2e 7061 7463 6828  s").@mock.patch(
+00016010: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
+00016020: 6c69 656e 742e 4761 6e74 7279 2e5f 6765  lient.Gantry._ge
+00016030: 6e65 7261 7465 5f70 7265 6469 6374 696f  nerate_predictio
+00016040: 6e5f 6576 656e 7473 2229 0a40 6d6f 636b  n_events").@mock
+00016050: 2e70 6174 6368 280a 2020 2020 2267 616e  .patch(.    "gan
+00016060: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
+00016070: 742e 4761 6e74 7279 2e5f 6765 6e65 7261  t.Gantry._genera
+00016080: 7465 5f66 6565 6462 6163 6b5f 6576 656e  te_feedback_even
+00016090: 7473 222c 0a20 2020 2072 6574 7572 6e5f  ts",.    return_
+000160a0: 7661 6c75 653d 285b 7b22 6576 656e 7422  value=([{"event"
+000160b0: 3a20 2270 6c61 6365 5f68 6f6c 6465 7222  : "place_holder"
+000160c0: 7d5d 2c20 5b22 3132 3334 3522 2c20 2236  }], ["12345", "6
+000160d0: 3738 3930 225d 292c 0a29 0a40 6d6f 636b  7890"]),.).@mock
+000160e0: 2e70 6174 6368 2822 6761 6e74 7279 2e6c  .patch("gantry.l
+000160f0: 6f67 6765 722e 636c 6965 6e74 2e5f 7361  ogger.client._sa
+00016100: 6d70 6c65 5f72 6563 6f72 6473 222c 2073  mple_records", s
+00016110: 6964 655f 6566 6665 6374 3d63 6c69 656e  ide_effect=clien
+00016120: 742e 5f73 616d 706c 655f 7265 636f 7264  t._sample_record
+00016130: 7329 0a64 6566 2074 6573 745f 6765 6e65  s).def test_gene
+00016140: 7261 7465 5f72 6563 6f72 6473 5f66 6565  rate_records_fee
+00016150: 6462 6163 6b5f 6f6e 6c79 280a 2020 2020  dback_only(.    
+00016160: 6d6f 636b 5f73 616d 706c 655f 7265 636f  mock_sample_reco
+00016170: 7264 732c 0a20 2020 206d 6f63 6b5f 6765  rds,.    mock_ge
+00016180: 6e65 7261 7465 5f66 6565 6462 6163 6b2c  nerate_feedback,
+00016190: 0a20 2020 206d 6f63 6b5f 6765 6e65 7261  .    mock_genera
+000161a0: 7465 5f70 7265 6473 2c0a 2020 2020 6d6f  te_preds,.    mo
+000161b0: 636b 5f67 656e 6572 6174 655f 7072 6564  ck_generate_pred
+000161c0: 735f 616e 645f 6665 6564 6261 636b 2c0a  s_and_feedback,.
+000161d0: 2020 2020 6d6f 636b 5f72 6573 6f6c 7665      mock_resolve
+000161e0: 5f6a 6f69 6e5f 6b65 7973 2c0a 2020 2020  _join_keys,.    
+000161f0: 7665 7273 696f 6e2c 0a20 2020 2074 6167  version,.    tag
+00016200: 732c 0a20 2020 2072 6f77 5f74 6167 732c  s,.    row_tags,
+00016210: 0a20 2020 2067 6c6f 6261 6c5f 7461 6773  .    global_tags
+00016220: 2c0a 2020 2020 6578 7065 6374 6564 5f74  ,.    expected_t
+00016230: 6167 735f 7061 7261 6d2c 0a20 2020 2074  ags_param,.    t
+00016240: 6573 745f 6665 6564 6261 636b 732c 0a20  est_feedbacks,. 
+00016250: 2020 2074 6573 745f 7469 6d65 7374 616d     test_timestam
+00016260: 7073 2c0a 2020 2020 7465 7374 5f74 696d  ps,.    test_tim
+00016270: 6573 7461 6d70 735f 6c69 7374 2c0a 2020  estamps_list,.  
+00016280: 2020 6b77 6172 6773 2c0a 2020 2020 636c    kwargs,.    cl
+00016290: 695f 6f62 6a2c 0a29 3a0a 2020 2020 6966  i_obj,.):.    if
+000162a0: 2069 7369 6e73 7461 6e63 6528 7461 6773   isinstance(tags
+000162b0: 2c20 6c69 7374 293a 0a20 2020 2020 2020  , list):.       
+000162c0: 2070 7974 6573 742e 736b 6970 2822 5468   pytest.skip("Th
+000162d0: 6973 2074 6573 7420 6973 206e 6f74 2061  is test is not a
+000162e0: 7070 6c69 6361 626c 6520 746f 206c 6973  pplicable to lis
+000162f0: 7420 7461 6773 2229 0a0a 2020 2020 7275  t tags")..    ru
+00016300: 6e5f 6964 203d 2073 7472 2875 7569 642e  n_id = str(uuid.
+00016310: 7575 6964 3428 2929 0a20 2020 2072 756e  uuid4()).    run
+00016320: 5f74 6167 7320 3d20 4e6f 6e65 0a20 2020  _tags = None.   
+00016330: 2069 6620 7461 6773 2061 6e64 2067 6c6f   if tags and glo
+00016340: 6261 6c5f 7461 6773 3a0a 2020 2020 2020  bal_tags:.      
+00016350: 2020 7275 6e5f 7461 6773 203d 207b 2a2a    run_tags = {**
+00016360: 7461 6773 2c20 2a2a 676c 6f62 616c 5f74  tags, **global_t
+00016370: 6167 737d 0a20 2020 2065 6c69 6620 7461  ags}.    elif ta
+00016380: 6773 3a0a 2020 2020 2020 2020 7275 6e5f  gs:.        run_
+00016390: 7461 6773 203d 2074 6167 730a 2020 2020  tags = tags.    
+000163a0: 656c 6966 2067 6c6f 6261 6c5f 7461 6773  elif global_tags
+000163b0: 3a0a 2020 2020 2020 2020 7275 6e5f 7461  :.        run_ta
+000163c0: 6773 203d 2067 6c6f 6261 6c5f 7461 6773  gs = global_tags
+000163d0: 0a20 2020 2061 7373 6572 7420 636c 695f  .    assert cli_
+000163e0: 6f62 6a2e 6c6f 6728 0a20 2020 2020 2020  obj.log(.       
+000163f0: 2061 7070 6c69 6361 7469 6f6e 3d22 666f   application="fo
+00016400: 6f62 6172 222c 0a20 2020 2020 2020 2076  obar",.        v
+00016410: 6572 7369 6f6e 3d76 6572 7369 6f6e 2c0a  ersion=version,.
+00016420: 2020 2020 2020 2020 696e 7075 7473 3d4e          inputs=N
+00016430: 6f6e 652c 0a20 2020 2020 2020 206f 7574  one,.        out
+00016440: 7075 7473 3d4e 6f6e 652c 0a20 2020 2020  puts=None,.     
+00016450: 2020 2066 6565 6462 6163 6b73 3d74 6573     feedbacks=tes
+00016460: 745f 6665 6564 6261 636b 732c 0a20 2020  t_feedbacks,.   
+00016470: 2020 2020 2074 696d 6573 7461 6d70 733d       timestamps=
+00016480: 7465 7374 5f74 696d 6573 7461 6d70 732c  test_timestamps,
+00016490: 0a20 2020 2020 2020 2073 6f72 745f 6f6e  .        sort_on
+000164a0: 5f74 696d 6573 7461 6d70 3d54 7275 652c  _timestamp=True,
+000164b0: 0a20 2020 2020 2020 2072 6f77 5f74 6167  .        row_tag
+000164c0: 733d 726f 775f 7461 6773 2c0a 2020 2020  s=row_tags,.    
+000164d0: 2020 2020 7275 6e5f 7461 6773 3d72 756e      run_tags=run
+000164e0: 5f74 6167 732c 0a20 2020 2020 2020 2072  _tags,.        r
+000164f0: 756e 5f69 643d 7275 6e5f 6964 2c0a 2020  un_id=run_id,.  
+00016500: 2020 2020 2020 2a2a 6b77 6172 6773 2c0a        **kwargs,.
+00016510: 2020 2020 2920 3d3d 205b 7b22 6576 656e      ) == [{"even
+00016520: 7422 3a20 2270 6c61 6365 5f68 6f6c 6465  t": "place_holde
+00016530: 7222 7d5d 0a0a 2020 2020 6d6f 636b 5f67  r"}]..    mock_g
+00016540: 656e 6572 6174 655f 7072 6564 735f 616e  enerate_preds_an
+00016550: 645f 6665 6564 6261 636b 2e61 7373 6572  d_feedback.asser
+00016560: 745f 6e6f 745f 6361 6c6c 6564 2829 0a20  t_not_called(). 
+00016570: 2020 206d 6f63 6b5f 6765 6e65 7261 7465     mock_generate
+00016580: 5f70 7265 6473 2e61 7373 6572 745f 6e6f  _preds.assert_no
+00016590: 745f 6361 6c6c 6564 2829 0a20 2020 206d  t_called().    m
+000165a0: 6f63 6b5f 6765 6e65 7261 7465 5f66 6565  ock_generate_fee
+000165b0: 6462 6163 6b2e 6173 7365 7274 5f63 616c  dback.assert_cal
+000165c0: 6c65 645f 6f6e 6365 5f77 6974 6828 0a20  led_once_with(. 
+000165d0: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
+000165e0: 6f6e 3d22 666f 6f62 6172 222c 0a20 2020  on="foobar",.   
+000165f0: 2020 2020 2066 6565 6462 6163 6b73 3d5b       feedbacks=[
+00016600: 7b22 4122 3a20 3230 307d 2c20 7b22 4122  {"A": 200}, {"A"
+00016610: 3a20 3230 317d 5d2c 0a20 2020 2020 2020  : 201}],.       
+00016620: 206a 6f69 6e5f 6b65 7973 3d5b 2231 3233   join_keys=["123
+00016630: 3435 222c 2022 3534 3332 3122 5d2c 0a20  45", "54321"],. 
+00016640: 2020 2020 2020 2066 6565 6462 6163 6b5f         feedback_
+00016650: 7665 7273 696f 6e3d 7665 7273 696f 6e2c  version=version,
+00016660: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
+00016670: 6d70 733d 7465 7374 5f74 696d 6573 7461  mps=test_timesta
+00016680: 6d70 735f 6c69 7374 2c0a 2020 2020 2020  mps_list,.      
+00016690: 2020 736f 7274 5f6f 6e5f 7469 6d65 7374    sort_on_timest
+000166a0: 616d 703d 5472 7565 2c0a 2020 2020 2020  amp=True,.      
+000166b0: 2020 7275 6e5f 6964 3d72 756e 5f69 642c    run_id=run_id,
+000166c0: 0a20 2020 2020 2020 2074 6167 733d 6578  .        tags=ex
+000166d0: 7065 6374 6564 5f74 6167 735f 7061 7261  pected_tags_para
+000166e0: 6d2c 0a20 2020 2029 0a0a 2020 2020 6d6f  m,.    )..    mo
+000166f0: 636b 5f73 616d 706c 655f 7265 636f 7264  ck_sample_record
+00016700: 732e 6173 7365 7274 5f63 616c 6c65 645f  s.assert_called_
+00016710: 6f6e 6365 5f77 6974 6828 0a20 2020 2020  once_with(.     
+00016720: 2020 2032 2c0a 2020 2020 2020 2020 312c     2,.        1,
+00016730: 0a20 2020 2020 2020 204e 6f6e 652c 0a20  .        None,. 
+00016740: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
+00016750: 2020 2020 205b 7b22 4122 3a20 3230 307d       [{"A": 200}
+00016760: 2c20 7b22 4122 3a20 3230 317d 5d2c 0a20  , {"A": 201}],. 
+00016770: 2020 2020 2020 2063 6c69 656e 742e 5f72         client._r
+00016780: 6573 6f6c 7665 5f6a 6f69 6e5f 6b65 7973  esolve_join_keys
+00016790: 282a 2a6b 7761 7267 7329 2c0a 2020 2020  (**kwargs),.    
+000167a0: 2020 2020 7465 7374 5f74 696d 6573 7461      test_timesta
+000167b0: 6d70 735f 6c69 7374 2c0a 2020 2020 2020  mps_list,.      
+000167c0: 2020 6578 7065 6374 6564 5f74 6167 735f    expected_tags_
+000167d0: 7061 7261 6d2c 0a20 2020 2029 0a0a 0a40  param,.    )...@
+000167e0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+000167f0: 6d65 7472 697a 6528 2274 6573 745f 6665  metrize("test_fe
+00016800: 6564 6261 636b 7322 2c20 5445 5354 5f46  edbacks", TEST_F
+00016810: 4545 4442 4143 4b53 290a 4070 7974 6573  EEDBACKS).@pytes
+00016820: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+00016830: 7a65 2822 7665 7273 696f 6e22 2c20 5b4e  ze("version", [N
+00016840: 6f6e 652c 2031 302c 2022 312e 322e 3322  one, 10, "1.2.3"
+00016850: 5d29 0a40 6d6f 636b 2e70 6174 6368 2822  ]).@mock.patch("
+00016860: 6761 6e74 7279 2e6c 6f67 6765 722e 636c  gantry.logger.cl
+00016870: 6965 6e74 2e47 616e 7472 792e 5f6c 6f67  ient.Gantry._log
+00016880: 5f70 7265 6469 6374 696f 6e5f 616e 645f  _prediction_and_
+00016890: 6665 6564 6261 636b 5f65 7665 6e74 7322  feedback_events"
+000168a0: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
+000168b0: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
+000168c0: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
+000168d0: 7072 6564 6963 7469 6f6e 5f65 7665 6e74  prediction_event
+000168e0: 7322 290a 406d 6f63 6b2e 7061 7463 6828  s").@mock.patch(
+000168f0: 0a20 2020 2022 6761 6e74 7279 2e6c 6f67  .    "gantry.log
+00016900: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
+00016910: 792e 5f6c 6f67 5f66 6565 6462 6163 6b5f  y._log_feedback_
+00016920: 6576 656e 7473 222c 2072 6574 7572 6e5f  events", return_
+00016930: 7661 6c75 653d 284e 6f6e 652c 205b 2231  value=(None, ["1
+00016940: 3233 3435 222c 2022 3637 3839 3022 5d29  2345", "67890"])
+00016950: 0a29 0a64 6566 2074 6573 745f 6c6f 675f  .).def test_log_
+00016960: 7265 636f 7264 735f 6665 6564 6261 636b  records_feedback
+00016970: 5f6f 6e6c 795f 6e6f 5f6a 6f69 6e5f 6b65  _only_no_join_ke
+00016980: 7973 280a 2020 2020 6d6f 636b 5f66 6565  ys(.    mock_fee
+00016990: 6462 6163 6b2c 0a20 2020 206d 6f63 6b5f  dback,.    mock_
+000169a0: 7072 6564 732c 0a20 2020 206d 6f63 6b5f  preds,.    mock_
+000169b0: 7072 6564 735f 616e 645f 6665 6564 6261  preds_and_feedba
+000169c0: 636b 2c0a 2020 2020 7665 7273 696f 6e2c  ck,.    version,
+000169d0: 0a20 2020 2074 6573 745f 6665 6564 6261  .    test_feedba
+000169e0: 636b 732c 0a20 2020 2063 6c69 5f6f 626a  cks,.    cli_obj
+000169f0: 2c0a 293a 0a20 2020 2061 7373 6572 7420  ,.):.    assert 
+00016a00: 280a 2020 2020 2020 2020 636c 695f 6f62  (.        cli_ob
+00016a10: 6a2e 6c6f 675f 7265 636f 7264 7328 0a20  j.log_records(. 
+00016a20: 2020 2020 2020 2020 2020 2061 7070 6c69             appli
+00016a30: 6361 7469 6f6e 3d22 666f 6f62 6172 222c  cation="foobar",
+00016a40: 0a20 2020 2020 2020 2020 2020 2076 6572  .            ver
+00016a50: 7369 6f6e 3d76 6572 7369 6f6e 2c0a 2020  sion=version,.  
+00016a60: 2020 2020 2020 2020 2020 696e 7075 7473            inputs
+00016a70: 3d4e 6f6e 652c 0a20 2020 2020 2020 2020  =None,.         
+00016a80: 2020 206f 7574 7075 7473 3d4e 6f6e 652c     outputs=None,
+00016a90: 0a20 2020 2020 2020 2020 2020 2066 6565  .            fee
+00016aa0: 6462 6163 6b73 3d74 6573 745f 6665 6564  dbacks=test_feed
+00016ab0: 6261 636b 732c 0a20 2020 2020 2020 2020  backs,.         
+00016ac0: 2020 2074 696d 6573 7461 6d70 733d 4e6f     timestamps=No
+00016ad0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+00016ae0: 736f 7274 5f6f 6e5f 7469 6d65 7374 616d  sort_on_timestam
+00016af0: 703d 5472 7565 2c0a 2020 2020 2020 2020  p=True,.        
+00016b00: 290a 2020 2020 2020 2020 6973 204e 6f6e  ).        is Non
+00016b10: 650a 2020 2020 290a 0a20 2020 206d 6f63  e.    )..    moc
+00016b20: 6b5f 7072 6564 735f 616e 645f 6665 6564  k_preds_and_feed
+00016b30: 6261 636b 2e61 7373 6572 745f 6e6f 745f  back.assert_not_
+00016b40: 6361 6c6c 6564 2829 0a20 2020 206d 6f63  called().    moc
+00016b50: 6b5f 7072 6564 732e 6173 7365 7274 5f6e  k_preds.assert_n
+00016b60: 6f74 5f63 616c 6c65 6428 290a 2020 2020  ot_called().    
+00016b70: 6d6f 636b 5f66 6565 6462 6163 6b2e 6173  mock_feedback.as
+00016b80: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
+00016b90: 290a 0a0a 4070 7974 6573 742e 6d61 726b  )...@pytest.mark
+00016ba0: 2e70 6172 616d 6574 7269 7a65 2822 7465  .parametrize("te
+00016bb0: 7374 5f66 6565 6462 6163 6b73 222c 2054  st_feedbacks", T
+00016bc0: 4553 545f 4645 4544 4241 434b 5329 0a40  EST_FEEDBACKS).@
+00016bd0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+00016be0: 6d65 7472 697a 6528 2276 6572 7369 6f6e  metrize("version
+00016bf0: 222c 205b 4e6f 6e65 2c20 3130 2c20 2231  ", [None, 10, "1
+00016c00: 2e32 2e33 225d 290a 406d 6f63 6b2e 7061  .2.3"]).@mock.pa
+00016c10: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
+00016c20: 6572 2e63 6c69 656e 742e 4761 6e74 7279  er.client.Gantry
+00016c30: 2e5f 6765 6e65 7261 7465 5f70 7265 6469  ._generate_predi
+00016c40: 6374 696f 6e5f 616e 645f 6665 6564 6261  ction_and_feedba
+00016c50: 636b 5f65 7665 6e74 7322 290a 406d 6f63  ck_events").@moc
+00016c60: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
+00016c70: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
+00016c80: 6e74 7279 2e5f 6765 6e65 7261 7465 5f70  ntry._generate_p
+00016c90: 7265 6469 6374 696f 6e5f 6576 656e 7473  rediction_events
+00016ca0: 2229 0a40 6d6f 636b 2e70 6174 6368 280a  ").@mock.patch(.
+00016cb0: 2020 2020 2267 616e 7472 792e 6c6f 6767      "gantry.logg
+00016cc0: 6572 2e63 6c69 656e 742e 4761 6e74 7279  er.client.Gantry
+00016cd0: 2e5f 6765 6e65 7261 7465 5f66 6565 6462  ._generate_feedb
+00016ce0: 6163 6b5f 6576 656e 7473 222c 2072 6574  ack_events", ret
+00016cf0: 7572 6e5f 7661 6c75 653d 284e 6f6e 652c  urn_value=(None,
+00016d00: 205b 2231 3233 3435 222c 2022 3637 3839   ["12345", "6789
+00016d10: 3022 5d29 0a29 0a64 6566 2074 6573 745f  0"]).).def test_
+00016d20: 6765 6e65 7261 7465 5f72 6563 6f72 6473  generate_records
+00016d30: 5f66 6565 6462 6163 6b5f 6f6e 6c79 5f6e  _feedback_only_n
+00016d40: 6f5f 6a6f 696e 5f6b 6579 7328 0a20 2020  o_join_keys(.   
+00016d50: 206d 6f63 6b5f 6665 6564 6261 636b 2c0a   mock_feedback,.
+00016d60: 2020 2020 6d6f 636b 5f70 7265 6473 2c0a      mock_preds,.
+00016d70: 2020 2020 6d6f 636b 5f70 7265 6473 5f61      mock_preds_a
+00016d80: 6e64 5f66 6565 6462 6163 6b2c 0a20 2020  nd_feedback,.   
+00016d90: 2076 6572 7369 6f6e 2c0a 2020 2020 7465   version,.    te
+00016da0: 7374 5f66 6565 6462 6163 6b73 2c0a 2020  st_feedbacks,.  
+00016db0: 2020 636c 695f 6f62 6a2c 0a29 3a0a 2020    cli_obj,.):.  
+00016dc0: 2020 6173 7365 7274 2028 0a20 2020 2020    assert (.     
+00016dd0: 2020 2063 6c69 5f6f 626a 2e67 656e 6572     cli_obj.gener
+00016de0: 6174 655f 7265 636f 7264 7328 0a20 2020  ate_records(.   
+00016df0: 2020 2020 2020 2020 2061 7070 6c69 6361           applica
+00016e00: 7469 6f6e 3d22 666f 6f62 6172 222c 0a20  tion="foobar",. 
+00016e10: 2020 2020 2020 2020 2020 2076 6572 7369             versi
+00016e20: 6f6e 3d76 6572 7369 6f6e 2c0a 2020 2020  on=version,.    
+00016e30: 2020 2020 2020 2020 696e 7075 7473 3d4e          inputs=N
+00016e40: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+00016e50: 206f 7574 7075 7473 3d4e 6f6e 652c 0a20   outputs=None,. 
+00016e60: 2020 2020 2020 2020 2020 2066 6565 6462             feedb
+00016e70: 6163 6b73 3d74 6573 745f 6665 6564 6261  acks=test_feedba
+00016e80: 636b 732c 0a20 2020 2020 2020 2020 2020  cks,.           
+00016e90: 2074 696d 6573 7461 6d70 733d 4e6f 6e65   timestamps=None
+00016ea0: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
+00016eb0: 7274 5f6f 6e5f 7469 6d65 7374 616d 703d  rt_on_timestamp=
+00016ec0: 5472 7565 2c0a 2020 2020 2020 2020 290a  True,.        ).
+00016ed0: 2020 2020 2020 2020 6973 204e 6f6e 650a          is None.
+00016ee0: 2020 2020 290a 0a20 2020 206d 6f63 6b5f      )..    mock_
+00016ef0: 7072 6564 735f 616e 645f 6665 6564 6261  preds_and_feedba
+00016f00: 636b 2e61 7373 6572 745f 6e6f 745f 6361  ck.assert_not_ca
+00016f10: 6c6c 6564 2829 0a20 2020 206d 6f63 6b5f  lled().    mock_
+00016f20: 7072 6564 732e 6173 7365 7274 5f6e 6f74  preds.assert_not
+00016f30: 5f63 616c 6c65 6428 290a 2020 2020 6d6f  _called().    mo
+00016f40: 636b 5f66 6565 6462 6163 6b2e 6173 7365  ck_feedback.asse
+00016f50: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
+00016f60: 0a0a 4070 7974 6573 742e 6d61 726b 2e70  ..@pytest.mark.p
+00016f70: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
+00016f80: 2822 7465 7374 5f66 6565 6462 6163 6b73  ("test_feedbacks
+00016f90: 222c 2022 7465 7374 5f6f 7574 7075 7473  ", "test_outputs
+00016fa0: 222c 2022 7465 7374 5f69 6e70 7574 7322  ", "test_inputs"
+00016fb0: 292c 0a20 2020 205b 0a20 2020 2020 2020  ),.    [.       
+00016fc0: 2028 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f   (None, None, No
+00016fd0: 6e65 292c 0a20 2020 2020 2020 2028 7064  ne),.        (pd
+00016fe0: 2e44 6174 6146 7261 6d65 2829 2c20 7064  .DataFrame(), pd
+00016ff0: 2e44 6174 6146 7261 6d65 2829 2c20 7064  .DataFrame(), pd
+00017000: 2e44 6174 6146 7261 6d65 2829 292c 0a20  .DataFrame()),. 
+00017010: 2020 2020 2020 2028 5b5d 2c20 5b5d 2c20         ([], [], 
+00017020: 5b5d 292c 0a20 2020 2020 2020 2028 7064  []),.        (pd
+00017030: 2e53 6572 6965 7328 292c 2070 642e 5365  .Series(), pd.Se
+00017040: 7269 6573 2829 2c20 7064 2e53 6572 6965  ries(), pd.Serie
+00017050: 7328 2929 2c0a 2020 2020 2020 2020 286e  s()),.        (n
+00017060: 702e 6172 7261 7928 5b5d 292c 206e 702e  p.array([]), np.
+00017070: 6172 7261 7928 5b5d 292c 206e 702e 6172  array([]), np.ar
+00017080: 7261 7928 5b5d 2929 2c0a 2020 2020 5d2c  ray([])),.    ],
+00017090: 0a29 0a40 7079 7465 7374 2e6d 6172 6b2e  .).@pytest.mark.
+000170a0: 7061 7261 6d65 7472 697a 6528 2276 6572  parametrize("ver
+000170b0: 7369 6f6e 222c 205b 4e6f 6e65 2c20 3130  sion", [None, 10
+000170c0: 2c20 2231 2e32 2e33 225d 290a 406d 6f63  , "1.2.3"]).@moc
+000170d0: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
+000170e0: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
+000170f0: 6e74 7279 2e5f 6c6f 675f 7072 6564 6963  ntry._log_predic
+00017100: 7469 6f6e 5f61 6e64 5f66 6565 6462 6163  tion_and_feedbac
+00017110: 6b5f 6576 656e 7473 2229 0a40 6d6f 636b  k_events").@mock
 00017120: 2e70 6174 6368 2822 6761 6e74 7279 2e6c  .patch("gantry.l
-00017130: 6f67 6765 722e 636c 6965 6e74 2e5f 7265  ogger.client._re
-00017140: 736f 6c76 655f 6a6f 696e 5f6b 6579 7322  solve_join_keys"
-00017150: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
-00017160: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
-00017170: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
-00017180: 7072 6564 6963 7469 6f6e 5f61 6e64 5f66  prediction_and_f
-00017190: 6565 6462 6163 6b5f 6576 656e 7473 2229  eedback_events")
-000171a0: 0a40 6d6f 636b 2e70 6174 6368 280a 2020  .@mock.patch(.  
-000171b0: 2020 2267 616e 7472 792e 6c6f 6767 6572    "gantry.logger
-000171c0: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
-000171d0: 6c6f 675f 7072 6564 6963 7469 6f6e 5f65  log_prediction_e
-000171e0: 7665 6e74 7322 2c20 7265 7475 726e 5f76  vents", return_v
-000171f0: 616c 7565 3d28 4e6f 6e65 2c20 5b22 3132  alue=(None, ["12
-00017200: 3334 3522 2c20 2236 3738 3930 225d 290a  345", "67890"]).
-00017210: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
-00017220: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
-00017230: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
-00017240: 6665 6564 6261 636b 5f65 7665 6e74 7322  feedback_events"
-00017250: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
-00017260: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
-00017270: 656e 742e 5f73 616d 706c 655f 7265 636f  ent._sample_reco
-00017280: 7264 7322 2c20 7369 6465 5f65 6666 6563  rds", side_effec
-00017290: 743d 636c 6965 6e74 2e5f 7361 6d70 6c65  t=client._sample
-000172a0: 5f72 6563 6f72 6473 290a 406d 6f63 6b2e  _records).@mock.
-000172b0: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
-000172c0: 6767 6572 2e63 6c69 656e 742e 5f64 6566  gger.client._def
-000172d0: 6175 6c74 5f6a 6f69 6e5f 6b65 795f 6765  ault_join_key_ge
-000172e0: 6e22 290a 6465 6620 7465 7374 5f73 696e  n").def test_sin
-000172f0: 676c 655f 6c6f 675f 7265 636f 7264 735f  gle_log_records_
-00017300: 7072 6564 735f 6f6e 6c79 280a 2020 2020  preds_only(.    
-00017310: 6d6f 636b 5f6a 6f69 6e5f 6b65 795f 6765  mock_join_key_ge
-00017320: 6e2c 0a20 2020 206d 6f63 6b5f 7361 6d70  n,.    mock_samp
-00017330: 6c65 5f72 6563 6f72 6473 2c0a 2020 2020  le_records,.    
-00017340: 6d6f 636b 5f66 6565 6462 6163 6b2c 0a20  mock_feedback,. 
-00017350: 2020 206d 6f63 6b5f 7072 6564 732c 0a20     mock_preds,. 
-00017360: 2020 206d 6f63 6b5f 7072 6564 735f 616e     mock_preds_an
-00017370: 645f 6665 6564 6261 636b 2c0a 2020 2020  d_feedback,.    
-00017380: 6d6f 636b 5f72 6573 6f6c 7665 5f6a 6f69  mock_resolve_joi
-00017390: 6e5f 6b65 7973 2c0a 2020 2020 7665 7273  n_keys,.    vers
-000173a0: 696f 6e2c 0a20 2020 2074 6167 732c 0a20  ion,.    tags,. 
-000173b0: 2020 2072 6f77 5f74 6167 732c 0a20 2020     row_tags,.   
-000173c0: 2067 6c6f 6261 6c5f 7461 6773 2c0a 2020   global_tags,.  
-000173d0: 2020 6578 7065 6374 6564 5f74 6167 735f    expected_tags_
-000173e0: 7061 7261 6d2c 0a20 2020 2074 6573 745f  param,.    test_
-000173f0: 7469 6d65 7374 616d 7073 2c0a 2020 2020  timestamps,.    
-00017400: 7465 7374 5f74 696d 6573 7461 6d70 735f  test_timestamps_
-00017410: 6c69 7374 2c0a 2020 2020 7465 7374 5f69  list,.    test_i
-00017420: 6e70 7574 732c 0a20 2020 2074 6573 745f  nputs,.    test_
-00017430: 6f75 7470 7574 732c 0a20 2020 206b 7761  outputs,.    kwa
-00017440: 7267 732c 0a20 2020 2063 6c69 5f6f 626a  rgs,.    cli_obj
-00017450: 2c0a 293a 0a20 2020 206d 6f63 6b5f 6a6f  ,.):.    mock_jo
-00017460: 696e 5f6b 6579 5f67 656e 2e73 6964 655f  in_key_gen.side_
-00017470: 6566 6665 6374 203d 205b 2236 3738 3930  effect = ["67890
-00017480: 222c 2022 3132 3334 3522 5d0a 2020 2020  ", "12345"].    
-00017490: 6d6f 636b 5f72 6573 6f6c 7665 5f6a 6f69  mock_resolve_joi
-000174a0: 6e5f 6b65 7973 2e72 6574 7572 6e5f 7661  n_keys.return_va
-000174b0: 6c75 6520 3d20 5b22 3132 3334 3522 2c20  lue = ["12345", 
-000174c0: 2236 3738 3930 225d 2069 6620 6b77 6172  "67890"] if kwar
-000174d0: 6773 2065 6c73 6520 4e6f 6e65 0a20 2020  gs else None.   
-000174e0: 2061 7373 6572 7420 636c 695f 6f62 6a2e   assert cli_obj.
-000174f0: 7369 6e67 6c65 5f6c 6f67 5f72 6563 6f72  single_log_recor
-00017500: 6473 280a 2020 2020 2020 2020 6170 706c  ds(.        appl
-00017510: 6963 6174 696f 6e3d 2266 6f6f 6261 7222  ication="foobar"
-00017520: 2c0a 2020 2020 2020 2020 7665 7273 696f  ,.        versio
-00017530: 6e3d 7665 7273 696f 6e2c 0a20 2020 2020  n=version,.     
-00017540: 2020 2069 6e70 7574 733d 7465 7374 5f69     inputs=test_i
-00017550: 6e70 7574 732c 0a20 2020 2020 2020 206f  nputs,.        o
-00017560: 7574 7075 7473 3d74 6573 745f 6f75 7470  utputs=test_outp
-00017570: 7574 732c 0a20 2020 2020 2020 2066 6565  uts,.        fee
-00017580: 6462 6163 6b73 3d4e 6f6e 652c 0a20 2020  dbacks=None,.   
-00017590: 2020 2020 2074 696d 6573 7461 6d70 733d       timestamps=
-000175a0: 7465 7374 5f74 696d 6573 7461 6d70 732c  test_timestamps,
-000175b0: 0a20 2020 2020 2020 2073 6f72 745f 6f6e  .        sort_on
-000175c0: 5f74 696d 6573 7461 6d70 3d54 7275 652c  _timestamp=True,
-000175d0: 0a20 2020 2020 2020 2074 6167 733d 7461  .        tags=ta
-000175e0: 6773 2c0a 2020 2020 2020 2020 726f 775f  gs,.        row_
-000175f0: 7461 6773 3d72 6f77 5f74 6167 732c 0a20  tags=row_tags,. 
-00017600: 2020 2020 2020 2067 6c6f 6261 6c5f 7461         global_ta
-00017610: 6773 3d67 6c6f 6261 6c5f 7461 6773 2c0a  gs=global_tags,.
-00017620: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
-00017630: 2c0a 2020 2020 2920 3d3d 2028 4e6f 6e65  ,.    ) == (None
-00017640: 2c20 5b22 3132 3334 3522 2c20 2236 3738  , ["12345", "678
-00017650: 3930 225d 290a 0a20 2020 206d 6f63 6b5f  90"])..    mock_
-00017660: 7072 6564 735f 616e 645f 6665 6564 6261  preds_and_feedba
-00017670: 636b 2e61 7373 6572 745f 6e6f 745f 6361  ck.assert_not_ca
-00017680: 6c6c 6564 2829 0a20 2020 206d 6f63 6b5f  lled().    mock_
-00017690: 7072 6564 732e 6173 7365 7274 5f63 616c  preds.assert_cal
-000176a0: 6c65 645f 6f6e 6365 5f77 6974 6828 0a20  led_once_with(. 
-000176b0: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
-000176c0: 6f6e 3d22 666f 6f62 6172 222c 0a20 2020  on="foobar",.   
-000176d0: 2020 2020 2069 6e70 7574 733d 5b7b 2241       inputs=[{"A
-000176e0: 223a 2031 3030 7d2c 207b 2241 223a 2031  ": 100}, {"A": 1
-000176f0: 3031 7d5d 2c0a 2020 2020 2020 2020 6f75  01}],.        ou
-00017700: 7470 7574 733d 5b7b 2242 223a 2033 3030  tputs=[{"B": 300
-00017710: 7d2c 207b 2242 223a 2033 3031 7d5d 2c0a  }, {"B": 301}],.
-00017720: 2020 2020 2020 2020 6a6f 696e 5f6b 6579          join_key
-00017730: 733d 5b22 3132 3334 3522 2c20 2236 3738  s=["12345", "678
-00017740: 3930 225d 2069 6620 6b77 6172 6773 2065  90"] if kwargs e
-00017750: 6c73 6520 5b22 3637 3839 3022 2c20 2231  lse ["67890", "1
-00017760: 3233 3435 225d 2c0a 2020 2020 2020 2020  2345"],.        
-00017770: 7665 7273 696f 6e3d 7665 7273 696f 6e2c  version=version,
-00017780: 0a20 2020 2020 2020 2069 676e 6f72 655f  .        ignore_
-00017790: 696e 7075 7473 3d4e 6f6e 652c 0a20 2020  inputs=None,.   
-000177a0: 2020 2020 2074 696d 6573 7461 6d70 733d       timestamps=
-000177b0: 7465 7374 5f74 696d 6573 7461 6d70 735f  test_timestamps_
-000177c0: 6c69 7374 2c0a 2020 2020 2020 2020 736f  list,.        so
-000177d0: 7274 5f6f 6e5f 7469 6d65 7374 616d 703d  rt_on_timestamp=
-000177e0: 5472 7565 2c0a 2020 2020 2020 2020 6173  True,.        as
-000177f0: 5f62 6174 6368 3d46 616c 7365 2c0a 2020  _batch=False,.  
-00017800: 2020 2020 2020 7461 6773 3d65 7870 6563        tags=expec
-00017810: 7465 645f 7461 6773 5f70 6172 616d 2c0a  ted_tags_param,.
-00017820: 2020 2020 290a 2020 2020 6d6f 636b 5f66      ).    mock_f
-00017830: 6565 6462 6163 6b2e 6173 7365 7274 5f6e  eedback.assert_n
-00017840: 6f74 5f63 616c 6c65 6428 290a 0a20 2020  ot_called()..   
-00017850: 206d 6f63 6b5f 7361 6d70 6c65 5f72 6563   mock_sample_rec
-00017860: 6f72 6473 2e61 7373 6572 745f 6361 6c6c  ords.assert_call
-00017870: 6564 5f6f 6e63 655f 7769 7468 280a 2020  ed_once_with(.  
-00017880: 2020 2020 2020 322c 0a20 2020 2020 2020        2,.       
-00017890: 2031 2c0a 2020 2020 2020 2020 5b7b 2241   1,.        [{"A
-000178a0: 223a 2031 3030 7d2c 207b 2241 223a 2031  ": 100}, {"A": 1
-000178b0: 3031 7d5d 2c0a 2020 2020 2020 2020 5b7b  01}],.        [{
-000178c0: 2242 223a 2033 3030 7d2c 207b 2242 223a  "B": 300}, {"B":
-000178d0: 2033 3031 7d5d 2c0a 2020 2020 2020 2020   301}],.        
-000178e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 636c  None,.        cl
-000178f0: 6965 6e74 2e5f 7265 736f 6c76 655f 6a6f  ient._resolve_jo
-00017900: 696e 5f6b 6579 7328 2a2a 6b77 6172 6773  in_keys(**kwargs
-00017910: 292c 0a20 2020 2020 2020 2074 6573 745f  ),.        test_
-00017920: 7469 6d65 7374 616d 7073 5f6c 6973 742c  timestamps_list,
-00017930: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
-00017940: 645f 7461 6773 5f70 6172 616d 2c0a 2020  d_tags_param,.  
-00017950: 2020 290a 0a20 2020 2069 6620 6b77 6172    )..    if kwar
-00017960: 6773 3a0a 2020 2020 2020 2020 6d6f 636b  gs:.        mock
-00017970: 5f6a 6f69 6e5f 6b65 795f 6765 6e2e 6173  _join_key_gen.as
-00017980: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
-00017990: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
-000179a0: 2020 2020 6d6f 636b 5f6a 6f69 6e5f 6b65      mock_join_ke
-000179b0: 795f 6765 6e2e 6173 7365 7274 5f63 616c  y_gen.assert_cal
-000179c0: 6c65 6428 290a 0a0a 4070 7974 6573 742e  led()...@pytest.
-000179d0: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-000179e0: 280a 2020 2020 2274 6573 745f 7469 6d65  (.    "test_time
-000179f0: 7374 616d 7073 2c20 7465 7374 5f74 696d  stamps, test_tim
-00017a00: 6573 7461 6d70 735f 6c69 7374 222c 0a20  estamps_list",. 
-00017a10: 2020 205b 0a20 2020 2020 2020 2028 4e6f     [.        (No
-00017a20: 6e65 2c20 4e6f 6e65 292c 0a20 2020 2020  ne, None),.     
-00017a30: 2020 2028 5b43 5552 5245 4e54 5f54 494d     ([CURRENT_TIM
-00017a40: 455d 202a 2032 2c20 5b43 5552 5245 4e54  E] * 2, [CURRENT
-00017a50: 5f54 494d 455d 202a 2032 292c 0a20 2020  _TIME] * 2),.   
-00017a60: 2020 2020 2028 6e70 2e61 7272 6179 285b       (np.array([
-00017a70: 4355 5252 454e 545f 5449 4d45 5d20 2a20  CURRENT_TIME] * 
-00017a80: 3229 2c20 5b43 5552 5245 4e54 5f54 494d  2), [CURRENT_TIM
-00017a90: 455d 202a 2032 292c 0a20 2020 205d 2c0a  E] * 2),.    ],.
-00017aa0: 290a 4070 7974 6573 742e 6d61 726b 2e70  ).@pytest.mark.p
-00017ab0: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
-00017ac0: 226b 7761 7267 7322 2c0a 2020 2020 5b0a  "kwargs",.    [.
-00017ad0: 2020 2020 2020 2020 7b22 6a6f 696e 5f6b          {"join_k
-00017ae0: 6579 7322 3a20 5b22 3534 3332 3122 2c20  eys": ["54321", 
-00017af0: 2236 3738 3930 225d 7d2c 0a20 2020 2020  "67890"]},.     
-00017b00: 2020 207b 226a 6f69 6e5f 6b65 7973 223a     {"join_keys":
-00017b10: 2070 642e 5365 7269 6573 285b 2235 3433   pd.Series(["543
-00017b20: 3231 222c 2022 3637 3839 3022 5d29 7d2c  21", "67890"])},
-00017b30: 0a20 2020 2020 2020 207b 7d2c 0a20 2020  .        {},.   
-00017b40: 205d 2c0a 290a 4070 7974 6573 742e 6d61   ],.).@pytest.ma
-00017b50: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
-00017b60: 2020 2020 2274 6573 745f 6f75 7470 7574      "test_output
-00017b70: 7322 2c0a 2020 2020 5b0a 2020 2020 2020  s",.    [.      
-00017b80: 2020 5b7b 2242 223a 2033 3030 7d2c 207b    [{"B": 300}, {
-00017b90: 2242 223a 2033 3031 7d5d 2c0a 2020 2020  "B": 301}],.    
-00017ba0: 2020 2020 7064 2e44 6174 6146 7261 6d65      pd.DataFrame
-00017bb0: 2e66 726f 6d5f 6469 6374 287b 2242 223a  .from_dict({"B":
-00017bc0: 205b 3330 302c 2033 3031 5d7d 292c 0a20   [300, 301]}),. 
-00017bd0: 2020 2020 2020 2070 642e 5365 7269 6573         pd.Series
-00017be0: 286e 616d 653d 2242 222c 2064 6174 613d  (name="B", data=
-00017bf0: 5b33 3030 2c20 3330 315d 292c 0a20 2020  [300, 301]),.   
-00017c00: 2020 2020 206e 702e 6172 7261 7928 5b7b       np.array([{
-00017c10: 2242 223a 2033 3030 7d2c 207b 2242 223a  "B": 300}, {"B":
-00017c20: 2033 3031 7d5d 292c 0a20 2020 205d 2c0a   301}]),.    ],.
-00017c30: 290a 4070 7974 6573 742e 6d61 726b 2e70  ).@pytest.mark.p
-00017c40: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
-00017c50: 2274 6573 745f 696e 7075 7473 222c 0a20  "test_inputs",. 
-00017c60: 2020 205b 0a20 2020 2020 2020 205b 7b22     [.        [{"
-00017c70: 4122 3a20 3130 307d 2c20 7b22 4122 3a20  A": 100}, {"A": 
-00017c80: 3130 317d 5d2c 0a20 2020 2020 2020 2070  101}],.        p
-00017c90: 642e 4461 7461 4672 616d 652e 6672 6f6d  d.DataFrame.from
-00017ca0: 5f64 6963 7428 7b22 4122 3a20 5b31 3030  _dict({"A": [100
-00017cb0: 2c20 3130 315d 7d29 2c0a 2020 2020 2020  , 101]}),.      
-00017cc0: 2020 7064 2e53 6572 6965 7328 6e61 6d65    pd.Series(name
-00017cd0: 3d22 4122 2c20 6461 7461 3d5b 3130 302c  ="A", data=[100,
-00017ce0: 2031 3031 5d29 2c0a 2020 2020 2020 2020   101]),.        
-00017cf0: 6e70 2e61 7272 6179 285b 7b22 4122 3a20  np.array([{"A": 
-00017d00: 3130 307d 2c20 7b22 4122 3a20 3130 317d  100}, {"A": 101}
-00017d10: 5d29 2c0a 2020 2020 5d2c 0a29 0a40 7079  ]),.    ],.).@py
-00017d20: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
-00017d30: 7472 697a 6528 2276 6572 7369 6f6e 222c  trize("version",
-00017d40: 205b 4e6f 6e65 2c20 3130 2c20 2231 2e32   [None, 10, "1.2
-00017d50: 2e33 225d 290a 4070 7974 6573 742e 6d61  .3"]).@pytest.ma
-00017d60: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
-00017d70: 2020 2020 2274 6167 732c 2072 6f77 5f74      "tags, row_t
-00017d80: 6167 732c 2067 6c6f 6261 6c5f 7461 6773  ags, global_tags
-00017d90: 2c20 6578 7065 6374 6564 5f74 6167 735f  , expected_tags_
-00017da0: 7061 7261 6d22 2c0a 2020 2020 5b0a 2020  param",.    [.  
-00017db0: 2020 2020 2020 284e 6f6e 652c 204e 6f6e        (None, Non
-00017dc0: 652c 204e 6f6e 652c 205b 7b22 656e 7622  e, None, [{"env"
-00017dd0: 3a20 2274 6573 7422 7d2c 207b 2265 6e76  : "test"}, {"env
-00017de0: 223a 2022 7465 7374 227d 5d29 2c0a 2020  ": "test"}]),.  
-00017df0: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-00017e00: 2020 2020 7b22 6261 7222 3a20 2262 6172      {"bar": "bar
-00017e10: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-00017e20: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-00017e30: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
-00017e40: 2020 2020 5b7b 2262 6172 223a 2022 6261      [{"bar": "ba
-00017e50: 7222 2c20 2265 6e76 223a 2022 7465 7374  r", "env": "test
-00017e60: 227d 2c20 7b22 6261 7222 3a20 2262 6172  "}, {"bar": "bar
-00017e70: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
-00017e80: 7d5d 2c0a 2020 2020 2020 2020 292c 0a20  }],.        ),. 
-00017e90: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
-00017ea0: 2020 2020 207b 2262 6172 223a 2022 6261       {"bar": "ba
-00017eb0: 7222 7d2c 0a20 2020 2020 2020 2020 2020  r"},.           
-00017ec0: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-00017ed0: 2020 207b 2266 6f6f 223a 2022 666f 6f22     {"foo": "foo"
-00017ee0: 7d2c 0a20 2020 2020 2020 2020 2020 205b  },.            [
-00017ef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017f00: 207b 2262 6172 223a 2022 6261 7222 2c20   {"bar": "bar", 
-00017f10: 2265 6e76 223a 2022 7465 7374 222c 2022  "env": "test", "
-00017f20: 666f 6f22 3a20 2266 6f6f 227d 2c0a 2020  foo": "foo"},.  
-00017f30: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-00017f40: 6261 7222 3a20 2262 6172 222c 2022 656e  bar": "bar", "en
-00017f50: 7622 3a20 2274 6573 7422 2c20 2266 6f6f  v": "test", "foo
-00017f60: 223a 2022 666f 6f22 7d2c 0a20 2020 2020  ": "foo"},.     
-00017f70: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-00017f80: 2020 292c 0a20 2020 2020 2020 2028 0a20    ),.        (. 
-00017f90: 2020 2020 2020 2020 2020 204e 6f6e 652c             None,
-00017fa0: 0a20 2020 2020 2020 2020 2020 205b 7b22  .            [{"
-00017fb0: 6261 7222 3a20 2262 6172 227d 2c20 7b22  bar": "bar"}, {"
-00017fc0: 6261 7222 3a20 2262 617a 227d 5d2c 0a20  bar": "baz"}],. 
-00017fd0: 2020 2020 2020 2020 2020 204e 6f6e 652c             None,
-00017fe0: 0a20 2020 2020 2020 2020 2020 205b 7b22  .            [{"
-00017ff0: 6261 7222 3a20 2262 6172 222c 2022 656e  bar": "bar", "en
-00018000: 7622 3a20 2274 6573 7422 7d2c 207b 2262  v": "test"}, {"b
-00018010: 6172 223a 2022 6261 7a22 2c20 2265 6e76  ar": "baz", "env
-00018020: 223a 2022 7465 7374 227d 5d2c 0a20 2020  ": "test"}],.   
-00018030: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-00018040: 280a 2020 2020 2020 2020 2020 2020 4e6f  (.            No
-00018050: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00018060: 5b7b 2262 6172 223a 2022 6261 7222 7d2c  [{"bar": "bar"},
-00018070: 207b 2262 6172 223a 2022 6261 7a22 7d5d   {"bar": "baz"}]
-00018080: 2c0a 2020 2020 2020 2020 2020 2020 7b22  ,.            {"
-00018090: 666f 6f22 3a20 2266 6f6f 227d 2c0a 2020  foo": "foo"},.  
-000180a0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-000180b0: 2020 2020 2020 2020 2020 2020 7b22 6261              {"ba
-000180c0: 7222 3a20 2262 6172 222c 2022 656e 7622  r": "bar", "env"
-000180d0: 3a20 2274 6573 7422 2c20 2266 6f6f 223a  : "test", "foo":
-000180e0: 2022 666f 6f22 7d2c 0a20 2020 2020 2020   "foo"},.       
-000180f0: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-00018100: 2022 6261 7a22 2c20 2265 6e76 223a 2022   "baz", "env": "
-00018110: 7465 7374 222c 2022 666f 6f22 3a20 2266  test", "foo": "f
-00018120: 6f6f 227d 2c0a 2020 2020 2020 2020 2020  oo"},.          
-00018130: 2020 5d2c 0a20 2020 2020 2020 2029 2c0a    ],.        ),.
-00018140: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
-00018150: 2020 2020 2020 7b22 666f 6f22 3a20 2266        {"foo": "f
-00018160: 6f6f 227d 2c0a 2020 2020 2020 2020 2020  oo"},.          
-00018170: 2020 5b7b 2262 6172 223a 2022 6261 7222    [{"bar": "bar"
-00018180: 7d2c 207b 2262 6172 223a 2022 6261 7a22  }, {"bar": "baz"
-00018190: 7d5d 2c0a 2020 2020 2020 2020 2020 2020  }],.            
-000181a0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-000181b0: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-000181c0: 2020 2020 7b22 6261 7222 3a20 2262 6172      {"bar": "bar
-000181d0: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
-000181e0: 2c20 2266 6f6f 223a 2022 666f 6f22 7d2c  , "foo": "foo"},
-000181f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018200: 207b 2262 6172 223a 2022 6261 7a22 2c20   {"bar": "baz", 
-00018210: 2265 6e76 223a 2022 7465 7374 222c 2022  "env": "test", "
-00018220: 666f 6f22 3a20 2266 6f6f 227d 2c0a 2020  foo": "foo"},.  
-00018230: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-00018240: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-00018250: 280a 2020 2020 2020 2020 2020 2020 7b22  (.            {"
-00018260: 6261 7222 3a20 2262 6172 227d 2c0a 2020  bar": "bar"},.  
-00018270: 2020 2020 2020 2020 2020 5b7b 2266 6f6f            [{"foo
-00018280: 223a 2022 666f 6f22 7d2c 207b 2262 617a  ": "foo"}, {"baz
-00018290: 223a 2022 6261 7a22 7d5d 2c0a 2020 2020  ": "baz"}],.    
-000182a0: 2020 2020 2020 2020 7b22 656e 7622 3a20          {"env": 
-000182b0: 2266 6f6f 6261 7222 7d2c 0a20 2020 2020  "foobar"},.     
-000182c0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-000182d0: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-000182e0: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
-000182f0: 666f 6f62 6172 222c 2022 666f 6f22 3a20  foobar", "foo": 
-00018300: 2266 6f6f 227d 2c0a 2020 2020 2020 2020  "foo"},.        
-00018310: 2020 2020 2020 2020 7b22 6261 7222 3a20          {"bar": 
-00018320: 2262 6172 222c 2022 656e 7622 3a20 2266  "bar", "env": "f
-00018330: 6f6f 6261 7222 2c20 2262 617a 223a 2022  oobar", "baz": "
-00018340: 6261 7a22 7d2c 0a20 2020 2020 2020 2020  baz"},.         
-00018350: 2020 205d 2c0a 2020 2020 2020 2020 292c     ],.        ),
-00018360: 0a20 2020 2020 2020 2028 0a20 2020 2020  .        (.     
-00018370: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
-00018380: 2020 2020 2020 2020 205b 7b22 6261 7222           [{"bar"
-00018390: 3a20 2262 6172 227d 2c20 7b22 6261 7222  : "bar"}, {"bar"
-000183a0: 3a20 2262 617a 227d 5d2c 0a20 2020 2020  : "baz"}],.     
-000183b0: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
-000183c0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
-000183d0: 2020 2020 2020 2020 2020 207b 2262 6172             {"bar
-000183e0: 223a 2022 6261 7222 2c20 2265 6e76 223a  ": "bar", "env":
-000183f0: 2022 7465 7374 227d 2c0a 2020 2020 2020   "test"},.      
-00018400: 2020 2020 2020 2020 2020 7b22 6261 7222            {"bar"
-00018410: 3a20 2262 617a 222c 2022 656e 7622 3a20  : "baz", "env": 
-00018420: 2274 6573 7422 7d2c 0a20 2020 2020 2020  "test"},.       
-00018430: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-00018440: 292c 0a20 2020 2020 2020 2028 0a20 2020  ),.        (.   
-00018450: 2020 2020 2020 2020 204e 6f6e 652c 0a20           None,. 
-00018460: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
-00018470: 7261 7928 5b7b 2262 6172 223a 2022 6261  ray([{"bar": "ba
-00018480: 7222 7d2c 207b 2262 6172 223a 2022 6261  r"}, {"bar": "ba
-00018490: 7a22 7d5d 292c 0a20 2020 2020 2020 2020  z"}]),.         
-000184a0: 2020 204e 6f6e 652c 0a20 2020 2020 2020     None,.       
-000184b0: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-000184c0: 2020 2020 2020 207b 2262 6172 223a 2022         {"bar": "
-000184d0: 6261 7222 2c20 2265 6e76 223a 2022 7465  bar", "env": "te
-000184e0: 7374 227d 2c0a 2020 2020 2020 2020 2020  st"},.          
-000184f0: 2020 2020 2020 7b22 6261 7222 3a20 2262        {"bar": "b
-00018500: 617a 222c 2022 656e 7622 3a20 2274 6573  az", "env": "tes
-00018510: 7422 7d2c 0a20 2020 2020 2020 2020 2020  t"},.           
-00018520: 205d 2c0a 2020 2020 2020 2020 292c 0a20   ],.        ),. 
-00018530: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
-00018540: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
-00018550: 2020 2020 2020 2070 642e 5365 7269 6573         pd.Series
-00018560: 285b 2262 6172 222c 2022 6261 7a22 5d2c  (["bar", "baz"],
-00018570: 206e 616d 653d 2262 6172 2229 2c0a 2020   name="bar"),.  
-00018580: 2020 2020 2020 2020 2020 4e6f 6e65 2c0a            None,.
-00018590: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-000185a0: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-000185b0: 6261 7222 3a20 2262 6172 222c 2022 656e  bar": "bar", "en
-000185c0: 7622 3a20 2274 6573 7422 7d2c 0a20 2020  v": "test"},.   
-000185d0: 2020 2020 2020 2020 2020 2020 207b 2262               {"b
-000185e0: 6172 223a 2022 6261 7a22 2c20 2265 6e76  ar": "baz", "env
-000185f0: 223a 2022 7465 7374 227d 2c0a 2020 2020  ": "test"},.    
-00018600: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-00018610: 2020 2029 2c0a 2020 2020 2020 2020 280a     ),.        (.
-00018620: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-00018630: 2c0a 2020 2020 2020 2020 2020 2020 7064  ,.            pd
-00018640: 2e44 6174 6146 7261 6d65 287b 2262 6172  .DataFrame({"bar
-00018650: 223a 205b 2262 6172 222c 2022 6261 7a22  ": ["bar", "baz"
-00018660: 5d7d 292c 0a20 2020 2020 2020 2020 2020  ]}),.           
-00018670: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-00018680: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-00018690: 2020 2020 207b 2262 6172 223a 2022 6261       {"bar": "ba
-000186a0: 7222 2c20 2265 6e76 223a 2022 7465 7374  r", "env": "test
-000186b0: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-000186c0: 2020 2020 7b22 6261 7222 3a20 2262 617a      {"bar": "baz
-000186d0: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
-000186e0: 7d2c 0a20 2020 2020 2020 2020 2020 205d  },.            ]
-000186f0: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
-00018700: 205d 2c0a 290a 406d 6f63 6b2e 7061 7463   ],.).@mock.patc
-00018710: 6828 2267 616e 7472 792e 6c6f 6767 6572  h("gantry.logger
-00018720: 2e63 6c69 656e 742e 5f72 6573 6f6c 7665  .client._resolve
-00018730: 5f6a 6f69 6e5f 6b65 7973 2229 0a40 6d6f  _join_keys").@mo
-00018740: 636b 2e70 6174 6368 2822 6761 6e74 7279  ck.patch("gantry
-00018750: 2e6c 6f67 6765 722e 636c 6965 6e74 2e47  .logger.client.G
-00018760: 616e 7472 792e 5f67 656e 6572 6174 655f  antry._generate_
-00018770: 7072 6564 6963 7469 6f6e 5f61 6e64 5f66  prediction_and_f
-00018780: 6565 6462 6163 6b5f 6576 656e 7473 2229  eedback_events")
-00018790: 0a40 6d6f 636b 2e70 6174 6368 280a 2020  .@mock.patch(.  
-000187a0: 2020 2267 616e 7472 792e 6c6f 6767 6572    "gantry.logger
-000187b0: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
-000187c0: 6765 6e65 7261 7465 5f70 7265 6469 6374  generate_predict
-000187d0: 696f 6e5f 6576 656e 7473 222c 0a20 2020  ion_events",.   
-000187e0: 2072 6574 7572 6e5f 7661 6c75 653d 285b   return_value=([
-000187f0: 7b22 6576 656e 7422 3a20 2270 6c61 6365  {"event": "place
-00018800: 5f68 6f6c 6465 7222 7d5d 2c20 5b22 3132  _holder"}], ["12
-00018810: 3334 3522 2c20 2236 3738 3930 225d 292c  345", "67890"]),
-00018820: 0a29 0a40 6d6f 636b 2e70 6174 6368 2822  .).@mock.patch("
-00018830: 6761 6e74 7279 2e6c 6f67 6765 722e 636c  gantry.logger.cl
-00018840: 6965 6e74 2e47 616e 7472 792e 5f67 656e  ient.Gantry._gen
-00018850: 6572 6174 655f 6665 6564 6261 636b 5f65  erate_feedback_e
-00018860: 7665 6e74 7322 290a 406d 6f63 6b2e 7061  vents").@mock.pa
-00018870: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
-00018880: 6572 2e63 6c69 656e 742e 5f73 616d 706c  er.client._sampl
-00018890: 655f 7265 636f 7264 7322 2c20 7369 6465  e_records", side
-000188a0: 5f65 6666 6563 743d 636c 6965 6e74 2e5f  _effect=client._
-000188b0: 7361 6d70 6c65 5f72 6563 6f72 6473 290a  sample_records).
-000188c0: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
-000188d0: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
-000188e0: 742e 5f64 6566 6175 6c74 5f6a 6f69 6e5f  t._default_join_
-000188f0: 6b65 795f 6765 6e22 290a 6465 6620 7465  key_gen").def te
-00018900: 7374 5f67 656e 6572 6174 655f 7265 636f  st_generate_reco
-00018910: 7264 735f 7072 6564 735f 6f6e 6c79 280a  rds_preds_only(.
-00018920: 2020 2020 6d6f 636b 5f6a 6f69 6e5f 6b65      mock_join_ke
-00018930: 795f 6765 6e2c 0a20 2020 206d 6f63 6b5f  y_gen,.    mock_
-00018940: 7361 6d70 6c65 5f72 6563 6f72 6473 2c0a  sample_records,.
-00018950: 2020 2020 6d6f 636b 5f67 656e 6572 6174      mock_generat
-00018960: 655f 6665 6564 6261 636b 2c0a 2020 2020  e_feedback,.    
-00018970: 6d6f 636b 5f67 656e 6572 6174 655f 7072  mock_generate_pr
-00018980: 6564 732c 0a20 2020 206d 6f63 6b5f 6765  eds,.    mock_ge
-00018990: 6e65 7261 7465 5f70 7265 6473 5f61 6e64  nerate_preds_and
-000189a0: 5f66 6565 6462 6163 6b2c 0a20 2020 206d  _feedback,.    m
-000189b0: 6f63 6b5f 7265 736f 6c76 655f 6a6f 696e  ock_resolve_join
-000189c0: 5f6b 6579 732c 0a20 2020 2076 6572 7369  _keys,.    versi
-000189d0: 6f6e 2c0a 2020 2020 7461 6773 2c0a 2020  on,.    tags,.  
-000189e0: 2020 726f 775f 7461 6773 2c0a 2020 2020    row_tags,.    
-000189f0: 676c 6f62 616c 5f74 6167 732c 0a20 2020  global_tags,.   
-00018a00: 2065 7870 6563 7465 645f 7461 6773 5f70   expected_tags_p
-00018a10: 6172 616d 2c0a 2020 2020 7465 7374 5f74  aram,.    test_t
-00018a20: 696d 6573 7461 6d70 732c 0a20 2020 2074  imestamps,.    t
-00018a30: 6573 745f 7469 6d65 7374 616d 7073 5f6c  est_timestamps_l
-00018a40: 6973 742c 0a20 2020 2074 6573 745f 696e  ist,.    test_in
-00018a50: 7075 7473 2c0a 2020 2020 7465 7374 5f6f  puts,.    test_o
-00018a60: 7574 7075 7473 2c0a 2020 2020 6b77 6172  utputs,.    kwar
-00018a70: 6773 2c0a 2020 2020 636c 695f 6f62 6a2c  gs,.    cli_obj,
-00018a80: 0a29 3a0a 2020 2020 6d6f 636b 5f6a 6f69  .):.    mock_joi
-00018a90: 6e5f 6b65 795f 6765 6e2e 7369 6465 5f65  n_key_gen.side_e
-00018aa0: 6666 6563 7420 3d20 5b22 3637 3839 3022  ffect = ["67890"
-00018ab0: 2c20 2231 3233 3435 225d 0a20 2020 206d  , "12345"].    m
-00018ac0: 6f63 6b5f 7265 736f 6c76 655f 6a6f 696e  ock_resolve_join
-00018ad0: 5f6b 6579 732e 7265 7475 726e 5f76 616c  _keys.return_val
-00018ae0: 7565 203d 205b 2231 3233 3435 222c 2022  ue = ["12345", "
-00018af0: 3637 3839 3022 5d20 6966 206b 7761 7267  67890"] if kwarg
-00018b00: 7320 656c 7365 204e 6f6e 650a 2020 2020  s else None.    
-00018b10: 7275 6e5f 6964 203d 2073 7472 2875 7569  run_id = str(uui
-00018b20: 642e 7575 6964 3428 2929 0a20 2020 2072  d.uuid4()).    r
-00018b30: 756e 5f74 6167 7320 3d20 4e6f 6e65 0a20  un_tags = None. 
-00018b40: 2020 2069 6620 7461 6773 2061 6e64 2067     if tags and g
-00018b50: 6c6f 6261 6c5f 7461 6773 3a0a 2020 2020  lobal_tags:.    
-00018b60: 2020 2020 7275 6e5f 7461 6773 203d 207b      run_tags = {
-00018b70: 2a2a 7461 6773 2c20 2a2a 676c 6f62 616c  **tags, **global
-00018b80: 5f74 6167 737d 0a20 2020 2065 6c69 6620  _tags}.    elif 
-00018b90: 7461 6773 3a0a 2020 2020 2020 2020 7275  tags:.        ru
-00018ba0: 6e5f 7461 6773 203d 2074 6167 730a 2020  n_tags = tags.  
-00018bb0: 2020 656c 6966 2067 6c6f 6261 6c5f 7461    elif global_ta
-00018bc0: 6773 3a0a 2020 2020 2020 2020 7275 6e5f  gs:.        run_
-00018bd0: 7461 6773 203d 2067 6c6f 6261 6c5f 7461  tags = global_ta
-00018be0: 6773 0a20 2020 2061 7373 6572 7420 636c  gs.    assert cl
-00018bf0: 695f 6f62 6a2e 6c6f 6728 0a20 2020 2020  i_obj.log(.     
-00018c00: 2020 2061 7070 6c69 6361 7469 6f6e 3d22     application="
-00018c10: 666f 6f62 6172 222c 0a20 2020 2020 2020  foobar",.       
-00018c20: 2076 6572 7369 6f6e 3d76 6572 7369 6f6e   version=version
-00018c30: 2c0a 2020 2020 2020 2020 696e 7075 7473  ,.        inputs
-00018c40: 3d74 6573 745f 696e 7075 7473 2c0a 2020  =test_inputs,.  
-00018c50: 2020 2020 2020 6f75 7470 7574 733d 7465        outputs=te
-00018c60: 7374 5f6f 7574 7075 7473 2c0a 2020 2020  st_outputs,.    
-00018c70: 2020 2020 6665 6564 6261 636b 733d 4e6f      feedbacks=No
-00018c80: 6e65 2c0a 2020 2020 2020 2020 7469 6d65  ne,.        time
-00018c90: 7374 616d 7073 3d74 6573 745f 7469 6d65  stamps=test_time
-00018ca0: 7374 616d 7073 2c0a 2020 2020 2020 2020  stamps,.        
-00018cb0: 736f 7274 5f6f 6e5f 7469 6d65 7374 616d  sort_on_timestam
-00018cc0: 703d 5472 7565 2c0a 2020 2020 2020 2020  p=True,.        
-00018cd0: 7275 6e5f 7461 6773 3d72 756e 5f74 6167  run_tags=run_tag
-00018ce0: 732c 0a20 2020 2020 2020 2072 6f77 5f74  s,.        row_t
-00018cf0: 6167 733d 726f 775f 7461 6773 2c0a 2020  ags=row_tags,.  
-00018d00: 2020 2020 2020 7275 6e5f 6964 3d72 756e        run_id=run
-00018d10: 5f69 642c 0a20 2020 2020 2020 202a 2a6b  _id,.        **k
-00018d20: 7761 7267 732c 0a20 2020 2029 203d 3d20  wargs,.    ) == 
-00018d30: 5b7b 2265 7665 6e74 223a 2022 706c 6163  [{"event": "plac
-00018d40: 655f 686f 6c64 6572 227d 5d0a 0a20 2020  e_holder"}]..   
-00018d50: 206d 6f63 6b5f 6765 6e65 7261 7465 5f70   mock_generate_p
-00018d60: 7265 6473 5f61 6e64 5f66 6565 6462 6163  reds_and_feedbac
-00018d70: 6b2e 6173 7365 7274 5f6e 6f74 5f63 616c  k.assert_not_cal
-00018d80: 6c65 6428 290a 2020 2020 6d6f 636b 5f67  led().    mock_g
-00018d90: 656e 6572 6174 655f 7072 6564 732e 6173  enerate_preds.as
-00018da0: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
-00018db0: 5f77 6974 6828 0a20 2020 2020 2020 2061  _with(.        a
-00018dc0: 7070 6c69 6361 7469 6f6e 3d22 666f 6f62  pplication="foob
-00018dd0: 6172 222c 0a20 2020 2020 2020 2069 6e70  ar",.        inp
-00018de0: 7574 733d 5b7b 2241 223a 2031 3030 7d2c  uts=[{"A": 100},
-00018df0: 207b 2241 223a 2031 3031 7d5d 2c0a 2020   {"A": 101}],.  
-00018e00: 2020 2020 2020 6f75 7470 7574 733d 5b7b        outputs=[{
-00018e10: 2242 223a 2033 3030 7d2c 207b 2242 223a  "B": 300}, {"B":
-00018e20: 2033 3031 7d5d 2c0a 2020 2020 2020 2020   301}],.        
-00018e30: 6a6f 696e 5f6b 6579 733d 5b22 3132 3334  join_keys=["1234
-00018e40: 3522 2c20 2236 3738 3930 225d 2069 6620  5", "67890"] if 
-00018e50: 6b77 6172 6773 2065 6c73 6520 5b22 3637  kwargs else ["67
-00018e60: 3839 3022 2c20 2231 3233 3435 225d 2c0a  890", "12345"],.
-00018e70: 2020 2020 2020 2020 7665 7273 696f 6e3d          version=
-00018e80: 7665 7273 696f 6e2c 0a20 2020 2020 2020  version,.       
-00018e90: 2069 676e 6f72 655f 696e 7075 7473 3d4e   ignore_inputs=N
-00018ea0: 6f6e 652c 0a20 2020 2020 2020 2074 696d  one,.        tim
-00018eb0: 6573 7461 6d70 733d 7465 7374 5f74 696d  estamps=test_tim
-00018ec0: 6573 7461 6d70 735f 6c69 7374 2c0a 2020  estamps_list,.  
-00018ed0: 2020 2020 2020 736f 7274 5f6f 6e5f 7469        sort_on_ti
-00018ee0: 6d65 7374 616d 703d 5472 7565 2c0a 2020  mestamp=True,.  
-00018ef0: 2020 2020 2020 7275 6e5f 6964 3d72 756e        run_id=run
-00018f00: 5f69 642c 0a20 2020 2020 2020 2074 6167  _id,.        tag
-00018f10: 733d 6578 7065 6374 6564 5f74 6167 735f  s=expected_tags_
-00018f20: 7061 7261 6d2c 0a20 2020 2029 0a20 2020  param,.    ).   
-00018f30: 206d 6f63 6b5f 6765 6e65 7261 7465 5f66   mock_generate_f
-00018f40: 6565 6462 6163 6b2e 6173 7365 7274 5f6e  eedback.assert_n
-00018f50: 6f74 5f63 616c 6c65 6428 290a 0a20 2020  ot_called()..   
-00018f60: 206d 6f63 6b5f 7361 6d70 6c65 5f72 6563   mock_sample_rec
-00018f70: 6f72 6473 2e61 7373 6572 745f 6361 6c6c  ords.assert_call
-00018f80: 6564 5f6f 6e63 655f 7769 7468 280a 2020  ed_once_with(.  
-00018f90: 2020 2020 2020 322c 0a20 2020 2020 2020        2,.       
-00018fa0: 2031 2c0a 2020 2020 2020 2020 5b7b 2241   1,.        [{"A
-00018fb0: 223a 2031 3030 7d2c 207b 2241 223a 2031  ": 100}, {"A": 1
-00018fc0: 3031 7d5d 2c0a 2020 2020 2020 2020 5b7b  01}],.        [{
-00018fd0: 2242 223a 2033 3030 7d2c 207b 2242 223a  "B": 300}, {"B":
-00018fe0: 2033 3031 7d5d 2c0a 2020 2020 2020 2020   301}],.        
-00018ff0: 4e6f 6e65 2c0a 2020 2020 2020 2020 636c  None,.        cl
-00019000: 6965 6e74 2e5f 7265 736f 6c76 655f 6a6f  ient._resolve_jo
-00019010: 696e 5f6b 6579 7328 2a2a 6b77 6172 6773  in_keys(**kwargs
-00019020: 292c 0a20 2020 2020 2020 2074 6573 745f  ),.        test_
-00019030: 7469 6d65 7374 616d 7073 5f6c 6973 742c  timestamps_list,
-00019040: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
-00019050: 645f 7461 6773 5f70 6172 616d 2c0a 2020  d_tags_param,.  
-00019060: 2020 290a 0a20 2020 2069 6620 6b77 6172    )..    if kwar
-00019070: 6773 3a0a 2020 2020 2020 2020 6d6f 636b  gs:.        mock
-00019080: 5f6a 6f69 6e5f 6b65 795f 6765 6e2e 6173  _join_key_gen.as
-00019090: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
-000190a0: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
-000190b0: 2020 2020 6d6f 636b 5f6a 6f69 6e5f 6b65      mock_join_ke
-000190c0: 795f 6765 6e2e 6173 7365 7274 5f63 616c  y_gen.assert_cal
-000190d0: 6c65 6428 290a 0a0a 4070 7974 6573 742e  led()...@pytest.
-000190e0: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-000190f0: 280a 2020 2020 2274 6573 745f 7469 6d65  (.    "test_time
-00019100: 7374 616d 7073 2c20 7465 7374 5f74 696d  stamps, test_tim
-00019110: 6573 7461 6d70 735f 6c69 7374 222c 0a20  estamps_list",. 
-00019120: 2020 205b 0a20 2020 2020 2020 2028 4e6f     [.        (No
-00019130: 6e65 2c20 4e6f 6e65 292c 0a20 2020 2020  ne, None),.     
-00019140: 2020 2028 5b43 5552 5245 4e54 5f54 494d     ([CURRENT_TIM
-00019150: 455d 202a 2032 2c20 5b43 5552 5245 4e54  E] * 2, [CURRENT
-00019160: 5f54 494d 455d 202a 2032 292c 0a20 2020  _TIME] * 2),.   
-00019170: 2020 2020 2028 6e70 2e61 7272 6179 285b       (np.array([
-00019180: 4355 5252 454e 545f 5449 4d45 5d20 2a20  CURRENT_TIME] * 
-00019190: 3229 2c20 5b43 5552 5245 4e54 5f54 494d  2), [CURRENT_TIM
-000191a0: 455d 202a 2032 292c 0a20 2020 205d 2c0a  E] * 2),.    ],.
-000191b0: 290a 4070 7974 6573 742e 6d61 726b 2e70  ).@pytest.mark.p
-000191c0: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
-000191d0: 226b 7761 7267 7322 2c0a 2020 2020 5b0a  "kwargs",.    [.
-000191e0: 2020 2020 2020 2020 7b22 6665 6564 6261          {"feedba
-000191f0: 636b 5f6b 6579 7322 3a20 5b22 4122 5d7d  ck_keys": ["A"]}
-00019200: 2c0a 2020 2020 2020 2020 7b22 6665 6564  ,.        {"feed
-00019210: 6261 636b 5f69 6473 223a 205b 2231 3233  back_ids": ["123
-00019220: 3435 222c 2022 3637 3839 3022 5d7d 2c0a  45", "67890"]},.
-00019230: 2020 2020 2020 2020 7b22 6a6f 696e 5f6b          {"join_k
-00019240: 6579 7322 3a20 5b22 3534 3332 3122 2c20  eys": ["54321", 
-00019250: 2236 3738 3930 225d 7d2c 0a20 2020 2020  "67890"]},.     
-00019260: 2020 207b 226a 6f69 6e5f 6b65 7973 223a     {"join_keys":
-00019270: 2070 642e 5365 7269 6573 285b 2235 3433   pd.Series(["543
-00019280: 3231 222c 2022 3637 3839 3022 5d29 7d2c  21", "67890"])},
-00019290: 0a20 2020 205d 2c0a 290a 4070 7974 6573  .    ],.).@pytes
-000192a0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
-000192b0: 7a65 280a 2020 2020 2274 6573 745f 6665  ze(.    "test_fe
-000192c0: 6564 6261 636b 7322 2c0a 2020 2020 5b0a  edbacks",.    [.
-000192d0: 2020 2020 2020 2020 5b7b 2241 223a 2032          [{"A": 2
-000192e0: 3030 7d2c 207b 2241 223a 2032 3031 7d5d  00}, {"A": 201}]
-000192f0: 2c0a 2020 2020 2020 2020 7064 2e44 6174  ,.        pd.Dat
-00019300: 6146 7261 6d65 2e66 726f 6d5f 6469 6374  aFrame.from_dict
-00019310: 287b 2241 223a 205b 3230 302c 2032 3031  ({"A": [200, 201
-00019320: 5d7d 292c 0a20 2020 2020 2020 2070 642e  ]}),.        pd.
-00019330: 5365 7269 6573 286e 616d 653d 2241 222c  Series(name="A",
-00019340: 2064 6174 613d 5b32 3030 2c20 3230 315d   data=[200, 201]
-00019350: 292c 0a20 2020 2020 2020 206e 702e 6172  ),.        np.ar
-00019360: 7261 7928 5b7b 2241 223a 2032 3030 7d2c  ray([{"A": 200},
-00019370: 207b 2241 223a 2032 3031 7d5d 292c 0a20   {"A": 201}]),. 
-00019380: 2020 205d 2c0a 290a 4070 7974 6573 742e     ],.).@pytest.
-00019390: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-000193a0: 2822 7665 7273 696f 6e22 2c20 5b4e 6f6e  ("version", [Non
-000193b0: 652c 2031 302c 2022 312e 322e 3322 5d29  e, 10, "1.2.3"])
-000193c0: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
-000193d0: 7261 6d65 7472 697a 6528 0a20 2020 2022  rametrize(.    "
-000193e0: 7461 6773 2c20 726f 775f 7461 6773 2c20  tags, row_tags, 
-000193f0: 676c 6f62 616c 5f74 6167 732c 2065 7870  global_tags, exp
-00019400: 6563 7465 645f 7461 6773 5f70 6172 616d  ected_tags_param
-00019410: 222c 0a20 2020 205b 0a20 2020 2020 2020  ",.    [.       
-00019420: 2028 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f   (None, None, No
-00019430: 6e65 2c20 5b7b 2265 6e76 223a 2022 7465  ne, [{"env": "te
-00019440: 7374 227d 2c20 7b22 656e 7622 3a20 2274  st"}, {"env": "t
-00019450: 6573 7422 7d5d 292c 0a20 2020 2020 2020  est"}]),.       
-00019460: 2028 0a20 2020 2020 2020 2020 2020 207b   (.            {
-00019470: 2262 6172 223a 2022 6261 7222 7d2c 0a20  "bar": "bar"},. 
-00019480: 2020 2020 2020 2020 2020 204e 6f6e 652c             None,
-00019490: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-000194a0: 652c 0a20 2020 2020 2020 2020 2020 205b  e,.            [
-000194b0: 7b22 6261 7222 3a20 2262 6172 222c 2022  {"bar": "bar", "
-000194c0: 656e 7622 3a20 2274 6573 7422 7d2c 207b  env": "test"}, {
-000194d0: 2262 6172 223a 2022 6261 7222 2c20 2265  "bar": "bar", "e
-000194e0: 6e76 223a 2022 7465 7374 227d 5d2c 0a20  nv": "test"}],. 
-000194f0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-00019500: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-00019510: 7b22 6261 7222 3a20 2262 6172 227d 2c0a  {"bar": "bar"},.
-00019520: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-00019530: 2c0a 2020 2020 2020 2020 2020 2020 7b22  ,.            {"
-00019540: 666f 6f22 3a20 2266 6f6f 227d 2c0a 2020  foo": "foo"},.  
-00019550: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-00019560: 2020 2020 2020 2020 2020 2020 7b22 6261              {"ba
-00019570: 7222 3a20 2262 6172 222c 2022 656e 7622  r": "bar", "env"
-00019580: 3a20 2274 6573 7422 2c20 2266 6f6f 223a  : "test", "foo":
-00019590: 2022 666f 6f22 7d2c 0a20 2020 2020 2020   "foo"},.       
-000195a0: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-000195b0: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
-000195c0: 7465 7374 222c 2022 666f 6f22 3a20 2266  test", "foo": "f
-000195d0: 6f6f 227d 2c0a 2020 2020 2020 2020 2020  oo"},.          
-000195e0: 2020 5d2c 0a20 2020 2020 2020 2029 2c0a    ],.        ),.
-000195f0: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
-00019600: 2020 2020 2020 5b7b 2262 6172 223a 2022        [{"bar": "
-00019610: 6261 7222 7d2c 207b 2262 6172 223a 2022  bar"}, {"bar": "
-00019620: 6261 7a22 7d5d 2c0a 2020 2020 2020 2020  baz"}],.        
-00019630: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
-00019640: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-00019650: 2020 2020 2020 2020 5b7b 2262 6172 223a          [{"bar":
-00019660: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
-00019670: 7465 7374 227d 2c20 7b22 6261 7222 3a20  test"}, {"bar": 
-00019680: 2262 617a 222c 2022 656e 7622 3a20 2274  "baz", "env": "t
-00019690: 6573 7422 7d5d 2c0a 2020 2020 2020 2020  est"}],.        
-000196a0: 292c 0a20 2020 2020 2020 2028 0a20 2020  ),.        (.   
-000196b0: 2020 2020 2020 2020 204e 6f6e 652c 0a20           None,. 
-000196c0: 2020 2020 2020 2020 2020 205b 7b22 6261             [{"ba
-000196d0: 7222 3a20 2262 6172 227d 2c20 7b22 6261  r": "bar"}, {"ba
-000196e0: 7222 3a20 2262 617a 227d 5d2c 0a20 2020  r": "baz"}],.   
-000196f0: 2020 2020 2020 2020 204e 6f6e 652c 0a20           None,. 
-00019700: 2020 2020 2020 2020 2020 205b 7b22 6261             [{"ba
-00019710: 7222 3a20 2262 6172 222c 2022 656e 7622  r": "bar", "env"
-00019720: 3a20 2274 6573 7422 7d2c 207b 2262 6172  : "test"}, {"bar
-00019730: 223a 2022 6261 7a22 2c20 2265 6e76 223a  ": "baz", "env":
-00019740: 2022 7465 7374 227d 5d2c 0a20 2020 2020   "test"}],.     
-00019750: 2020 2029 2c0a 2020 2020 2020 2020 280a     ),.        (.
-00019760: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-00019770: 2c0a 2020 2020 2020 2020 2020 2020 5b7b  ,.            [{
-00019780: 2262 6172 223a 2022 6261 7222 7d2c 207b  "bar": "bar"}, {
-00019790: 2262 6172 223a 2022 6261 7a22 7d5d 2c0a  "bar": "baz"}],.
-000197a0: 2020 2020 2020 2020 2020 2020 7b22 666f              {"fo
-000197b0: 6f22 3a20 2266 6f6f 227d 2c0a 2020 2020  o": "foo"},.    
-000197c0: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-000197d0: 2020 2020 2020 2020 2020 7b22 6261 7222            {"bar"
-000197e0: 3a20 2262 6172 222c 2022 656e 7622 3a20  : "bar", "env": 
-000197f0: 2274 6573 7422 2c20 2266 6f6f 223a 2022  "test", "foo": "
-00019800: 666f 6f22 7d2c 0a20 2020 2020 2020 2020  foo"},.         
-00019810: 2020 2020 2020 207b 2262 6172 223a 2022         {"bar": "
-00019820: 6261 7a22 2c20 2265 6e76 223a 2022 7465  baz", "env": "te
-00019830: 7374 222c 2022 666f 6f22 3a20 2266 6f6f  st", "foo": "foo
-00019840: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-00019850: 5d2c 0a20 2020 2020 2020 2029 2c0a 2020  ],.        ),.  
-00019860: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-00019870: 2020 2020 7b22 666f 6f22 3a20 2266 6f6f      {"foo": "foo
-00019880: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-00019890: 5b7b 2262 6172 223a 2022 6261 7222 7d2c  [{"bar": "bar"},
-000198a0: 207b 2262 6172 223a 2022 6261 7a22 7d5d   {"bar": "baz"}]
-000198b0: 2c0a 2020 2020 2020 2020 2020 2020 4e6f  ,.            No
-000198c0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-000198d0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-000198e0: 2020 7b22 6261 7222 3a20 2262 6172 222c    {"bar": "bar",
-000198f0: 2022 656e 7622 3a20 2274 6573 7422 2c20   "env": "test", 
-00019900: 2266 6f6f 223a 2022 666f 6f22 7d2c 0a20  "foo": "foo"},. 
-00019910: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00019920: 2262 6172 223a 2022 6261 7a22 2c20 2265  "bar": "baz", "e
-00019930: 6e76 223a 2022 7465 7374 222c 2022 666f  nv": "test", "fo
-00019940: 6f22 3a20 2266 6f6f 227d 2c0a 2020 2020  o": "foo"},.    
-00019950: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-00019960: 2020 2029 2c0a 2020 2020 2020 2020 280a     ),.        (.
-00019970: 2020 2020 2020 2020 2020 2020 7b22 6261              {"ba
-00019980: 7222 3a20 2262 6172 227d 2c0a 2020 2020  r": "bar"},.    
-00019990: 2020 2020 2020 2020 5b7b 2266 6f6f 223a          [{"foo":
-000199a0: 2022 666f 6f22 7d2c 207b 2262 617a 223a   "foo"}, {"baz":
-000199b0: 2022 6261 7a22 7d5d 2c0a 2020 2020 2020   "baz"}],.      
-000199c0: 2020 2020 2020 7b22 656e 7622 3a20 2266        {"env": "f
-000199d0: 6f6f 6261 7222 7d2c 0a20 2020 2020 2020  oobar"},.       
-000199e0: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-000199f0: 2020 2020 2020 207b 2262 6172 223a 2022         {"bar": "
-00019a00: 6261 7222 2c20 2265 6e76 223a 2022 666f  bar", "env": "fo
-00019a10: 6f62 6172 222c 2022 666f 6f22 3a20 2266  obar", "foo": "f
-00019a20: 6f6f 227d 2c0a 2020 2020 2020 2020 2020  oo"},.          
-00019a30: 2020 2020 2020 7b22 6261 7222 3a20 2262        {"bar": "b
-00019a40: 6172 222c 2022 656e 7622 3a20 2266 6f6f  ar", "env": "foo
-00019a50: 6261 7222 2c20 2262 617a 223a 2022 6261  bar", "baz": "ba
-00019a60: 7a22 7d2c 0a20 2020 2020 2020 2020 2020  z"},.           
-00019a70: 205d 2c0a 2020 2020 2020 2020 292c 0a20   ],.        ),. 
-00019a80: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
-00019a90: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
-00019aa0: 2020 2020 2020 205b 7b22 6261 7222 3a20         [{"bar": 
-00019ab0: 2262 6172 227d 2c20 7b22 6261 7222 3a20  "bar"}, {"bar": 
-00019ac0: 2262 617a 227d 5d2c 0a20 2020 2020 2020  "baz"}],.       
-00019ad0: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
-00019ae0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-00019af0: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-00019b00: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
-00019b10: 7465 7374 227d 2c0a 2020 2020 2020 2020  test"},.        
-00019b20: 2020 2020 2020 2020 7b22 6261 7222 3a20          {"bar": 
-00019b30: 2262 617a 222c 2022 656e 7622 3a20 2274  "baz", "env": "t
-00019b40: 6573 7422 7d2c 0a20 2020 2020 2020 2020  est"},.         
-00019b50: 2020 205d 2c0a 2020 2020 2020 2020 292c     ],.        ),
-00019b60: 0a20 2020 2020 2020 2028 0a20 2020 2020  .        (.     
-00019b70: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
-00019b80: 2020 2020 2020 2020 206e 702e 6172 7261           np.arra
-00019b90: 7928 5b7b 2262 6172 223a 2022 6261 7222  y([{"bar": "bar"
-00019ba0: 7d2c 207b 2262 6172 223a 2022 6261 7a22  }, {"bar": "baz"
-00019bb0: 7d5d 292c 0a20 2020 2020 2020 2020 2020  }]),.           
-00019bc0: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-00019bd0: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-00019be0: 2020 2020 207b 2262 6172 223a 2022 6261       {"bar": "ba
-00019bf0: 7222 2c20 2265 6e76 223a 2022 7465 7374  r", "env": "test
-00019c00: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-00019c10: 2020 2020 7b22 6261 7222 3a20 2262 617a      {"bar": "baz
-00019c20: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
-00019c30: 7d2c 0a20 2020 2020 2020 2020 2020 205d  },.            ]
-00019c40: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
-00019c50: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
-00019c60: 2020 204e 6f6e 652c 0a20 2020 2020 2020     None,.       
-00019c70: 2020 2020 2070 642e 5365 7269 6573 285b       pd.Series([
-00019c80: 2262 6172 222c 2022 6261 7a22 5d2c 206e  "bar", "baz"], n
-00019c90: 616d 653d 2262 6172 2229 2c0a 2020 2020  ame="bar"),.    
-00019ca0: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
-00019cb0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-00019cc0: 2020 2020 2020 2020 2020 2020 7b22 6261              {"ba
-00019cd0: 7222 3a20 2262 6172 222c 2022 656e 7622  r": "bar", "env"
-00019ce0: 3a20 2274 6573 7422 7d2c 0a20 2020 2020  : "test"},.     
-00019cf0: 2020 2020 2020 2020 2020 207b 2262 6172             {"bar
-00019d00: 223a 2022 6261 7a22 2c20 2265 6e76 223a  ": "baz", "env":
-00019d10: 2022 7465 7374 227d 2c0a 2020 2020 2020   "test"},.      
-00019d20: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-00019d30: 2029 2c0a 2020 2020 2020 2020 280a 2020   ),.        (.  
-00019d40: 2020 2020 2020 2020 2020 4e6f 6e65 2c0a            None,.
-00019d50: 2020 2020 2020 2020 2020 2020 7064 2e44              pd.D
-00019d60: 6174 6146 7261 6d65 287b 2262 6172 223a  ataFrame({"bar":
-00019d70: 205b 2262 6172 222c 2022 6261 7a22 5d7d   ["bar", "baz"]}
-00019d80: 292c 0a20 2020 2020 2020 2020 2020 204e  ),.            N
-00019d90: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-00019da0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-00019db0: 2020 207b 2262 6172 223a 2022 6261 7222     {"bar": "bar"
-00019dc0: 2c20 2265 6e76 223a 2022 7465 7374 227d  , "env": "test"}
-00019dd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00019de0: 2020 7b22 6261 7222 3a20 2262 617a 222c    {"bar": "baz",
-00019df0: 2022 656e 7622 3a20 2274 6573 7422 7d2c   "env": "test"},
-00019e00: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
-00019e10: 2020 2020 2020 2020 292c 0a20 2020 205d          ),.    ]
-00019e20: 2c0a 290a 406d 6f63 6b2e 7061 7463 6828  ,.).@mock.patch(
-00019e30: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
-00019e40: 6c69 656e 742e 5f72 6573 6f6c 7665 5f6a  lient._resolve_j
-00019e50: 6f69 6e5f 6b65 7973 222c 2072 6574 7572  oin_keys", retur
-00019e60: 6e5f 7661 6c75 653d 5b22 3132 3334 3522  n_value=["12345"
-00019e70: 2c20 2235 3433 3231 225d 290a 406d 6f63  , "54321"]).@moc
-00019e80: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
-00019e90: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
-00019ea0: 6e74 7279 2e5f 6c6f 675f 7072 6564 6963  ntry._log_predic
-00019eb0: 7469 6f6e 5f61 6e64 5f66 6565 6462 6163  tion_and_feedbac
-00019ec0: 6b5f 6576 656e 7473 2229 0a40 6d6f 636b  k_events").@mock
-00019ed0: 2e70 6174 6368 2822 6761 6e74 7279 2e6c  .patch("gantry.l
-00019ee0: 6f67 6765 722e 636c 6965 6e74 2e47 616e  ogger.client.Gan
-00019ef0: 7472 792e 5f6c 6f67 5f70 7265 6469 6374  try._log_predict
-00019f00: 696f 6e5f 6576 656e 7473 2229 0a40 6d6f  ion_events").@mo
-00019f10: 636b 2e70 6174 6368 280a 2020 2020 2267  ck.patch(.    "g
-00019f20: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
-00019f30: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
-00019f40: 6665 6564 6261 636b 5f65 7665 6e74 7322  feedback_events"
-00019f50: 2c20 7265 7475 726e 5f76 616c 7565 3d28  , return_value=(
-00019f60: 4e6f 6e65 2c20 5b22 3132 3334 3522 2c20  None, ["12345", 
-00019f70: 2236 3738 3930 225d 290a 290a 406d 6f63  "67890"]).).@moc
-00019f80: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
-00019f90: 6c6f 6767 6572 2e63 6c69 656e 742e 5f73  logger.client._s
-00019fa0: 616d 706c 655f 7265 636f 7264 7322 2c20  ample_records", 
-00019fb0: 7369 6465 5f65 6666 6563 743d 636c 6965  side_effect=clie
-00019fc0: 6e74 2e5f 7361 6d70 6c65 5f72 6563 6f72  nt._sample_recor
-00019fd0: 6473 290a 6465 6620 7465 7374 5f6c 6f67  ds).def test_log
-00019fe0: 5f72 6563 6f72 6473 5f66 6565 6462 6163  _records_feedbac
-00019ff0: 6b5f 6f6e 6c79 280a 2020 2020 6d6f 636b  k_only(.    mock
-0001a000: 5f73 616d 706c 655f 7265 636f 7264 732c  _sample_records,
-0001a010: 0a20 2020 206d 6f63 6b5f 6665 6564 6261  .    mock_feedba
-0001a020: 636b 2c0a 2020 2020 6d6f 636b 5f70 7265  ck,.    mock_pre
-0001a030: 6473 2c0a 2020 2020 6d6f 636b 5f70 7265  ds,.    mock_pre
-0001a040: 6473 5f61 6e64 5f66 6565 6462 6163 6b2c  ds_and_feedback,
-0001a050: 0a20 2020 206d 6f63 6b5f 7265 736f 6c76  .    mock_resolv
-0001a060: 655f 6a6f 696e 5f6b 6579 732c 0a20 2020  e_join_keys,.   
-0001a070: 2076 6572 7369 6f6e 2c0a 2020 2020 7461   version,.    ta
-0001a080: 6773 2c0a 2020 2020 726f 775f 7461 6773  gs,.    row_tags
-0001a090: 2c0a 2020 2020 676c 6f62 616c 5f74 6167  ,.    global_tag
-0001a0a0: 732c 0a20 2020 2065 7870 6563 7465 645f  s,.    expected_
-0001a0b0: 7461 6773 5f70 6172 616d 2c0a 2020 2020  tags_param,.    
-0001a0c0: 7465 7374 5f66 6565 6462 6163 6b73 2c0a  test_feedbacks,.
-0001a0d0: 2020 2020 7465 7374 5f74 696d 6573 7461      test_timesta
-0001a0e0: 6d70 732c 0a20 2020 2074 6573 745f 7469  mps,.    test_ti
-0001a0f0: 6d65 7374 616d 7073 5f6c 6973 742c 0a20  mestamps_list,. 
-0001a100: 2020 206b 7761 7267 732c 0a20 2020 2063     kwargs,.    c
-0001a110: 6c69 5f6f 626a 2c0a 293a 0a20 2020 2061  li_obj,.):.    a
-0001a120: 7373 6572 7420 636c 695f 6f62 6a2e 6c6f  ssert cli_obj.lo
-0001a130: 675f 7265 636f 7264 7328 0a20 2020 2020  g_records(.     
-0001a140: 2020 2061 7070 6c69 6361 7469 6f6e 3d22     application="
-0001a150: 666f 6f62 6172 222c 0a20 2020 2020 2020  foobar",.       
-0001a160: 2076 6572 7369 6f6e 3d76 6572 7369 6f6e   version=version
-0001a170: 2c0a 2020 2020 2020 2020 696e 7075 7473  ,.        inputs
-0001a180: 3d4e 6f6e 652c 0a20 2020 2020 2020 206f  =None,.        o
-0001a190: 7574 7075 7473 3d4e 6f6e 652c 0a20 2020  utputs=None,.   
-0001a1a0: 2020 2020 2066 6565 6462 6163 6b73 3d74       feedbacks=t
-0001a1b0: 6573 745f 6665 6564 6261 636b 732c 0a20  est_feedbacks,. 
-0001a1c0: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
-0001a1d0: 733d 7465 7374 5f74 696d 6573 7461 6d70  s=test_timestamp
-0001a1e0: 732c 0a20 2020 2020 2020 2073 6f72 745f  s,.        sort_
-0001a1f0: 6f6e 5f74 696d 6573 7461 6d70 3d54 7275  on_timestamp=Tru
-0001a200: 652c 0a20 2020 2020 2020 2074 6167 733d  e,.        tags=
-0001a210: 7461 6773 2c0a 2020 2020 2020 2020 726f  tags,.        ro
-0001a220: 775f 7461 6773 3d72 6f77 5f74 6167 732c  w_tags=row_tags,
-0001a230: 0a20 2020 2020 2020 2067 6c6f 6261 6c5f  .        global_
-0001a240: 7461 6773 3d67 6c6f 6261 6c5f 7461 6773  tags=global_tags
-0001a250: 2c0a 2020 2020 2020 2020 2a2a 6b77 6172  ,.        **kwar
-0001a260: 6773 2c0a 2020 2020 2920 3d3d 2028 4e6f  gs,.    ) == (No
-0001a270: 6e65 2c20 5b22 3132 3334 3522 2c20 2236  ne, ["12345", "6
-0001a280: 3738 3930 225d 290a 0a20 2020 206d 6f63  7890"])..    moc
-0001a290: 6b5f 7072 6564 735f 616e 645f 6665 6564  k_preds_and_feed
-0001a2a0: 6261 636b 2e61 7373 6572 745f 6e6f 745f  back.assert_not_
-0001a2b0: 6361 6c6c 6564 2829 0a20 2020 206d 6f63  called().    moc
-0001a2c0: 6b5f 7072 6564 732e 6173 7365 7274 5f6e  k_preds.assert_n
-0001a2d0: 6f74 5f63 616c 6c65 6428 290a 2020 2020  ot_called().    
-0001a2e0: 6d6f 636b 5f66 6565 6462 6163 6b2e 6173  mock_feedback.as
-0001a2f0: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
-0001a300: 5f77 6974 6828 0a20 2020 2020 2020 2022  _with(.        "
-0001a310: 666f 6f62 6172 222c 0a20 2020 2020 2020  foobar",.       
-0001a320: 205b 7b22 4122 3a20 3230 307d 2c20 7b22   [{"A": 200}, {"
-0001a330: 4122 3a20 3230 317d 5d2c 0a20 2020 2020  A": 201}],.     
-0001a340: 2020 205b 2231 3233 3435 222c 2022 3534     ["12345", "54
-0001a350: 3332 3122 5d2c 0a20 2020 2020 2020 2076  321"],.        v
-0001a360: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
-0001a370: 7465 7374 5f74 696d 6573 7461 6d70 735f  test_timestamps_
-0001a380: 6c69 7374 2c0a 2020 2020 2020 2020 5472  list,.        Tr
-0001a390: 7565 2c0a 2020 2020 2020 2020 4661 6c73  ue,.        Fals
-0001a3a0: 652c 0a20 2020 2020 2020 2065 7870 6563  e,.        expec
-0001a3b0: 7465 645f 7461 6773 5f70 6172 616d 2c0a  ted_tags_param,.
-0001a3c0: 2020 2020 290a 0a20 2020 206d 6f63 6b5f      )..    mock_
-0001a3d0: 7361 6d70 6c65 5f72 6563 6f72 6473 2e61  sample_records.a
-0001a3e0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-0001a3f0: 655f 7769 7468 280a 2020 2020 2020 2020  e_with(.        
-0001a400: 322c 0a20 2020 2020 2020 2031 2c0a 2020  2,.        1,.  
-0001a410: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-0001a420: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
-0001a430: 2020 5b7b 2241 223a 2032 3030 7d2c 207b    [{"A": 200}, {
-0001a440: 2241 223a 2032 3031 7d5d 2c0a 2020 2020  "A": 201}],.    
-0001a450: 2020 2020 636c 6965 6e74 2e5f 7265 736f      client._reso
-0001a460: 6c76 655f 6a6f 696e 5f6b 6579 7328 2a2a  lve_join_keys(**
-0001a470: 6b77 6172 6773 292c 0a20 2020 2020 2020  kwargs),.       
-0001a480: 2074 6573 745f 7469 6d65 7374 616d 7073   test_timestamps
-0001a490: 5f6c 6973 742c 0a20 2020 2020 2020 2065  _list,.        e
-0001a4a0: 7870 6563 7465 645f 7461 6773 5f70 6172  xpected_tags_par
-0001a4b0: 616d 2c0a 2020 2020 290a 0a0a 4070 7974  am,.    )...@pyt
-0001a4c0: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-0001a4d0: 7269 7a65 280a 2020 2020 2274 6573 745f  rize(.    "test_
-0001a4e0: 7469 6d65 7374 616d 7073 2c20 7465 7374  timestamps, test
-0001a4f0: 5f74 696d 6573 7461 6d70 735f 6c69 7374  _timestamps_list
-0001a500: 222c 0a20 2020 205b 0a20 2020 2020 2020  ",.    [.       
-0001a510: 2028 4e6f 6e65 2c20 4e6f 6e65 292c 0a20   (None, None),. 
-0001a520: 2020 2020 2020 2028 5b43 5552 5245 4e54         ([CURRENT
-0001a530: 5f54 494d 455d 202a 2032 2c20 5b43 5552  _TIME] * 2, [CUR
-0001a540: 5245 4e54 5f54 494d 455d 202a 2032 292c  RENT_TIME] * 2),
-0001a550: 0a20 2020 2020 2020 2028 6e70 2e61 7272  .        (np.arr
-0001a560: 6179 285b 4355 5252 454e 545f 5449 4d45  ay([CURRENT_TIME
-0001a570: 5d20 2a20 3229 2c20 5b43 5552 5245 4e54  ] * 2), [CURRENT
-0001a580: 5f54 494d 455d 202a 2032 292c 0a20 2020  _TIME] * 2),.   
-0001a590: 205d 2c0a 290a 4070 7974 6573 742e 6d61   ],.).@pytest.ma
-0001a5a0: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
-0001a5b0: 2020 2020 226b 7761 7267 7322 2c0a 2020      "kwargs",.  
-0001a5c0: 2020 5b0a 2020 2020 2020 2020 7b22 6665    [.        {"fe
-0001a5d0: 6564 6261 636b 5f6b 6579 7322 3a20 5b22  edback_keys": ["
-0001a5e0: 4122 5d7d 2c0a 2020 2020 2020 2020 7b22  A"]},.        {"
-0001a5f0: 6665 6564 6261 636b 5f69 6473 223a 205b  feedback_ids": [
-0001a600: 2231 3233 3435 222c 2022 3637 3839 3022  "12345", "67890"
-0001a610: 5d7d 2c0a 2020 2020 2020 2020 7b22 6a6f  ]},.        {"jo
-0001a620: 696e 5f6b 6579 7322 3a20 5b22 3534 3332  in_keys": ["5432
-0001a630: 3122 2c20 2236 3738 3930 225d 7d2c 0a20  1", "67890"]},. 
-0001a640: 2020 2020 2020 207b 226a 6f69 6e5f 6b65         {"join_ke
-0001a650: 7973 223a 2070 642e 5365 7269 6573 285b  ys": pd.Series([
-0001a660: 2235 3433 3231 222c 2022 3637 3839 3022  "54321", "67890"
-0001a670: 5d29 7d2c 0a20 2020 205d 2c0a 290a 4070  ])},.    ],.).@p
-0001a680: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
-0001a690: 6574 7269 7a65 280a 2020 2020 2274 6573  etrize(.    "tes
-0001a6a0: 745f 6665 6564 6261 636b 7322 2c0a 2020  t_feedbacks",.  
-0001a6b0: 2020 5b0a 2020 2020 2020 2020 5b7b 2241    [.        [{"A
-0001a6c0: 223a 2032 3030 7d2c 207b 2241 223a 2032  ": 200}, {"A": 2
-0001a6d0: 3031 7d5d 2c0a 2020 2020 2020 2020 7064  01}],.        pd
-0001a6e0: 2e44 6174 6146 7261 6d65 2e66 726f 6d5f  .DataFrame.from_
-0001a6f0: 6469 6374 287b 2241 223a 205b 3230 302c  dict({"A": [200,
-0001a700: 2032 3031 5d7d 292c 0a20 2020 2020 2020   201]}),.       
-0001a710: 2070 642e 5365 7269 6573 286e 616d 653d   pd.Series(name=
-0001a720: 2241 222c 2064 6174 613d 5b32 3030 2c20  "A", data=[200, 
-0001a730: 3230 315d 292c 0a20 2020 2020 2020 206e  201]),.        n
-0001a740: 702e 6172 7261 7928 5b7b 2241 223a 2032  p.array([{"A": 2
-0001a750: 3030 7d2c 207b 2241 223a 2032 3031 7d5d  00}, {"A": 201}]
-0001a760: 292c 0a20 2020 205d 2c0a 290a 4070 7974  ),.    ],.).@pyt
-0001a770: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-0001a780: 7269 7a65 2822 7665 7273 696f 6e22 2c20  rize("version", 
-0001a790: 5b4e 6f6e 652c 2031 302c 2022 312e 322e  [None, 10, "1.2.
-0001a7a0: 3322 5d29 0a40 7079 7465 7374 2e6d 6172  3"]).@pytest.mar
-0001a7b0: 6b2e 7061 7261 6d65 7472 697a 6528 0a20  k.parametrize(. 
-0001a7c0: 2020 2022 7461 6773 2c20 726f 775f 7461     "tags, row_ta
-0001a7d0: 6773 2c20 676c 6f62 616c 5f74 6167 732c  gs, global_tags,
-0001a7e0: 2065 7870 6563 7465 645f 7461 6773 5f70   expected_tags_p
-0001a7f0: 6172 616d 222c 0a20 2020 205b 0a20 2020  aram",.    [.   
-0001a800: 2020 2020 2028 4e6f 6e65 2c20 4e6f 6e65       (None, None
-0001a810: 2c20 4e6f 6e65 2c20 5b7b 2265 6e76 223a  , None, [{"env":
-0001a820: 2022 7465 7374 227d 2c20 7b22 656e 7622   "test"}, {"env"
-0001a830: 3a20 2274 6573 7422 7d5d 292c 0a20 2020  : "test"}]),.   
-0001a840: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
-0001a850: 2020 207b 2262 6172 223a 2022 6261 7222     {"bar": "bar"
-0001a860: 7d2c 0a20 2020 2020 2020 2020 2020 204e  },.            N
-0001a870: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-0001a880: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-0001a890: 2020 205b 7b22 6261 7222 3a20 2262 6172     [{"bar": "bar
-0001a8a0: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
-0001a8b0: 7d2c 207b 2262 6172 223a 2022 6261 7222  }, {"bar": "bar"
-0001a8c0: 2c20 2265 6e76 223a 2022 7465 7374 227d  , "env": "test"}
-0001a8d0: 5d2c 0a20 2020 2020 2020 2029 2c0a 2020  ],.        ),.  
-0001a8e0: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-0001a8f0: 2020 2020 7b22 6261 7222 3a20 2262 6172      {"bar": "bar
-0001a900: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-0001a910: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0001a920: 2020 7b22 666f 6f22 3a20 2266 6f6f 227d    {"foo": "foo"}
-0001a930: 2c0a 2020 2020 2020 2020 2020 2020 5b0a  ,.            [.
-0001a940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a950: 7b22 6261 7222 3a20 2262 6172 222c 2022  {"bar": "bar", "
-0001a960: 656e 7622 3a20 2274 6573 7422 2c20 2266  env": "test", "f
-0001a970: 6f6f 223a 2022 666f 6f22 7d2c 0a20 2020  oo": "foo"},.   
-0001a980: 2020 2020 2020 2020 2020 2020 207b 2262               {"b
-0001a990: 6172 223a 2022 6261 7222 2c20 2265 6e76  ar": "bar", "env
-0001a9a0: 223a 2022 7465 7374 222c 2022 666f 6f22  ": "test", "foo"
-0001a9b0: 3a20 2266 6f6f 227d 2c0a 2020 2020 2020  : "foo"},.      
-0001a9c0: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-0001a9d0: 2029 2c0a 2020 2020 2020 2020 280a 2020   ),.        (.  
-0001a9e0: 2020 2020 2020 2020 2020 5b7b 2262 6172            [{"bar
-0001a9f0: 223a 2022 6261 7222 7d2c 207b 2262 6172  ": "bar"}, {"bar
-0001aa00: 223a 2022 6261 7a22 7d5d 2c0a 2020 2020  ": "baz"}],.    
-0001aa10: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
-0001aa20: 2020 2020 2020 2020 2020 4e6f 6e65 2c0a            None,.
-0001aa30: 2020 2020 2020 2020 2020 2020 5b7b 2262              [{"b
-0001aa40: 6172 223a 2022 6261 7222 2c20 2265 6e76  ar": "bar", "env
-0001aa50: 223a 2022 7465 7374 227d 2c20 7b22 6261  ": "test"}, {"ba
-0001aa60: 7222 3a20 2262 617a 222c 2022 656e 7622  r": "baz", "env"
-0001aa70: 3a20 2274 6573 7422 7d5d 2c0a 2020 2020  : "test"}],.    
-0001aa80: 2020 2020 292c 0a20 2020 2020 2020 2028      ),.        (
-0001aa90: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-0001aaa0: 652c 0a20 2020 2020 2020 2020 2020 205b  e,.            [
-0001aab0: 7b22 6261 7222 3a20 2262 6172 227d 2c20  {"bar": "bar"}, 
-0001aac0: 7b22 6261 7222 3a20 2262 617a 227d 5d2c  {"bar": "baz"}],
-0001aad0: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-0001aae0: 652c 0a20 2020 2020 2020 2020 2020 205b  e,.            [
-0001aaf0: 7b22 6261 7222 3a20 2262 6172 222c 2022  {"bar": "bar", "
-0001ab00: 656e 7622 3a20 2274 6573 7422 7d2c 207b  env": "test"}, {
-0001ab10: 2262 6172 223a 2022 6261 7a22 2c20 2265  "bar": "baz", "e
-0001ab20: 6e76 223a 2022 7465 7374 227d 5d2c 0a20  nv": "test"}],. 
-0001ab30: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-0001ab40: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-0001ab50: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0001ab60: 2020 5b7b 2262 6172 223a 2022 6261 7222    [{"bar": "bar"
-0001ab70: 7d2c 207b 2262 6172 223a 2022 6261 7a22  }, {"bar": "baz"
-0001ab80: 7d5d 2c0a 2020 2020 2020 2020 2020 2020  }],.            
-0001ab90: 7b22 666f 6f22 3a20 2266 6f6f 227d 2c0a  {"foo": "foo"},.
-0001aba0: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-0001abb0: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-0001abc0: 6261 7222 3a20 2262 6172 222c 2022 656e  bar": "bar", "en
-0001abd0: 7622 3a20 2274 6573 7422 2c20 2266 6f6f  v": "test", "foo
-0001abe0: 223a 2022 666f 6f22 7d2c 0a20 2020 2020  ": "foo"},.     
-0001abf0: 2020 2020 2020 2020 2020 207b 2262 6172             {"bar
-0001ac00: 223a 2022 6261 7a22 2c20 2265 6e76 223a  ": "baz", "env":
-0001ac10: 2022 7465 7374 222c 2022 666f 6f22 3a20   "test", "foo": 
-0001ac20: 2266 6f6f 227d 2c0a 2020 2020 2020 2020  "foo"},.        
-0001ac30: 2020 2020 5d2c 0a20 2020 2020 2020 2029      ],.        )
-0001ac40: 2c0a 2020 2020 2020 2020 280a 2020 2020  ,.        (.    
-0001ac50: 2020 2020 2020 2020 7b22 666f 6f22 3a20          {"foo": 
-0001ac60: 2266 6f6f 227d 2c0a 2020 2020 2020 2020  "foo"},.        
-0001ac70: 2020 2020 5b7b 2262 6172 223a 2022 6261      [{"bar": "ba
-0001ac80: 7222 7d2c 207b 2262 6172 223a 2022 6261  r"}, {"bar": "ba
-0001ac90: 7a22 7d5d 2c0a 2020 2020 2020 2020 2020  z"}],.          
-0001aca0: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
-0001acb0: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-0001acc0: 2020 2020 2020 7b22 6261 7222 3a20 2262        {"bar": "b
-0001acd0: 6172 222c 2022 656e 7622 3a20 2274 6573  ar", "env": "tes
-0001ace0: 7422 2c20 2266 6f6f 223a 2022 666f 6f22  t", "foo": "foo"
-0001acf0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-0001ad00: 2020 207b 2262 6172 223a 2022 6261 7a22     {"bar": "baz"
-0001ad10: 2c20 2265 6e76 223a 2022 7465 7374 222c  , "env": "test",
-0001ad20: 2022 666f 6f22 3a20 2266 6f6f 227d 2c0a   "foo": "foo"},.
-0001ad30: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-0001ad40: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-0001ad50: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-0001ad60: 7b22 6261 7222 3a20 2262 6172 227d 2c0a  {"bar": "bar"},.
-0001ad70: 2020 2020 2020 2020 2020 2020 5b7b 2266              [{"f
-0001ad80: 6f6f 223a 2022 666f 6f22 7d2c 207b 2262  oo": "foo"}, {"b
-0001ad90: 617a 223a 2022 6261 7a22 7d5d 2c0a 2020  az": "baz"}],.  
-0001ada0: 2020 2020 2020 2020 2020 7b22 656e 7622            {"env"
-0001adb0: 3a20 2266 6f6f 6261 7222 7d2c 0a20 2020  : "foobar"},.   
-0001adc0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
-0001add0: 2020 2020 2020 2020 2020 207b 2262 6172             {"bar
-0001ade0: 223a 2022 6261 7222 2c20 2265 6e76 223a  ": "bar", "env":
-0001adf0: 2022 666f 6f62 6172 222c 2022 666f 6f22   "foobar", "foo"
-0001ae00: 3a20 2266 6f6f 227d 2c0a 2020 2020 2020  : "foo"},.      
-0001ae10: 2020 2020 2020 2020 2020 7b22 6261 7222            {"bar"
-0001ae20: 3a20 2262 6172 222c 2022 656e 7622 3a20  : "bar", "env": 
-0001ae30: 2266 6f6f 6261 7222 2c20 2262 617a 223a  "foobar", "baz":
-0001ae40: 2022 6261 7a22 7d2c 0a20 2020 2020 2020   "baz"},.       
-0001ae50: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-0001ae60: 292c 0a20 2020 2020 2020 2028 0a20 2020  ),.        (.   
-0001ae70: 2020 2020 2020 2020 204e 6f6e 652c 0a20           None,. 
-0001ae80: 2020 2020 2020 2020 2020 205b 7b22 6261             [{"ba
-0001ae90: 7222 3a20 2262 6172 227d 2c20 7b22 6261  r": "bar"}, {"ba
-0001aea0: 7222 3a20 2262 617a 227d 5d2c 0a20 2020  r": "baz"}],.   
-0001aeb0: 2020 2020 2020 2020 204e 6f6e 652c 0a20           None,. 
-0001aec0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
-0001aed0: 2020 2020 2020 2020 2020 2020 207b 2262               {"b
-0001aee0: 6172 223a 2022 6261 7222 2c20 2265 6e76  ar": "bar", "env
-0001aef0: 223a 2022 7465 7374 227d 2c0a 2020 2020  ": "test"},.    
-0001af00: 2020 2020 2020 2020 2020 2020 7b22 6261              {"ba
-0001af10: 7222 3a20 2262 617a 222c 2022 656e 7622  r": "baz", "env"
-0001af20: 3a20 2274 6573 7422 7d2c 0a20 2020 2020  : "test"},.     
-0001af30: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-0001af40: 2020 292c 0a20 2020 2020 2020 2028 0a20    ),.        (. 
-0001af50: 2020 2020 2020 2020 2020 204e 6f6e 652c             None,
-0001af60: 0a20 2020 2020 2020 2020 2020 206e 702e  .            np.
-0001af70: 6172 7261 7928 5b7b 2262 6172 223a 2022  array([{"bar": "
-0001af80: 6261 7222 7d2c 207b 2262 6172 223a 2022  bar"}, {"bar": "
-0001af90: 6261 7a22 7d5d 292c 0a20 2020 2020 2020  baz"}]),.       
-0001afa0: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
-0001afb0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-0001afc0: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-0001afd0: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
-0001afe0: 7465 7374 227d 2c0a 2020 2020 2020 2020  test"},.        
-0001aff0: 2020 2020 2020 2020 7b22 6261 7222 3a20          {"bar": 
-0001b000: 2262 617a 222c 2022 656e 7622 3a20 2274  "baz", "env": "t
-0001b010: 6573 7422 7d2c 0a20 2020 2020 2020 2020  est"},.         
-0001b020: 2020 205d 2c0a 2020 2020 2020 2020 292c     ],.        ),
-0001b030: 0a20 2020 2020 2020 2028 0a20 2020 2020  .        (.     
-0001b040: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
-0001b050: 2020 2020 2020 2020 2070 642e 5365 7269           pd.Seri
-0001b060: 6573 285b 2262 6172 222c 2022 6261 7a22  es(["bar", "baz"
-0001b070: 5d2c 206e 616d 653d 2262 6172 2229 2c0a  ], name="bar"),.
-0001b080: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-0001b090: 2c0a 2020 2020 2020 2020 2020 2020 5b0a  ,.            [.
-0001b0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b0b0: 7b22 6261 7222 3a20 2262 6172 222c 2022  {"bar": "bar", "
-0001b0c0: 656e 7622 3a20 2274 6573 7422 7d2c 0a20  env": "test"},. 
-0001b0d0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0001b0e0: 2262 6172 223a 2022 6261 7a22 2c20 2265  "bar": "baz", "e
-0001b0f0: 6e76 223a 2022 7465 7374 227d 2c0a 2020  nv": "test"},.  
-0001b100: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-0001b110: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-0001b120: 280a 2020 2020 2020 2020 2020 2020 4e6f  (.            No
-0001b130: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0001b140: 7064 2e44 6174 6146 7261 6d65 287b 2262  pd.DataFrame({"b
-0001b150: 6172 223a 205b 2262 6172 222c 2022 6261  ar": ["bar", "ba
-0001b160: 7a22 5d7d 292c 0a20 2020 2020 2020 2020  z"]}),.         
-0001b170: 2020 204e 6f6e 652c 0a20 2020 2020 2020     None,.       
-0001b180: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-0001b190: 2020 2020 2020 207b 2262 6172 223a 2022         {"bar": "
-0001b1a0: 6261 7222 2c20 2265 6e76 223a 2022 7465  bar", "env": "te
-0001b1b0: 7374 227d 2c0a 2020 2020 2020 2020 2020  st"},.          
-0001b1c0: 2020 2020 2020 7b22 6261 7222 3a20 2262        {"bar": "b
-0001b1d0: 617a 222c 2022 656e 7622 3a20 2274 6573  az", "env": "tes
-0001b1e0: 7422 7d2c 0a20 2020 2020 2020 2020 2020  t"},.           
-0001b1f0: 205d 2c0a 2020 2020 2020 2020 292c 0a20   ],.        ),. 
-0001b200: 2020 205d 2c0a 290a 406d 6f63 6b2e 7061     ],.).@mock.pa
-0001b210: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
-0001b220: 6572 2e63 6c69 656e 742e 5f72 6573 6f6c  er.client._resol
-0001b230: 7665 5f6a 6f69 6e5f 6b65 7973 222c 2072  ve_join_keys", r
-0001b240: 6574 7572 6e5f 7661 6c75 653d 5b22 3132  eturn_value=["12
-0001b250: 3334 3522 2c20 2235 3433 3231 225d 290a  345", "54321"]).
-0001b260: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
-0001b270: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
-0001b280: 742e 4761 6e74 7279 2e5f 6c6f 675f 7072  t.Gantry._log_pr
-0001b290: 6564 6963 7469 6f6e 5f61 6e64 5f66 6565  ediction_and_fee
-0001b2a0: 6462 6163 6b5f 6576 656e 7473 2229 0a40  dback_events").@
-0001b2b0: 6d6f 636b 2e70 6174 6368 2822 6761 6e74  mock.patch("gant
-0001b2c0: 7279 2e6c 6f67 6765 722e 636c 6965 6e74  ry.logger.client
-0001b2d0: 2e47 616e 7472 792e 5f6c 6f67 5f70 7265  .Gantry._log_pre
-0001b2e0: 6469 6374 696f 6e5f 6576 656e 7473 2229  diction_events")
-0001b2f0: 0a40 6d6f 636b 2e70 6174 6368 280a 2020  .@mock.patch(.  
-0001b300: 2020 2267 616e 7472 792e 6c6f 6767 6572    "gantry.logger
-0001b310: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
-0001b320: 6c6f 675f 6665 6564 6261 636b 5f65 7665  log_feedback_eve
-0001b330: 6e74 7322 2c20 7265 7475 726e 5f76 616c  nts", return_val
-0001b340: 7565 3d28 4e6f 6e65 2c20 5b22 3132 3334  ue=(None, ["1234
-0001b350: 3522 2c20 2236 3738 3930 225d 290a 290a  5", "67890"]).).
-0001b360: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
-0001b370: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
-0001b380: 742e 5f73 616d 706c 655f 7265 636f 7264  t._sample_record
-0001b390: 7322 2c20 7369 6465 5f65 6666 6563 743d  s", side_effect=
-0001b3a0: 636c 6965 6e74 2e5f 7361 6d70 6c65 5f72  client._sample_r
-0001b3b0: 6563 6f72 6473 290a 6465 6620 7465 7374  ecords).def test
-0001b3c0: 5f73 696e 676c 655f 6c6f 675f 7265 636f  _single_log_reco
-0001b3d0: 7264 735f 6665 6564 6261 636b 5f6f 6e6c  rds_feedback_onl
-0001b3e0: 7928 0a20 2020 206d 6f63 6b5f 7361 6d70  y(.    mock_samp
-0001b3f0: 6c65 5f72 6563 6f72 6473 2c0a 2020 2020  le_records,.    
-0001b400: 6d6f 636b 5f66 6565 6462 6163 6b2c 0a20  mock_feedback,. 
-0001b410: 2020 206d 6f63 6b5f 7072 6564 732c 0a20     mock_preds,. 
-0001b420: 2020 206d 6f63 6b5f 7072 6564 735f 616e     mock_preds_an
-0001b430: 645f 6665 6564 6261 636b 2c0a 2020 2020  d_feedback,.    
-0001b440: 6d6f 636b 5f72 6573 6f6c 7665 5f6a 6f69  mock_resolve_joi
-0001b450: 6e5f 6b65 7973 2c0a 2020 2020 7665 7273  n_keys,.    vers
-0001b460: 696f 6e2c 0a20 2020 2074 6167 732c 0a20  ion,.    tags,. 
-0001b470: 2020 2072 6f77 5f74 6167 732c 0a20 2020     row_tags,.   
-0001b480: 2067 6c6f 6261 6c5f 7461 6773 2c0a 2020   global_tags,.  
-0001b490: 2020 6578 7065 6374 6564 5f74 6167 735f    expected_tags_
-0001b4a0: 7061 7261 6d2c 0a20 2020 2074 6573 745f  param,.    test_
-0001b4b0: 6665 6564 6261 636b 732c 0a20 2020 2074  feedbacks,.    t
-0001b4c0: 6573 745f 7469 6d65 7374 616d 7073 2c0a  est_timestamps,.
-0001b4d0: 2020 2020 7465 7374 5f74 696d 6573 7461      test_timesta
-0001b4e0: 6d70 735f 6c69 7374 2c0a 2020 2020 6b77  mps_list,.    kw
-0001b4f0: 6172 6773 2c0a 2020 2020 636c 695f 6f62  args,.    cli_ob
-0001b500: 6a2c 0a29 3a0a 2020 2020 6173 7365 7274  j,.):.    assert
-0001b510: 2063 6c69 5f6f 626a 2e73 696e 676c 655f   cli_obj.single_
-0001b520: 6c6f 675f 7265 636f 7264 7328 0a20 2020  log_records(.   
-0001b530: 2020 2020 2061 7070 6c69 6361 7469 6f6e       application
-0001b540: 3d22 666f 6f62 6172 222c 0a20 2020 2020  ="foobar",.     
-0001b550: 2020 2076 6572 7369 6f6e 3d76 6572 7369     version=versi
-0001b560: 6f6e 2c0a 2020 2020 2020 2020 696e 7075  on,.        inpu
-0001b570: 7473 3d4e 6f6e 652c 0a20 2020 2020 2020  ts=None,.       
-0001b580: 206f 7574 7075 7473 3d4e 6f6e 652c 0a20   outputs=None,. 
-0001b590: 2020 2020 2020 2066 6565 6462 6163 6b73         feedbacks
-0001b5a0: 3d74 6573 745f 6665 6564 6261 636b 732c  =test_feedbacks,
-0001b5b0: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
-0001b5c0: 6d70 733d 7465 7374 5f74 696d 6573 7461  mps=test_timesta
-0001b5d0: 6d70 732c 0a20 2020 2020 2020 2073 6f72  mps,.        sor
-0001b5e0: 745f 6f6e 5f74 696d 6573 7461 6d70 3d54  t_on_timestamp=T
-0001b5f0: 7275 652c 0a20 2020 2020 2020 2074 6167  rue,.        tag
-0001b600: 733d 7461 6773 2c0a 2020 2020 2020 2020  s=tags,.        
-0001b610: 726f 775f 7461 6773 3d72 6f77 5f74 6167  row_tags=row_tag
-0001b620: 732c 0a20 2020 2020 2020 2067 6c6f 6261  s,.        globa
-0001b630: 6c5f 7461 6773 3d67 6c6f 6261 6c5f 7461  l_tags=global_ta
-0001b640: 6773 2c0a 2020 2020 2020 2020 2a2a 6b77  gs,.        **kw
-0001b650: 6172 6773 2c0a 2020 2020 2920 3d3d 2028  args,.    ) == (
-0001b660: 4e6f 6e65 2c20 5b22 3132 3334 3522 2c20  None, ["12345", 
-0001b670: 2236 3738 3930 225d 290a 0a20 2020 206d  "67890"])..    m
-0001b680: 6f63 6b5f 7072 6564 735f 616e 645f 6665  ock_preds_and_fe
-0001b690: 6564 6261 636b 2e61 7373 6572 745f 6e6f  edback.assert_no
-0001b6a0: 745f 6361 6c6c 6564 2829 0a20 2020 206d  t_called().    m
-0001b6b0: 6f63 6b5f 7072 6564 732e 6173 7365 7274  ock_preds.assert
-0001b6c0: 5f6e 6f74 5f63 616c 6c65 6428 290a 2020  _not_called().  
-0001b6d0: 2020 6d6f 636b 5f66 6565 6462 6163 6b2e    mock_feedback.
-0001b6e0: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-0001b6f0: 6365 5f77 6974 6828 0a20 2020 2020 2020  ce_with(.       
-0001b700: 2061 7070 6c69 6361 7469 6f6e 3d22 666f   application="fo
-0001b710: 6f62 6172 222c 0a20 2020 2020 2020 2066  obar",.        f
-0001b720: 6565 6462 6163 6b73 3d5b 7b22 4122 3a20  eedbacks=[{"A": 
-0001b730: 3230 307d 2c20 7b22 4122 3a20 3230 317d  200}, {"A": 201}
-0001b740: 5d2c 0a20 2020 2020 2020 206a 6f69 6e5f  ],.        join_
-0001b750: 6b65 7973 3d5b 2231 3233 3435 222c 2022  keys=["12345", "
-0001b760: 3534 3332 3122 5d2c 0a20 2020 2020 2020  54321"],.       
-0001b770: 2066 6565 6462 6163 6b5f 7665 7273 696f   feedback_versio
-0001b780: 6e3d 7665 7273 696f 6e2c 0a20 2020 2020  n=version,.     
-0001b790: 2020 2074 696d 6573 7461 6d70 733d 7465     timestamps=te
-0001b7a0: 7374 5f74 696d 6573 7461 6d70 735f 6c69  st_timestamps_li
-0001b7b0: 7374 2c0a 2020 2020 2020 2020 736f 7274  st,.        sort
-0001b7c0: 5f6f 6e5f 7469 6d65 7374 616d 703d 5472  _on_timestamp=Tr
-0001b7d0: 7565 2c0a 2020 2020 2020 2020 6173 5f62  ue,.        as_b
-0001b7e0: 6174 6368 3d46 616c 7365 2c0a 2020 2020  atch=False,.    
-0001b7f0: 2020 2020 7461 6773 3d65 7870 6563 7465      tags=expecte
-0001b800: 645f 7461 6773 5f70 6172 616d 2c0a 2020  d_tags_param,.  
-0001b810: 2020 290a 0a20 2020 206d 6f63 6b5f 7361    )..    mock_sa
-0001b820: 6d70 6c65 5f72 6563 6f72 6473 2e61 7373  mple_records.ass
-0001b830: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
-0001b840: 7769 7468 280a 2020 2020 2020 2020 322c  with(.        2,
-0001b850: 0a20 2020 2020 2020 2031 2c0a 2020 2020  .        1,.    
-0001b860: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
-0001b870: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
-0001b880: 5b7b 2241 223a 2032 3030 7d2c 207b 2241  [{"A": 200}, {"A
-0001b890: 223a 2032 3031 7d5d 2c0a 2020 2020 2020  ": 201}],.      
-0001b8a0: 2020 636c 6965 6e74 2e5f 7265 736f 6c76    client._resolv
-0001b8b0: 655f 6a6f 696e 5f6b 6579 7328 2a2a 6b77  e_join_keys(**kw
-0001b8c0: 6172 6773 292c 0a20 2020 2020 2020 2074  args),.        t
-0001b8d0: 6573 745f 7469 6d65 7374 616d 7073 5f6c  est_timestamps_l
-0001b8e0: 6973 742c 0a20 2020 2020 2020 2065 7870  ist,.        exp
-0001b8f0: 6563 7465 645f 7461 6773 5f70 6172 616d  ected_tags_param
-0001b900: 2c0a 2020 2020 290a 0a0a 4070 7974 6573  ,.    )...@pytes
-0001b910: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
-0001b920: 7a65 280a 2020 2020 2274 6573 745f 7469  ze(.    "test_ti
-0001b930: 6d65 7374 616d 7073 2c20 7465 7374 5f74  mestamps, test_t
-0001b940: 696d 6573 7461 6d70 735f 6c69 7374 222c  imestamps_list",
-0001b950: 0a20 2020 205b 0a20 2020 2020 2020 2028  .    [.        (
-0001b960: 4e6f 6e65 2c20 4e6f 6e65 292c 0a20 2020  None, None),.   
-0001b970: 2020 2020 2028 5b43 5552 5245 4e54 5f54       ([CURRENT_T
-0001b980: 494d 455d 202a 2032 2c20 5b43 5552 5245  IME] * 2, [CURRE
-0001b990: 4e54 5f54 494d 455d 202a 2032 292c 0a20  NT_TIME] * 2),. 
-0001b9a0: 2020 2020 2020 2028 6e70 2e61 7272 6179         (np.array
-0001b9b0: 285b 4355 5252 454e 545f 5449 4d45 5d20  ([CURRENT_TIME] 
-0001b9c0: 2a20 3229 2c20 5b43 5552 5245 4e54 5f54  * 2), [CURRENT_T
-0001b9d0: 494d 455d 202a 2032 292c 0a20 2020 205d  IME] * 2),.    ]
-0001b9e0: 2c0a 290a 4070 7974 6573 742e 6d61 726b  ,.).@pytest.mark
-0001b9f0: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
-0001ba00: 2020 226b 7761 7267 7322 2c0a 2020 2020    "kwargs",.    
-0001ba10: 5b0a 2020 2020 2020 2020 7b22 6a6f 696e  [.        {"join
-0001ba20: 5f6b 6579 7322 3a20 5b22 3534 3332 3122  _keys": ["54321"
-0001ba30: 2c20 2236 3738 3930 225d 7d2c 0a20 2020  , "67890"]},.   
-0001ba40: 2020 2020 207b 226a 6f69 6e5f 6b65 7973       {"join_keys
-0001ba50: 223a 2070 642e 5365 7269 6573 285b 2235  ": pd.Series(["5
-0001ba60: 3433 3231 222c 2022 3637 3839 3022 5d29  4321", "67890"])
-0001ba70: 7d2c 0a20 2020 205d 2c0a 290a 4070 7974  },.    ],.).@pyt
-0001ba80: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-0001ba90: 7269 7a65 280a 2020 2020 2274 6573 745f  rize(.    "test_
-0001baa0: 6665 6564 6261 636b 7322 2c0a 2020 2020  feedbacks",.    
-0001bab0: 5b0a 2020 2020 2020 2020 5b7b 2241 223a  [.        [{"A":
-0001bac0: 2032 3030 7d2c 207b 2241 223a 2032 3031   200}, {"A": 201
-0001bad0: 7d5d 2c0a 2020 2020 2020 2020 7064 2e44  }],.        pd.D
-0001bae0: 6174 6146 7261 6d65 2e66 726f 6d5f 6469  ataFrame.from_di
-0001baf0: 6374 287b 2241 223a 205b 3230 302c 2032  ct({"A": [200, 2
-0001bb00: 3031 5d7d 292c 0a20 2020 2020 2020 2070  01]}),.        p
-0001bb10: 642e 5365 7269 6573 286e 616d 653d 2241  d.Series(name="A
-0001bb20: 222c 2064 6174 613d 5b32 3030 2c20 3230  ", data=[200, 20
-0001bb30: 315d 292c 0a20 2020 2020 2020 206e 702e  1]),.        np.
-0001bb40: 6172 7261 7928 5b7b 2241 223a 2032 3030  array([{"A": 200
-0001bb50: 7d2c 207b 2241 223a 2032 3031 7d5d 292c  }, {"A": 201}]),
-0001bb60: 0a20 2020 205d 2c0a 290a 4070 7974 6573  .    ],.).@pytes
-0001bb70: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
-0001bb80: 7a65 2822 7665 7273 696f 6e22 2c20 5b4e  ze("version", [N
-0001bb90: 6f6e 652c 2031 302c 2022 312e 322e 3322  one, 10, "1.2.3"
-0001bba0: 5d29 0a40 7079 7465 7374 2e6d 6172 6b2e  ]).@pytest.mark.
-0001bbb0: 7061 7261 6d65 7472 697a 6528 0a20 2020  parametrize(.   
-0001bbc0: 2022 7461 6773 2c20 726f 775f 7461 6773   "tags, row_tags
-0001bbd0: 2c20 676c 6f62 616c 5f74 6167 732c 2065  , global_tags, e
-0001bbe0: 7870 6563 7465 645f 7461 6773 5f70 6172  xpected_tags_par
-0001bbf0: 616d 222c 0a20 2020 205b 0a20 2020 2020  am",.    [.     
-0001bc00: 2020 2028 4e6f 6e65 2c20 4e6f 6e65 2c20     (None, None, 
-0001bc10: 4e6f 6e65 2c20 5b7b 2265 6e76 223a 2022  None, [{"env": "
-0001bc20: 7465 7374 227d 2c20 7b22 656e 7622 3a20  test"}, {"env": 
-0001bc30: 2274 6573 7422 7d5d 292c 0a20 2020 2020  "test"}]),.     
-0001bc40: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
-0001bc50: 207b 2262 6172 223a 2022 6261 7222 7d2c   {"bar": "bar"},
-0001bc60: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-0001bc70: 652c 0a20 2020 2020 2020 2020 2020 204e  e,.            N
-0001bc80: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-0001bc90: 205b 7b22 6261 7222 3a20 2262 6172 222c   [{"bar": "bar",
-0001bca0: 2022 656e 7622 3a20 2274 6573 7422 7d2c   "env": "test"},
-0001bcb0: 207b 2262 6172 223a 2022 6261 7222 2c20   {"bar": "bar", 
-0001bcc0: 2265 6e76 223a 2022 7465 7374 227d 5d2c  "env": "test"}],
-0001bcd0: 0a20 2020 2020 2020 2029 2c0a 2020 2020  .        ),.    
-0001bce0: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
-0001bcf0: 2020 7b22 6261 7222 3a20 2262 6172 227d    {"bar": "bar"}
-0001bd00: 2c0a 2020 2020 2020 2020 2020 2020 4e6f  ,.            No
-0001bd10: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0001bd20: 7b22 666f 6f22 3a20 2266 6f6f 227d 2c0a  {"foo": "foo"},.
-0001bd30: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-0001bd40: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-0001bd50: 6261 7222 3a20 2262 6172 222c 2022 656e  bar": "bar", "en
-0001bd60: 7622 3a20 2274 6573 7422 2c20 2266 6f6f  v": "test", "foo
-0001bd70: 223a 2022 666f 6f22 7d2c 0a20 2020 2020  ": "foo"},.     
-0001bd80: 2020 2020 2020 2020 2020 207b 2262 6172             {"bar
-0001bd90: 223a 2022 6261 7222 2c20 2265 6e76 223a  ": "bar", "env":
-0001bda0: 2022 7465 7374 222c 2022 666f 6f22 3a20   "test", "foo": 
-0001bdb0: 2266 6f6f 227d 2c0a 2020 2020 2020 2020  "foo"},.        
-0001bdc0: 2020 2020 5d2c 0a20 2020 2020 2020 2029      ],.        )
-0001bdd0: 2c0a 2020 2020 2020 2020 280a 2020 2020  ,.        (.    
-0001bde0: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
-0001bdf0: 2020 2020 2020 2020 2020 5b7b 2262 6172            [{"bar
-0001be00: 223a 2022 6261 7222 7d2c 207b 2262 6172  ": "bar"}, {"bar
-0001be10: 223a 2022 6261 7a22 7d5d 2c0a 2020 2020  ": "baz"}],.    
-0001be20: 2020 2020 2020 2020 4e6f 6e65 2c0a 2020          None,.  
-0001be30: 2020 2020 2020 2020 2020 5b7b 2262 6172            [{"bar
-0001be40: 223a 2022 6261 7222 2c20 2265 6e76 223a  ": "bar", "env":
-0001be50: 2022 7465 7374 227d 2c20 7b22 6261 7222   "test"}, {"bar"
-0001be60: 3a20 2262 617a 222c 2022 656e 7622 3a20  : "baz", "env": 
-0001be70: 2274 6573 7422 7d5d 2c0a 2020 2020 2020  "test"}],.      
-0001be80: 2020 292c 0a20 2020 2020 2020 2028 0a20    ),.        (. 
-0001be90: 2020 2020 2020 2020 2020 204e 6f6e 652c             None,
-0001bea0: 0a20 2020 2020 2020 2020 2020 205b 7b22  .            [{"
-0001beb0: 6261 7222 3a20 2262 6172 227d 2c20 7b22  bar": "bar"}, {"
-0001bec0: 6261 7222 3a20 2262 617a 227d 5d2c 0a20  bar": "baz"}],. 
-0001bed0: 2020 2020 2020 2020 2020 207b 2266 6f6f             {"foo
-0001bee0: 223a 2022 666f 6f22 7d2c 0a20 2020 2020  ": "foo"},.     
-0001bef0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-0001bf00: 2020 2020 2020 2020 207b 2262 6172 223a           {"bar":
-0001bf10: 2022 6261 7222 2c20 2265 6e76 223a 2022   "bar", "env": "
-0001bf20: 7465 7374 222c 2022 666f 6f22 3a20 2266  test", "foo": "f
-0001bf30: 6f6f 227d 2c0a 2020 2020 2020 2020 2020  oo"},.          
-0001bf40: 2020 2020 2020 7b22 6261 7222 3a20 2262        {"bar": "b
-0001bf50: 617a 222c 2022 656e 7622 3a20 2274 6573  az", "env": "tes
-0001bf60: 7422 2c20 2266 6f6f 223a 2022 666f 6f22  t", "foo": "foo"
-0001bf70: 7d2c 0a20 2020 2020 2020 2020 2020 205d  },.            ]
-0001bf80: 2c0a 2020 2020 2020 2020 292c 0a20 2020  ,.        ),.   
-0001bf90: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
-0001bfa0: 2020 207b 2266 6f6f 223a 2022 666f 6f22     {"foo": "foo"
-0001bfb0: 7d2c 0a20 2020 2020 2020 2020 2020 205b  },.            [
-0001bfc0: 7b22 6261 7222 3a20 2262 6172 227d 2c20  {"bar": "bar"}, 
-0001bfd0: 7b22 6261 7222 3a20 2262 617a 227d 5d2c  {"bar": "baz"}],
-0001bfe0: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-0001bff0: 652c 0a20 2020 2020 2020 2020 2020 205b  e,.            [
-0001c000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c010: 207b 2262 6172 223a 2022 6261 7222 2c20   {"bar": "bar", 
-0001c020: 2265 6e76 223a 2022 7465 7374 222c 2022  "env": "test", "
-0001c030: 666f 6f22 3a20 2266 6f6f 227d 2c0a 2020  foo": "foo"},.  
-0001c040: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-0001c050: 6261 7222 3a20 2262 617a 222c 2022 656e  bar": "baz", "en
-0001c060: 7622 3a20 2274 6573 7422 2c20 2266 6f6f  v": "test", "foo
-0001c070: 223a 2022 666f 6f22 7d2c 0a20 2020 2020  ": "foo"},.     
-0001c080: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-0001c090: 2020 292c 0a20 2020 2020 2020 2028 0a20    ),.        (. 
-0001c0a0: 2020 2020 2020 2020 2020 207b 2262 6172             {"bar
-0001c0b0: 223a 2022 6261 7222 7d2c 0a20 2020 2020  ": "bar"},.     
-0001c0c0: 2020 2020 2020 205b 7b22 666f 6f22 3a20         [{"foo": 
-0001c0d0: 2266 6f6f 227d 2c20 7b22 6261 7a22 3a20  "foo"}, {"baz": 
-0001c0e0: 2262 617a 227d 5d2c 0a20 2020 2020 2020  "baz"}],.       
-0001c0f0: 2020 2020 207b 2265 6e76 223a 2022 666f       {"env": "fo
-0001c100: 6f62 6172 227d 2c0a 2020 2020 2020 2020  obar"},.        
-0001c110: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-0001c120: 2020 2020 2020 7b22 6261 7222 3a20 2262        {"bar": "b
-0001c130: 6172 222c 2022 656e 7622 3a20 2266 6f6f  ar", "env": "foo
-0001c140: 6261 7222 2c20 2266 6f6f 223a 2022 666f  bar", "foo": "fo
-0001c150: 6f22 7d2c 0a20 2020 2020 2020 2020 2020  o"},.           
-0001c160: 2020 2020 207b 2262 6172 223a 2022 6261       {"bar": "ba
-0001c170: 7222 2c20 2265 6e76 223a 2022 666f 6f62  r", "env": "foob
-0001c180: 6172 222c 2022 6261 7a22 3a20 2262 617a  ar", "baz": "baz
-0001c190: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-0001c1a0: 5d2c 0a20 2020 2020 2020 2029 2c0a 2020  ],.        ),.  
-0001c1b0: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-0001c1c0: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
-0001c1d0: 2020 2020 2020 5b7b 2262 6172 223a 2022        [{"bar": "
-0001c1e0: 6261 7222 7d2c 207b 2262 6172 223a 2022  bar"}, {"bar": "
-0001c1f0: 6261 7a22 7d5d 2c0a 2020 2020 2020 2020  baz"}],.        
-0001c200: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
-0001c210: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
-0001c220: 2020 2020 2020 2020 7b22 6261 7222 3a20          {"bar": 
-0001c230: 2262 6172 222c 2022 656e 7622 3a20 2274  "bar", "env": "t
-0001c240: 6573 7422 7d2c 0a20 2020 2020 2020 2020  est"},.         
-0001c250: 2020 2020 2020 207b 2262 6172 223a 2022         {"bar": "
-0001c260: 6261 7a22 2c20 2265 6e76 223a 2022 7465  baz", "env": "te
-0001c270: 7374 227d 2c0a 2020 2020 2020 2020 2020  st"},.          
-0001c280: 2020 5d2c 0a20 2020 2020 2020 2029 2c0a    ],.        ),.
-0001c290: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
-0001c2a0: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-0001c2b0: 2020 2020 2020 2020 6e70 2e61 7272 6179          np.array
-0001c2c0: 285b 7b22 6261 7222 3a20 2262 6172 227d  ([{"bar": "bar"}
-0001c2d0: 2c20 7b22 6261 7222 3a20 2262 617a 227d  , {"bar": "baz"}
-0001c2e0: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
-0001c2f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0001c300: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-0001c310: 2020 2020 7b22 6261 7222 3a20 2262 6172      {"bar": "bar
-0001c320: 222c 2022 656e 7622 3a20 2274 6573 7422  ", "env": "test"
-0001c330: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-0001c340: 2020 207b 2262 6172 223a 2022 6261 7a22     {"bar": "baz"
-0001c350: 2c20 2265 6e76 223a 2022 7465 7374 227d  , "env": "test"}
-0001c360: 2c0a 2020 2020 2020 2020 2020 2020 5d2c  ,.            ],
-0001c370: 0a20 2020 2020 2020 2029 2c0a 2020 2020  .        ),.    
-0001c380: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
-0001c390: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
-0001c3a0: 2020 2020 7064 2e53 6572 6965 7328 5b22      pd.Series(["
-0001c3b0: 6261 7222 2c20 2262 617a 225d 2c20 6e61  bar", "baz"], na
-0001c3c0: 6d65 3d22 6261 7222 292c 0a20 2020 2020  me="bar"),.     
-0001c3d0: 2020 2020 2020 204e 6f6e 652c 0a20 2020         None,.   
-0001c3e0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
-0001c3f0: 2020 2020 2020 2020 2020 207b 2262 6172             {"bar
-0001c400: 223a 2022 6261 7222 2c20 2265 6e76 223a  ": "bar", "env":
-0001c410: 2022 7465 7374 227d 2c0a 2020 2020 2020   "test"},.      
-0001c420: 2020 2020 2020 2020 2020 7b22 6261 7222            {"bar"
-0001c430: 3a20 2262 617a 222c 2022 656e 7622 3a20  : "baz", "env": 
-0001c440: 2274 6573 7422 7d2c 0a20 2020 2020 2020  "test"},.       
-0001c450: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-0001c460: 292c 0a20 2020 2020 2020 2028 0a20 2020  ),.        (.   
-0001c470: 2020 2020 2020 2020 204e 6f6e 652c 0a20           None,. 
-0001c480: 2020 2020 2020 2020 2020 2070 642e 4461             pd.Da
-0001c490: 7461 4672 616d 6528 7b22 6261 7222 3a20  taFrame({"bar": 
-0001c4a0: 5b22 6261 7222 2c20 2262 617a 225d 7d29  ["bar", "baz"]})
-0001c4b0: 2c0a 2020 2020 2020 2020 2020 2020 4e6f  ,.            No
-0001c4c0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0001c4d0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0001c4e0: 2020 7b22 6261 7222 3a20 2262 6172 222c    {"bar": "bar",
-0001c4f0: 2022 656e 7622 3a20 2274 6573 7422 7d2c   "env": "test"},
-0001c500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c510: 207b 2262 6172 223a 2022 6261 7a22 2c20   {"bar": "baz", 
-0001c520: 2265 6e76 223a 2022 7465 7374 227d 2c0a  "env": "test"},.
-0001c530: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-0001c540: 2020 2020 2020 2029 2c0a 2020 2020 5d2c         ),.    ],
-0001c550: 0a29 0a40 6d6f 636b 2e70 6174 6368 2822  .).@mock.patch("
-0001c560: 6761 6e74 7279 2e6c 6f67 6765 722e 636c  gantry.logger.cl
-0001c570: 6965 6e74 2e5f 7265 736f 6c76 655f 6a6f  ient._resolve_jo
-0001c580: 696e 5f6b 6579 7322 2c20 7265 7475 726e  in_keys", return
-0001c590: 5f76 616c 7565 3d5b 2231 3233 3435 222c  _value=["12345",
-0001c5a0: 2022 3534 3332 3122 5d29 0a40 6d6f 636b   "54321"]).@mock
-0001c5b0: 2e70 6174 6368 2822 6761 6e74 7279 2e6c  .patch("gantry.l
-0001c5c0: 6f67 6765 722e 636c 6965 6e74 2e47 616e  ogger.client.Gan
-0001c5d0: 7472 792e 5f67 656e 6572 6174 655f 7072  try._generate_pr
-0001c5e0: 6564 6963 7469 6f6e 5f61 6e64 5f66 6565  ediction_and_fee
-0001c5f0: 6462 6163 6b5f 6576 656e 7473 2229 0a40  dback_events").@
-0001c600: 6d6f 636b 2e70 6174 6368 2822 6761 6e74  mock.patch("gant
-0001c610: 7279 2e6c 6f67 6765 722e 636c 6965 6e74  ry.logger.client
-0001c620: 2e47 616e 7472 792e 5f67 656e 6572 6174  .Gantry._generat
-0001c630: 655f 7072 6564 6963 7469 6f6e 5f65 7665  e_prediction_eve
-0001c640: 6e74 7322 290a 406d 6f63 6b2e 7061 7463  nts").@mock.patc
-0001c650: 6828 0a20 2020 2022 6761 6e74 7279 2e6c  h(.    "gantry.l
-0001c660: 6f67 6765 722e 636c 6965 6e74 2e47 616e  ogger.client.Gan
-0001c670: 7472 792e 5f67 656e 6572 6174 655f 6665  try._generate_fe
-0001c680: 6564 6261 636b 5f65 7665 6e74 7322 2c0a  edback_events",.
-0001c690: 2020 2020 7265 7475 726e 5f76 616c 7565      return_value
-0001c6a0: 3d28 5b7b 2265 7665 6e74 223a 2022 706c  =([{"event": "pl
-0001c6b0: 6163 655f 686f 6c64 6572 227d 5d2c 205b  ace_holder"}], [
-0001c6c0: 2231 3233 3435 222c 2022 3637 3839 3022  "12345", "67890"
-0001c6d0: 5d29 2c0a 290a 406d 6f63 6b2e 7061 7463  ]),.).@mock.patc
-0001c6e0: 6828 2267 616e 7472 792e 6c6f 6767 6572  h("gantry.logger
-0001c6f0: 2e63 6c69 656e 742e 5f73 616d 706c 655f  .client._sample_
-0001c700: 7265 636f 7264 7322 2c20 7369 6465 5f65  records", side_e
-0001c710: 6666 6563 743d 636c 6965 6e74 2e5f 7361  ffect=client._sa
-0001c720: 6d70 6c65 5f72 6563 6f72 6473 290a 6465  mple_records).de
-0001c730: 6620 7465 7374 5f67 656e 6572 6174 655f  f test_generate_
-0001c740: 7265 636f 7264 735f 6665 6564 6261 636b  records_feedback
-0001c750: 5f6f 6e6c 7928 0a20 2020 206d 6f63 6b5f  _only(.    mock_
-0001c760: 7361 6d70 6c65 5f72 6563 6f72 6473 2c0a  sample_records,.
-0001c770: 2020 2020 6d6f 636b 5f67 656e 6572 6174      mock_generat
-0001c780: 655f 6665 6564 6261 636b 2c0a 2020 2020  e_feedback,.    
-0001c790: 6d6f 636b 5f67 656e 6572 6174 655f 7072  mock_generate_pr
-0001c7a0: 6564 732c 0a20 2020 206d 6f63 6b5f 6765  eds,.    mock_ge
-0001c7b0: 6e65 7261 7465 5f70 7265 6473 5f61 6e64  nerate_preds_and
-0001c7c0: 5f66 6565 6462 6163 6b2c 0a20 2020 206d  _feedback,.    m
-0001c7d0: 6f63 6b5f 7265 736f 6c76 655f 6a6f 696e  ock_resolve_join
-0001c7e0: 5f6b 6579 732c 0a20 2020 2076 6572 7369  _keys,.    versi
-0001c7f0: 6f6e 2c0a 2020 2020 7461 6773 2c0a 2020  on,.    tags,.  
-0001c800: 2020 726f 775f 7461 6773 2c0a 2020 2020    row_tags,.    
-0001c810: 676c 6f62 616c 5f74 6167 732c 0a20 2020  global_tags,.   
-0001c820: 2065 7870 6563 7465 645f 7461 6773 5f70   expected_tags_p
-0001c830: 6172 616d 2c0a 2020 2020 7465 7374 5f66  aram,.    test_f
-0001c840: 6565 6462 6163 6b73 2c0a 2020 2020 7465  eedbacks,.    te
-0001c850: 7374 5f74 696d 6573 7461 6d70 732c 0a20  st_timestamps,. 
-0001c860: 2020 2074 6573 745f 7469 6d65 7374 616d     test_timestam
-0001c870: 7073 5f6c 6973 742c 0a20 2020 206b 7761  ps_list,.    kwa
-0001c880: 7267 732c 0a20 2020 2063 6c69 5f6f 626a  rgs,.    cli_obj
-0001c890: 2c0a 293a 0a20 2020 2072 756e 5f69 6420  ,.):.    run_id 
-0001c8a0: 3d20 7374 7228 7575 6964 2e75 7569 6434  = str(uuid.uuid4
-0001c8b0: 2829 290a 2020 2020 7275 6e5f 7461 6773  ()).    run_tags
-0001c8c0: 203d 204e 6f6e 650a 2020 2020 6966 2074   = None.    if t
-0001c8d0: 6167 7320 616e 6420 676c 6f62 616c 5f74  ags and global_t
-0001c8e0: 6167 733a 0a20 2020 2020 2020 2072 756e  ags:.        run
-0001c8f0: 5f74 6167 7320 3d20 7b2a 2a74 6167 732c  _tags = {**tags,
-0001c900: 202a 2a67 6c6f 6261 6c5f 7461 6773 7d0a   **global_tags}.
-0001c910: 2020 2020 656c 6966 2074 6167 733a 0a20      elif tags:. 
-0001c920: 2020 2020 2020 2072 756e 5f74 6167 7320         run_tags 
-0001c930: 3d20 7461 6773 0a20 2020 2065 6c69 6620  = tags.    elif 
-0001c940: 676c 6f62 616c 5f74 6167 733a 0a20 2020  global_tags:.   
-0001c950: 2020 2020 2072 756e 5f74 6167 7320 3d20       run_tags = 
-0001c960: 676c 6f62 616c 5f74 6167 730a 2020 2020  global_tags.    
-0001c970: 6173 7365 7274 2063 6c69 5f6f 626a 2e6c  assert cli_obj.l
-0001c980: 6f67 280a 2020 2020 2020 2020 6170 706c  og(.        appl
-0001c990: 6963 6174 696f 6e3d 2266 6f6f 6261 7222  ication="foobar"
-0001c9a0: 2c0a 2020 2020 2020 2020 7665 7273 696f  ,.        versio
-0001c9b0: 6e3d 7665 7273 696f 6e2c 0a20 2020 2020  n=version,.     
-0001c9c0: 2020 2069 6e70 7574 733d 4e6f 6e65 2c0a     inputs=None,.
-0001c9d0: 2020 2020 2020 2020 6f75 7470 7574 733d          outputs=
-0001c9e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6665  None,.        fe
-0001c9f0: 6564 6261 636b 733d 7465 7374 5f66 6565  edbacks=test_fee
-0001ca00: 6462 6163 6b73 2c0a 2020 2020 2020 2020  dbacks,.        
-0001ca10: 7469 6d65 7374 616d 7073 3d74 6573 745f  timestamps=test_
-0001ca20: 7469 6d65 7374 616d 7073 2c0a 2020 2020  timestamps,.    
-0001ca30: 2020 2020 736f 7274 5f6f 6e5f 7469 6d65      sort_on_time
-0001ca40: 7374 616d 703d 5472 7565 2c0a 2020 2020  stamp=True,.    
-0001ca50: 2020 2020 726f 775f 7461 6773 3d72 6f77      row_tags=row
-0001ca60: 5f74 6167 732c 0a20 2020 2020 2020 2072  _tags,.        r
-0001ca70: 756e 5f74 6167 733d 7275 6e5f 7461 6773  un_tags=run_tags
-0001ca80: 2c0a 2020 2020 2020 2020 7275 6e5f 6964  ,.        run_id
-0001ca90: 3d72 756e 5f69 642c 0a20 2020 2020 2020  =run_id,.       
-0001caa0: 202a 2a6b 7761 7267 732c 0a20 2020 2029   **kwargs,.    )
-0001cab0: 203d 3d20 5b7b 2265 7665 6e74 223a 2022   == [{"event": "
-0001cac0: 706c 6163 655f 686f 6c64 6572 227d 5d0a  place_holder"}].
-0001cad0: 0a20 2020 206d 6f63 6b5f 6765 6e65 7261  .    mock_genera
-0001cae0: 7465 5f70 7265 6473 5f61 6e64 5f66 6565  te_preds_and_fee
-0001caf0: 6462 6163 6b2e 6173 7365 7274 5f6e 6f74  dback.assert_not
-0001cb00: 5f63 616c 6c65 6428 290a 2020 2020 6d6f  _called().    mo
-0001cb10: 636b 5f67 656e 6572 6174 655f 7072 6564  ck_generate_pred
-0001cb20: 732e 6173 7365 7274 5f6e 6f74 5f63 616c  s.assert_not_cal
-0001cb30: 6c65 6428 290a 2020 2020 6d6f 636b 5f67  led().    mock_g
-0001cb40: 656e 6572 6174 655f 6665 6564 6261 636b  enerate_feedback
-0001cb50: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
-0001cb60: 6e63 655f 7769 7468 280a 2020 2020 2020  nce_with(.      
-0001cb70: 2020 6170 706c 6963 6174 696f 6e3d 2266    application="f
-0001cb80: 6f6f 6261 7222 2c0a 2020 2020 2020 2020  oobar",.        
-0001cb90: 6665 6564 6261 636b 733d 5b7b 2241 223a  feedbacks=[{"A":
-0001cba0: 2032 3030 7d2c 207b 2241 223a 2032 3031   200}, {"A": 201
-0001cbb0: 7d5d 2c0a 2020 2020 2020 2020 6a6f 696e  }],.        join
-0001cbc0: 5f6b 6579 733d 5b22 3132 3334 3522 2c20  _keys=["12345", 
-0001cbd0: 2235 3433 3231 225d 2c0a 2020 2020 2020  "54321"],.      
-0001cbe0: 2020 6665 6564 6261 636b 5f76 6572 7369    feedback_versi
-0001cbf0: 6f6e 3d76 6572 7369 6f6e 2c0a 2020 2020  on=version,.    
-0001cc00: 2020 2020 7469 6d65 7374 616d 7073 3d74      timestamps=t
-0001cc10: 6573 745f 7469 6d65 7374 616d 7073 5f6c  est_timestamps_l
-0001cc20: 6973 742c 0a20 2020 2020 2020 2073 6f72  ist,.        sor
-0001cc30: 745f 6f6e 5f74 696d 6573 7461 6d70 3d54  t_on_timestamp=T
-0001cc40: 7275 652c 0a20 2020 2020 2020 2072 756e  rue,.        run
-0001cc50: 5f69 643d 7275 6e5f 6964 2c0a 2020 2020  _id=run_id,.    
-0001cc60: 2020 2020 7461 6773 3d65 7870 6563 7465      tags=expecte
-0001cc70: 645f 7461 6773 5f70 6172 616d 2c0a 2020  d_tags_param,.  
-0001cc80: 2020 290a 0a20 2020 206d 6f63 6b5f 7361    )..    mock_sa
-0001cc90: 6d70 6c65 5f72 6563 6f72 6473 2e61 7373  mple_records.ass
-0001cca0: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
-0001ccb0: 7769 7468 280a 2020 2020 2020 2020 322c  with(.        2,
-0001ccc0: 0a20 2020 2020 2020 2031 2c0a 2020 2020  .        1,.    
-0001ccd0: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
-0001cce0: 2020 4e6f 6e65 2c0a 2020 2020 2020 2020    None,.        
-0001ccf0: 5b7b 2241 223a 2032 3030 7d2c 207b 2241  [{"A": 200}, {"A
-0001cd00: 223a 2032 3031 7d5d 2c0a 2020 2020 2020  ": 201}],.      
-0001cd10: 2020 636c 6965 6e74 2e5f 7265 736f 6c76    client._resolv
-0001cd20: 655f 6a6f 696e 5f6b 6579 7328 2a2a 6b77  e_join_keys(**kw
-0001cd30: 6172 6773 292c 0a20 2020 2020 2020 2074  args),.        t
-0001cd40: 6573 745f 7469 6d65 7374 616d 7073 5f6c  est_timestamps_l
-0001cd50: 6973 742c 0a20 2020 2020 2020 2065 7870  ist,.        exp
-0001cd60: 6563 7465 645f 7461 6773 5f70 6172 616d  ected_tags_param
-0001cd70: 2c0a 2020 2020 290a 0a0a 4070 7974 6573  ,.    )...@pytes
-0001cd80: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
-0001cd90: 7a65 280a 2020 2020 2274 6573 745f 6665  ze(.    "test_fe
-0001cda0: 6564 6261 636b 7322 2c0a 2020 2020 5b0a  edbacks",.    [.
-0001cdb0: 2020 2020 2020 2020 5b7b 2241 223a 2032          [{"A": 2
-0001cdc0: 3030 7d2c 207b 2241 223a 2032 3031 7d5d  00}, {"A": 201}]
-0001cdd0: 2c0a 2020 2020 2020 2020 7064 2e44 6174  ,.        pd.Dat
-0001cde0: 6146 7261 6d65 2e66 726f 6d5f 6469 6374  aFrame.from_dict
-0001cdf0: 287b 2241 223a 205b 3230 302c 2032 3031  ({"A": [200, 201
-0001ce00: 5d7d 292c 0a20 2020 2020 2020 2070 642e  ]}),.        pd.
-0001ce10: 5365 7269 6573 286e 616d 653d 2241 222c  Series(name="A",
-0001ce20: 2064 6174 613d 5b32 3030 2c20 3230 315d   data=[200, 201]
-0001ce30: 292c 0a20 2020 205d 2c0a 290a 4070 7974  ),.    ],.).@pyt
-0001ce40: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-0001ce50: 7269 7a65 2822 7665 7273 696f 6e22 2c20  rize("version", 
-0001ce60: 5b4e 6f6e 652c 2031 302c 2022 312e 322e  [None, 10, "1.2.
-0001ce70: 3322 5d29 0a40 6d6f 636b 2e70 6174 6368  3"]).@mock.patch
-0001ce80: 2822 6761 6e74 7279 2e6c 6f67 6765 722e  ("gantry.logger.
-0001ce90: 636c 6965 6e74 2e47 616e 7472 792e 5f6c  client.Gantry._l
-0001cea0: 6f67 5f70 7265 6469 6374 696f 6e5f 616e  og_prediction_an
-0001ceb0: 645f 6665 6564 6261 636b 5f65 7665 6e74  d_feedback_event
-0001cec0: 7322 290a 406d 6f63 6b2e 7061 7463 6828  s").@mock.patch(
-0001ced0: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
-0001cee0: 6c69 656e 742e 4761 6e74 7279 2e5f 6c6f  lient.Gantry._lo
-0001cef0: 675f 7072 6564 6963 7469 6f6e 5f65 7665  g_prediction_eve
-0001cf00: 6e74 7322 290a 406d 6f63 6b2e 7061 7463  nts").@mock.patc
-0001cf10: 6828 0a20 2020 2022 6761 6e74 7279 2e6c  h(.    "gantry.l
-0001cf20: 6f67 6765 722e 636c 6965 6e74 2e47 616e  ogger.client.Gan
-0001cf30: 7472 792e 5f6c 6f67 5f66 6565 6462 6163  try._log_feedbac
-0001cf40: 6b5f 6576 656e 7473 222c 2072 6574 7572  k_events", retur
-0001cf50: 6e5f 7661 6c75 653d 284e 6f6e 652c 205b  n_value=(None, [
-0001cf60: 2231 3233 3435 222c 2022 3637 3839 3022  "12345", "67890"
-0001cf70: 5d29 0a29 0a64 6566 2074 6573 745f 6c6f  ]).).def test_lo
-0001cf80: 675f 7265 636f 7264 735f 6665 6564 6261  g_records_feedba
-0001cf90: 636b 5f6f 6e6c 795f 6e6f 5f6a 6f69 6e5f  ck_only_no_join_
-0001cfa0: 6b65 7973 280a 2020 2020 6d6f 636b 5f66  keys(.    mock_f
-0001cfb0: 6565 6462 6163 6b2c 0a20 2020 206d 6f63  eedback,.    moc
-0001cfc0: 6b5f 7072 6564 732c 0a20 2020 206d 6f63  k_preds,.    moc
-0001cfd0: 6b5f 7072 6564 735f 616e 645f 6665 6564  k_preds_and_feed
-0001cfe0: 6261 636b 2c0a 2020 2020 7665 7273 696f  back,.    versio
-0001cff0: 6e2c 0a20 2020 2074 6573 745f 6665 6564  n,.    test_feed
-0001d000: 6261 636b 732c 0a20 2020 2063 6c69 5f6f  backs,.    cli_o
-0001d010: 626a 2c0a 293a 0a20 2020 2061 7373 6572  bj,.):.    asser
-0001d020: 7420 280a 2020 2020 2020 2020 636c 695f  t (.        cli_
-0001d030: 6f62 6a2e 6c6f 675f 7265 636f 7264 7328  obj.log_records(
-0001d040: 0a20 2020 2020 2020 2020 2020 2061 7070  .            app
-0001d050: 6c69 6361 7469 6f6e 3d22 666f 6f62 6172  lication="foobar
-0001d060: 222c 0a20 2020 2020 2020 2020 2020 2076  ",.            v
-0001d070: 6572 7369 6f6e 3d76 6572 7369 6f6e 2c0a  ersion=version,.
-0001d080: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-0001d090: 7473 3d4e 6f6e 652c 0a20 2020 2020 2020  ts=None,.       
-0001d0a0: 2020 2020 206f 7574 7075 7473 3d4e 6f6e       outputs=Non
-0001d0b0: 652c 0a20 2020 2020 2020 2020 2020 2066  e,.            f
-0001d0c0: 6565 6462 6163 6b73 3d74 6573 745f 6665  eedbacks=test_fe
-0001d0d0: 6564 6261 636b 732c 0a20 2020 2020 2020  edbacks,.       
-0001d0e0: 2020 2020 2074 696d 6573 7461 6d70 733d       timestamps=
-0001d0f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0001d100: 2020 736f 7274 5f6f 6e5f 7469 6d65 7374    sort_on_timest
-0001d110: 616d 703d 5472 7565 2c0a 2020 2020 2020  amp=True,.      
-0001d120: 2020 290a 2020 2020 2020 2020 6973 204e    ).        is N
-0001d130: 6f6e 650a 2020 2020 290a 0a20 2020 206d  one.    )..    m
-0001d140: 6f63 6b5f 7072 6564 735f 616e 645f 6665  ock_preds_and_fe
-0001d150: 6564 6261 636b 2e61 7373 6572 745f 6e6f  edback.assert_no
-0001d160: 745f 6361 6c6c 6564 2829 0a20 2020 206d  t_called().    m
-0001d170: 6f63 6b5f 7072 6564 732e 6173 7365 7274  ock_preds.assert
-0001d180: 5f6e 6f74 5f63 616c 6c65 6428 290a 2020  _not_called().  
-0001d190: 2020 6d6f 636b 5f66 6565 6462 6163 6b2e    mock_feedback.
-0001d1a0: 6173 7365 7274 5f6e 6f74 5f63 616c 6c65  assert_not_calle
-0001d1b0: 6428 290a 0a0a 4070 7974 6573 742e 6d61  d()...@pytest.ma
-0001d1c0: 726b 2e70 6172 616d 6574 7269 7a65 280a  rk.parametrize(.
-0001d1d0: 2020 2020 2274 6573 745f 6665 6564 6261      "test_feedba
-0001d1e0: 636b 7322 2c0a 2020 2020 5b0a 2020 2020  cks",.    [.    
-0001d1f0: 2020 2020 5b7b 2241 223a 2032 3030 7d2c      [{"A": 200},
-0001d200: 207b 2241 223a 2032 3031 7d5d 2c0a 2020   {"A": 201}],.  
-0001d210: 2020 2020 2020 7064 2e44 6174 6146 7261        pd.DataFra
-0001d220: 6d65 2e66 726f 6d5f 6469 6374 287b 2241  me.from_dict({"A
-0001d230: 223a 205b 3230 302c 2032 3031 5d7d 292c  ": [200, 201]}),
-0001d240: 0a20 2020 2020 2020 2070 642e 5365 7269  .        pd.Seri
-0001d250: 6573 286e 616d 653d 2241 222c 2064 6174  es(name="A", dat
-0001d260: 613d 5b32 3030 2c20 3230 315d 292c 0a20  a=[200, 201]),. 
-0001d270: 2020 205d 2c0a 290a 4070 7974 6573 742e     ],.).@pytest.
-0001d280: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-0001d290: 2822 7665 7273 696f 6e22 2c20 5b4e 6f6e  ("version", [Non
-0001d2a0: 652c 2031 302c 2022 312e 322e 3322 5d29  e, 10, "1.2.3"])
-0001d2b0: 0a40 6d6f 636b 2e70 6174 6368 2822 6761  .@mock.patch("ga
-0001d2c0: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
-0001d2d0: 6e74 2e47 616e 7472 792e 5f67 656e 6572  nt.Gantry._gener
-0001d2e0: 6174 655f 7072 6564 6963 7469 6f6e 5f61  ate_prediction_a
-0001d2f0: 6e64 5f66 6565 6462 6163 6b5f 6576 656e  nd_feedback_even
-0001d300: 7473 2229 0a40 6d6f 636b 2e70 6174 6368  ts").@mock.patch
-0001d310: 2822 6761 6e74 7279 2e6c 6f67 6765 722e  ("gantry.logger.
-0001d320: 636c 6965 6e74 2e47 616e 7472 792e 5f67  client.Gantry._g
-0001d330: 656e 6572 6174 655f 7072 6564 6963 7469  enerate_predicti
-0001d340: 6f6e 5f65 7665 6e74 7322 290a 406d 6f63  on_events").@moc
-0001d350: 6b2e 7061 7463 6828 0a20 2020 2022 6761  k.patch(.    "ga
-0001d360: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
-0001d370: 6e74 2e47 616e 7472 792e 5f67 656e 6572  nt.Gantry._gener
-0001d380: 6174 655f 6665 6564 6261 636b 5f65 7665  ate_feedback_eve
-0001d390: 6e74 7322 2c20 7265 7475 726e 5f76 616c  nts", return_val
-0001d3a0: 7565 3d28 4e6f 6e65 2c20 5b22 3132 3334  ue=(None, ["1234
-0001d3b0: 3522 2c20 2236 3738 3930 225d 290a 290a  5", "67890"]).).
-0001d3c0: 6465 6620 7465 7374 5f67 656e 6572 6174  def test_generat
-0001d3d0: 655f 7265 636f 7264 735f 6665 6564 6261  e_records_feedba
-0001d3e0: 636b 5f6f 6e6c 795f 6e6f 5f6a 6f69 6e5f  ck_only_no_join_
-0001d3f0: 6b65 7973 280a 2020 2020 6d6f 636b 5f66  keys(.    mock_f
-0001d400: 6565 6462 6163 6b2c 0a20 2020 206d 6f63  eedback,.    moc
-0001d410: 6b5f 7072 6564 732c 0a20 2020 206d 6f63  k_preds,.    moc
-0001d420: 6b5f 7072 6564 735f 616e 645f 6665 6564  k_preds_and_feed
-0001d430: 6261 636b 2c0a 2020 2020 7665 7273 696f  back,.    versio
-0001d440: 6e2c 0a20 2020 2074 6573 745f 6665 6564  n,.    test_feed
-0001d450: 6261 636b 732c 0a20 2020 2063 6c69 5f6f  backs,.    cli_o
-0001d460: 626a 2c0a 293a 0a20 2020 2061 7373 6572  bj,.):.    asser
-0001d470: 7420 280a 2020 2020 2020 2020 636c 695f  t (.        cli_
-0001d480: 6f62 6a2e 6765 6e65 7261 7465 5f72 6563  obj.generate_rec
-0001d490: 6f72 6473 280a 2020 2020 2020 2020 2020  ords(.          
-0001d4a0: 2020 6170 706c 6963 6174 696f 6e3d 2266    application="f
-0001d4b0: 6f6f 6261 7222 2c0a 2020 2020 2020 2020  oobar",.        
-0001d4c0: 2020 2020 7665 7273 696f 6e3d 7665 7273      version=vers
-0001d4d0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0001d4e0: 2069 6e70 7574 733d 4e6f 6e65 2c0a 2020   inputs=None,.  
-0001d4f0: 2020 2020 2020 2020 2020 6f75 7470 7574            output
-0001d500: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
-0001d510: 2020 2020 6665 6564 6261 636b 733d 7465      feedbacks=te
-0001d520: 7374 5f66 6565 6462 6163 6b73 2c0a 2020  st_feedbacks,.  
-0001d530: 2020 2020 2020 2020 2020 7469 6d65 7374            timest
-0001d540: 616d 7073 3d4e 6f6e 652c 0a20 2020 2020  amps=None,.     
-0001d550: 2020 2020 2020 2073 6f72 745f 6f6e 5f74         sort_on_t
-0001d560: 696d 6573 7461 6d70 3d54 7275 652c 0a20  imestamp=True,. 
-0001d570: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001d580: 2069 7320 4e6f 6e65 0a20 2020 2029 0a0a   is None.    )..
-0001d590: 2020 2020 6d6f 636b 5f70 7265 6473 5f61      mock_preds_a
-0001d5a0: 6e64 5f66 6565 6462 6163 6b2e 6173 7365  nd_feedback.asse
-0001d5b0: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
-0001d5c0: 2020 2020 6d6f 636b 5f70 7265 6473 2e61      mock_preds.a
-0001d5d0: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
-0001d5e0: 2829 0a20 2020 206d 6f63 6b5f 6665 6564  ().    mock_feed
-0001d5f0: 6261 636b 2e61 7373 6572 745f 6e6f 745f  back.assert_not_
-0001d600: 6361 6c6c 6564 2829 0a0a 0a40 7079 7465  called()...@pyte
-0001d610: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
-0001d620: 697a 6528 0a20 2020 2022 7465 7374 5f66  ize(.    "test_f
-0001d630: 6565 6462 6163 6b73 222c 0a20 2020 205b  eedbacks",.    [
-0001d640: 4e6f 6e65 2c20 7064 2e44 6174 6146 7261  None, pd.DataFra
-0001d650: 6d65 2829 2c20 5b5d 2c20 7064 2e53 6572  me(), [], pd.Ser
-0001d660: 6965 7328 292c 206e 702e 6172 7261 7928  ies(), np.array(
-0001d670: 5b5d 295d 2c0a 290a 4070 7974 6573 742e  [])],.).@pytest.
-0001d680: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-0001d690: 280a 2020 2020 2274 6573 745f 6f75 7470  (.    "test_outp
-0001d6a0: 7574 7322 2c0a 2020 2020 5b4e 6f6e 652c  uts",.    [None,
-0001d6b0: 2070 642e 4461 7461 4672 616d 6528 292c   pd.DataFrame(),
-0001d6c0: 205b 5d2c 2070 642e 5365 7269 6573 2829   [], pd.Series()
-0001d6d0: 2c20 6e70 2e61 7272 6179 285b 5d29 5d2c  , np.array([])],
-0001d6e0: 0a29 0a40 7079 7465 7374 2e6d 6172 6b2e  .).@pytest.mark.
-0001d6f0: 7061 7261 6d65 7472 697a 6528 0a20 2020  parametrize(.   
-0001d700: 2022 7465 7374 5f69 6e70 7574 7322 2c0a   "test_inputs",.
-0001d710: 2020 2020 5b4e 6f6e 652c 2070 642e 4461      [None, pd.Da
-0001d720: 7461 4672 616d 6528 292c 205b 5d2c 2070  taFrame(), [], p
-0001d730: 642e 5365 7269 6573 2829 2c20 6e70 2e61  d.Series(), np.a
-0001d740: 7272 6179 285b 5d29 5d2c 0a29 0a40 7079  rray([])],.).@py
-0001d750: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
-0001d760: 7472 697a 6528 2276 6572 7369 6f6e 222c  trize("version",
-0001d770: 205b 4e6f 6e65 2c20 3130 2c20 2231 2e32   [None, 10, "1.2
-0001d780: 2e33 225d 290a 406d 6f63 6b2e 7061 7463  .3"]).@mock.patc
-0001d790: 6828 2267 616e 7472 792e 6c6f 6767 6572  h("gantry.logger
-0001d7a0: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
-0001d7b0: 6c6f 675f 7072 6564 6963 7469 6f6e 5f61  log_prediction_a
-0001d7c0: 6e64 5f66 6565 6462 6163 6b5f 6576 656e  nd_feedback_even
-0001d7d0: 7473 2229 0a40 6d6f 636b 2e70 6174 6368  ts").@mock.patch
-0001d7e0: 2822 6761 6e74 7279 2e6c 6f67 6765 722e  ("gantry.logger.
-0001d7f0: 636c 6965 6e74 2e47 616e 7472 792e 5f6c  client.Gantry._l
-0001d800: 6f67 5f70 7265 6469 6374 696f 6e5f 6576  og_prediction_ev
-0001d810: 656e 7473 2229 0a40 6d6f 636b 2e70 6174  ents").@mock.pat
-0001d820: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
-0001d830: 722e 636c 6965 6e74 2e47 616e 7472 792e  r.client.Gantry.
-0001d840: 5f6c 6f67 5f66 6565 6462 6163 6b5f 6576  _log_feedback_ev
-0001d850: 656e 7473 2229 0a64 6566 2074 6573 745f  ents").def test_
-0001d860: 6c6f 675f 7265 636f 7264 735f 6e6f 5f64  log_records_no_d
-0001d870: 6174 6128 0a20 2020 206d 6f63 6b5f 6665  ata(.    mock_fe
-0001d880: 6564 6261 636b 2c0a 2020 2020 6d6f 636b  edback,.    mock
-0001d890: 5f70 7265 6473 2c0a 2020 2020 6d6f 636b  _preds,.    mock
-0001d8a0: 5f70 7265 6473 5f61 6e64 5f66 6565 6462  _preds_and_feedb
-0001d8b0: 6163 6b2c 0a20 2020 2076 6572 7369 6f6e  ack,.    version
-0001d8c0: 2c0a 2020 2020 7465 7374 5f69 6e70 7574  ,.    test_input
-0001d8d0: 732c 0a20 2020 2074 6573 745f 6f75 7470  s,.    test_outp
-0001d8e0: 7574 732c 0a20 2020 2074 6573 745f 6665  uts,.    test_fe
-0001d8f0: 6564 6261 636b 732c 0a20 2020 2063 6c69  edbacks,.    cli
-0001d900: 5f6f 626a 2c0a 293a 0a20 2020 2061 7373  _obj,.):.    ass
-0001d910: 6572 7420 280a 2020 2020 2020 2020 636c  ert (.        cl
-0001d920: 695f 6f62 6a2e 6c6f 675f 7265 636f 7264  i_obj.log_record
-0001d930: 7328 0a20 2020 2020 2020 2020 2020 2061  s(.            a
-0001d940: 7070 6c69 6361 7469 6f6e 3d22 666f 6f62  pplication="foob
-0001d950: 6172 222c 0a20 2020 2020 2020 2020 2020  ar",.           
-0001d960: 2076 6572 7369 6f6e 3d76 6572 7369 6f6e   version=version
-0001d970: 2c0a 2020 2020 2020 2020 2020 2020 696e  ,.            in
-0001d980: 7075 7473 3d74 6573 745f 696e 7075 7473  puts=test_inputs
-0001d990: 2c0a 2020 2020 2020 2020 2020 2020 6f75  ,.            ou
-0001d9a0: 7470 7574 733d 7465 7374 5f6f 7574 7075  tputs=test_outpu
-0001d9b0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
-0001d9c0: 6665 6564 6261 636b 733d 7465 7374 5f66  feedbacks=test_f
-0001d9d0: 6565 6462 6163 6b73 2c0a 2020 2020 2020  eedbacks,.      
-0001d9e0: 2020 2020 2020 7469 6d65 7374 616d 7073        timestamps
-0001d9f0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2020  =None,.         
-0001da00: 2020 2073 6f72 745f 6f6e 5f74 696d 6573     sort_on_times
-0001da10: 7461 6d70 3d54 7275 652c 0a20 2020 2020  tamp=True,.     
-0001da20: 2020 2029 0a20 2020 2020 2020 2069 7320     ).        is 
-0001da30: 4e6f 6e65 0a20 2020 2029 0a0a 2020 2020  None.    )..    
-0001da40: 6d6f 636b 5f70 7265 6473 5f61 6e64 5f66  mock_preds_and_f
-0001da50: 6565 6462 6163 6b2e 6173 7365 7274 5f6e  eedback.assert_n
-0001da60: 6f74 5f63 616c 6c65 6428 290a 2020 2020  ot_called().    
-0001da70: 6d6f 636b 5f70 7265 6473 2e61 7373 6572  mock_preds.asser
-0001da80: 745f 6e6f 745f 6361 6c6c 6564 2829 0a20  t_not_called(). 
-0001da90: 2020 206d 6f63 6b5f 6665 6564 6261 636b     mock_feedback
-0001daa0: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
-0001dab0: 6564 2829 0a0a 0a40 7079 7465 7374 2e6d  ed()...@pytest.m
-0001dac0: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
-0001dad0: 0a20 2020 2022 7465 7374 5f66 6565 6462  .    "test_feedb
-0001dae0: 6163 6b73 222c 0a20 2020 205b 4e6f 6e65  acks",.    [None
-0001daf0: 2c20 7064 2e44 6174 6146 7261 6d65 2829  , pd.DataFrame()
-0001db00: 2c20 5b5d 2c20 7064 2e53 6572 6965 7328  , [], pd.Series(
-0001db10: 292c 206e 702e 6172 7261 7928 5b5d 295d  ), np.array([])]
-0001db20: 2c0a 290a 4070 7974 6573 742e 6d61 726b  ,.).@pytest.mark
-0001db30: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
-0001db40: 2020 2274 6573 745f 6f75 7470 7574 7322    "test_outputs"
-0001db50: 2c0a 2020 2020 5b4e 6f6e 652c 2070 642e  ,.    [None, pd.
-0001db60: 4461 7461 4672 616d 6528 292c 205b 5d2c  DataFrame(), [],
-0001db70: 2070 642e 5365 7269 6573 2829 2c20 6e70   pd.Series(), np
-0001db80: 2e61 7272 6179 285b 5d29 5d2c 0a29 0a40  .array([])],.).@
-0001db90: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
-0001dba0: 6d65 7472 697a 6528 0a20 2020 2022 7465  metrize(.    "te
-0001dbb0: 7374 5f69 6e70 7574 7322 2c0a 2020 2020  st_inputs",.    
-0001dbc0: 5b4e 6f6e 652c 2070 642e 4461 7461 4672  [None, pd.DataFr
-0001dbd0: 616d 6528 292c 205b 5d2c 2070 642e 5365  ame(), [], pd.Se
-0001dbe0: 7269 6573 2829 2c20 6e70 2e61 7272 6179  ries(), np.array
-0001dbf0: 285b 5d29 5d2c 0a29 0a40 7079 7465 7374  ([])],.).@pytest
-0001dc00: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
-0001dc10: 6528 2276 6572 7369 6f6e 222c 205b 4e6f  e("version", [No
-0001dc20: 6e65 2c20 3130 2c20 2231 2e32 2e33 225d  ne, 10, "1.2.3"]
-0001dc30: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
-0001dc40: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
-0001dc50: 656e 742e 4761 6e74 7279 2e5f 6765 6e65  ent.Gantry._gene
-0001dc60: 7261 7465 5f70 7265 6469 6374 696f 6e5f  rate_prediction_
-0001dc70: 616e 645f 6665 6564 6261 636b 5f65 7665  and_feedback_eve
-0001dc80: 6e74 7322 290a 406d 6f63 6b2e 7061 7463  nts").@mock.patc
-0001dc90: 6828 2267 616e 7472 792e 6c6f 6767 6572  h("gantry.logger
-0001dca0: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
-0001dcb0: 6765 6e65 7261 7465 5f70 7265 6469 6374  generate_predict
-0001dcc0: 696f 6e5f 6576 656e 7473 2229 0a40 6d6f  ion_events").@mo
-0001dcd0: 636b 2e70 6174 6368 2822 6761 6e74 7279  ck.patch("gantry
-0001dce0: 2e6c 6f67 6765 722e 636c 6965 6e74 2e47  .logger.client.G
-0001dcf0: 616e 7472 792e 5f67 656e 6572 6174 655f  antry._generate_
-0001dd00: 6665 6564 6261 636b 5f65 7665 6e74 7322  feedback_events"
-0001dd10: 290a 6465 6620 7465 7374 5f67 656e 6572  ).def test_gener
-0001dd20: 6174 655f 7265 636f 7264 735f 6e6f 5f64  ate_records_no_d
-0001dd30: 6174 6128 0a20 2020 206d 6f63 6b5f 6765  ata(.    mock_ge
-0001dd40: 6e65 7261 7465 5f66 6565 6462 6163 6b2c  nerate_feedback,
-0001dd50: 0a20 2020 206d 6f63 6b5f 6765 6e65 7261  .    mock_genera
-0001dd60: 7465 5f70 7265 6473 2c0a 2020 2020 6d6f  te_preds,.    mo
-0001dd70: 636b 5f67 656e 6572 6174 655f 7072 6564  ck_generate_pred
-0001dd80: 735f 616e 645f 6665 6564 6261 636b 2c0a  s_and_feedback,.
-0001dd90: 2020 2020 7665 7273 696f 6e2c 0a20 2020      version,.   
-0001dda0: 2074 6573 745f 696e 7075 7473 2c0a 2020   test_inputs,.  
-0001ddb0: 2020 7465 7374 5f6f 7574 7075 7473 2c0a    test_outputs,.
-0001ddc0: 2020 2020 7465 7374 5f66 6565 6462 6163      test_feedbac
-0001ddd0: 6b73 2c0a 2020 2020 636c 695f 6f62 6a2c  ks,.    cli_obj,
-0001dde0: 0a29 3a0a 2020 2020 6173 7365 7274 2028  .):.    assert (
-0001ddf0: 0a20 2020 2020 2020 2063 6c69 5f6f 626a  .        cli_obj
-0001de00: 2e67 656e 6572 6174 655f 7265 636f 7264  .generate_record
-0001de10: 7328 0a20 2020 2020 2020 2020 2020 2061  s(.            a
-0001de20: 7070 6c69 6361 7469 6f6e 3d22 666f 6f62  pplication="foob
-0001de30: 6172 222c 0a20 2020 2020 2020 2020 2020  ar",.           
-0001de40: 2076 6572 7369 6f6e 3d76 6572 7369 6f6e   version=version
-0001de50: 2c0a 2020 2020 2020 2020 2020 2020 696e  ,.            in
-0001de60: 7075 7473 3d74 6573 745f 696e 7075 7473  puts=test_inputs
-0001de70: 2c0a 2020 2020 2020 2020 2020 2020 6f75  ,.            ou
-0001de80: 7470 7574 733d 7465 7374 5f6f 7574 7075  tputs=test_outpu
-0001de90: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
-0001dea0: 6665 6564 6261 636b 733d 7465 7374 5f66  feedbacks=test_f
-0001deb0: 6565 6462 6163 6b73 2c0a 2020 2020 2020  eedbacks,.      
-0001dec0: 2020 2020 2020 7469 6d65 7374 616d 7073        timestamps
-0001ded0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2020  =None,.         
-0001dee0: 2020 2073 6f72 745f 6f6e 5f74 696d 6573     sort_on_times
-0001def0: 7461 6d70 3d54 7275 652c 0a20 2020 2020  tamp=True,.     
-0001df00: 2020 2029 0a20 2020 2020 2020 2069 7320     ).        is 
-0001df10: 4e6f 6e65 0a20 2020 2029 0a0a 2020 2020  None.    )..    
-0001df20: 6d6f 636b 5f67 656e 6572 6174 655f 7072  mock_generate_pr
-0001df30: 6564 735f 616e 645f 6665 6564 6261 636b  eds_and_feedback
-0001df40: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
-0001df50: 6564 2829 0a20 2020 206d 6f63 6b5f 6765  ed().    mock_ge
-0001df60: 6e65 7261 7465 5f70 7265 6473 2e61 7373  nerate_preds.ass
-0001df70: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
-0001df80: 0a20 2020 206d 6f63 6b5f 6765 6e65 7261  .    mock_genera
-0001df90: 7465 5f66 6565 6462 6163 6b2e 6173 7365  te_feedback.asse
-0001dfa0: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
-0001dfb0: 0a0a 4070 7974 6573 742e 6d61 726b 2e70  ..@pytest.mark.p
-0001dfc0: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
-0001dfd0: 2274 6573 745f 6665 6564 6261 636b 7322  "test_feedbacks"
-0001dfe0: 2c0a 2020 2020 5b4e 6f6e 652c 2070 642e  ,.    [None, pd.
-0001dff0: 4461 7461 4672 616d 6528 292c 205b 7b22  DataFrame(), [{"
-0001e000: 4122 3a20 337d 2c20 7b22 4122 3a20 337d  A": 3}, {"A": 3}
-0001e010: 5d2c 2070 642e 5365 7269 6573 2829 5d2c  ], pd.Series()],
-0001e020: 0a29 0a40 6d6f 636b 2e70 6174 6368 2822  .).@mock.patch("
-0001e030: 6761 6e74 7279 2e6c 6f67 6765 722e 636c  gantry.logger.cl
-0001e040: 6965 6e74 2e47 616e 7472 792e 5f6c 6f67  ient.Gantry._log
-0001e050: 5f70 7265 6469 6374 696f 6e5f 616e 645f  _prediction_and_
-0001e060: 6665 6564 6261 636b 5f65 7665 6e74 7322  feedback_events"
-0001e070: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
-0001e080: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
-0001e090: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
-0001e0a0: 7072 6564 6963 7469 6f6e 5f65 7665 6e74  prediction_event
-0001e0b0: 7322 290a 406d 6f63 6b2e 7061 7463 6828  s").@mock.patch(
-0001e0c0: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
-0001e0d0: 6c69 656e 742e 4761 6e74 7279 2e5f 6c6f  lient.Gantry._lo
-0001e0e0: 675f 6665 6564 6261 636b 5f65 7665 6e74  g_feedback_event
-0001e0f0: 7322 290a 6465 6620 7465 7374 5f6c 6f67  s").def test_log
-0001e100: 5f72 6563 6f72 6473 5f69 6e63 6f6d 706c  _records_incompl
-0001e110: 6574 655f 7072 6564 7328 0a20 2020 206d  ete_preds(.    m
-0001e120: 6f63 6b5f 6665 6564 6261 636b 2c0a 2020  ock_feedback,.  
-0001e130: 2020 6d6f 636b 5f70 7265 6473 2c0a 2020    mock_preds,.  
-0001e140: 2020 6d6f 636b 5f70 7265 6473 5f61 6e64    mock_preds_and
-0001e150: 5f66 6565 6462 6163 6b2c 0a20 2020 2074  _feedback,.    t
-0001e160: 6573 745f 6665 6564 6261 636b 732c 0a20  est_feedbacks,. 
-0001e170: 2020 2063 6c69 5f6f 626a 2c0a 293a 0a20     cli_obj,.):. 
-0001e180: 2020 2072 7620 3d20 636c 695f 6f62 6a2e     rv = cli_obj.
-0001e190: 6c6f 675f 7265 636f 7264 7328 0a20 2020  log_records(.   
-0001e1a0: 2020 2020 2061 7070 6c69 6361 7469 6f6e       application
-0001e1b0: 3d22 666f 6f62 6172 222c 0a20 2020 2020  ="foobar",.     
-0001e1c0: 2020 2076 6572 7369 6f6e 3d22 322e 302e     version="2.0.
-0001e1d0: 3122 2c0a 2020 2020 2020 2020 696e 7075  1",.        inpu
-0001e1e0: 7473 3d5b 5d2c 0a20 2020 2020 2020 206f  ts=[],.        o
-0001e1f0: 7574 7075 7473 3d5b 7b22 4122 3a20 317d  utputs=[{"A": 1}
-0001e200: 2c20 7b22 4122 3a20 327d 5d2c 0a20 2020  , {"A": 2}],.   
-0001e210: 2020 2020 2066 6565 6462 6163 6b73 3d74       feedbacks=t
-0001e220: 6573 745f 6665 6564 6261 636b 732c 0a20  est_feedbacks,. 
-0001e230: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
-0001e240: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
-0001e250: 736f 7274 5f6f 6e5f 7469 6d65 7374 616d  sort_on_timestam
-0001e260: 703d 5472 7565 2c0a 2020 2020 290a 2020  p=True,.    ).  
-0001e270: 2020 6173 7365 7274 2072 7620 6973 204e    assert rv is N
-0001e280: 6f6e 650a 0a20 2020 206d 6f63 6b5f 7072  one..    mock_pr
-0001e290: 6564 735f 616e 645f 6665 6564 6261 636b  eds_and_feedback
-0001e2a0: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
-0001e2b0: 6564 2829 0a20 2020 206d 6f63 6b5f 7072  ed().    mock_pr
-0001e2c0: 6564 732e 6173 7365 7274 5f6e 6f74 5f63  eds.assert_not_c
-0001e2d0: 616c 6c65 6428 290a 2020 2020 6d6f 636b  alled().    mock
-0001e2e0: 5f66 6565 6462 6163 6b2e 6173 7365 7274  _feedback.assert
-0001e2f0: 5f6e 6f74 5f63 616c 6c65 6428 290a 0a0a  _not_called()...
-0001e300: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
-0001e310: 616d 6574 7269 7a65 280a 2020 2020 2274  ametrize(.    "t
-0001e320: 6573 745f 6665 6564 6261 636b 7322 2c0a  est_feedbacks",.
-0001e330: 2020 2020 5b4e 6f6e 652c 2070 642e 4461      [None, pd.Da
-0001e340: 7461 4672 616d 6528 292c 205b 7b22 4122  taFrame(), [{"A"
-0001e350: 3a20 337d 2c20 7b22 4122 3a20 337d 5d2c  : 3}, {"A": 3}],
-0001e360: 2070 642e 5365 7269 6573 2829 5d2c 0a29   pd.Series()],.)
-0001e370: 0a40 6d6f 636b 2e70 6174 6368 2822 6761  .@mock.patch("ga
-0001e380: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
-0001e390: 6e74 2e47 616e 7472 792e 5f67 656e 6572  nt.Gantry._gener
-0001e3a0: 6174 655f 7072 6564 6963 7469 6f6e 5f61  ate_prediction_a
-0001e3b0: 6e64 5f66 6565 6462 6163 6b5f 6576 656e  nd_feedback_even
-0001e3c0: 7473 2229 0a40 6d6f 636b 2e70 6174 6368  ts").@mock.patch
-0001e3d0: 2822 6761 6e74 7279 2e6c 6f67 6765 722e  ("gantry.logger.
-0001e3e0: 636c 6965 6e74 2e47 616e 7472 792e 5f67  client.Gantry._g
-0001e3f0: 656e 6572 6174 655f 7072 6564 6963 7469  enerate_predicti
-0001e400: 6f6e 5f65 7665 6e74 7322 290a 406d 6f63  on_events").@moc
-0001e410: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
-0001e420: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
-0001e430: 6e74 7279 2e5f 6765 6e65 7261 7465 5f66  ntry._generate_f
-0001e440: 6565 6462 6163 6b5f 6576 656e 7473 2229  eedback_events")
-0001e450: 0a64 6566 2074 6573 745f 6765 6e65 7261  .def test_genera
-0001e460: 7465 5f72 6563 6f72 6473 5f69 6e63 6f6d  te_records_incom
-0001e470: 706c 6574 655f 7072 6564 7328 0a20 2020  plete_preds(.   
-0001e480: 206d 6f63 6b5f 6765 6e65 7261 7465 5f66   mock_generate_f
-0001e490: 6565 6462 6163 6b2c 0a20 2020 206d 6f63  eedback,.    moc
-0001e4a0: 6b5f 6765 6e65 7261 7465 5f70 7265 6473  k_generate_preds
-0001e4b0: 2c0a 2020 2020 6d6f 636b 5f67 656e 6572  ,.    mock_gener
-0001e4c0: 6174 655f 7072 6564 735f 616e 645f 6665  ate_preds_and_fe
-0001e4d0: 6564 6261 636b 2c0a 2020 2020 7465 7374  edback,.    test
-0001e4e0: 5f66 6565 6462 6163 6b73 2c0a 2020 2020  _feedbacks,.    
-0001e4f0: 636c 695f 6f62 6a2c 0a29 3a0a 2020 2020  cli_obj,.):.    
-0001e500: 7276 203d 2063 6c69 5f6f 626a 2e67 656e  rv = cli_obj.gen
-0001e510: 6572 6174 655f 7265 636f 7264 7328 0a20  erate_records(. 
-0001e520: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
-0001e530: 6f6e 3d22 666f 6f62 6172 222c 0a20 2020  on="foobar",.   
-0001e540: 2020 2020 2076 6572 7369 6f6e 3d22 322e       version="2.
-0001e550: 302e 3122 2c0a 2020 2020 2020 2020 696e  0.1",.        in
-0001e560: 7075 7473 3d5b 5d2c 0a20 2020 2020 2020  puts=[],.       
-0001e570: 206f 7574 7075 7473 3d5b 7b22 4122 3a20   outputs=[{"A": 
-0001e580: 317d 2c20 7b22 4122 3a20 327d 5d2c 0a20  1}, {"A": 2}],. 
-0001e590: 2020 2020 2020 2066 6565 6462 6163 6b73         feedbacks
-0001e5a0: 3d74 6573 745f 6665 6564 6261 636b 732c  =test_feedbacks,
-0001e5b0: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
-0001e5c0: 6d70 733d 4e6f 6e65 2c0a 2020 2020 2020  mps=None,.      
-0001e5d0: 2020 736f 7274 5f6f 6e5f 7469 6d65 7374    sort_on_timest
-0001e5e0: 616d 703d 5472 7565 2c0a 2020 2020 290a  amp=True,.    ).
-0001e5f0: 2020 2020 6173 7365 7274 2072 7620 6973      assert rv is
-0001e600: 204e 6f6e 650a 0a20 2020 206d 6f63 6b5f   None..    mock_
-0001e610: 6765 6e65 7261 7465 5f70 7265 6473 5f61  generate_preds_a
-0001e620: 6e64 5f66 6565 6462 6163 6b2e 6173 7365  nd_feedback.asse
-0001e630: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
-0001e640: 2020 2020 6d6f 636b 5f67 656e 6572 6174      mock_generat
-0001e650: 655f 7072 6564 732e 6173 7365 7274 5f6e  e_preds.assert_n
-0001e660: 6f74 5f63 616c 6c65 6428 290a 2020 2020  ot_called().    
-0001e670: 6d6f 636b 5f67 656e 6572 6174 655f 6665  mock_generate_fe
-0001e680: 6564 6261 636b 2e61 7373 6572 745f 6e6f  edback.assert_no
-0001e690: 745f 6361 6c6c 6564 2829 0a0a 0a40 7079  t_called()...@py
-0001e6a0: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
-0001e6b0: 7472 697a 6528 0a20 2020 2022 7465 7374  trize(.    "test
-0001e6c0: 5f69 6e70 7574 7322 2c0a 2020 2020 5b5b  _inputs",.    [[
-0001e6d0: 7b22 4122 3a20 3130 307d 2c20 7b22 4122  {"A": 100}, {"A"
-0001e6e0: 3a20 3130 317d 5d5d 2c0a 290a 406d 6f63  : 101}]],.).@moc
-0001e6f0: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
-0001e700: 6c6f 6767 6572 2e75 7469 6c73 2e67 6574  logger.utils.get
-0001e710: 5f66 696c 655f 6c69 6e65 636f 756e 7422  _file_linecount"
-0001e720: 290a 6465 6620 7465 7374 5f6c 6f67 5f66  ).def test_log_f
-0001e730: 696c 6528 6d6f 636b 5f6c 696e 655f 636f  ile(mock_line_co
-0001e740: 756e 742c 2074 6573 745f 696e 7075 7473  unt, test_inputs
-0001e750: 293a 0a20 2020 206c 6f67 5f73 746f 7265  ):.    log_store
-0001e760: 203d 206d 6f63 6b2e 4d61 6769 634d 6f63   = mock.MagicMoc
-0001e770: 6b28 290a 2020 2020 6761 6e74 7279 203d  k().    gantry =
-0001e780: 2063 6c69 656e 742e 4761 6e74 7279 286c   client.Gantry(l
-0001e790: 6f67 5f73 746f 7265 3d6c 6f67 5f73 746f  og_store=log_sto
-0001e7a0: 7265 2c20 656e 7669 726f 6e6d 656e 743d  re, environment=
-0001e7b0: 2274 6573 7422 290a 2020 2020 6d6f 636b  "test").    mock
-0001e7c0: 5f6c 696e 655f 636f 756e 742e 7265 7475  _line_count.retu
-0001e7d0: 726e 5f76 616c 7565 203d 2035 0a0a 2020  rn_value = 5..  
-0001e7e0: 2020 6761 6e74 7279 2e6c 6f67 5f66 696c    gantry.log_fil
-0001e7f0: 6528 0a20 2020 2020 2020 2022 666f 6f62  e(.        "foob
-0001e800: 6172 222c 0a20 2020 2020 2020 2022 6469  ar",.        "di
-0001e810: 722f 6373 765f 7769 7468 5f68 6561 6465  r/csv_with_heade
-0001e820: 7273 2e63 7376 222c 0a20 2020 2020 2020  rs.csv",.       
-0001e830: 2076 6572 7369 6f6e 3d22 322e 302e 3122   version="2.0.1"
-0001e840: 2c0a 2020 2020 290a 0a20 2020 206c 6f67  ,.    )..    log
-0001e850: 5f73 746f 7265 2e6c 6f67 5f62 6174 6368  _store.log_batch
-0001e860: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
-0001e870: 6564 2829 0a0a 0a40 6d6f 636b 2e70 6174  ed()...@mock.pat
-0001e880: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
-0001e890: 722e 636c 6965 6e74 2e75 7569 642e 7575  r.client.uuid.uu
-0001e8a0: 6964 3422 2c20 7265 7475 726e 5f76 616c  id4", return_val
-0001e8b0: 7565 3d22 4142 4322 290a 406d 6f63 6b2e  ue="ABC").@mock.
-0001e8c0: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
-0001e8d0: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
-0001e8e0: 7279 2e5f 6861 6e64 6c65 5f75 706c 6f61  ry._handle_uploa
-0001e8f0: 6422 290a 6465 6620 7465 7374 5f73 6d61  d").def test_sma
-0001e900: 7274 5f66 696c 6572 6561 6428 6d6f 636b  rt_fileread(mock
-0001e910: 5f68 616e 646c 655f 7570 6c6f 6164 2c20  _handle_upload, 
-0001e920: 6d6f 636b 5f75 7569 642c 2063 6c69 5f6f  mock_uuid, cli_o
-0001e930: 626a 293a 0a20 2020 2064 6174 615f 6c69  bj):.    data_li
-0001e940: 6e6b 203d 206d 6f63 6b2e 4d6f 636b 2829  nk = mock.Mock()
-0001e950: 0a20 2020 2063 6c69 5f6f 626a 2e5f 736d  .    cli_obj._sm
-0001e960: 6172 745f 6669 6c65 5f72 6561 6428 0a20  art_file_read(. 
-0001e970: 2020 2020 2020 2064 6174 615f 6c69 6e6b         data_link
-0001e980: 3d64 6174 615f 6c69 6e6b 2c0a 2020 2020  =data_link,.    
-0001e990: 2020 2020 6f62 6a65 6374 5f73 697a 653d      object_size=
-0001e9a0: 3130 2c0a 2020 2020 2020 2020 7061 7468  10,.        path
-0001e9b0: 5f6e 616d 653d 2266 6f6f 6261 7222 2c0a  _name="foobar",.
-0001e9c0: 2020 2020 2020 2020 6669 6c65 3d69 6f2e          file=io.
-0001e9d0: 5374 7269 6e67 494f 2822 f09f 988e f09f  StringIO("......
-0001e9e0: 988e 2229 2c0a 2020 2020 2020 2020 6368  .."),.        ch
-0001e9f0: 756e 6b5f 7369 7a65 3d32 3030 2c0a 2020  unk_size=200,.  
-0001ea00: 2020 290a 0a20 2020 2061 7267 732c 206b    )..    args, k
-0001ea10: 7761 7267 7320 3d20 6d6f 636b 5f68 616e  wargs = mock_han
-0001ea20: 646c 655f 7570 6c6f 6164 2e63 616c 6c5f  dle_upload.call_
-0001ea30: 6172 6773 0a0a 2020 2020 6173 7365 7274  args..    assert
-0001ea40: 206c 6973 7428 6172 6773 5b30 5d29 203d   list(args[0]) =
-0001ea50: 3d20 5b62 225c 7866 305c 7839 665c 7839  = [b"\xf0\x9f\x9
-0001ea60: 385c 7838 655c 7866 305c 7839 665c 7839  8\x8e\xf0\x9f\x9
-0001ea70: 385c 7838 6522 5d20 2023 2074 6573 7420  8\x8e"]  # test 
-0001ea80: 5554 462d 3820 7375 7070 6f72 740a 2020  UTF-8 support.  
-0001ea90: 2020 6173 7365 7274 2061 7267 735b 315d    assert args[1]
-0001eaa0: 203d 3d20 6461 7461 5f6c 696e 6b0a 2020   == data_link.  
-0001eab0: 2020 6173 7365 7274 2061 7267 735b 325d    assert args[2]
-0001eac0: 203d 3d20 3130 0a20 2020 2061 7373 6572   == 10.    asser
-0001ead0: 7420 6172 6773 5b33 5d20 3d3d 2022 4142  t args[3] == "AB
-0001eae0: 435f 666f 6f62 6172 220a 0a0a 4070 7974  C_foobar"...@pyt
-0001eaf0: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-0001eb00: 7269 7a65 280a 2020 2020 5b22 696e 7075  rize(.    ["inpu
-0001eb10: 7473 222c 2022 6f75 7470 7574 7322 2c20  ts", "outputs", 
-0001eb20: 2266 6565 6462 6163 6b73 222c 2022 6a6f  "feedbacks", "jo
-0001eb30: 696e 5f6b 6579 7322 2c20 2274 696d 6573  in_keys", "times
-0001eb40: 7461 6d70 7322 5d2c 0a20 2020 205b 0a20  tamps"],.    [. 
-0001eb50: 2020 2020 2020 2028 5b7b 2241 223a 2031         ([{"A": 1
-0001eb60: 307d 5d20 2a20 3130 2c20 5b7b 2241 223a  0}] * 10, [{"A":
-0001eb70: 2031 307d 5d20 2a20 392c 204e 6f6e 652c   10}] * 9, None,
-0001eb80: 204e 6f6e 652c 204e 6f6e 6529 2c0a 2020   None, None),.  
-0001eb90: 2020 2020 2020 285b 7b22 4122 3a20 3130        ([{"A": 10
-0001eba0: 7d5d 202a 2031 302c 205b 7b22 4122 3a20  }] * 10, [{"A": 
-0001ebb0: 3130 7d5d 202a 2039 2c20 5b7b 2241 223a  10}] * 9, [{"A":
-0001ebc0: 2031 317d 5d20 2a20 3130 2c20 5b22 666f   11}] * 10, ["fo
-0001ebd0: 6f62 6172 225d 202a 2031 302c 204e 6f6e  obar"] * 10, Non
-0001ebe0: 6529 2c0a 2020 2020 2020 2020 285b 7b22  e),.        ([{"
-0001ebf0: 4122 3a20 3130 7d5d 202a 2039 2c20 5b7b  A": 10}] * 9, [{
-0001ec00: 2241 223a 2031 307d 5d20 2a20 382c 205b  "A": 10}] * 8, [
-0001ec10: 7b22 4122 3a20 3131 7d5d 202a 2031 302c  {"A": 11}] * 10,
-0001ec20: 205b 2266 6f6f 6261 7222 5d20 2a20 3130   ["foobar"] * 10
-0001ec30: 2c20 4e6f 6e65 292c 0a20 2020 2020 2020  , None),.       
-0001ec40: 2028 5b7b 2241 223a 2031 307d 5d20 2a20   ([{"A": 10}] * 
-0001ec50: 392c 204e 6f6e 652c 205b 7b22 4122 3a20  9, None, [{"A": 
-0001ec60: 3131 7d5d 202a 2031 302c 205b 2266 6f6f  11}] * 10, ["foo
-0001ec70: 6261 7222 5d20 2a20 3130 2c20 4e6f 6e65  bar"] * 10, None
-0001ec80: 292c 0a20 2020 2020 2020 2028 4e6f 6e65  ),.        (None
-0001ec90: 2c20 4e6f 6e65 2c20 5b7b 2241 223a 2031  , None, [{"A": 1
-0001eca0: 317d 5d20 2a20 3131 2c20 5b22 666f 6f62  1}] * 11, ["foob
-0001ecb0: 6172 225d 202a 2031 302c 204e 6f6e 6529  ar"] * 10, None)
-0001ecc0: 2c0a 2020 2020 2020 2020 284e 6f6e 652c  ,.        (None,
-0001ecd0: 204e 6f6e 652c 205b 7b22 4122 3a20 3131   None, [{"A": 11
-0001ece0: 7d5d 202a 2031 312c 205b 2266 6f6f 6261  }] * 11, ["fooba
-0001ecf0: 7222 5d20 2a20 3130 2c20 5b43 5552 5245  r"] * 10, [CURRE
-0001ed00: 4e54 5f54 494d 455d 202a 2031 3029 2c0a  NT_TIME] * 10),.
-0001ed10: 2020 2020 2020 2020 284e 6f6e 652c 204e          (None, N
-0001ed20: 6f6e 652c 205b 7b22 4122 3a20 3131 7d5d  one, [{"A": 11}]
-0001ed30: 202a 2031 312c 205b 2266 6f6f 6261 7222   * 11, ["foobar"
-0001ed40: 5d20 2a20 3130 2c20 6e70 2e61 7272 6179  ] * 10, np.array
-0001ed50: 285b 4355 5252 454e 545f 5449 4d45 5d20  ([CURRENT_TIME] 
-0001ed60: 2a20 3130 2929 2c0a 2020 2020 5d2c 0a29  * 10)),.    ],.)
-0001ed70: 0a40 6d6f 636b 2e70 6174 6368 2822 6761  .@mock.patch("ga
-0001ed80: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
-0001ed90: 6e74 2e47 616e 7472 792e 5f6c 6f67 5f70  nt.Gantry._log_p
-0001eda0: 7265 6469 6374 696f 6e5f 616e 645f 6665  rediction_and_fe
-0001edb0: 6564 6261 636b 5f65 7665 6e74 7322 290a  edback_events").
-0001edc0: 406d 6f63 6b2e 7061 7463 6828 2267 616e  @mock.patch("gan
-0001edd0: 7472 792e 6c6f 6767 6572 2e63 6c69 656e  try.logger.clien
-0001ede0: 742e 4761 6e74 7279 2e5f 6c6f 675f 7072  t.Gantry._log_pr
-0001edf0: 6564 6963 7469 6f6e 5f65 7665 6e74 7322  ediction_events"
-0001ee00: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
-0001ee10: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
-0001ee20: 656e 742e 4761 6e74 7279 2e5f 6c6f 675f  ent.Gantry._log_
-0001ee30: 6665 6564 6261 636b 5f65 7665 6e74 7322  feedback_events"
-0001ee40: 290a 6465 6620 7465 7374 5f6c 6f67 5f72  ).def test_log_r
-0001ee50: 6563 6f72 6473 5f73 697a 655f 6d69 736d  ecords_size_mism
-0001ee60: 6174 6368 280a 2020 2020 6d6f 636b 5f66  atch(.    mock_f
-0001ee70: 6565 6462 6163 6b73 2c0a 2020 2020 6d6f  eedbacks,.    mo
-0001ee80: 636b 5f70 7265 6473 2c0a 2020 2020 6d6f  ck_preds,.    mo
-0001ee90: 636b 5f70 7265 6473 5f61 6e64 5f66 6565  ck_preds_and_fee
-0001eea0: 6462 6163 6b2c 0a20 2020 2069 6e70 7574  dback,.    input
-0001eeb0: 732c 0a20 2020 206f 7574 7075 7473 2c0a  s,.    outputs,.
-0001eec0: 2020 2020 6665 6564 6261 636b 732c 0a20      feedbacks,. 
-0001eed0: 2020 2074 696d 6573 7461 6d70 732c 0a20     timestamps,. 
-0001eee0: 2020 206a 6f69 6e5f 6b65 7973 2c0a 2020     join_keys,.  
-0001eef0: 2020 636c 695f 6f62 6a2c 0a29 3a0a 2020    cli_obj,.):.  
-0001ef00: 2020 6173 7365 7274 2028 0a20 2020 2020    assert (.     
-0001ef10: 2020 2063 6c69 5f6f 626a 2e6c 6f67 5f72     cli_obj.log_r
-0001ef20: 6563 6f72 6473 280a 2020 2020 2020 2020  ecords(.        
-0001ef30: 2020 2020 6170 706c 6963 6174 696f 6e3d      application=
-0001ef40: 2266 6f6f 6261 7222 2c0a 2020 2020 2020  "foobar",.      
-0001ef50: 2020 2020 2020 7665 7273 696f 6e3d 2232        version="2
-0001ef60: 2e30 2e31 222c 0a20 2020 2020 2020 2020  .0.1",.         
-0001ef70: 2020 2069 6e70 7574 733d 696e 7075 7473     inputs=inputs
-0001ef80: 2c0a 2020 2020 2020 2020 2020 2020 6f75  ,.            ou
-0001ef90: 7470 7574 733d 6f75 7470 7574 732c 0a20  tputs=outputs,. 
-0001efa0: 2020 2020 2020 2020 2020 2066 6565 6462             feedb
-0001efb0: 6163 6b73 3d66 6565 6462 6163 6b73 2c0a  acks=feedbacks,.
-0001efc0: 2020 2020 2020 2020 2020 2020 7469 6d65              time
-0001efd0: 7374 616d 7073 3d74 696d 6573 7461 6d70  stamps=timestamp
-0001efe0: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
-0001eff0: 6f72 745f 6f6e 5f74 696d 6573 7461 6d70  ort_on_timestamp
-0001f000: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
-0001f010: 2020 206a 6f69 6e5f 6b65 7973 3d6a 6f69     join_keys=joi
-0001f020: 6e5f 6b65 7973 2c0a 2020 2020 2020 2020  n_keys,.        
-0001f030: 290a 2020 2020 2020 2020 6973 204e 6f6e  ).        is Non
-0001f040: 650a 2020 2020 290a 0a20 2020 206d 6f63  e.    )..    moc
-0001f050: 6b5f 7072 6564 735f 616e 645f 6665 6564  k_preds_and_feed
-0001f060: 6261 636b 2e61 7373 6572 745f 6e6f 745f  back.assert_not_
-0001f070: 6361 6c6c 6564 2829 0a20 2020 206d 6f63  called().    moc
-0001f080: 6b5f 7072 6564 732e 6173 7365 7274 5f6e  k_preds.assert_n
-0001f090: 6f74 5f63 616c 6c65 6428 290a 2020 2020  ot_called().    
-0001f0a0: 6d6f 636b 5f66 6565 6462 6163 6b73 2e61  mock_feedbacks.a
-0001f0b0: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
-0001f0c0: 2829 0a0a 0a40 7079 7465 7374 2e6d 6172  ()...@pytest.mar
-0001f0d0: 6b2e 7061 7261 6d65 7472 697a 6528 0a20  k.parametrize(. 
-0001f0e0: 2020 205b 2269 6e70 7574 7322 2c20 226f     ["inputs", "o
-0001f0f0: 7574 7075 7473 222c 2022 6665 6564 6261  utputs", "feedba
-0001f100: 636b 7322 2c20 226a 6f69 6e5f 6b65 7973  cks", "join_keys
-0001f110: 222c 2022 7469 6d65 7374 616d 7073 225d  ", "timestamps"]
-0001f120: 2c0a 2020 2020 5b0a 2020 2020 2020 2020  ,.    [.        
-0001f130: 285b 7b22 4122 3a20 3130 7d5d 202a 2031  ([{"A": 10}] * 1
-0001f140: 302c 205b 7b22 4122 3a20 3130 7d5d 202a  0, [{"A": 10}] *
-0001f150: 2039 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20   9, None, None, 
-0001f160: 4e6f 6e65 292c 0a20 2020 2020 2020 2028  None),.        (
-0001f170: 5b7b 2241 223a 2031 307d 5d20 2a20 3130  [{"A": 10}] * 10
-0001f180: 2c20 5b7b 2241 223a 2031 307d 5d20 2a20  , [{"A": 10}] * 
-0001f190: 392c 205b 7b22 4122 3a20 3131 7d5d 202a  9, [{"A": 11}] *
-0001f1a0: 2031 302c 205b 2266 6f6f 6261 7222 5d20   10, ["foobar"] 
-0001f1b0: 2a20 3130 2c20 4e6f 6e65 292c 0a20 2020  * 10, None),.   
-0001f1c0: 2020 2020 2028 5b7b 2241 223a 2031 307d       ([{"A": 10}
-0001f1d0: 5d20 2a20 392c 205b 7b22 4122 3a20 3130  ] * 9, [{"A": 10
-0001f1e0: 7d5d 202a 2038 2c20 5b7b 2241 223a 2031  }] * 8, [{"A": 1
-0001f1f0: 317d 5d20 2a20 3130 2c20 5b22 666f 6f62  1}] * 10, ["foob
-0001f200: 6172 225d 202a 2031 302c 204e 6f6e 6529  ar"] * 10, None)
-0001f210: 2c0a 2020 2020 2020 2020 285b 7b22 4122  ,.        ([{"A"
-0001f220: 3a20 3130 7d5d 202a 2039 2c20 4e6f 6e65  : 10}] * 9, None
-0001f230: 2c20 5b7b 2241 223a 2031 317d 5d20 2a20  , [{"A": 11}] * 
-0001f240: 3130 2c20 5b22 666f 6f62 6172 225d 202a  10, ["foobar"] *
-0001f250: 2031 302c 204e 6f6e 6529 2c0a 2020 2020   10, None),.    
-0001f260: 2020 2020 284e 6f6e 652c 204e 6f6e 652c      (None, None,
-0001f270: 205b 7b22 4122 3a20 3131 7d5d 202a 2031   [{"A": 11}] * 1
-0001f280: 312c 205b 2266 6f6f 6261 7222 5d20 2a20  1, ["foobar"] * 
-0001f290: 3130 2c20 4e6f 6e65 292c 0a20 2020 2020  10, None),.     
-0001f2a0: 2020 2028 4e6f 6e65 2c20 4e6f 6e65 2c20     (None, None, 
-0001f2b0: 5b7b 2241 223a 2031 317d 5d20 2a20 3131  [{"A": 11}] * 11
-0001f2c0: 2c20 5b22 666f 6f62 6172 225d 202a 2031  , ["foobar"] * 1
-0001f2d0: 302c 205b 4355 5252 454e 545f 5449 4d45  0, [CURRENT_TIME
-0001f2e0: 5d20 2a20 3130 292c 0a20 2020 2020 2020  ] * 10),.       
-0001f2f0: 2028 4e6f 6e65 2c20 4e6f 6e65 2c20 5b7b   (None, None, [{
-0001f300: 2241 223a 2031 317d 5d20 2a20 3131 2c20  "A": 11}] * 11, 
-0001f310: 5b22 666f 6f62 6172 225d 202a 2031 302c  ["foobar"] * 10,
-0001f320: 206e 702e 6172 7261 7928 5b43 5552 5245   np.array([CURRE
-0001f330: 4e54 5f54 494d 455d 202a 2031 3029 292c  NT_TIME] * 10)),
-0001f340: 0a20 2020 205d 2c0a 290a 406d 6f63 6b2e  .    ],.).@mock.
-0001f350: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
-0001f360: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
-0001f370: 7279 2e5f 6765 6e65 7261 7465 5f70 7265  ry._generate_pre
-0001f380: 6469 6374 696f 6e5f 616e 645f 6665 6564  diction_and_feed
-0001f390: 6261 636b 5f65 7665 6e74 7322 290a 406d  back_events").@m
-0001f3a0: 6f63 6b2e 7061 7463 6828 2267 616e 7472  ock.patch("gantr
-0001f3b0: 792e 6c6f 6767 6572 2e63 6c69 656e 742e  y.logger.client.
-0001f3c0: 4761 6e74 7279 2e5f 6765 6e65 7261 7465  Gantry._generate
-0001f3d0: 5f70 7265 6469 6374 696f 6e5f 6576 656e  _prediction_even
-0001f3e0: 7473 2229 0a40 6d6f 636b 2e70 6174 6368  ts").@mock.patch
-0001f3f0: 2822 6761 6e74 7279 2e6c 6f67 6765 722e  ("gantry.logger.
-0001f400: 636c 6965 6e74 2e47 616e 7472 792e 5f67  client.Gantry._g
-0001f410: 656e 6572 6174 655f 6665 6564 6261 636b  enerate_feedback
-0001f420: 5f65 7665 6e74 7322 290a 6465 6620 7465  _events").def te
-0001f430: 7374 5f67 656e 6572 6174 655f 7265 636f  st_generate_reco
-0001f440: 7264 735f 7369 7a65 5f6d 6973 6d61 7463  rds_size_mismatc
-0001f450: 6828 0a20 2020 206d 6f63 6b5f 6765 6e65  h(.    mock_gene
-0001f460: 7261 7465 5f66 6565 6462 6163 6b73 2c0a  rate_feedbacks,.
-0001f470: 2020 2020 6d6f 636b 5f67 656e 6572 6174      mock_generat
-0001f480: 655f 7072 6564 732c 0a20 2020 206d 6f63  e_preds,.    moc
-0001f490: 6b5f 6765 6e65 7261 7465 5f70 7265 6473  k_generate_preds
-0001f4a0: 5f61 6e64 5f66 6565 6462 6163 6b2c 0a20  _and_feedback,. 
-0001f4b0: 2020 2069 6e70 7574 732c 0a20 2020 206f     inputs,.    o
-0001f4c0: 7574 7075 7473 2c0a 2020 2020 6665 6564  utputs,.    feed
-0001f4d0: 6261 636b 732c 0a20 2020 2074 696d 6573  backs,.    times
-0001f4e0: 7461 6d70 732c 0a20 2020 206a 6f69 6e5f  tamps,.    join_
-0001f4f0: 6b65 7973 2c0a 2020 2020 636c 695f 6f62  keys,.    cli_ob
-0001f500: 6a2c 0a29 3a0a 2020 2020 6173 7365 7274  j,.):.    assert
-0001f510: 2028 0a20 2020 2020 2020 2063 6c69 5f6f   (.        cli_o
-0001f520: 626a 2e67 656e 6572 6174 655f 7265 636f  bj.generate_reco
-0001f530: 7264 7328 0a20 2020 2020 2020 2020 2020  rds(.           
-0001f540: 2061 7070 6c69 6361 7469 6f6e 3d22 666f   application="fo
-0001f550: 6f62 6172 222c 0a20 2020 2020 2020 2020  obar",.         
-0001f560: 2020 2076 6572 7369 6f6e 3d22 322e 302e     version="2.0.
-0001f570: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
-0001f580: 696e 7075 7473 3d69 6e70 7574 732c 0a20  inputs=inputs,. 
-0001f590: 2020 2020 2020 2020 2020 206f 7574 7075             outpu
-0001f5a0: 7473 3d6f 7574 7075 7473 2c0a 2020 2020  ts=outputs,.    
-0001f5b0: 2020 2020 2020 2020 6665 6564 6261 636b          feedback
-0001f5c0: 733d 6665 6564 6261 636b 732c 0a20 2020  s=feedbacks,.   
-0001f5d0: 2020 2020 2020 2020 2074 696d 6573 7461           timesta
-0001f5e0: 6d70 733d 7469 6d65 7374 616d 7073 2c0a  mps=timestamps,.
-0001f5f0: 2020 2020 2020 2020 2020 2020 736f 7274              sort
-0001f600: 5f6f 6e5f 7469 6d65 7374 616d 703d 5472  _on_timestamp=Tr
-0001f610: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-0001f620: 6a6f 696e 5f6b 6579 733d 6a6f 696e 5f6b  join_keys=join_k
-0001f630: 6579 732c 0a20 2020 2020 2020 2029 0a20  eys,.        ). 
-0001f640: 2020 2020 2020 2069 7320 4e6f 6e65 0a20         is None. 
-0001f650: 2020 2029 0a0a 2020 2020 6d6f 636b 5f67     )..    mock_g
-0001f660: 656e 6572 6174 655f 7072 6564 735f 616e  enerate_preds_an
-0001f670: 645f 6665 6564 6261 636b 2e61 7373 6572  d_feedback.asser
-0001f680: 745f 6e6f 745f 6361 6c6c 6564 2829 0a20  t_not_called(). 
-0001f690: 2020 206d 6f63 6b5f 6765 6e65 7261 7465     mock_generate
-0001f6a0: 5f70 7265 6473 2e61 7373 6572 745f 6e6f  _preds.assert_no
-0001f6b0: 745f 6361 6c6c 6564 2829 0a20 2020 206d  t_called().    m
-0001f6c0: 6f63 6b5f 6765 6e65 7261 7465 5f66 6565  ock_generate_fee
-0001f6d0: 6462 6163 6b73 2e61 7373 6572 745f 6e6f  dbacks.assert_no
-0001f6e0: 745f 6361 6c6c 6564 2829 0a0a 0a40 7079  t_called()...@py
-0001f6f0: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
-0001f700: 7472 697a 6528 0a20 2020 205b 2269 6e70  trize(.    ["inp
-0001f710: 7574 7322 2c20 226f 7574 7075 7473 222c  uts", "outputs",
-0001f720: 2022 6665 6564 6261 636b 7322 2c20 226a   "feedbacks", "j
-0001f730: 6f69 6e5f 6b65 7973 222c 2022 7469 6d65  oin_keys", "time
-0001f740: 7374 616d 7073 225d 2c0a 2020 2020 5b0a  stamps"],.    [.
-0001f750: 2020 2020 2020 2020 285b 7b22 4122 3a20          ([{"A": 
-0001f760: 3130 7d5d 202a 2031 302c 205b 7b22 4122  10}] * 10, [{"A"
-0001f770: 3a20 3130 7d5d 202a 2031 302c 204e 6f6e  : 10}] * 10, Non
-0001f780: 652c 204e 6f6e 652c 204e 6f6e 6529 2c0a  e, None, None),.
-0001f790: 2020 2020 2020 2020 285b 7b22 4122 3a20          ([{"A": 
-0001f7a0: 3130 7d5d 202a 2031 302c 205b 7b22 4122  10}] * 10, [{"A"
-0001f7b0: 3a20 3130 7d5d 202a 2031 302c 205b 7b22  : 10}] * 10, [{"
-0001f7c0: 4122 3a20 3131 7d5d 202a 2031 302c 205b  A": 11}] * 10, [
-0001f7d0: 2266 6f6f 6261 7222 5d20 2a20 3130 2c20  "foobar"] * 10, 
-0001f7e0: 4e6f 6e65 292c 0a20 2020 2020 2020 2028  None),.        (
-0001f7f0: 5b7b 2241 223a 2031 307d 5d20 2a20 3130  [{"A": 10}] * 10
-0001f800: 2c20 5b7b 2241 223a 2031 307d 5d20 2a20  , [{"A": 10}] * 
-0001f810: 3130 2c20 5b7b 2241 223a 2031 317d 5d20  10, [{"A": 11}] 
-0001f820: 2a20 3130 2c20 5b22 666f 6f62 6172 225d  * 10, ["foobar"]
-0001f830: 202a 2031 302c 204e 6f6e 6529 2c0a 2020   * 10, None),.  
-0001f840: 2020 2020 2020 284e 6f6e 652c 204e 6f6e        (None, Non
-0001f850: 652c 205b 7b22 4122 3a20 3131 7d5d 202a  e, [{"A": 11}] *
-0001f860: 2031 302c 205b 2266 6f6f 6261 7222 5d20   10, ["foobar"] 
-0001f870: 2a20 3130 2c20 4e6f 6e65 292c 0a20 2020  * 10, None),.   
-0001f880: 2020 2020 2028 4e6f 6e65 2c20 4e6f 6e65       (None, None
-0001f890: 2c20 5b7b 2241 223a 2031 317d 5d20 2a20  , [{"A": 11}] * 
-0001f8a0: 3130 2c20 5b22 666f 6f62 6172 225d 202a  10, ["foobar"] *
-0001f8b0: 2031 302c 205b 4355 5252 454e 545f 5449   10, [CURRENT_TI
-0001f8c0: 4d45 5d20 2a20 3130 292c 0a20 2020 2020  ME] * 10),.     
-0001f8d0: 2020 2028 4e6f 6e65 2c20 4e6f 6e65 2c20     (None, None, 
-0001f8e0: 5b7b 2241 223a 2031 317d 5d20 2a20 3130  [{"A": 11}] * 10
-0001f8f0: 2c20 5b22 666f 6f62 6172 225d 202a 2031  , ["foobar"] * 1
-0001f900: 302c 206e 702e 6172 7261 7928 5b43 5552  0, np.array([CUR
-0001f910: 5245 4e54 5f54 494d 455d 202a 2031 3029  RENT_TIME] * 10)
-0001f920: 292c 0a20 2020 205d 2c0a 290a 406d 6f63  ),.    ],.).@moc
-0001f930: 6b2e 7061 7463 6828 0a20 2020 2022 6761  k.patch(.    "ga
-0001f940: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
-0001f950: 6e74 2e47 616e 7472 792e 5f6c 6f67 5f70  nt.Gantry._log_p
-0001f960: 7265 6469 6374 696f 6e5f 616e 645f 6665  rediction_and_fe
-0001f970: 6564 6261 636b 5f65 7665 6e74 7322 2c0a  edback_events",.
-0001f980: 2020 2020 7265 7475 726e 5f76 616c 7565      return_value
-0001f990: 3d28 4e6f 6e65 2c20 5b22 3132 3334 3522  =(None, ["12345"
-0001f9a0: 2c20 2236 3738 3930 225d 292c 0a29 0a40  , "67890"]),.).@
-0001f9b0: 6d6f 636b 2e70 6174 6368 280a 2020 2020  mock.patch(.    
-0001f9c0: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
-0001f9d0: 6c69 656e 742e 4761 6e74 7279 2e5f 6c6f  lient.Gantry._lo
-0001f9e0: 675f 7072 6564 6963 7469 6f6e 5f65 7665  g_prediction_eve
-0001f9f0: 6e74 7322 2c20 7265 7475 726e 5f76 616c  nts", return_val
-0001fa00: 7565 3d28 4e6f 6e65 2c20 5b22 3132 3334  ue=(None, ["1234
-0001fa10: 3522 2c20 2236 3738 3930 225d 290a 290a  5", "67890"]).).
-0001fa20: 406d 6f63 6b2e 7061 7463 6828 0a20 2020  @mock.patch(.   
-0001fa30: 2022 6761 6e74 7279 2e6c 6f67 6765 722e   "gantry.logger.
-0001fa40: 636c 6965 6e74 2e47 616e 7472 792e 5f6c  client.Gantry._l
-0001fa50: 6f67 5f66 6565 6462 6163 6b5f 6576 656e  og_feedback_even
-0001fa60: 7473 222c 2072 6574 7572 6e5f 7661 6c75  ts", return_valu
-0001fa70: 653d 284e 6f6e 652c 205b 2231 3233 3435  e=(None, ["12345
-0001fa80: 222c 2022 3637 3839 3022 5d29 0a29 0a64  ", "67890"]).).d
-0001fa90: 6566 2074 6573 745f 6c6f 675f 7265 636f  ef test_log_reco
-0001faa0: 7264 735f 7369 7a65 5f6d 6174 6368 280a  rds_size_match(.
-0001fab0: 2020 2020 6d6f 636b 5f66 6565 6462 6163      mock_feedbac
-0001fac0: 6b73 2c0a 2020 2020 6d6f 636b 5f70 7265  ks,.    mock_pre
-0001fad0: 6473 2c0a 2020 2020 6d6f 636b 5f70 7265  ds,.    mock_pre
-0001fae0: 6473 5f61 6e64 5f66 6565 6462 6163 6b2c  ds_and_feedback,
-0001faf0: 0a20 2020 2069 6e70 7574 732c 0a20 2020  .    inputs,.   
-0001fb00: 206f 7574 7075 7473 2c0a 2020 2020 6665   outputs,.    fe
-0001fb10: 6564 6261 636b 732c 0a20 2020 2074 696d  edbacks,.    tim
-0001fb20: 6573 7461 6d70 732c 0a20 2020 206a 6f69  estamps,.    joi
-0001fb30: 6e5f 6b65 7973 2c0a 2020 2020 636c 695f  n_keys,.    cli_
-0001fb40: 6f62 6a2c 0a29 3a0a 2020 2020 6173 7365  obj,.):.    asse
-0001fb50: 7274 2028 0a20 2020 2020 2020 2063 6c69  rt (.        cli
-0001fb60: 5f6f 626a 2e6c 6f67 5f72 6563 6f72 6473  _obj.log_records
-0001fb70: 280a 2020 2020 2020 2020 2020 2020 6170  (.            ap
-0001fb80: 706c 6963 6174 696f 6e3d 2266 6f6f 6261  plication="fooba
-0001fb90: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
-0001fba0: 7665 7273 696f 6e3d 2232 2e30 2e31 222c  version="2.0.1",
-0001fbb0: 0a20 2020 2020 2020 2020 2020 2069 6e70  .            inp
-0001fbc0: 7574 733d 696e 7075 7473 2c0a 2020 2020  uts=inputs,.    
-0001fbd0: 2020 2020 2020 2020 6f75 7470 7574 733d          outputs=
-0001fbe0: 6f75 7470 7574 732c 0a20 2020 2020 2020  outputs,.       
-0001fbf0: 2020 2020 2066 6565 6462 6163 6b73 3d66       feedbacks=f
-0001fc00: 6565 6462 6163 6b73 2c0a 2020 2020 2020  eedbacks,.      
-0001fc10: 2020 2020 2020 7469 6d65 7374 616d 7073        timestamps
-0001fc20: 3d74 696d 6573 7461 6d70 732c 0a20 2020  =timestamps,.   
-0001fc30: 2020 2020 2020 2020 2073 6f72 745f 6f6e           sort_on
-0001fc40: 5f74 696d 6573 7461 6d70 3d54 7275 652c  _timestamp=True,
-0001fc50: 0a20 2020 2020 2020 2020 2020 206a 6f69  .            joi
-0001fc60: 6e5f 6b65 7973 3d6a 6f69 6e5f 6b65 7973  n_keys=join_keys
-0001fc70: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0001fc80: 2020 2020 6973 206e 6f74 204e 6f6e 650a      is not None.
-0001fc90: 2020 2020 290a 0a0a 4070 7974 6573 742e      )...@pytest.
-0001fca0: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
-0001fcb0: 280a 2020 2020 5b22 696e 7075 7473 222c  (.    ["inputs",
-0001fcc0: 2022 6f75 7470 7574 7322 2c20 2266 6565   "outputs", "fee
-0001fcd0: 6462 6163 6b73 222c 2022 6a6f 696e 5f6b  dbacks", "join_k
-0001fce0: 6579 7322 2c20 2274 696d 6573 7461 6d70  eys", "timestamp
-0001fcf0: 7322 5d2c 0a20 2020 205b 0a20 2020 2020  s"],.    [.     
-0001fd00: 2020 2028 5b7b 2241 223a 2031 307d 5d20     ([{"A": 10}] 
-0001fd10: 2a20 3130 2c20 5b7b 2241 223a 2031 307d  * 10, [{"A": 10}
-0001fd20: 5d20 2a20 3130 2c20 4e6f 6e65 2c20 4e6f  ] * 10, None, No
-0001fd30: 6e65 2c20 4e6f 6e65 292c 0a20 2020 2020  ne, None),.     
-0001fd40: 2020 2028 5b7b 2241 223a 2031 307d 5d20     ([{"A": 10}] 
-0001fd50: 2a20 3130 2c20 5b7b 2241 223a 2031 307d  * 10, [{"A": 10}
-0001fd60: 5d20 2a20 3130 2c20 5b7b 2241 223a 2031  ] * 10, [{"A": 1
-0001fd70: 317d 5d20 2a20 3130 2c20 5b22 666f 6f62  1}] * 10, ["foob
-0001fd80: 6172 225d 202a 2031 302c 204e 6f6e 6529  ar"] * 10, None)
-0001fd90: 2c0a 2020 2020 2020 2020 285b 7b22 4122  ,.        ([{"A"
-0001fda0: 3a20 3130 7d5d 202a 2031 302c 205b 7b22  : 10}] * 10, [{"
-0001fdb0: 4122 3a20 3130 7d5d 202a 2031 302c 205b  A": 10}] * 10, [
-0001fdc0: 7b22 4122 3a20 3131 7d5d 202a 2031 302c  {"A": 11}] * 10,
-0001fdd0: 205b 2266 6f6f 6261 7222 5d20 2a20 3130   ["foobar"] * 10
-0001fde0: 2c20 4e6f 6e65 292c 0a20 2020 2020 2020  , None),.       
-0001fdf0: 2028 4e6f 6e65 2c20 4e6f 6e65 2c20 5b7b   (None, None, [{
-0001fe00: 2241 223a 2031 317d 5d20 2a20 3130 2c20  "A": 11}] * 10, 
-0001fe10: 5b22 666f 6f62 6172 225d 202a 2031 302c  ["foobar"] * 10,
-0001fe20: 204e 6f6e 6529 2c0a 2020 2020 2020 2020   None),.        
-0001fe30: 284e 6f6e 652c 204e 6f6e 652c 205b 7b22  (None, None, [{"
-0001fe40: 4122 3a20 3131 7d5d 202a 2031 302c 205b  A": 11}] * 10, [
-0001fe50: 2266 6f6f 6261 7222 5d20 2a20 3130 2c20  "foobar"] * 10, 
-0001fe60: 5b43 5552 5245 4e54 5f54 494d 455d 202a  [CURRENT_TIME] *
-0001fe70: 2031 3029 2c0a 2020 2020 2020 2020 284e   10),.        (N
-0001fe80: 6f6e 652c 204e 6f6e 652c 205b 7b22 4122  one, None, [{"A"
-0001fe90: 3a20 3131 7d5d 202a 2031 302c 205b 2266  : 11}] * 10, ["f
-0001fea0: 6f6f 6261 7222 5d20 2a20 3130 2c20 6e70  oobar"] * 10, np
-0001feb0: 2e61 7272 6179 285b 4355 5252 454e 545f  .array([CURRENT_
-0001fec0: 5449 4d45 5d20 2a20 3130 2929 2c0a 2020  TIME] * 10)),.  
-0001fed0: 2020 5d2c 0a29 0a40 6d6f 636b 2e70 6174    ],.).@mock.pat
-0001fee0: 6368 280a 2020 2020 2267 616e 7472 792e  ch(.    "gantry.
-0001fef0: 6c6f 6767 6572 2e63 6c69 656e 742e 4761  logger.client.Ga
-0001ff00: 6e74 7279 2e5f 6765 6e65 7261 7465 5f70  ntry._generate_p
-0001ff10: 7265 6469 6374 696f 6e5f 616e 645f 6665  rediction_and_fe
-0001ff20: 6564 6261 636b 5f65 7665 6e74 7322 2c0a  edback_events",.
-0001ff30: 2020 2020 7265 7475 726e 5f76 616c 7565      return_value
-0001ff40: 3d28 4e6f 6e65 2c20 5b22 3132 3334 3522  =(None, ["12345"
-0001ff50: 2c20 2236 3738 3930 225d 292c 0a29 0a40  , "67890"]),.).@
-0001ff60: 6d6f 636b 2e70 6174 6368 280a 2020 2020  mock.patch(.    
-0001ff70: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
-0001ff80: 6c69 656e 742e 4761 6e74 7279 2e5f 6765  lient.Gantry._ge
-0001ff90: 6e65 7261 7465 5f70 7265 6469 6374 696f  nerate_predictio
-0001ffa0: 6e5f 6576 656e 7473 222c 0a20 2020 2072  n_events",.    r
-0001ffb0: 6574 7572 6e5f 7661 6c75 653d 284e 6f6e  eturn_value=(Non
-0001ffc0: 652c 205b 2231 3233 3435 222c 2022 3637  e, ["12345", "67
-0001ffd0: 3839 3022 5d29 2c0a 290a 406d 6f63 6b2e  890"]),.).@mock.
-0001ffe0: 7061 7463 6828 0a20 2020 2022 6761 6e74  patch(.    "gant
-0001fff0: 7279 2e6c 6f67 6765 722e 636c 6965 6e74  ry.logger.client
-00020000: 2e47 616e 7472 792e 5f67 656e 6572 6174  .Gantry._generat
-00020010: 655f 6665 6564 6261 636b 5f65 7665 6e74  e_feedback_event
-00020020: 7322 2c20 7265 7475 726e 5f76 616c 7565  s", return_value
-00020030: 3d28 4e6f 6e65 2c20 5b22 3132 3334 3522  =(None, ["12345"
-00020040: 2c20 2236 3738 3930 225d 290a 290a 6465  , "67890"]).).de
-00020050: 6620 7465 7374 5f67 656e 6572 6174 655f  f test_generate_
-00020060: 7265 636f 7264 735f 7369 7a65 5f6d 6174  records_size_mat
-00020070: 6368 280a 2020 2020 6d6f 636b 5f67 656e  ch(.    mock_gen
-00020080: 6572 6174 655f 6665 6564 6261 636b 732c  erate_feedbacks,
-00020090: 0a20 2020 206d 6f63 6b5f 6765 6e65 7261  .    mock_genera
-000200a0: 7465 5f70 7265 6473 2c0a 2020 2020 6d6f  te_preds,.    mo
-000200b0: 636b 5f67 656e 6572 6174 655f 7072 6564  ck_generate_pred
-000200c0: 735f 616e 645f 6665 6564 6261 636b 2c0a  s_and_feedback,.
-000200d0: 2020 2020 696e 7075 7473 2c0a 2020 2020      inputs,.    
-000200e0: 6f75 7470 7574 732c 0a20 2020 2066 6565  outputs,.    fee
-000200f0: 6462 6163 6b73 2c0a 2020 2020 7469 6d65  dbacks,.    time
-00020100: 7374 616d 7073 2c0a 2020 2020 6a6f 696e  stamps,.    join
-00020110: 5f6b 6579 732c 0a20 2020 2063 6c69 5f6f  _keys,.    cli_o
-00020120: 626a 2c0a 293a 0a20 2020 2061 7373 6572  bj,.):.    asser
-00020130: 7420 280a 2020 2020 2020 2020 636c 695f  t (.        cli_
-00020140: 6f62 6a2e 6765 6e65 7261 7465 5f72 6563  obj.generate_rec
-00020150: 6f72 6473 280a 2020 2020 2020 2020 2020  ords(.          
-00020160: 2020 6170 706c 6963 6174 696f 6e3d 2266    application="f
-00020170: 6f6f 6261 7222 2c0a 2020 2020 2020 2020  oobar",.        
-00020180: 2020 2020 7665 7273 696f 6e3d 2232 2e30      version="2.0
-00020190: 2e31 222c 0a20 2020 2020 2020 2020 2020  .1",.           
-000201a0: 2069 6e70 7574 733d 696e 7075 7473 2c0a   inputs=inputs,.
-000201b0: 2020 2020 2020 2020 2020 2020 6f75 7470              outp
-000201c0: 7574 733d 6f75 7470 7574 732c 0a20 2020  uts=outputs,.   
-000201d0: 2020 2020 2020 2020 2066 6565 6462 6163           feedbac
-000201e0: 6b73 3d66 6565 6462 6163 6b73 2c0a 2020  ks=feedbacks,.  
-000201f0: 2020 2020 2020 2020 2020 7469 6d65 7374            timest
-00020200: 616d 7073 3d74 696d 6573 7461 6d70 732c  amps=timestamps,
-00020210: 0a20 2020 2020 2020 2020 2020 2073 6f72  .            sor
-00020220: 745f 6f6e 5f74 696d 6573 7461 6d70 3d54  t_on_timestamp=T
-00020230: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
-00020240: 206a 6f69 6e5f 6b65 7973 3d6a 6f69 6e5f   join_keys=join_
-00020250: 6b65 7973 2c0a 2020 2020 2020 2020 290a  keys,.        ).
-00020260: 2020 2020 2020 2020 6973 206e 6f74 204e          is not N
-00020270: 6f6e 650a 2020 2020 290a 0a0a 4070 7974  one.    )...@pyt
-00020280: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
-00020290: 7269 7a65 280a 2020 2020 2822 7469 6d65  rize(.    ("time
-000202a0: 7374 616d 7022 2c20 2269 6e70 7574 7322  stamp", "inputs"
-000202b0: 2c20 226f 7574 7075 7473 222c 2022 6665  , "outputs", "fe
-000202c0: 6564 6261 636b 7322 2c20 226a 6f69 6e5f  edbacks", "join_
-000202d0: 6b65 7922 2c20 2267 6c6f 6261 6c5f 7461  key", "global_ta
-000202e0: 6773 222c 2022 726f 775f 7461 6773 2229  gs", "row_tags")
-000202f0: 2c0a 2020 2020 5b20 2023 2054 6573 7420  ,.    [  # Test 
-00020300: 616c 6c20 636f 6d62 696e 6174 696f 6e73  all combinations
-00020310: 206f 6620 696e 7075 7473 2c20 6f75 7470   of inputs, outp
-00020320: 7574 732c 2066 6565 6462 6163 6b73 2c20  uts, feedbacks, 
-00020330: 616e 6420 6a6f 696e 5f6b 6579 0a20 2020  and join_key.   
-00020340: 2020 2020 2028 2254 222c 205b 2241 222c       ("T", ["A",
-00020350: 2022 4222 5d2c 205b 2243 222c 2022 4422   "B"], ["C", "D"
-00020360: 5d2c 205b 2248 222c 2022 4922 5d2c 2022  ], ["H", "I"], "
-00020370: 4522 2c20 7b22 7665 7273 696f 6e22 3a20  E", {"version": 
-00020380: 2274 6573 745f 7665 7273 696f 6e22 7d2c  "test_version"},
-00020390: 205b 2247 225d 292c 0a20 2020 2020 2020   ["G"]),.       
-000203a0: 2023 2054 6573 7420 7769 7468 6f75 7420   # Test without 
-000203b0: 6665 6564 6261 636b 7320 616e 6420 726f  feedbacks and ro
-000203c0: 775f 7461 6773 0a20 2020 2020 2020 2028  w_tags.        (
-000203d0: 2254 222c 205b 2241 222c 2022 4222 5d2c  "T", ["A", "B"],
-000203e0: 205b 2244 225d 2c20 4e6f 6e65 2c20 2245   ["D"], None, "E
-000203f0: 222c 207b 2276 6572 7369 6f6e 223a 2022  ", {"version": "
-00020400: 7465 7374 5f76 6572 7369 6f6e 227d 2c20  test_version"}, 
-00020410: 4e6f 6e65 292c 0a20 2020 2020 2020 2023  None),.        #
-00020420: 2054 6573 7420 7769 7468 6f75 7420 696e   Test without in
-00020430: 7075 7473 2061 6e64 2074 696d 6573 7461  puts and timesta
-00020440: 6d70 0a20 2020 2020 2020 2028 4e6f 6e65  mp.        (None
-00020450: 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20 5b22  , None, None, ["
-00020460: 4822 2c20 2249 225d 2c20 2245 222c 207b  H", "I"], "E", {
-00020470: 2276 6572 7369 6f6e 223a 2022 7465 7374  "version": "test
-00020480: 5f76 6572 7369 6f6e 227d 2c20 5b22 4722  _version"}, ["G"
-00020490: 5d29 2c0a 2020 2020 2020 2020 2320 5465  ]),.        # Te
-000204a0: 7374 206f 6e6c 7920 7769 7468 2066 6565  st only with fee
-000204b0: 6462 6163 6b73 2061 6e64 206a 6f69 6e5f  dbacks and join_
-000204c0: 6b65 790a 2020 2020 2020 2020 284e 6f6e  key.        (Non
-000204d0: 652c 204e 6f6e 652c 204e 6f6e 652c 205b  e, None, None, [
-000204e0: 2248 222c 2022 4922 5d2c 2022 4522 2c20  "H", "I"], "E", 
-000204f0: 4e6f 6e65 2c20 4e6f 6e65 292c 0a20 2020  None, None),.   
-00020500: 2020 2020 2023 2054 6573 7420 6f6e 6c79       # Test only
-00020510: 2077 6974 6820 696e 7075 7473 2061 6e64   with inputs and
-00020520: 2067 6c6f 6261 6c20 7461 6773 0a20 2020   global tags.   
-00020530: 2020 2020 2028 2254 222c 205b 2241 222c       ("T", ["A",
-00020540: 2022 4222 5d2c 205b 2243 222c 2022 4422   "B"], ["C", "D"
-00020550: 5d2c 204e 6f6e 652c 204e 6f6e 652c 207b  ], None, None, {
-00020560: 2276 6572 7369 6f6e 223a 2022 7465 7374  "version": "test
-00020570: 5f76 6572 7369 6f6e 227d 2c20 4e6f 6e65  _version"}, None
-00020580: 292c 0a20 2020 205d 2c0a 290a 6465 6620  ),.    ],.).def 
-00020590: 7465 7374 5f6c 6f67 5f66 726f 6d5f 6461  test_log_from_da
-000205a0: 7461 5f63 6f6e 6e65 6374 6f72 280a 2020  ta_connector(.  
-000205b0: 2020 7469 6d65 7374 616d 703a 2073 7472    timestamp: str
-000205c0: 2c0a 2020 2020 696e 7075 7473 3a20 4c69  ,.    inputs: Li
-000205d0: 7374 5b73 7472 5d2c 0a20 2020 206f 7574  st[str],.    out
-000205e0: 7075 7473 3a20 4c69 7374 5b73 7472 5d2c  puts: List[str],
-000205f0: 0a20 2020 2066 6565 6462 6163 6b73 3a20  .    feedbacks: 
-00020600: 4c69 7374 5b73 7472 5d2c 0a20 2020 206a  List[str],.    j
-00020610: 6f69 6e5f 6b65 793a 2073 7472 2c0a 2020  oin_key: str,.  
-00020620: 2020 726f 775f 7461 6773 3a20 4c69 7374    row_tags: List
-00020630: 5b73 7472 5d2c 0a20 2020 2067 6c6f 6261  [str],.    globa
-00020640: 6c5f 7461 6773 3a20 4469 6374 5b73 7472  l_tags: Dict[str
-00020650: 2c20 7374 725d 2c0a 2020 2020 636c 695f  , str],.    cli_
-00020660: 6f62 6a2c 0a29 3a0a 2020 2020 2222 220a  obj,.):.    """.
-00020670: 2020 2020 5465 7374 7320 7468 6174 2074      Tests that t
-00020680: 6865 206c 6f67 5f66 726f 6d5f 6461 7461  he log_from_data
-00020690: 5f63 6f6e 6e65 6374 6f72 2066 756e 6374  _connector funct
-000206a0: 696f 6e20 6361 6c6c 7320 7468 6520 6c6f  ion calls the lo
-000206b0: 675f 6672 6f6d 5f64 6174 615f 636f 6e6e  g_from_data_conn
-000206c0: 6563 746f 725f 6173 796e 630a 2020 2020  ector_async.    
-000206d0: 6675 6e63 7469 6f6e 2077 6974 6820 636f  function with co
-000206e0: 7272 6563 7420 7061 7261 6d65 7465 7273  rrect parameters
-000206f0: 0a20 2020 2022 2222 0a20 2020 2063 6c69  .    """.    cli
-00020700: 5f6f 626a 2e6c 6f67 5f73 746f 7265 203d  _obj.log_store =
-00020710: 206d 6f63 6b2e 4d6f 636b 2829 0a20 2020   mock.Mock().   
-00020720: 2063 6c69 5f6f 626a 2e6c 6f67 5f66 726f   cli_obj.log_fro
-00020730: 6d5f 6461 7461 5f63 6f6e 6e65 6374 6f72  m_data_connector
-00020740: 280a 2020 2020 2020 2020 6170 706c 6963  (.        applic
-00020750: 6174 696f 6e3d 2266 6f6f 6261 7222 2c0a  ation="foobar",.
-00020760: 2020 2020 2020 2020 736f 7572 6365 5f64          source_d
-00020770: 6174 615f 636f 6e6e 6563 746f 725f 6e61  ata_connector_na
-00020780: 6d65 3d22 7465 7374 2d63 6f6e 6e65 6374  me="test-connect
-00020790: 6f72 222c 0a20 2020 2020 2020 2074 696d  or",.        tim
-000207a0: 6573 7461 6d70 3d74 696d 6573 7461 6d70  estamp=timestamp
-000207b0: 2c0a 2020 2020 2020 2020 696e 7075 7473  ,.        inputs
-000207c0: 3d69 6e70 7574 732c 0a20 2020 2020 2020  =inputs,.       
-000207d0: 206f 7574 7075 7473 3d6f 7574 7075 7473   outputs=outputs
-000207e0: 2c0a 2020 2020 2020 2020 6665 6564 6261  ,.        feedba
-000207f0: 636b 733d 6665 6564 6261 636b 732c 0a20  cks=feedbacks,. 
-00020800: 2020 2020 2020 206a 6f69 6e5f 6b65 793d         join_key=
-00020810: 6a6f 696e 5f6b 6579 2c0a 2020 2020 2020  join_key,.      
-00020820: 2020 726f 775f 7461 6773 3d72 6f77 5f74    row_tags=row_t
-00020830: 6167 732c 0a20 2020 2020 2020 2067 6c6f  ags,.        glo
-00020840: 6261 6c5f 7461 6773 3d67 6c6f 6261 6c5f  bal_tags=global_
-00020850: 7461 6773 2c0a 2020 2020 290a 0a20 2020  tags,.    )..   
-00020860: 2063 616c 6c5f 6172 6773 203d 2063 6c69   call_args = cli
-00020870: 5f6f 626a 2e6c 6f67 5f73 746f 7265 2e6c  _obj.log_store.l
-00020880: 6f67 5f66 726f 6d5f 6461 7461 5f63 6f6e  og_from_data_con
-00020890: 6e65 6374 6f72 5f61 7379 6e63 2e63 616c  nector_async.cal
-000208a0: 6c5f 6172 6773 0a20 2020 2061 7373 6572  l_args.    asser
-000208b0: 7420 6361 6c6c 5f61 7267 732e 6b77 6172  t call_args.kwar
-000208c0: 6773 203d 3d20 7b0a 2020 2020 2020 2020  gs == {.        
-000208d0: 2272 6571 7565 7374 223a 2049 6e67 6573  "request": Inges
-000208e0: 7446 726f 6d44 6174 6143 6f6e 6e65 6374  tFromDataConnect
-000208f0: 6f72 5265 7175 6573 7428 0a20 2020 2020  orRequest(.     
-00020900: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
-00020910: 6f6e 3d22 666f 6f62 6172 222c 0a20 2020  on="foobar",.   
-00020920: 2020 2020 2020 2020 2073 6f75 7263 655f           source_
-00020930: 6461 7461 5f63 6f6e 6e65 6374 6f72 5f6e  data_connector_n
-00020940: 616d 653d 2274 6573 742d 636f 6e6e 6563  ame="test-connec
-00020950: 746f 7222 2c0a 2020 2020 2020 2020 2020  tor",.          
-00020960: 2020 7469 6d65 7374 616d 703d 7469 6d65    timestamp=time
-00020970: 7374 616d 702c 0a20 2020 2020 2020 2020  stamp,.         
-00020980: 2020 2069 6e70 7574 733d 696e 7075 7473     inputs=inputs
-00020990: 2c0a 2020 2020 2020 2020 2020 2020 6f75  ,.            ou
-000209a0: 7470 7574 733d 6f75 7470 7574 732c 0a20  tputs=outputs,. 
-000209b0: 2020 2020 2020 2020 2020 2066 6565 6462             feedb
-000209c0: 6163 6b73 3d66 6565 6462 6163 6b73 2c0a  acks=feedbacks,.
-000209d0: 2020 2020 2020 2020 2020 2020 6a6f 696e              join
-000209e0: 5f6b 6579 3d6a 6f69 6e5f 6b65 792c 0a20  _key=join_key,. 
-000209f0: 2020 2020 2020 2020 2020 2072 6f77 5f74             row_t
-00020a00: 6167 733d 726f 775f 7461 6773 2c0a 2020  ags=row_tags,.  
-00020a10: 2020 2020 2020 2020 2020 676c 6f62 616c            global
-00020a20: 5f74 6167 733d 676c 6f62 616c 5f74 6167  _tags=global_tag
-00020a30: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
-00020a40: 6368 6564 756c 653d 4e6f 6e65 2c0a 2020  chedule=None,.  
-00020a50: 2020 2020 2020 2020 2020 7069 7065 6c69            pipeli
-00020a60: 6e65 5f6e 616d 653d 4e6f 6e65 2c0a 2020  ne_name=None,.  
-00020a70: 2020 2020 2020 290a 2020 2020 7d0a 0a0a        ).    }...
-00020a80: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
-00020a90: 616d 6574 7269 7a65 280a 2020 2020 2822  ametrize(.    ("
-00020aa0: 7374 6172 745f 6f6e 222c 2022 6672 6571  start_on", "freq
-00020ab0: 7565 6e63 7922 2c20 2274 7970 6522 2c20  uency", "type", 
-00020ac0: 226f 7074 696f 6e73 2229 2c0a 2020 2020  "options"),.    
-00020ad0: 5b0a 2020 2020 2020 2020 280a 2020 2020  [.        (.    
-00020ae0: 2020 2020 2020 2020 2232 3032 332d 3032          "2023-02
-00020af0: 2d30 3154 3030 3a30 303a 3030 2e30 3030  -01T00:00:00.000
-00020b00: 3030 3022 2c0a 2020 2020 2020 2020 2020  000",.          
-00020b10: 2020 5363 6865 6475 6c65 4672 6571 7565    ScheduleFreque
-00020b20: 6e63 792e 4556 4552 595f 484f 5552 2c0a  ncy.EVERY_HOUR,.
-00020b30: 2020 2020 2020 2020 2020 2020 5363 6865              Sche
-00020b40: 6475 6c65 5479 7065 2e49 4e43 5245 4d45  duleType.INCREME
-00020b50: 4e54 414c 5f41 5050 454e 442c 0a20 2020  NTAL_APPEND,.   
-00020b60: 2020 2020 2020 2020 207b 2277 6174 6572           {"water
-00020b70: 6d61 726b 5f6b 6579 223a 2022 7570 6461  mark_key": "upda
-00020b80: 7465 645f 6174 227d 2c0a 2020 2020 2020  ted_at"},.      
-00020b90: 2020 292c 0a20 2020 2020 2020 2028 0a20    ),.        (. 
-00020ba0: 2020 2020 2020 2020 2020 2064 6174 6574             datet
-00020bb0: 696d 652e 6461 7465 7469 6d65 2e75 7463  ime.datetime.utc
-00020bc0: 6e6f 7728 292c 0a20 2020 2020 2020 2020  now(),.         
-00020bd0: 2020 2053 6368 6564 756c 6546 7265 7175     ScheduleFrequ
-00020be0: 656e 6379 2e45 5645 5259 5f32 5f48 4f55  ency.EVERY_2_HOU
-00020bf0: 5253 2c0a 2020 2020 2020 2020 2020 2020  RS,.            
-00020c00: 5363 6865 6475 6c65 5479 7065 2e49 4e43  ScheduleType.INC
-00020c10: 5245 4d45 4e54 414c 5f41 5050 454e 442c  REMENTAL_APPEND,
-00020c20: 0a20 2020 2020 2020 2020 2020 207b 2277  .            {"w
-00020c30: 6174 6572 6d61 726b 5f6b 6579 223a 204e  atermark_key": N
-00020c40: 6f6e 657d 2c0a 2020 2020 2020 2020 292c  one},.        ),
-00020c50: 0a20 2020 2020 2020 2028 0a20 2020 2020  .        (.     
-00020c60: 2020 2020 2020 2064 6174 6574 696d 652e         datetime.
-00020c70: 6461 7465 7469 6d65 2e75 7463 6e6f 7728  datetime.utcnow(
-00020c80: 292c 0a20 2020 2020 2020 2020 2020 2053  ),.            S
-00020c90: 6368 6564 756c 6546 7265 7175 656e 6379  cheduleFrequency
-00020ca0: 2e45 5645 5259 5f34 5f48 4f55 5253 2c0a  .EVERY_4_HOURS,.
-00020cb0: 2020 2020 2020 2020 2020 2020 5363 6865              Sche
-00020cc0: 6475 6c65 5479 7065 2e49 4e43 5245 4d45  duleType.INCREME
-00020cd0: 4e54 414c 5f41 5050 454e 442c 0a20 2020  NTAL_APPEND,.   
-00020ce0: 2020 2020 2020 2020 207b 2277 6174 6572           {"water
-00020cf0: 6d61 726b 5f6b 6579 223a 2022 7570 6461  mark_key": "upda
-00020d00: 7465 645f 6174 227d 2c0a 2020 2020 2020  ted_at"},.      
-00020d10: 2020 292c 0a20 2020 2020 2020 2028 0a20    ),.        (. 
-00020d20: 2020 2020 2020 2020 2020 2064 6174 6574             datet
-00020d30: 696d 652e 6461 7465 7469 6d65 2e75 7463  ime.datetime.utc
-00020d40: 6e6f 7728 292c 0a20 2020 2020 2020 2020  now(),.         
-00020d50: 2020 2053 6368 6564 756c 6546 7265 7175     ScheduleFrequ
-00020d60: 656e 6379 2e45 5645 5259 5f34 5f48 4f55  ency.EVERY_4_HOU
-00020d70: 5253 2c0a 2020 2020 2020 2020 2020 2020  RS,.            
-00020d80: 5363 6865 6475 6c65 5479 7065 2e49 4e43  ScheduleType.INC
-00020d90: 5245 4d45 4e54 414c 5f41 5050 454e 442c  REMENTAL_APPEND,
-00020da0: 0a20 2020 2020 2020 2020 2020 207b 2264  .            {"d
-00020db0: 656c 6179 5f74 696d 6522 3a20 3330 302c  elay_time": 300,
-00020dc0: 2022 7761 7465 726d 6172 6b5f 6b65 7922   "watermark_key"
-00020dd0: 3a20 2275 7064 6174 6564 5f61 7422 7d2c  : "updated_at"},
-00020de0: 0a20 2020 2020 2020 2029 2c0a 2020 2020  .        ),.    
-00020df0: 5d2c 0a29 0a64 6566 2074 6573 745f 6c6f  ],.).def test_lo
-00020e00: 675f 6672 6f6d 5f64 6174 615f 636f 6e6e  g_from_data_conn
-00020e10: 6563 746f 725f 7769 7468 5f73 6368 6564  ector_with_sched
-00020e20: 756c 6528 0a20 2020 2073 7461 7274 5f6f  ule(.    start_o
-00020e30: 6e3a 2055 6e69 6f6e 5b64 6174 6574 696d  n: Union[datetim
-00020e40: 652e 6461 7465 7469 6d65 2c20 7374 725d  e.datetime, str]
-00020e50: 2c0a 2020 2020 6672 6571 7565 6e63 793a  ,.    frequency:
-00020e60: 2053 6368 6564 756c 6546 7265 7175 656e   ScheduleFrequen
-00020e70: 6379 2c0a 2020 2020 7479 7065 3a20 5363  cy,.    type: Sc
-00020e80: 6865 6475 6c65 5479 7065 2c0a 2020 2020  heduleType,.    
-00020e90: 6f70 7469 6f6e 733a 2044 6963 745b 7374  options: Dict[st
-00020ea0: 722c 2073 7472 5d2c 0a20 2020 2063 6c69  r, str],.    cli
-00020eb0: 5f6f 626a 2c0a 293a 0a20 2020 2022 2222  _obj,.):.    """
-00020ec0: 0a20 2020 2054 6573 7473 2074 6861 7420  .    Tests that 
-00020ed0: 7468 6520 6c6f 675f 6672 6f6d 5f64 6174  the log_from_dat
-00020ee0: 615f 636f 6e6e 6563 746f 7220 6675 6e63  a_connector func
-00020ef0: 7469 6f6e 2063 616c 6c73 2074 6865 206c  tion calls the l
-00020f00: 6f67 5f66 726f 6d5f 6461 7461 5f63 6f6e  og_from_data_con
-00020f10: 6e65 6374 6f72 5f61 7379 6e63 0a20 2020  nector_async.   
-00020f20: 2066 756e 6374 696f 6e20 7769 7468 2063   function with c
-00020f30: 6f72 7265 6374 2070 6172 616d 6574 6572  orrect parameter
-00020f40: 730a 2020 2020 2222 220a 2020 2020 636c  s.    """.    cl
-00020f50: 695f 6f62 6a2e 6c6f 675f 7374 6f72 6520  i_obj.log_store 
-00020f60: 3d20 6d6f 636b 2e4d 6f63 6b28 290a 2020  = mock.Mock().  
-00020f70: 2020 636c 695f 6f62 6a2e 6c6f 675f 6672    cli_obj.log_fr
-00020f80: 6f6d 5f64 6174 615f 636f 6e6e 6563 746f  om_data_connecto
-00020f90: 7228 0a20 2020 2020 2020 2061 7070 6c69  r(.        appli
-00020fa0: 6361 7469 6f6e 3d22 666f 6f62 6172 222c  cation="foobar",
-00020fb0: 0a20 2020 2020 2020 2073 6f75 7263 655f  .        source_
-00020fc0: 6461 7461 5f63 6f6e 6e65 6374 6f72 5f6e  data_connector_n
-00020fd0: 616d 653d 2274 6573 742d 636f 6e6e 6563  ame="test-connec
-00020fe0: 746f 7222 2c0a 2020 2020 2020 2020 7469  tor",.        ti
-00020ff0: 6d65 7374 616d 703d 2254 222c 0a20 2020  mestamp="T",.   
-00021000: 2020 2020 2069 6e70 7574 733d 5b22 4122       inputs=["A"
-00021010: 2c20 2242 225d 2c0a 2020 2020 2020 2020  , "B"],.        
-00021020: 6f75 7470 7574 733d 5b22 4322 2c20 2244  outputs=["C", "D
-00021030: 225d 2c0a 2020 2020 2020 2020 6665 6564  "],.        feed
-00021040: 6261 636b 733d 5b22 4522 2c20 2246 225d  backs=["E", "F"]
-00021050: 2c0a 2020 2020 2020 2020 6a6f 696e 5f6b  ,.        join_k
-00021060: 6579 3d22 4822 2c0a 2020 2020 2020 2020  ey="H",.        
-00021070: 726f 775f 7461 6773 3d5b 2249 222c 2022  row_tags=["I", "
-00021080: 4a22 5d2c 0a20 2020 2020 2020 2067 6c6f  J"],.        glo
-00021090: 6261 6c5f 7461 6773 3d7b 2276 6572 7369  bal_tags={"versi
-000210a0: 6f6e 223a 2022 7465 7374 5f76 6572 7369  on": "test_versi
-000210b0: 6f6e 227d 2c0a 2020 2020 2020 2020 7363  on"},.        sc
-000210c0: 6865 6475 6c65 3d53 6368 6564 756c 6528  hedule=Schedule(
-000210d0: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
-000210e0: 7274 5f6f 6e3d 7374 6172 745f 6f6e 2c0a  rt_on=start_on,.
-000210f0: 2020 2020 2020 2020 2020 2020 6672 6571              freq
-00021100: 7565 6e63 793d 6672 6571 7565 6e63 792c  uency=frequency,
-00021110: 0a20 2020 2020 2020 2020 2020 2074 7970  .            typ
-00021120: 653d 7479 7065 2c0a 2020 2020 2020 2020  e=type,.        
-00021130: 2020 2020 6f70 7469 6f6e 733d 5363 6865      options=Sche
-00021140: 6475 6c65 4f70 7469 6f6e 7328 2a2a 6f70  duleOptions(**op
-00021150: 7469 6f6e 7329 2c0a 2020 2020 2020 2020  tions),.        
-00021160: 292c 0a20 2020 2029 0a0a 2020 2020 6361  ),.    )..    ca
-00021170: 6c6c 5f61 7267 7320 3d20 636c 695f 6f62  ll_args = cli_ob
-00021180: 6a2e 6c6f 675f 7374 6f72 652e 6c6f 675f  j.log_store.log_
-00021190: 6672 6f6d 5f64 6174 615f 636f 6e6e 6563  from_data_connec
-000211a0: 746f 725f 6173 796e 632e 6361 6c6c 5f61  tor_async.call_a
-000211b0: 7267 730a 2020 2020 6173 7365 7274 2063  rgs.    assert c
-000211c0: 616c 6c5f 6172 6773 2e6b 7761 7267 7320  all_args.kwargs 
-000211d0: 3d3d 207b 0a20 2020 2020 2020 2022 7265  == {.        "re
-000211e0: 7175 6573 7422 3a20 496e 6765 7374 4672  quest": IngestFr
-000211f0: 6f6d 4461 7461 436f 6e6e 6563 746f 7252  omDataConnectorR
-00021200: 6571 7565 7374 280a 2020 2020 2020 2020  equest(.        
-00021210: 2020 2020 6170 706c 6963 6174 696f 6e3d      application=
-00021220: 2266 6f6f 6261 7222 2c0a 2020 2020 2020  "foobar",.      
-00021230: 2020 2020 2020 736f 7572 6365 5f64 6174        source_dat
-00021240: 615f 636f 6e6e 6563 746f 725f 6e61 6d65  a_connector_name
-00021250: 3d22 7465 7374 2d63 6f6e 6e65 6374 6f72  ="test-connector
-00021260: 222c 0a20 2020 2020 2020 2020 2020 2074  ",.            t
-00021270: 696d 6573 7461 6d70 3d22 5422 2c0a 2020  imestamp="T",.  
-00021280: 2020 2020 2020 2020 2020 696e 7075 7473            inputs
-00021290: 3d5b 2241 222c 2022 4222 5d2c 0a20 2020  =["A", "B"],.   
-000212a0: 2020 2020 2020 2020 206f 7574 7075 7473           outputs
-000212b0: 3d5b 2243 222c 2022 4422 5d2c 0a20 2020  =["C", "D"],.   
-000212c0: 2020 2020 2020 2020 2066 6565 6462 6163           feedbac
-000212d0: 6b73 3d5b 2245 222c 2022 4622 5d2c 0a20  ks=["E", "F"],. 
-000212e0: 2020 2020 2020 2020 2020 206a 6f69 6e5f             join_
-000212f0: 6b65 793d 2248 222c 0a20 2020 2020 2020  key="H",.       
-00021300: 2020 2020 2072 6f77 5f74 6167 733d 5b22       row_tags=["
-00021310: 4922 2c20 224a 225d 2c0a 2020 2020 2020  I", "J"],.      
-00021320: 2020 2020 2020 676c 6f62 616c 5f74 6167        global_tag
-00021330: 733d 7b22 7665 7273 696f 6e22 3a20 2274  s={"version": "t
-00021340: 6573 745f 7665 7273 696f 6e22 7d2c 0a20  est_version"},. 
-00021350: 2020 2020 2020 2020 2020 2073 6368 6564             sched
-00021360: 756c 653d 5363 6865 6475 6c65 280a 2020  ule=Schedule(.  
-00021370: 2020 2020 2020 2020 2020 2020 2020 7374                st
-00021380: 6172 745f 6f6e 3d73 7461 7274 5f6f 6e2e  art_on=start_on.
-00021390: 6973 6f66 6f72 6d61 7428 290a 2020 2020  isoformat().    
-000213a0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-000213b0: 7369 6e73 7461 6e63 6528 7374 6172 745f  sinstance(start_
-000213c0: 6f6e 2c20 6461 7465 7469 6d65 2e64 6174  on, datetime.dat
-000213d0: 6574 696d 6529 0a20 2020 2020 2020 2020  etime).         
-000213e0: 2020 2020 2020 2065 6c73 6520 7374 6172         else star
-000213f0: 745f 6f6e 2c0a 2020 2020 2020 2020 2020  t_on,.          
-00021400: 2020 2020 2020 6672 6571 7565 6e63 793d        frequency=
-00021410: 6672 6571 7565 6e63 792c 0a20 2020 2020  frequency,.     
-00021420: 2020 2020 2020 2020 2020 2074 7970 653d             type=
-00021430: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-00021440: 2020 2020 2020 6f70 7469 6f6e 733d 5363        options=Sc
-00021450: 6865 6475 6c65 4f70 7469 6f6e 7328 2a2a  heduleOptions(**
-00021460: 6f70 7469 6f6e 7329 2c0a 2020 2020 2020  options),.      
-00021470: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-00021480: 2020 2020 2070 6970 656c 696e 655f 6e61       pipeline_na
-00021490: 6d65 3d4e 6f6e 652c 0a20 2020 2020 2020  me=None,.       
-000214a0: 2029 0a20 2020 207d 0a                    ).    }.
+00017130: 6f67 6765 722e 636c 6965 6e74 2e47 616e  ogger.client.Gan
+00017140: 7472 792e 5f6c 6f67 5f70 7265 6469 6374  try._log_predict
+00017150: 696f 6e5f 6576 656e 7473 2229 0a40 6d6f  ion_events").@mo
+00017160: 636b 2e70 6174 6368 2822 6761 6e74 7279  ck.patch("gantry
+00017170: 2e6c 6f67 6765 722e 636c 6965 6e74 2e47  .logger.client.G
+00017180: 616e 7472 792e 5f6c 6f67 5f66 6565 6462  antry._log_feedb
+00017190: 6163 6b5f 6576 656e 7473 2229 0a64 6566  ack_events").def
+000171a0: 2074 6573 745f 6c6f 675f 7265 636f 7264   test_log_record
+000171b0: 735f 6e6f 5f64 6174 6128 0a20 2020 206d  s_no_data(.    m
+000171c0: 6f63 6b5f 6665 6564 6261 636b 2c0a 2020  ock_feedback,.  
+000171d0: 2020 6d6f 636b 5f70 7265 6473 2c0a 2020    mock_preds,.  
+000171e0: 2020 6d6f 636b 5f70 7265 6473 5f61 6e64    mock_preds_and
+000171f0: 5f66 6565 6462 6163 6b2c 0a20 2020 2076  _feedback,.    v
+00017200: 6572 7369 6f6e 2c0a 2020 2020 7465 7374  ersion,.    test
+00017210: 5f69 6e70 7574 732c 0a20 2020 2074 6573  _inputs,.    tes
+00017220: 745f 6f75 7470 7574 732c 0a20 2020 2074  t_outputs,.    t
+00017230: 6573 745f 6665 6564 6261 636b 732c 0a20  est_feedbacks,. 
+00017240: 2020 2063 6c69 5f6f 626a 2c0a 293a 0a20     cli_obj,.):. 
+00017250: 2020 2061 7373 6572 7420 280a 2020 2020     assert (.    
+00017260: 2020 2020 636c 695f 6f62 6a2e 6c6f 675f      cli_obj.log_
+00017270: 7265 636f 7264 7328 0a20 2020 2020 2020  records(.       
+00017280: 2020 2020 2061 7070 6c69 6361 7469 6f6e       application
+00017290: 3d22 666f 6f62 6172 222c 0a20 2020 2020  ="foobar",.     
+000172a0: 2020 2020 2020 2076 6572 7369 6f6e 3d76         version=v
+000172b0: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
+000172c0: 2020 2020 696e 7075 7473 3d74 6573 745f      inputs=test_
+000172d0: 696e 7075 7473 2c0a 2020 2020 2020 2020  inputs,.        
+000172e0: 2020 2020 6f75 7470 7574 733d 7465 7374      outputs=test
+000172f0: 5f6f 7574 7075 7473 2c0a 2020 2020 2020  _outputs,.      
+00017300: 2020 2020 2020 6665 6564 6261 636b 733d        feedbacks=
+00017310: 7465 7374 5f66 6565 6462 6163 6b73 2c0a  test_feedbacks,.
+00017320: 2020 2020 2020 2020 2020 2020 7469 6d65              time
+00017330: 7374 616d 7073 3d4e 6f6e 652c 0a20 2020  stamps=None,.   
+00017340: 2020 2020 2020 2020 2073 6f72 745f 6f6e           sort_on
+00017350: 5f74 696d 6573 7461 6d70 3d54 7275 652c  _timestamp=True,
+00017360: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00017370: 2020 2069 7320 4e6f 6e65 0a20 2020 2029     is None.    )
+00017380: 0a0a 2020 2020 6d6f 636b 5f70 7265 6473  ..    mock_preds
+00017390: 5f61 6e64 5f66 6565 6462 6163 6b2e 6173  _and_feedback.as
+000173a0: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
+000173b0: 290a 2020 2020 6d6f 636b 5f70 7265 6473  ).    mock_preds
+000173c0: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
+000173d0: 6564 2829 0a20 2020 206d 6f63 6b5f 6665  ed().    mock_fe
+000173e0: 6564 6261 636b 2e61 7373 6572 745f 6e6f  edback.assert_no
+000173f0: 745f 6361 6c6c 6564 2829 0a0a 0a40 7079  t_called()...@py
+00017400: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
+00017410: 7472 697a 6528 0a20 2020 2028 2274 6573  trize(.    ("tes
+00017420: 745f 6665 6564 6261 636b 7322 2c20 2274  t_feedbacks", "t
+00017430: 6573 745f 6f75 7470 7574 7322 2c20 2274  est_outputs", "t
+00017440: 6573 745f 696e 7075 7473 2229 2c0a 2020  est_inputs"),.  
+00017450: 2020 5b0a 2020 2020 2020 2020 284e 6f6e    [.        (Non
+00017460: 652c 204e 6f6e 652c 204e 6f6e 6529 2c0a  e, None, None),.
+00017470: 2020 2020 2020 2020 2870 642e 4461 7461          (pd.Data
+00017480: 4672 616d 6528 292c 2070 642e 4461 7461  Frame(), pd.Data
+00017490: 4672 616d 6528 292c 2070 642e 4461 7461  Frame(), pd.Data
+000174a0: 4672 616d 6528 2929 2c0a 2020 2020 2020  Frame()),.      
+000174b0: 2020 285b 5d2c 205b 5d2c 205b 5d29 2c0a    ([], [], []),.
+000174c0: 2020 2020 2020 2020 2870 642e 5365 7269          (pd.Seri
+000174d0: 6573 2829 2c20 7064 2e53 6572 6965 7328  es(), pd.Series(
+000174e0: 292c 2070 642e 5365 7269 6573 2829 292c  ), pd.Series()),
+000174f0: 0a20 2020 2020 2020 2028 6e70 2e61 7272  .        (np.arr
+00017500: 6179 285b 5d29 2c20 6e70 2e61 7272 6179  ay([]), np.array
+00017510: 285b 5d29 2c20 6e70 2e61 7272 6179 285b  ([]), np.array([
+00017520: 5d29 292c 0a20 2020 205d 2c0a 290a 4070  ])),.    ],.).@p
+00017530: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+00017540: 6574 7269 7a65 2822 7665 7273 696f 6e22  etrize("version"
+00017550: 2c20 5b4e 6f6e 652c 2031 302c 2022 312e  , [None, 10, "1.
+00017560: 322e 3322 5d29 0a40 6d6f 636b 2e70 6174  2.3"]).@mock.pat
+00017570: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
+00017580: 722e 636c 6965 6e74 2e47 616e 7472 792e  r.client.Gantry.
+00017590: 5f67 656e 6572 6174 655f 7072 6564 6963  _generate_predic
+000175a0: 7469 6f6e 5f61 6e64 5f66 6565 6462 6163  tion_and_feedbac
+000175b0: 6b5f 6576 656e 7473 2229 0a40 6d6f 636b  k_events").@mock
+000175c0: 2e70 6174 6368 2822 6761 6e74 7279 2e6c  .patch("gantry.l
+000175d0: 6f67 6765 722e 636c 6965 6e74 2e47 616e  ogger.client.Gan
+000175e0: 7472 792e 5f67 656e 6572 6174 655f 7072  try._generate_pr
+000175f0: 6564 6963 7469 6f6e 5f65 7665 6e74 7322  ediction_events"
+00017600: 290a 406d 6f63 6b2e 7061 7463 6828 2267  ).@mock.patch("g
+00017610: 616e 7472 792e 6c6f 6767 6572 2e63 6c69  antry.logger.cli
+00017620: 656e 742e 4761 6e74 7279 2e5f 6765 6e65  ent.Gantry._gene
+00017630: 7261 7465 5f66 6565 6462 6163 6b5f 6576  rate_feedback_ev
+00017640: 656e 7473 2229 0a64 6566 2074 6573 745f  ents").def test_
+00017650: 6765 6e65 7261 7465 5f72 6563 6f72 6473  generate_records
+00017660: 5f6e 6f5f 6461 7461 280a 2020 2020 6d6f  _no_data(.    mo
+00017670: 636b 5f67 656e 6572 6174 655f 6665 6564  ck_generate_feed
+00017680: 6261 636b 2c0a 2020 2020 6d6f 636b 5f67  back,.    mock_g
+00017690: 656e 6572 6174 655f 7072 6564 732c 0a20  enerate_preds,. 
+000176a0: 2020 206d 6f63 6b5f 6765 6e65 7261 7465     mock_generate
+000176b0: 5f70 7265 6473 5f61 6e64 5f66 6565 6462  _preds_and_feedb
+000176c0: 6163 6b2c 0a20 2020 2076 6572 7369 6f6e  ack,.    version
+000176d0: 2c0a 2020 2020 7465 7374 5f69 6e70 7574  ,.    test_input
+000176e0: 732c 0a20 2020 2074 6573 745f 6f75 7470  s,.    test_outp
+000176f0: 7574 732c 0a20 2020 2074 6573 745f 6665  uts,.    test_fe
+00017700: 6564 6261 636b 732c 0a20 2020 2063 6c69  edbacks,.    cli
+00017710: 5f6f 626a 2c0a 293a 0a20 2020 2061 7373  _obj,.):.    ass
+00017720: 6572 7420 280a 2020 2020 2020 2020 636c  ert (.        cl
+00017730: 695f 6f62 6a2e 6765 6e65 7261 7465 5f72  i_obj.generate_r
+00017740: 6563 6f72 6473 280a 2020 2020 2020 2020  ecords(.        
+00017750: 2020 2020 6170 706c 6963 6174 696f 6e3d      application=
+00017760: 2266 6f6f 6261 7222 2c0a 2020 2020 2020  "foobar",.      
+00017770: 2020 2020 2020 7665 7273 696f 6e3d 7665        version=ve
+00017780: 7273 696f 6e2c 0a20 2020 2020 2020 2020  rsion,.         
+00017790: 2020 2069 6e70 7574 733d 7465 7374 5f69     inputs=test_i
+000177a0: 6e70 7574 732c 0a20 2020 2020 2020 2020  nputs,.         
+000177b0: 2020 206f 7574 7075 7473 3d74 6573 745f     outputs=test_
+000177c0: 6f75 7470 7574 732c 0a20 2020 2020 2020  outputs,.       
+000177d0: 2020 2020 2066 6565 6462 6163 6b73 3d74       feedbacks=t
+000177e0: 6573 745f 6665 6564 6261 636b 732c 0a20  est_feedbacks,. 
+000177f0: 2020 2020 2020 2020 2020 2074 696d 6573             times
+00017800: 7461 6d70 733d 4e6f 6e65 2c0a 2020 2020  tamps=None,.    
+00017810: 2020 2020 2020 2020 736f 7274 5f6f 6e5f          sort_on_
+00017820: 7469 6d65 7374 616d 703d 5472 7565 2c0a  timestamp=True,.
+00017830: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00017840: 2020 6973 204e 6f6e 650a 2020 2020 290a    is None.    ).
+00017850: 0a20 2020 206d 6f63 6b5f 6765 6e65 7261  .    mock_genera
+00017860: 7465 5f70 7265 6473 5f61 6e64 5f66 6565  te_preds_and_fee
+00017870: 6462 6163 6b2e 6173 7365 7274 5f6e 6f74  dback.assert_not
+00017880: 5f63 616c 6c65 6428 290a 2020 2020 6d6f  _called().    mo
+00017890: 636b 5f67 656e 6572 6174 655f 7072 6564  ck_generate_pred
+000178a0: 732e 6173 7365 7274 5f6e 6f74 5f63 616c  s.assert_not_cal
+000178b0: 6c65 6428 290a 2020 2020 6d6f 636b 5f67  led().    mock_g
+000178c0: 656e 6572 6174 655f 6665 6564 6261 636b  enerate_feedback
+000178d0: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
+000178e0: 6564 2829 0a0a 0a40 7079 7465 7374 2e6d  ed()...@pytest.m
+000178f0: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+00017900: 0a20 2020 2022 7465 7374 5f66 6565 6462  .    "test_feedb
+00017910: 6163 6b73 222c 0a20 2020 205b 4e6f 6e65  acks",.    [None
+00017920: 2c20 7064 2e44 6174 6146 7261 6d65 2829  , pd.DataFrame()
+00017930: 2c20 5b7b 2241 223a 2033 7d2c 207b 2241  , [{"A": 3}, {"A
+00017940: 223a 2033 7d5d 2c20 7064 2e53 6572 6965  ": 3}], pd.Serie
+00017950: 7328 295d 2c0a 290a 406d 6f63 6b2e 7061  s()],.).@mock.pa
+00017960: 7463 6828 2267 616e 7472 792e 6c6f 6767  tch("gantry.logg
+00017970: 6572 2e63 6c69 656e 742e 4761 6e74 7279  er.client.Gantry
+00017980: 2e5f 6c6f 675f 7072 6564 6963 7469 6f6e  ._log_prediction
+00017990: 5f61 6e64 5f66 6565 6462 6163 6b5f 6576  _and_feedback_ev
+000179a0: 656e 7473 2229 0a40 6d6f 636b 2e70 6174  ents").@mock.pat
+000179b0: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
+000179c0: 722e 636c 6965 6e74 2e47 616e 7472 792e  r.client.Gantry.
+000179d0: 5f6c 6f67 5f70 7265 6469 6374 696f 6e5f  _log_prediction_
+000179e0: 6576 656e 7473 2229 0a40 6d6f 636b 2e70  events").@mock.p
+000179f0: 6174 6368 2822 6761 6e74 7279 2e6c 6f67  atch("gantry.log
+00017a00: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
+00017a10: 792e 5f6c 6f67 5f66 6565 6462 6163 6b5f  y._log_feedback_
+00017a20: 6576 656e 7473 2229 0a64 6566 2074 6573  events").def tes
+00017a30: 745f 6c6f 675f 7265 636f 7264 735f 696e  t_log_records_in
+00017a40: 636f 6d70 6c65 7465 5f70 7265 6473 280a  complete_preds(.
+00017a50: 2020 2020 6d6f 636b 5f66 6565 6462 6163      mock_feedbac
+00017a60: 6b2c 0a20 2020 206d 6f63 6b5f 7072 6564  k,.    mock_pred
+00017a70: 732c 0a20 2020 206d 6f63 6b5f 7072 6564  s,.    mock_pred
+00017a80: 735f 616e 645f 6665 6564 6261 636b 2c0a  s_and_feedback,.
+00017a90: 2020 2020 7465 7374 5f66 6565 6462 6163      test_feedbac
+00017aa0: 6b73 2c0a 2020 2020 636c 695f 6f62 6a2c  ks,.    cli_obj,
+00017ab0: 0a29 3a0a 2020 2020 7276 203d 2063 6c69  .):.    rv = cli
+00017ac0: 5f6f 626a 2e6c 6f67 5f72 6563 6f72 6473  _obj.log_records
+00017ad0: 280a 2020 2020 2020 2020 6170 706c 6963  (.        applic
+00017ae0: 6174 696f 6e3d 2266 6f6f 6261 7222 2c0a  ation="foobar",.
+00017af0: 2020 2020 2020 2020 7665 7273 696f 6e3d          version=
+00017b00: 2232 2e30 2e31 222c 0a20 2020 2020 2020  "2.0.1",.       
+00017b10: 2069 6e70 7574 733d 5b5d 2c0a 2020 2020   inputs=[],.    
+00017b20: 2020 2020 6f75 7470 7574 733d 5b7b 2241      outputs=[{"A
+00017b30: 223a 2031 7d2c 207b 2241 223a 2032 7d5d  ": 1}, {"A": 2}]
+00017b40: 2c0a 2020 2020 2020 2020 6665 6564 6261  ,.        feedba
+00017b50: 636b 733d 7465 7374 5f66 6565 6462 6163  cks=test_feedbac
+00017b60: 6b73 2c0a 2020 2020 2020 2020 7469 6d65  ks,.        time
+00017b70: 7374 616d 7073 3d4e 6f6e 652c 0a20 2020  stamps=None,.   
+00017b80: 2020 2020 2073 6f72 745f 6f6e 5f74 696d       sort_on_tim
+00017b90: 6573 7461 6d70 3d54 7275 652c 0a20 2020  estamp=True,.   
+00017ba0: 2029 0a20 2020 2061 7373 6572 7420 7276   ).    assert rv
+00017bb0: 2069 7320 4e6f 6e65 0a0a 2020 2020 6d6f   is None..    mo
+00017bc0: 636b 5f70 7265 6473 5f61 6e64 5f66 6565  ck_preds_and_fee
+00017bd0: 6462 6163 6b2e 6173 7365 7274 5f6e 6f74  dback.assert_not
+00017be0: 5f63 616c 6c65 6428 290a 2020 2020 6d6f  _called().    mo
+00017bf0: 636b 5f70 7265 6473 2e61 7373 6572 745f  ck_preds.assert_
+00017c00: 6e6f 745f 6361 6c6c 6564 2829 0a20 2020  not_called().   
+00017c10: 206d 6f63 6b5f 6665 6564 6261 636b 2e61   mock_feedback.a
+00017c20: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
+00017c30: 2829 0a0a 0a40 7079 7465 7374 2e6d 6172  ()...@pytest.mar
+00017c40: 6b2e 7061 7261 6d65 7472 697a 6528 0a20  k.parametrize(. 
+00017c50: 2020 2022 7465 7374 5f66 6565 6462 6163     "test_feedbac
+00017c60: 6b73 222c 0a20 2020 205b 4e6f 6e65 2c20  ks",.    [None, 
+00017c70: 7064 2e44 6174 6146 7261 6d65 2829 2c20  pd.DataFrame(), 
+00017c80: 5b7b 2241 223a 2033 7d2c 207b 2241 223a  [{"A": 3}, {"A":
+00017c90: 2033 7d5d 2c20 7064 2e53 6572 6965 7328   3}], pd.Series(
+00017ca0: 295d 2c0a 290a 406d 6f63 6b2e 7061 7463  )],.).@mock.patc
+00017cb0: 6828 2267 616e 7472 792e 6c6f 6767 6572  h("gantry.logger
+00017cc0: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
+00017cd0: 6765 6e65 7261 7465 5f70 7265 6469 6374  generate_predict
+00017ce0: 696f 6e5f 616e 645f 6665 6564 6261 636b  ion_and_feedback
+00017cf0: 5f65 7665 6e74 7322 290a 406d 6f63 6b2e  _events").@mock.
+00017d00: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
+00017d10: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
+00017d20: 7279 2e5f 6765 6e65 7261 7465 5f70 7265  ry._generate_pre
+00017d30: 6469 6374 696f 6e5f 6576 656e 7473 2229  diction_events")
+00017d40: 0a40 6d6f 636b 2e70 6174 6368 2822 6761  .@mock.patch("ga
+00017d50: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
+00017d60: 6e74 2e47 616e 7472 792e 5f67 656e 6572  nt.Gantry._gener
+00017d70: 6174 655f 6665 6564 6261 636b 5f65 7665  ate_feedback_eve
+00017d80: 6e74 7322 290a 6465 6620 7465 7374 5f67  nts").def test_g
+00017d90: 656e 6572 6174 655f 7265 636f 7264 735f  enerate_records_
+00017da0: 696e 636f 6d70 6c65 7465 5f70 7265 6473  incomplete_preds
+00017db0: 280a 2020 2020 6d6f 636b 5f67 656e 6572  (.    mock_gener
+00017dc0: 6174 655f 6665 6564 6261 636b 2c0a 2020  ate_feedback,.  
+00017dd0: 2020 6d6f 636b 5f67 656e 6572 6174 655f    mock_generate_
+00017de0: 7072 6564 732c 0a20 2020 206d 6f63 6b5f  preds,.    mock_
+00017df0: 6765 6e65 7261 7465 5f70 7265 6473 5f61  generate_preds_a
+00017e00: 6e64 5f66 6565 6462 6163 6b2c 0a20 2020  nd_feedback,.   
+00017e10: 2074 6573 745f 6665 6564 6261 636b 732c   test_feedbacks,
+00017e20: 0a20 2020 2063 6c69 5f6f 626a 2c0a 293a  .    cli_obj,.):
+00017e30: 0a20 2020 2072 7620 3d20 636c 695f 6f62  .    rv = cli_ob
+00017e40: 6a2e 6765 6e65 7261 7465 5f72 6563 6f72  j.generate_recor
+00017e50: 6473 280a 2020 2020 2020 2020 6170 706c  ds(.        appl
+00017e60: 6963 6174 696f 6e3d 2266 6f6f 6261 7222  ication="foobar"
+00017e70: 2c0a 2020 2020 2020 2020 7665 7273 696f  ,.        versio
+00017e80: 6e3d 2232 2e30 2e31 222c 0a20 2020 2020  n="2.0.1",.     
+00017e90: 2020 2069 6e70 7574 733d 5b5d 2c0a 2020     inputs=[],.  
+00017ea0: 2020 2020 2020 6f75 7470 7574 733d 5b7b        outputs=[{
+00017eb0: 2241 223a 2031 7d2c 207b 2241 223a 2032  "A": 1}, {"A": 2
+00017ec0: 7d5d 2c0a 2020 2020 2020 2020 6665 6564  }],.        feed
+00017ed0: 6261 636b 733d 7465 7374 5f66 6565 6462  backs=test_feedb
+00017ee0: 6163 6b73 2c0a 2020 2020 2020 2020 7469  acks,.        ti
+00017ef0: 6d65 7374 616d 7073 3d4e 6f6e 652c 0a20  mestamps=None,. 
+00017f00: 2020 2020 2020 2073 6f72 745f 6f6e 5f74         sort_on_t
+00017f10: 696d 6573 7461 6d70 3d54 7275 652c 0a20  imestamp=True,. 
+00017f20: 2020 2029 0a20 2020 2061 7373 6572 7420     ).    assert 
+00017f30: 7276 2069 7320 4e6f 6e65 0a0a 2020 2020  rv is None..    
+00017f40: 6d6f 636b 5f67 656e 6572 6174 655f 7072  mock_generate_pr
+00017f50: 6564 735f 616e 645f 6665 6564 6261 636b  eds_and_feedback
+00017f60: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
+00017f70: 6564 2829 0a20 2020 206d 6f63 6b5f 6765  ed().    mock_ge
+00017f80: 6e65 7261 7465 5f70 7265 6473 2e61 7373  nerate_preds.ass
+00017f90: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
+00017fa0: 0a20 2020 206d 6f63 6b5f 6765 6e65 7261  .    mock_genera
+00017fb0: 7465 5f66 6565 6462 6163 6b2e 6173 7365  te_feedback.asse
+00017fc0: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
+00017fd0: 0a0a 4070 7974 6573 742e 6d61 726b 2e70  ..@pytest.mark.p
+00017fe0: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
+00017ff0: 2274 6573 745f 696e 7075 7473 222c 0a20  "test_inputs",. 
+00018000: 2020 205b 5b7b 2241 223a 2031 3030 7d2c     [[{"A": 100},
+00018010: 207b 2241 223a 2031 3031 7d5d 5d2c 0a29   {"A": 101}]],.)
+00018020: 0a40 6d6f 636b 2e70 6174 6368 2822 6761  .@mock.patch("ga
+00018030: 6e74 7279 2e6c 6f67 6765 722e 7574 696c  ntry.logger.util
+00018040: 732e 6765 745f 6669 6c65 5f6c 696e 6563  s.get_file_linec
+00018050: 6f75 6e74 2229 0a64 6566 2074 6573 745f  ount").def test_
+00018060: 6c6f 675f 6669 6c65 286d 6f63 6b5f 6c69  log_file(mock_li
+00018070: 6e65 5f63 6f75 6e74 2c20 7465 7374 5f69  ne_count, test_i
+00018080: 6e70 7574 7329 3a0a 2020 2020 6c6f 675f  nputs):.    log_
+00018090: 7374 6f72 6520 3d20 6d6f 636b 2e4d 6167  store = mock.Mag
+000180a0: 6963 4d6f 636b 2829 0a20 2020 2067 616e  icMock().    gan
+000180b0: 7472 7920 3d20 636c 6965 6e74 2e47 616e  try = client.Gan
+000180c0: 7472 7928 6c6f 675f 7374 6f72 653d 6c6f  try(log_store=lo
+000180d0: 675f 7374 6f72 652c 2065 6e76 6972 6f6e  g_store, environ
+000180e0: 6d65 6e74 3d22 7465 7374 2229 0a20 2020  ment="test").   
+000180f0: 206d 6f63 6b5f 6c69 6e65 5f63 6f75 6e74   mock_line_count
+00018100: 2e72 6574 7572 6e5f 7661 6c75 6520 3d20  .return_value = 
+00018110: 350a 0a20 2020 2067 616e 7472 792e 6c6f  5..    gantry.lo
+00018120: 675f 6669 6c65 280a 2020 2020 2020 2020  g_file(.        
+00018130: 2266 6f6f 6261 7222 2c0a 2020 2020 2020  "foobar",.      
+00018140: 2020 2264 6972 2f63 7376 5f77 6974 685f    "dir/csv_with_
+00018150: 6865 6164 6572 732e 6373 7622 2c0a 2020  headers.csv",.  
+00018160: 2020 2020 2020 7665 7273 696f 6e3d 2232        version="2
+00018170: 2e30 2e31 222c 0a20 2020 2029 0a0a 2020  .0.1",.    )..  
+00018180: 2020 6c6f 675f 7374 6f72 652e 6c6f 675f    log_store.log_
+00018190: 6261 7463 682e 6173 7365 7274 5f6e 6f74  batch.assert_not
+000181a0: 5f63 616c 6c65 6428 290a 0a0a 406d 6f63  _called()...@moc
+000181b0: 6b2e 7061 7463 6828 2267 616e 7472 792e  k.patch("gantry.
+000181c0: 6c6f 6767 6572 2e63 6c69 656e 742e 7575  logger.client.uu
+000181d0: 6964 2e75 7569 6434 222c 2072 6574 7572  id.uuid4", retur
+000181e0: 6e5f 7661 6c75 653d 2241 4243 2229 0a40  n_value="ABC").@
+000181f0: 6d6f 636b 2e70 6174 6368 2822 6761 6e74  mock.patch("gant
+00018200: 7279 2e6c 6f67 6765 722e 636c 6965 6e74  ry.logger.client
+00018210: 2e47 616e 7472 792e 5f68 616e 646c 655f  .Gantry._handle_
+00018220: 7570 6c6f 6164 2229 0a64 6566 2074 6573  upload").def tes
+00018230: 745f 736d 6172 745f 6669 6c65 7265 6164  t_smart_fileread
+00018240: 286d 6f63 6b5f 6861 6e64 6c65 5f75 706c  (mock_handle_upl
+00018250: 6f61 642c 206d 6f63 6b5f 7575 6964 2c20  oad, mock_uuid, 
+00018260: 636c 695f 6f62 6a29 3a0a 2020 2020 6461  cli_obj):.    da
+00018270: 7461 5f6c 696e 6b20 3d20 6d6f 636b 2e4d  ta_link = mock.M
+00018280: 6f63 6b28 290a 2020 2020 636c 695f 6f62  ock().    cli_ob
+00018290: 6a2e 5f73 6d61 7274 5f66 696c 655f 7265  j._smart_file_re
+000182a0: 6164 280a 2020 2020 2020 2020 6461 7461  ad(.        data
+000182b0: 5f6c 696e 6b3d 6461 7461 5f6c 696e 6b2c  _link=data_link,
+000182c0: 0a20 2020 2020 2020 206f 626a 6563 745f  .        object_
+000182d0: 7369 7a65 3d31 302c 0a20 2020 2020 2020  size=10,.       
+000182e0: 2070 6174 685f 6e61 6d65 3d22 666f 6f62   path_name="foob
+000182f0: 6172 222c 0a20 2020 2020 2020 2066 696c  ar",.        fil
+00018300: 653d 696f 2e53 7472 696e 6749 4f28 22f0  e=io.StringIO(".
+00018310: 9f98 8ef0 9f98 8e22 292c 0a20 2020 2020  ......."),.     
+00018320: 2020 2063 6875 6e6b 5f73 697a 653d 3230     chunk_size=20
+00018330: 302c 0a20 2020 2029 0a0a 2020 2020 6172  0,.    )..    ar
+00018340: 6773 2c20 6b77 6172 6773 203d 206d 6f63  gs, kwargs = moc
+00018350: 6b5f 6861 6e64 6c65 5f75 706c 6f61 642e  k_handle_upload.
+00018360: 6361 6c6c 5f61 7267 730a 0a20 2020 2061  call_args..    a
+00018370: 7373 6572 7420 6c69 7374 2861 7267 735b  ssert list(args[
+00018380: 305d 2920 3d3d 205b 6222 5c78 6630 5c78  0]) == [b"\xf0\x
+00018390: 3966 5c78 3938 5c78 3865 5c78 6630 5c78  9f\x98\x8e\xf0\x
+000183a0: 3966 5c78 3938 5c78 3865 225d 2020 2320  9f\x98\x8e"]  # 
+000183b0: 7465 7374 2055 5446 2d38 2073 7570 706f  test UTF-8 suppo
+000183c0: 7274 0a20 2020 2061 7373 6572 7420 6172  rt.    assert ar
+000183d0: 6773 5b31 5d20 3d3d 2064 6174 615f 6c69  gs[1] == data_li
+000183e0: 6e6b 0a20 2020 2061 7373 6572 7420 6172  nk.    assert ar
+000183f0: 6773 5b32 5d20 3d3d 2031 300a 2020 2020  gs[2] == 10.    
+00018400: 6173 7365 7274 2061 7267 735b 335d 203d  assert args[3] =
+00018410: 3d20 2241 4243 5f66 6f6f 6261 7222 0a0a  = "ABC_foobar"..
+00018420: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
+00018430: 7261 6d65 7472 697a 6528 0a20 2020 205b  rametrize(.    [
+00018440: 2269 6e70 7574 7322 2c20 226f 7574 7075  "inputs", "outpu
+00018450: 7473 222c 2022 6665 6564 6261 636b 7322  ts", "feedbacks"
+00018460: 2c20 226a 6f69 6e5f 6b65 7973 222c 2022  , "join_keys", "
+00018470: 7469 6d65 7374 616d 7073 225d 2c0a 2020  timestamps"],.  
+00018480: 2020 5b0a 2020 2020 2020 2020 285b 7b22    [.        ([{"
+00018490: 4122 3a20 3130 7d5d 202a 2031 302c 205b  A": 10}] * 10, [
+000184a0: 7b22 4122 3a20 3130 7d5d 202a 2039 2c20  {"A": 10}] * 9, 
+000184b0: 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f 6e65  None, None, None
+000184c0: 292c 0a20 2020 2020 2020 2028 5b7b 2241  ),.        ([{"A
+000184d0: 223a 2031 307d 5d20 2a20 3130 2c20 5b7b  ": 10}] * 10, [{
+000184e0: 2241 223a 2031 307d 5d20 2a20 392c 205b  "A": 10}] * 9, [
+000184f0: 7b22 4122 3a20 3131 7d5d 202a 2031 302c  {"A": 11}] * 10,
+00018500: 205b 2266 6f6f 6261 7222 5d20 2a20 3130   ["foobar"] * 10
+00018510: 2c20 4e6f 6e65 292c 0a20 2020 2020 2020  , None),.       
+00018520: 2028 5b7b 2241 223a 2031 307d 5d20 2a20   ([{"A": 10}] * 
+00018530: 392c 205b 7b22 4122 3a20 3130 7d5d 202a  9, [{"A": 10}] *
+00018540: 2038 2c20 5b7b 2241 223a 2031 317d 5d20   8, [{"A": 11}] 
+00018550: 2a20 3130 2c20 5b22 666f 6f62 6172 225d  * 10, ["foobar"]
+00018560: 202a 2031 302c 204e 6f6e 6529 2c0a 2020   * 10, None),.  
+00018570: 2020 2020 2020 285b 7b22 4122 3a20 3130        ([{"A": 10
+00018580: 7d5d 202a 2039 2c20 4e6f 6e65 2c20 5b7b  }] * 9, None, [{
+00018590: 2241 223a 2031 317d 5d20 2a20 3130 2c20  "A": 11}] * 10, 
+000185a0: 5b22 666f 6f62 6172 225d 202a 2031 302c  ["foobar"] * 10,
+000185b0: 204e 6f6e 6529 2c0a 2020 2020 2020 2020   None),.        
+000185c0: 284e 6f6e 652c 204e 6f6e 652c 205b 7b22  (None, None, [{"
+000185d0: 4122 3a20 3131 7d5d 202a 2031 312c 205b  A": 11}] * 11, [
+000185e0: 2266 6f6f 6261 7222 5d20 2a20 3130 2c20  "foobar"] * 10, 
+000185f0: 4e6f 6e65 292c 0a20 2020 2020 2020 2028  None),.        (
+00018600: 4e6f 6e65 2c20 4e6f 6e65 2c20 5b7b 2241  None, None, [{"A
+00018610: 223a 2031 317d 5d20 2a20 3131 2c20 5b22  ": 11}] * 11, ["
+00018620: 666f 6f62 6172 225d 202a 2031 302c 205b  foobar"] * 10, [
+00018630: 4355 5252 454e 545f 5449 4d45 5d20 2a20  CURRENT_TIME] * 
+00018640: 3130 292c 0a20 2020 2020 2020 2028 4e6f  10),.        (No
+00018650: 6e65 2c20 4e6f 6e65 2c20 5b7b 2241 223a  ne, None, [{"A":
+00018660: 2031 317d 5d20 2a20 3131 2c20 5b22 666f   11}] * 11, ["fo
+00018670: 6f62 6172 225d 202a 2031 302c 206e 702e  obar"] * 10, np.
+00018680: 6172 7261 7928 5b43 5552 5245 4e54 5f54  array([CURRENT_T
+00018690: 494d 455d 202a 2031 3029 292c 0a20 2020  IME] * 10)),.   
+000186a0: 205d 2c0a 290a 406d 6f63 6b2e 7061 7463   ],.).@mock.patc
+000186b0: 6828 2267 616e 7472 792e 6c6f 6767 6572  h("gantry.logger
+000186c0: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
+000186d0: 6c6f 675f 7072 6564 6963 7469 6f6e 5f61  log_prediction_a
+000186e0: 6e64 5f66 6565 6462 6163 6b5f 6576 656e  nd_feedback_even
+000186f0: 7473 2229 0a40 6d6f 636b 2e70 6174 6368  ts").@mock.patch
+00018700: 2822 6761 6e74 7279 2e6c 6f67 6765 722e  ("gantry.logger.
+00018710: 636c 6965 6e74 2e47 616e 7472 792e 5f6c  client.Gantry._l
+00018720: 6f67 5f70 7265 6469 6374 696f 6e5f 6576  og_prediction_ev
+00018730: 656e 7473 2229 0a40 6d6f 636b 2e70 6174  ents").@mock.pat
+00018740: 6368 2822 6761 6e74 7279 2e6c 6f67 6765  ch("gantry.logge
+00018750: 722e 636c 6965 6e74 2e47 616e 7472 792e  r.client.Gantry.
+00018760: 5f6c 6f67 5f66 6565 6462 6163 6b5f 6576  _log_feedback_ev
+00018770: 656e 7473 2229 0a64 6566 2074 6573 745f  ents").def test_
+00018780: 6c6f 675f 7265 636f 7264 735f 7369 7a65  log_records_size
+00018790: 5f6d 6973 6d61 7463 6828 0a20 2020 206d  _mismatch(.    m
+000187a0: 6f63 6b5f 6665 6564 6261 636b 732c 0a20  ock_feedbacks,. 
+000187b0: 2020 206d 6f63 6b5f 7072 6564 732c 0a20     mock_preds,. 
+000187c0: 2020 206d 6f63 6b5f 7072 6564 735f 616e     mock_preds_an
+000187d0: 645f 6665 6564 6261 636b 2c0a 2020 2020  d_feedback,.    
+000187e0: 696e 7075 7473 2c0a 2020 2020 6f75 7470  inputs,.    outp
+000187f0: 7574 732c 0a20 2020 2066 6565 6462 6163  uts,.    feedbac
+00018800: 6b73 2c0a 2020 2020 7469 6d65 7374 616d  ks,.    timestam
+00018810: 7073 2c0a 2020 2020 6a6f 696e 5f6b 6579  ps,.    join_key
+00018820: 732c 0a20 2020 2063 6c69 5f6f 626a 2c0a  s,.    cli_obj,.
+00018830: 293a 0a20 2020 2061 7373 6572 7420 280a  ):.    assert (.
+00018840: 2020 2020 2020 2020 636c 695f 6f62 6a2e          cli_obj.
+00018850: 6c6f 675f 7265 636f 7264 7328 0a20 2020  log_records(.   
+00018860: 2020 2020 2020 2020 2061 7070 6c69 6361           applica
+00018870: 7469 6f6e 3d22 666f 6f62 6172 222c 0a20  tion="foobar",. 
+00018880: 2020 2020 2020 2020 2020 2076 6572 7369             versi
+00018890: 6f6e 3d22 322e 302e 3122 2c0a 2020 2020  on="2.0.1",.    
+000188a0: 2020 2020 2020 2020 696e 7075 7473 3d69          inputs=i
+000188b0: 6e70 7574 732c 0a20 2020 2020 2020 2020  nputs,.         
+000188c0: 2020 206f 7574 7075 7473 3d6f 7574 7075     outputs=outpu
+000188d0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+000188e0: 6665 6564 6261 636b 733d 6665 6564 6261  feedbacks=feedba
+000188f0: 636b 732c 0a20 2020 2020 2020 2020 2020  cks,.           
+00018900: 2074 696d 6573 7461 6d70 733d 7469 6d65   timestamps=time
+00018910: 7374 616d 7073 2c0a 2020 2020 2020 2020  stamps,.        
+00018920: 2020 2020 736f 7274 5f6f 6e5f 7469 6d65      sort_on_time
+00018930: 7374 616d 703d 5472 7565 2c0a 2020 2020  stamp=True,.    
+00018940: 2020 2020 2020 2020 6a6f 696e 5f6b 6579          join_key
+00018950: 733d 6a6f 696e 5f6b 6579 732c 0a20 2020  s=join_keys,.   
+00018960: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
+00018970: 7320 4e6f 6e65 0a20 2020 2029 0a0a 2020  s None.    )..  
+00018980: 2020 6d6f 636b 5f70 7265 6473 5f61 6e64    mock_preds_and
+00018990: 5f66 6565 6462 6163 6b2e 6173 7365 7274  _feedback.assert
+000189a0: 5f6e 6f74 5f63 616c 6c65 6428 290a 2020  _not_called().  
+000189b0: 2020 6d6f 636b 5f70 7265 6473 2e61 7373    mock_preds.ass
+000189c0: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
+000189d0: 0a20 2020 206d 6f63 6b5f 6665 6564 6261  .    mock_feedba
+000189e0: 636b 732e 6173 7365 7274 5f6e 6f74 5f63  cks.assert_not_c
+000189f0: 616c 6c65 6428 290a 0a0a 4070 7974 6573  alled()...@pytes
+00018a00: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+00018a10: 7a65 280a 2020 2020 5b22 696e 7075 7473  ze(.    ["inputs
+00018a20: 222c 2022 6f75 7470 7574 7322 2c20 2266  ", "outputs", "f
+00018a30: 6565 6462 6163 6b73 222c 2022 6a6f 696e  eedbacks", "join
+00018a40: 5f6b 6579 7322 2c20 2274 696d 6573 7461  _keys", "timesta
+00018a50: 6d70 7322 5d2c 0a20 2020 205b 0a20 2020  mps"],.    [.   
+00018a60: 2020 2020 2028 5b7b 2241 223a 2031 307d       ([{"A": 10}
+00018a70: 5d20 2a20 3130 2c20 5b7b 2241 223a 2031  ] * 10, [{"A": 1
+00018a80: 307d 5d20 2a20 392c 204e 6f6e 652c 204e  0}] * 9, None, N
+00018a90: 6f6e 652c 204e 6f6e 6529 2c0a 2020 2020  one, None),.    
+00018aa0: 2020 2020 285b 7b22 4122 3a20 3130 7d5d      ([{"A": 10}]
+00018ab0: 202a 2031 302c 205b 7b22 4122 3a20 3130   * 10, [{"A": 10
+00018ac0: 7d5d 202a 2039 2c20 5b7b 2241 223a 2031  }] * 9, [{"A": 1
+00018ad0: 317d 5d20 2a20 3130 2c20 5b22 666f 6f62  1}] * 10, ["foob
+00018ae0: 6172 225d 202a 2031 302c 204e 6f6e 6529  ar"] * 10, None)
+00018af0: 2c0a 2020 2020 2020 2020 285b 7b22 4122  ,.        ([{"A"
+00018b00: 3a20 3130 7d5d 202a 2039 2c20 5b7b 2241  : 10}] * 9, [{"A
+00018b10: 223a 2031 307d 5d20 2a20 382c 205b 7b22  ": 10}] * 8, [{"
+00018b20: 4122 3a20 3131 7d5d 202a 2031 302c 205b  A": 11}] * 10, [
+00018b30: 2266 6f6f 6261 7222 5d20 2a20 3130 2c20  "foobar"] * 10, 
+00018b40: 4e6f 6e65 292c 0a20 2020 2020 2020 2028  None),.        (
+00018b50: 5b7b 2241 223a 2031 307d 5d20 2a20 392c  [{"A": 10}] * 9,
+00018b60: 204e 6f6e 652c 205b 7b22 4122 3a20 3131   None, [{"A": 11
+00018b70: 7d5d 202a 2031 302c 205b 2266 6f6f 6261  }] * 10, ["fooba
+00018b80: 7222 5d20 2a20 3130 2c20 4e6f 6e65 292c  r"] * 10, None),
+00018b90: 0a20 2020 2020 2020 2028 4e6f 6e65 2c20  .        (None, 
+00018ba0: 4e6f 6e65 2c20 5b7b 2241 223a 2031 317d  None, [{"A": 11}
+00018bb0: 5d20 2a20 3131 2c20 5b22 666f 6f62 6172  ] * 11, ["foobar
+00018bc0: 225d 202a 2031 302c 204e 6f6e 6529 2c0a  "] * 10, None),.
+00018bd0: 2020 2020 2020 2020 284e 6f6e 652c 204e          (None, N
+00018be0: 6f6e 652c 205b 7b22 4122 3a20 3131 7d5d  one, [{"A": 11}]
+00018bf0: 202a 2031 312c 205b 2266 6f6f 6261 7222   * 11, ["foobar"
+00018c00: 5d20 2a20 3130 2c20 5b43 5552 5245 4e54  ] * 10, [CURRENT
+00018c10: 5f54 494d 455d 202a 2031 3029 2c0a 2020  _TIME] * 10),.  
+00018c20: 2020 2020 2020 284e 6f6e 652c 204e 6f6e        (None, Non
+00018c30: 652c 205b 7b22 4122 3a20 3131 7d5d 202a  e, [{"A": 11}] *
+00018c40: 2031 312c 205b 2266 6f6f 6261 7222 5d20   11, ["foobar"] 
+00018c50: 2a20 3130 2c20 6e70 2e61 7272 6179 285b  * 10, np.array([
+00018c60: 4355 5252 454e 545f 5449 4d45 5d20 2a20  CURRENT_TIME] * 
+00018c70: 3130 2929 2c0a 2020 2020 5d2c 0a29 0a40  10)),.    ],.).@
+00018c80: 6d6f 636b 2e70 6174 6368 2822 6761 6e74  mock.patch("gant
+00018c90: 7279 2e6c 6f67 6765 722e 636c 6965 6e74  ry.logger.client
+00018ca0: 2e47 616e 7472 792e 5f67 656e 6572 6174  .Gantry._generat
+00018cb0: 655f 7072 6564 6963 7469 6f6e 5f61 6e64  e_prediction_and
+00018cc0: 5f66 6565 6462 6163 6b5f 6576 656e 7473  _feedback_events
+00018cd0: 2229 0a40 6d6f 636b 2e70 6174 6368 2822  ").@mock.patch("
+00018ce0: 6761 6e74 7279 2e6c 6f67 6765 722e 636c  gantry.logger.cl
+00018cf0: 6965 6e74 2e47 616e 7472 792e 5f67 656e  ient.Gantry._gen
+00018d00: 6572 6174 655f 7072 6564 6963 7469 6f6e  erate_prediction
+00018d10: 5f65 7665 6e74 7322 290a 406d 6f63 6b2e  _events").@mock.
+00018d20: 7061 7463 6828 2267 616e 7472 792e 6c6f  patch("gantry.lo
+00018d30: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
+00018d40: 7279 2e5f 6765 6e65 7261 7465 5f66 6565  ry._generate_fee
+00018d50: 6462 6163 6b5f 6576 656e 7473 2229 0a64  dback_events").d
+00018d60: 6566 2074 6573 745f 6765 6e65 7261 7465  ef test_generate
+00018d70: 5f72 6563 6f72 6473 5f73 697a 655f 6d69  _records_size_mi
+00018d80: 736d 6174 6368 280a 2020 2020 6d6f 636b  smatch(.    mock
+00018d90: 5f67 656e 6572 6174 655f 6665 6564 6261  _generate_feedba
+00018da0: 636b 732c 0a20 2020 206d 6f63 6b5f 6765  cks,.    mock_ge
+00018db0: 6e65 7261 7465 5f70 7265 6473 2c0a 2020  nerate_preds,.  
+00018dc0: 2020 6d6f 636b 5f67 656e 6572 6174 655f    mock_generate_
+00018dd0: 7072 6564 735f 616e 645f 6665 6564 6261  preds_and_feedba
+00018de0: 636b 2c0a 2020 2020 696e 7075 7473 2c0a  ck,.    inputs,.
+00018df0: 2020 2020 6f75 7470 7574 732c 0a20 2020      outputs,.   
+00018e00: 2066 6565 6462 6163 6b73 2c0a 2020 2020   feedbacks,.    
+00018e10: 7469 6d65 7374 616d 7073 2c0a 2020 2020  timestamps,.    
+00018e20: 6a6f 696e 5f6b 6579 732c 0a20 2020 2063  join_keys,.    c
+00018e30: 6c69 5f6f 626a 2c0a 293a 0a20 2020 2061  li_obj,.):.    a
+00018e40: 7373 6572 7420 280a 2020 2020 2020 2020  ssert (.        
+00018e50: 636c 695f 6f62 6a2e 6765 6e65 7261 7465  cli_obj.generate
+00018e60: 5f72 6563 6f72 6473 280a 2020 2020 2020  _records(.      
+00018e70: 2020 2020 2020 6170 706c 6963 6174 696f        applicatio
+00018e80: 6e3d 2266 6f6f 6261 7222 2c0a 2020 2020  n="foobar",.    
+00018e90: 2020 2020 2020 2020 7665 7273 696f 6e3d          version=
+00018ea0: 2232 2e30 2e31 222c 0a20 2020 2020 2020  "2.0.1",.       
+00018eb0: 2020 2020 2069 6e70 7574 733d 696e 7075       inputs=inpu
+00018ec0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+00018ed0: 6f75 7470 7574 733d 6f75 7470 7574 732c  outputs=outputs,
+00018ee0: 0a20 2020 2020 2020 2020 2020 2066 6565  .            fee
+00018ef0: 6462 6163 6b73 3d66 6565 6462 6163 6b73  dbacks=feedbacks
+00018f00: 2c0a 2020 2020 2020 2020 2020 2020 7469  ,.            ti
+00018f10: 6d65 7374 616d 7073 3d74 696d 6573 7461  mestamps=timesta
+00018f20: 6d70 732c 0a20 2020 2020 2020 2020 2020  mps,.           
+00018f30: 2073 6f72 745f 6f6e 5f74 696d 6573 7461   sort_on_timesta
+00018f40: 6d70 3d54 7275 652c 0a20 2020 2020 2020  mp=True,.       
+00018f50: 2020 2020 206a 6f69 6e5f 6b65 7973 3d6a       join_keys=j
+00018f60: 6f69 6e5f 6b65 7973 2c0a 2020 2020 2020  oin_keys,.      
+00018f70: 2020 290a 2020 2020 2020 2020 6973 204e    ).        is N
+00018f80: 6f6e 650a 2020 2020 290a 0a20 2020 206d  one.    )..    m
+00018f90: 6f63 6b5f 6765 6e65 7261 7465 5f70 7265  ock_generate_pre
+00018fa0: 6473 5f61 6e64 5f66 6565 6462 6163 6b2e  ds_and_feedback.
+00018fb0: 6173 7365 7274 5f6e 6f74 5f63 616c 6c65  assert_not_calle
+00018fc0: 6428 290a 2020 2020 6d6f 636b 5f67 656e  d().    mock_gen
+00018fd0: 6572 6174 655f 7072 6564 732e 6173 7365  erate_preds.asse
+00018fe0: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
+00018ff0: 2020 2020 6d6f 636b 5f67 656e 6572 6174      mock_generat
+00019000: 655f 6665 6564 6261 636b 732e 6173 7365  e_feedbacks.asse
+00019010: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
+00019020: 0a0a 4070 7974 6573 742e 6d61 726b 2e70  ..@pytest.mark.p
+00019030: 6172 616d 6574 7269 7a65 280a 2020 2020  arametrize(.    
+00019040: 5b22 696e 7075 7473 222c 2022 6f75 7470  ["inputs", "outp
+00019050: 7574 7322 2c20 2266 6565 6462 6163 6b73  uts", "feedbacks
+00019060: 222c 2022 6a6f 696e 5f6b 6579 7322 2c20  ", "join_keys", 
+00019070: 2274 696d 6573 7461 6d70 7322 5d2c 0a20  "timestamps"],. 
+00019080: 2020 205b 0a20 2020 2020 2020 2028 5b7b     [.        ([{
+00019090: 2241 223a 2031 307d 5d20 2a20 3130 2c20  "A": 10}] * 10, 
+000190a0: 5b7b 2241 223a 2031 307d 5d20 2a20 3130  [{"A": 10}] * 10
+000190b0: 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f  , None, None, No
+000190c0: 6e65 292c 0a20 2020 2020 2020 2028 5b7b  ne),.        ([{
+000190d0: 2241 223a 2031 307d 5d20 2a20 3130 2c20  "A": 10}] * 10, 
+000190e0: 5b7b 2241 223a 2031 307d 5d20 2a20 3130  [{"A": 10}] * 10
+000190f0: 2c20 5b7b 2241 223a 2031 317d 5d20 2a20  , [{"A": 11}] * 
+00019100: 3130 2c20 5b22 666f 6f62 6172 225d 202a  10, ["foobar"] *
+00019110: 2031 302c 204e 6f6e 6529 2c0a 2020 2020   10, None),.    
+00019120: 2020 2020 285b 7b22 4122 3a20 3130 7d5d      ([{"A": 10}]
+00019130: 202a 2031 302c 205b 7b22 4122 3a20 3130   * 10, [{"A": 10
+00019140: 7d5d 202a 2031 302c 205b 7b22 4122 3a20  }] * 10, [{"A": 
+00019150: 3131 7d5d 202a 2031 302c 205b 2266 6f6f  11}] * 10, ["foo
+00019160: 6261 7222 5d20 2a20 3130 2c20 4e6f 6e65  bar"] * 10, None
+00019170: 292c 0a20 2020 2020 2020 2028 4e6f 6e65  ),.        (None
+00019180: 2c20 4e6f 6e65 2c20 5b7b 2241 223a 2031  , None, [{"A": 1
+00019190: 317d 5d20 2a20 3130 2c20 5b22 666f 6f62  1}] * 10, ["foob
+000191a0: 6172 225d 202a 2031 302c 204e 6f6e 6529  ar"] * 10, None)
+000191b0: 2c0a 2020 2020 2020 2020 284e 6f6e 652c  ,.        (None,
+000191c0: 204e 6f6e 652c 205b 7b22 4122 3a20 3131   None, [{"A": 11
+000191d0: 7d5d 202a 2031 302c 205b 2266 6f6f 6261  }] * 10, ["fooba
+000191e0: 7222 5d20 2a20 3130 2c20 5b43 5552 5245  r"] * 10, [CURRE
+000191f0: 4e54 5f54 494d 455d 202a 2031 3029 2c0a  NT_TIME] * 10),.
+00019200: 2020 2020 2020 2020 284e 6f6e 652c 204e          (None, N
+00019210: 6f6e 652c 205b 7b22 4122 3a20 3131 7d5d  one, [{"A": 11}]
+00019220: 202a 2031 302c 205b 2266 6f6f 6261 7222   * 10, ["foobar"
+00019230: 5d20 2a20 3130 2c20 6e70 2e61 7272 6179  ] * 10, np.array
+00019240: 285b 4355 5252 454e 545f 5449 4d45 5d20  ([CURRENT_TIME] 
+00019250: 2a20 3130 2929 2c0a 2020 2020 5d2c 0a29  * 10)),.    ],.)
+00019260: 0a40 6d6f 636b 2e70 6174 6368 280a 2020  .@mock.patch(.  
+00019270: 2020 2267 616e 7472 792e 6c6f 6767 6572    "gantry.logger
+00019280: 2e63 6c69 656e 742e 4761 6e74 7279 2e5f  .client.Gantry._
+00019290: 6c6f 675f 7072 6564 6963 7469 6f6e 5f61  log_prediction_a
+000192a0: 6e64 5f66 6565 6462 6163 6b5f 6576 656e  nd_feedback_even
+000192b0: 7473 222c 0a20 2020 2072 6574 7572 6e5f  ts",.    return_
+000192c0: 7661 6c75 653d 284e 6f6e 652c 205b 2231  value=(None, ["1
+000192d0: 3233 3435 222c 2022 3637 3839 3022 5d29  2345", "67890"])
+000192e0: 2c0a 290a 406d 6f63 6b2e 7061 7463 6828  ,.).@mock.patch(
+000192f0: 0a20 2020 2022 6761 6e74 7279 2e6c 6f67  .    "gantry.log
+00019300: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
+00019310: 792e 5f6c 6f67 5f70 7265 6469 6374 696f  y._log_predictio
+00019320: 6e5f 6576 656e 7473 222c 2072 6574 7572  n_events", retur
+00019330: 6e5f 7661 6c75 653d 284e 6f6e 652c 205b  n_value=(None, [
+00019340: 2231 3233 3435 222c 2022 3637 3839 3022  "12345", "67890"
+00019350: 5d29 0a29 0a40 6d6f 636b 2e70 6174 6368  ]).).@mock.patch
+00019360: 280a 2020 2020 2267 616e 7472 792e 6c6f  (.    "gantry.lo
+00019370: 6767 6572 2e63 6c69 656e 742e 4761 6e74  gger.client.Gant
+00019380: 7279 2e5f 6c6f 675f 6665 6564 6261 636b  ry._log_feedback
+00019390: 5f65 7665 6e74 7322 2c20 7265 7475 726e  _events", return
+000193a0: 5f76 616c 7565 3d28 4e6f 6e65 2c20 5b22  _value=(None, ["
+000193b0: 3132 3334 3522 2c20 2236 3738 3930 225d  12345", "67890"]
+000193c0: 290a 290a 6465 6620 7465 7374 5f6c 6f67  ).).def test_log
+000193d0: 5f72 6563 6f72 6473 5f73 697a 655f 6d61  _records_size_ma
+000193e0: 7463 6828 0a20 2020 206d 6f63 6b5f 6665  tch(.    mock_fe
+000193f0: 6564 6261 636b 732c 0a20 2020 206d 6f63  edbacks,.    moc
+00019400: 6b5f 7072 6564 732c 0a20 2020 206d 6f63  k_preds,.    moc
+00019410: 6b5f 7072 6564 735f 616e 645f 6665 6564  k_preds_and_feed
+00019420: 6261 636b 2c0a 2020 2020 696e 7075 7473  back,.    inputs
+00019430: 2c0a 2020 2020 6f75 7470 7574 732c 0a20  ,.    outputs,. 
+00019440: 2020 2066 6565 6462 6163 6b73 2c0a 2020     feedbacks,.  
+00019450: 2020 7469 6d65 7374 616d 7073 2c0a 2020    timestamps,.  
+00019460: 2020 6a6f 696e 5f6b 6579 732c 0a20 2020    join_keys,.   
+00019470: 2063 6c69 5f6f 626a 2c0a 293a 0a20 2020   cli_obj,.):.   
+00019480: 2061 7373 6572 7420 280a 2020 2020 2020   assert (.      
+00019490: 2020 636c 695f 6f62 6a2e 6c6f 675f 7265    cli_obj.log_re
+000194a0: 636f 7264 7328 0a20 2020 2020 2020 2020  cords(.         
+000194b0: 2020 2061 7070 6c69 6361 7469 6f6e 3d22     application="
+000194c0: 666f 6f62 6172 222c 0a20 2020 2020 2020  foobar",.       
+000194d0: 2020 2020 2076 6572 7369 6f6e 3d22 322e       version="2.
+000194e0: 302e 3122 2c0a 2020 2020 2020 2020 2020  0.1",.          
+000194f0: 2020 696e 7075 7473 3d69 6e70 7574 732c    inputs=inputs,
+00019500: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
+00019510: 7075 7473 3d6f 7574 7075 7473 2c0a 2020  puts=outputs,.  
+00019520: 2020 2020 2020 2020 2020 6665 6564 6261            feedba
+00019530: 636b 733d 6665 6564 6261 636b 732c 0a20  cks=feedbacks,. 
+00019540: 2020 2020 2020 2020 2020 2074 696d 6573             times
+00019550: 7461 6d70 733d 7469 6d65 7374 616d 7073  tamps=timestamps
+00019560: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
+00019570: 7274 5f6f 6e5f 7469 6d65 7374 616d 703d  rt_on_timestamp=
+00019580: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+00019590: 2020 6a6f 696e 5f6b 6579 733d 6a6f 696e    join_keys=join
+000195a0: 5f6b 6579 732c 0a20 2020 2020 2020 2029  _keys,.        )
+000195b0: 0a20 2020 2020 2020 2069 7320 6e6f 7420  .        is not 
+000195c0: 4e6f 6e65 0a20 2020 2029 0a0a 0a40 7079  None.    )...@py
+000195d0: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
+000195e0: 7472 697a 6528 0a20 2020 205b 2269 6e70  trize(.    ["inp
+000195f0: 7574 7322 2c20 226f 7574 7075 7473 222c  uts", "outputs",
+00019600: 2022 6665 6564 6261 636b 7322 2c20 226a   "feedbacks", "j
+00019610: 6f69 6e5f 6b65 7973 222c 2022 7469 6d65  oin_keys", "time
+00019620: 7374 616d 7073 225d 2c0a 2020 2020 5b0a  stamps"],.    [.
+00019630: 2020 2020 2020 2020 285b 7b22 4122 3a20          ([{"A": 
+00019640: 3130 7d5d 202a 2031 302c 205b 7b22 4122  10}] * 10, [{"A"
+00019650: 3a20 3130 7d5d 202a 2031 302c 204e 6f6e  : 10}] * 10, Non
+00019660: 652c 204e 6f6e 652c 204e 6f6e 6529 2c0a  e, None, None),.
+00019670: 2020 2020 2020 2020 285b 7b22 4122 3a20          ([{"A": 
+00019680: 3130 7d5d 202a 2031 302c 205b 7b22 4122  10}] * 10, [{"A"
+00019690: 3a20 3130 7d5d 202a 2031 302c 205b 7b22  : 10}] * 10, [{"
+000196a0: 4122 3a20 3131 7d5d 202a 2031 302c 205b  A": 11}] * 10, [
+000196b0: 2266 6f6f 6261 7222 5d20 2a20 3130 2c20  "foobar"] * 10, 
+000196c0: 4e6f 6e65 292c 0a20 2020 2020 2020 2028  None),.        (
+000196d0: 5b7b 2241 223a 2031 307d 5d20 2a20 3130  [{"A": 10}] * 10
+000196e0: 2c20 5b7b 2241 223a 2031 307d 5d20 2a20  , [{"A": 10}] * 
+000196f0: 3130 2c20 5b7b 2241 223a 2031 317d 5d20  10, [{"A": 11}] 
+00019700: 2a20 3130 2c20 5b22 666f 6f62 6172 225d  * 10, ["foobar"]
+00019710: 202a 2031 302c 204e 6f6e 6529 2c0a 2020   * 10, None),.  
+00019720: 2020 2020 2020 284e 6f6e 652c 204e 6f6e        (None, Non
+00019730: 652c 205b 7b22 4122 3a20 3131 7d5d 202a  e, [{"A": 11}] *
+00019740: 2031 302c 205b 2266 6f6f 6261 7222 5d20   10, ["foobar"] 
+00019750: 2a20 3130 2c20 4e6f 6e65 292c 0a20 2020  * 10, None),.   
+00019760: 2020 2020 2028 4e6f 6e65 2c20 4e6f 6e65       (None, None
+00019770: 2c20 5b7b 2241 223a 2031 317d 5d20 2a20  , [{"A": 11}] * 
+00019780: 3130 2c20 5b22 666f 6f62 6172 225d 202a  10, ["foobar"] *
+00019790: 2031 302c 205b 4355 5252 454e 545f 5449   10, [CURRENT_TI
+000197a0: 4d45 5d20 2a20 3130 292c 0a20 2020 2020  ME] * 10),.     
+000197b0: 2020 2028 4e6f 6e65 2c20 4e6f 6e65 2c20     (None, None, 
+000197c0: 5b7b 2241 223a 2031 317d 5d20 2a20 3130  [{"A": 11}] * 10
+000197d0: 2c20 5b22 666f 6f62 6172 225d 202a 2031  , ["foobar"] * 1
+000197e0: 302c 206e 702e 6172 7261 7928 5b43 5552  0, np.array([CUR
+000197f0: 5245 4e54 5f54 494d 455d 202a 2031 3029  RENT_TIME] * 10)
+00019800: 292c 0a20 2020 205d 2c0a 290a 406d 6f63  ),.    ],.).@moc
+00019810: 6b2e 7061 7463 6828 0a20 2020 2022 6761  k.patch(.    "ga
+00019820: 6e74 7279 2e6c 6f67 6765 722e 636c 6965  ntry.logger.clie
+00019830: 6e74 2e47 616e 7472 792e 5f67 656e 6572  nt.Gantry._gener
+00019840: 6174 655f 7072 6564 6963 7469 6f6e 5f61  ate_prediction_a
+00019850: 6e64 5f66 6565 6462 6163 6b5f 6576 656e  nd_feedback_even
+00019860: 7473 222c 0a20 2020 2072 6574 7572 6e5f  ts",.    return_
+00019870: 7661 6c75 653d 284e 6f6e 652c 205b 2231  value=(None, ["1
+00019880: 3233 3435 222c 2022 3637 3839 3022 5d29  2345", "67890"])
+00019890: 2c0a 290a 406d 6f63 6b2e 7061 7463 6828  ,.).@mock.patch(
+000198a0: 0a20 2020 2022 6761 6e74 7279 2e6c 6f67  .    "gantry.log
+000198b0: 6765 722e 636c 6965 6e74 2e47 616e 7472  ger.client.Gantr
+000198c0: 792e 5f67 656e 6572 6174 655f 7072 6564  y._generate_pred
+000198d0: 6963 7469 6f6e 5f65 7665 6e74 7322 2c0a  iction_events",.
+000198e0: 2020 2020 7265 7475 726e 5f76 616c 7565      return_value
+000198f0: 3d28 4e6f 6e65 2c20 5b22 3132 3334 3522  =(None, ["12345"
+00019900: 2c20 2236 3738 3930 225d 292c 0a29 0a40  , "67890"]),.).@
+00019910: 6d6f 636b 2e70 6174 6368 280a 2020 2020  mock.patch(.    
+00019920: 2267 616e 7472 792e 6c6f 6767 6572 2e63  "gantry.logger.c
+00019930: 6c69 656e 742e 4761 6e74 7279 2e5f 6765  lient.Gantry._ge
+00019940: 6e65 7261 7465 5f66 6565 6462 6163 6b5f  nerate_feedback_
+00019950: 6576 656e 7473 222c 2072 6574 7572 6e5f  events", return_
+00019960: 7661 6c75 653d 284e 6f6e 652c 205b 2231  value=(None, ["1
+00019970: 3233 3435 222c 2022 3637 3839 3022 5d29  2345", "67890"])
+00019980: 0a29 0a64 6566 2074 6573 745f 6765 6e65  .).def test_gene
+00019990: 7261 7465 5f72 6563 6f72 6473 5f73 697a  rate_records_siz
+000199a0: 655f 6d61 7463 6828 0a20 2020 206d 6f63  e_match(.    moc
+000199b0: 6b5f 6765 6e65 7261 7465 5f66 6565 6462  k_generate_feedb
+000199c0: 6163 6b73 2c0a 2020 2020 6d6f 636b 5f67  acks,.    mock_g
+000199d0: 656e 6572 6174 655f 7072 6564 732c 0a20  enerate_preds,. 
+000199e0: 2020 206d 6f63 6b5f 6765 6e65 7261 7465     mock_generate
+000199f0: 5f70 7265 6473 5f61 6e64 5f66 6565 6462  _preds_and_feedb
+00019a00: 6163 6b2c 0a20 2020 2069 6e70 7574 732c  ack,.    inputs,
+00019a10: 0a20 2020 206f 7574 7075 7473 2c0a 2020  .    outputs,.  
+00019a20: 2020 6665 6564 6261 636b 732c 0a20 2020    feedbacks,.   
+00019a30: 2074 696d 6573 7461 6d70 732c 0a20 2020   timestamps,.   
+00019a40: 206a 6f69 6e5f 6b65 7973 2c0a 2020 2020   join_keys,.    
+00019a50: 636c 695f 6f62 6a2c 0a29 3a0a 2020 2020  cli_obj,.):.    
+00019a60: 6173 7365 7274 2028 0a20 2020 2020 2020  assert (.       
+00019a70: 2063 6c69 5f6f 626a 2e67 656e 6572 6174   cli_obj.generat
+00019a80: 655f 7265 636f 7264 7328 0a20 2020 2020  e_records(.     
+00019a90: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
+00019aa0: 6f6e 3d22 666f 6f62 6172 222c 0a20 2020  on="foobar",.   
+00019ab0: 2020 2020 2020 2020 2076 6572 7369 6f6e           version
+00019ac0: 3d22 322e 302e 3122 2c0a 2020 2020 2020  ="2.0.1",.      
+00019ad0: 2020 2020 2020 696e 7075 7473 3d69 6e70        inputs=inp
+00019ae0: 7574 732c 0a20 2020 2020 2020 2020 2020  uts,.           
+00019af0: 206f 7574 7075 7473 3d6f 7574 7075 7473   outputs=outputs
+00019b00: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
+00019b10: 6564 6261 636b 733d 6665 6564 6261 636b  edbacks=feedback
+00019b20: 732c 0a20 2020 2020 2020 2020 2020 2074  s,.            t
+00019b30: 696d 6573 7461 6d70 733d 7469 6d65 7374  imestamps=timest
+00019b40: 616d 7073 2c0a 2020 2020 2020 2020 2020  amps,.          
+00019b50: 2020 736f 7274 5f6f 6e5f 7469 6d65 7374    sort_on_timest
+00019b60: 616d 703d 5472 7565 2c0a 2020 2020 2020  amp=True,.      
+00019b70: 2020 2020 2020 6a6f 696e 5f6b 6579 733d        join_keys=
+00019b80: 6a6f 696e 5f6b 6579 732c 0a20 2020 2020  join_keys,.     
+00019b90: 2020 2029 0a20 2020 2020 2020 2069 7320     ).        is 
+00019ba0: 6e6f 7420 4e6f 6e65 0a20 2020 2029 0a0a  not None.    )..
+00019bb0: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
+00019bc0: 7261 6d65 7472 697a 6528 0a20 2020 2028  rametrize(.    (
+00019bd0: 2274 696d 6573 7461 6d70 222c 2022 696e  "timestamp", "in
+00019be0: 7075 7473 222c 2022 6f75 7470 7574 7322  puts", "outputs"
+00019bf0: 2c20 2266 6565 6462 6163 6b73 222c 2022  , "feedbacks", "
+00019c00: 6a6f 696e 5f6b 6579 222c 2022 676c 6f62  join_key", "glob
+00019c10: 616c 5f74 6167 7322 2c20 2272 6f77 5f74  al_tags", "row_t
+00019c20: 6167 7322 292c 0a20 2020 205b 2020 2320  ags"),.    [  # 
+00019c30: 5465 7374 2061 6c6c 2063 6f6d 6269 6e61  Test all combina
+00019c40: 7469 6f6e 7320 6f66 2069 6e70 7574 732c  tions of inputs,
+00019c50: 206f 7574 7075 7473 2c20 6665 6564 6261   outputs, feedba
+00019c60: 636b 732c 2061 6e64 206a 6f69 6e5f 6b65  cks, and join_ke
+00019c70: 790a 2020 2020 2020 2020 2822 5422 2c20  y.        ("T", 
+00019c80: 5b22 4122 2c20 2242 225d 2c20 5b22 4322  ["A", "B"], ["C"
+00019c90: 2c20 2244 225d 2c20 5b22 4822 2c20 2249  , "D"], ["H", "I
+00019ca0: 225d 2c20 2245 222c 207b 2276 6572 7369  "], "E", {"versi
+00019cb0: 6f6e 223a 2022 7465 7374 5f76 6572 7369  on": "test_versi
+00019cc0: 6f6e 227d 2c20 5b22 4722 5d29 2c0a 2020  on"}, ["G"]),.  
+00019cd0: 2020 2020 2020 2320 5465 7374 2077 6974        # Test wit
+00019ce0: 686f 7574 2066 6565 6462 6163 6b73 2061  hout feedbacks a
+00019cf0: 6e64 2072 6f77 5f74 6167 730a 2020 2020  nd row_tags.    
+00019d00: 2020 2020 2822 5422 2c20 5b22 4122 2c20      ("T", ["A", 
+00019d10: 2242 225d 2c20 5b22 4422 5d2c 204e 6f6e  "B"], ["D"], Non
+00019d20: 652c 2022 4522 2c20 7b22 7665 7273 696f  e, "E", {"versio
+00019d30: 6e22 3a20 2274 6573 745f 7665 7273 696f  n": "test_versio
+00019d40: 6e22 7d2c 204e 6f6e 6529 2c0a 2020 2020  n"}, None),.    
+00019d50: 2020 2020 2320 5465 7374 2077 6974 686f      # Test witho
+00019d60: 7574 2069 6e70 7574 7320 616e 6420 7469  ut inputs and ti
+00019d70: 6d65 7374 616d 700a 2020 2020 2020 2020  mestamp.        
+00019d80: 284e 6f6e 652c 204e 6f6e 652c 204e 6f6e  (None, None, Non
+00019d90: 652c 205b 2248 222c 2022 4922 5d2c 2022  e, ["H", "I"], "
+00019da0: 4522 2c20 7b22 7665 7273 696f 6e22 3a20  E", {"version": 
+00019db0: 2274 6573 745f 7665 7273 696f 6e22 7d2c  "test_version"},
+00019dc0: 205b 2247 225d 292c 0a20 2020 2020 2020   ["G"]),.       
+00019dd0: 2023 2054 6573 7420 6f6e 6c79 2077 6974   # Test only wit
+00019de0: 6820 6665 6564 6261 636b 7320 616e 6420  h feedbacks and 
+00019df0: 6a6f 696e 5f6b 6579 0a20 2020 2020 2020  join_key.       
+00019e00: 2028 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f   (None, None, No
+00019e10: 6e65 2c20 5b22 4822 2c20 2249 225d 2c20  ne, ["H", "I"], 
+00019e20: 2245 222c 204e 6f6e 652c 204e 6f6e 6529  "E", None, None)
+00019e30: 2c0a 2020 2020 2020 2020 2320 5465 7374  ,.        # Test
+00019e40: 206f 6e6c 7920 7769 7468 2069 6e70 7574   only with input
+00019e50: 7320 616e 6420 676c 6f62 616c 2074 6167  s and global tag
+00019e60: 730a 2020 2020 2020 2020 2822 5422 2c20  s.        ("T", 
+00019e70: 5b22 4122 2c20 2242 225d 2c20 5b22 4322  ["A", "B"], ["C"
+00019e80: 2c20 2244 225d 2c20 4e6f 6e65 2c20 4e6f  , "D"], None, No
+00019e90: 6e65 2c20 7b22 7665 7273 696f 6e22 3a20  ne, {"version": 
+00019ea0: 2274 6573 745f 7665 7273 696f 6e22 7d2c  "test_version"},
+00019eb0: 204e 6f6e 6529 2c0a 2020 2020 5d2c 0a29   None),.    ],.)
+00019ec0: 0a64 6566 2074 6573 745f 6c6f 675f 6672  .def test_log_fr
+00019ed0: 6f6d 5f64 6174 615f 636f 6e6e 6563 746f  om_data_connecto
+00019ee0: 7228 0a20 2020 2074 696d 6573 7461 6d70  r(.    timestamp
+00019ef0: 3a20 7374 722c 0a20 2020 2069 6e70 7574  : str,.    input
+00019f00: 733a 204c 6973 745b 7374 725d 2c0a 2020  s: List[str],.  
+00019f10: 2020 6f75 7470 7574 733a 204c 6973 745b    outputs: List[
+00019f20: 7374 725d 2c0a 2020 2020 6665 6564 6261  str],.    feedba
+00019f30: 636b 733a 204c 6973 745b 7374 725d 2c0a  cks: List[str],.
+00019f40: 2020 2020 6a6f 696e 5f6b 6579 3a20 7374      join_key: st
+00019f50: 722c 0a20 2020 2072 6f77 5f74 6167 733a  r,.    row_tags:
+00019f60: 204c 6973 745b 7374 725d 2c0a 2020 2020   List[str],.    
+00019f70: 676c 6f62 616c 5f74 6167 733a 2044 6963  global_tags: Dic
+00019f80: 745b 7374 722c 2073 7472 5d2c 0a20 2020  t[str, str],.   
+00019f90: 2063 6c69 5f6f 626a 2c0a 293a 0a20 2020   cli_obj,.):.   
+00019fa0: 2022 2222 0a20 2020 2054 6573 7473 2074   """.    Tests t
+00019fb0: 6861 7420 7468 6520 6c6f 675f 6672 6f6d  hat the log_from
+00019fc0: 5f64 6174 615f 636f 6e6e 6563 746f 7220  _data_connector 
+00019fd0: 6675 6e63 7469 6f6e 2063 616c 6c73 2074  function calls t
+00019fe0: 6865 206c 6f67 5f66 726f 6d5f 6461 7461  he log_from_data
+00019ff0: 5f63 6f6e 6e65 6374 6f72 5f61 7379 6e63  _connector_async
+0001a000: 0a20 2020 2066 756e 6374 696f 6e20 7769  .    function wi
+0001a010: 7468 2063 6f72 7265 6374 2070 6172 616d  th correct param
+0001a020: 6574 6572 730a 2020 2020 2222 220a 2020  eters.    """.  
+0001a030: 2020 636c 695f 6f62 6a2e 6c6f 675f 7374    cli_obj.log_st
+0001a040: 6f72 6520 3d20 6d6f 636b 2e4d 6f63 6b28  ore = mock.Mock(
+0001a050: 290a 2020 2020 636c 695f 6f62 6a2e 6c6f  ).    cli_obj.lo
+0001a060: 675f 6672 6f6d 5f64 6174 615f 636f 6e6e  g_from_data_conn
+0001a070: 6563 746f 7228 0a20 2020 2020 2020 2061  ector(.        a
+0001a080: 7070 6c69 6361 7469 6f6e 3d22 666f 6f62  pplication="foob
+0001a090: 6172 222c 0a20 2020 2020 2020 2073 6f75  ar",.        sou
+0001a0a0: 7263 655f 6461 7461 5f63 6f6e 6e65 6374  rce_data_connect
+0001a0b0: 6f72 5f6e 616d 653d 2274 6573 742d 636f  or_name="test-co
+0001a0c0: 6e6e 6563 746f 7222 2c0a 2020 2020 2020  nnector",.      
+0001a0d0: 2020 7469 6d65 7374 616d 703d 7469 6d65    timestamp=time
+0001a0e0: 7374 616d 702c 0a20 2020 2020 2020 2069  stamp,.        i
+0001a0f0: 6e70 7574 733d 696e 7075 7473 2c0a 2020  nputs=inputs,.  
+0001a100: 2020 2020 2020 6f75 7470 7574 733d 6f75        outputs=ou
+0001a110: 7470 7574 732c 0a20 2020 2020 2020 2066  tputs,.        f
+0001a120: 6565 6462 6163 6b73 3d66 6565 6462 6163  eedbacks=feedbac
+0001a130: 6b73 2c0a 2020 2020 2020 2020 6a6f 696e  ks,.        join
+0001a140: 5f6b 6579 3d6a 6f69 6e5f 6b65 792c 0a20  _key=join_key,. 
+0001a150: 2020 2020 2020 2072 6f77 5f74 6167 733d         row_tags=
+0001a160: 726f 775f 7461 6773 2c0a 2020 2020 2020  row_tags,.      
+0001a170: 2020 676c 6f62 616c 5f74 6167 733d 676c    global_tags=gl
+0001a180: 6f62 616c 5f74 6167 732c 0a20 2020 2029  obal_tags,.    )
+0001a190: 0a0a 2020 2020 6361 6c6c 5f61 7267 7320  ..    call_args 
+0001a1a0: 3d20 636c 695f 6f62 6a2e 6c6f 675f 7374  = cli_obj.log_st
+0001a1b0: 6f72 652e 6c6f 675f 6672 6f6d 5f64 6174  ore.log_from_dat
+0001a1c0: 615f 636f 6e6e 6563 746f 725f 6173 796e  a_connector_asyn
+0001a1d0: 632e 6361 6c6c 5f61 7267 730a 2020 2020  c.call_args.    
+0001a1e0: 6173 7365 7274 2063 616c 6c5f 6172 6773  assert call_args
+0001a1f0: 2e6b 7761 7267 7320 3d3d 207b 0a20 2020  .kwargs == {.   
+0001a200: 2020 2020 2022 7265 7175 6573 7422 3a20       "request": 
+0001a210: 496e 6765 7374 4672 6f6d 4461 7461 436f  IngestFromDataCo
+0001a220: 6e6e 6563 746f 7252 6571 7565 7374 280a  nnectorRequest(.
+0001a230: 2020 2020 2020 2020 2020 2020 6170 706c              appl
+0001a240: 6963 6174 696f 6e3d 2266 6f6f 6261 7222  ication="foobar"
+0001a250: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
+0001a260: 7572 6365 5f64 6174 615f 636f 6e6e 6563  urce_data_connec
+0001a270: 746f 725f 6e61 6d65 3d22 7465 7374 2d63  tor_name="test-c
+0001a280: 6f6e 6e65 6374 6f72 222c 0a20 2020 2020  onnector",.     
+0001a290: 2020 2020 2020 2074 696d 6573 7461 6d70         timestamp
+0001a2a0: 3d74 696d 6573 7461 6d70 2c0a 2020 2020  =timestamp,.    
+0001a2b0: 2020 2020 2020 2020 696e 7075 7473 3d69          inputs=i
+0001a2c0: 6e70 7574 732c 0a20 2020 2020 2020 2020  nputs,.         
+0001a2d0: 2020 206f 7574 7075 7473 3d6f 7574 7075     outputs=outpu
+0001a2e0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+0001a2f0: 6665 6564 6261 636b 733d 6665 6564 6261  feedbacks=feedba
+0001a300: 636b 732c 0a20 2020 2020 2020 2020 2020  cks,.           
+0001a310: 206a 6f69 6e5f 6b65 793d 6a6f 696e 5f6b   join_key=join_k
+0001a320: 6579 2c0a 2020 2020 2020 2020 2020 2020  ey,.            
+0001a330: 726f 775f 7461 6773 3d72 6f77 5f74 6167  row_tags=row_tag
+0001a340: 732c 0a20 2020 2020 2020 2020 2020 2067  s,.            g
+0001a350: 6c6f 6261 6c5f 7461 6773 3d67 6c6f 6261  lobal_tags=globa
+0001a360: 6c5f 7461 6773 2c0a 2020 2020 2020 2020  l_tags,.        
+0001a370: 2020 2020 7363 6865 6475 6c65 3d4e 6f6e      schedule=Non
+0001a380: 652c 0a20 2020 2020 2020 2020 2020 2070  e,.            p
+0001a390: 6970 656c 696e 655f 6e61 6d65 3d4e 6f6e  ipeline_name=Non
+0001a3a0: 652c 0a20 2020 2020 2020 2029 0a20 2020  e,.        ).   
+0001a3b0: 207d 0a0a 0a40 7079 7465 7374 2e6d 6172   }...@pytest.mar
+0001a3c0: 6b2e 7061 7261 6d65 7472 697a 6528 0a20  k.parametrize(. 
+0001a3d0: 2020 2028 2273 7461 7274 5f6f 6e22 2c20     ("start_on", 
+0001a3e0: 2266 7265 7175 656e 6379 222c 2022 7479  "frequency", "ty
+0001a3f0: 7065 222c 2022 6f70 7469 6f6e 7322 292c  pe", "options"),
+0001a400: 0a20 2020 205b 0a20 2020 2020 2020 2028  .    [.        (
+0001a410: 0a20 2020 2020 2020 2020 2020 2022 3230  .            "20
+0001a420: 3233 2d30 322d 3031 5430 303a 3030 3a30  23-02-01T00:00:0
+0001a430: 302e 3030 3030 3030 222c 0a20 2020 2020  0.000000",.     
+0001a440: 2020 2020 2020 2053 6368 6564 756c 6546         ScheduleF
+0001a450: 7265 7175 656e 6379 2e45 5645 5259 5f48  requency.EVERY_H
+0001a460: 4f55 522c 0a20 2020 2020 2020 2020 2020  OUR,.           
+0001a470: 2053 6368 6564 756c 6554 7970 652e 494e   ScheduleType.IN
+0001a480: 4352 454d 454e 5441 4c5f 4150 5045 4e44  CREMENTAL_APPEND
+0001a490: 2c0a 2020 2020 2020 2020 2020 2020 7b22  ,.            {"
+0001a4a0: 7761 7465 726d 6172 6b5f 6b65 7922 3a20  watermark_key": 
+0001a4b0: 2275 7064 6174 6564 5f61 7422 7d2c 0a20  "updated_at"},. 
+0001a4c0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+0001a4d0: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
+0001a4e0: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+0001a4f0: 652e 7574 636e 6f77 2829 2c0a 2020 2020  e.utcnow(),.    
+0001a500: 2020 2020 2020 2020 5363 6865 6475 6c65          Schedule
+0001a510: 4672 6571 7565 6e63 792e 4556 4552 595f  Frequency.EVERY_
+0001a520: 325f 484f 5552 532c 0a20 2020 2020 2020  2_HOURS,.       
+0001a530: 2020 2020 2053 6368 6564 756c 6554 7970       ScheduleTyp
+0001a540: 652e 494e 4352 454d 454e 5441 4c5f 4150  e.INCREMENTAL_AP
+0001a550: 5045 4e44 2c0a 2020 2020 2020 2020 2020  PEND,.          
+0001a560: 2020 7b22 7761 7465 726d 6172 6b5f 6b65    {"watermark_ke
+0001a570: 7922 3a20 4e6f 6e65 7d2c 0a20 2020 2020  y": None},.     
+0001a580: 2020 2029 2c0a 2020 2020 2020 2020 280a     ),.        (.
+0001a590: 2020 2020 2020 2020 2020 2020 6461 7465              date
+0001a5a0: 7469 6d65 2e64 6174 6574 696d 652e 7574  time.datetime.ut
+0001a5b0: 636e 6f77 2829 2c0a 2020 2020 2020 2020  cnow(),.        
+0001a5c0: 2020 2020 5363 6865 6475 6c65 4672 6571      ScheduleFreq
+0001a5d0: 7565 6e63 792e 4556 4552 595f 345f 484f  uency.EVERY_4_HO
+0001a5e0: 5552 532c 0a20 2020 2020 2020 2020 2020  URS,.           
+0001a5f0: 2053 6368 6564 756c 6554 7970 652e 494e   ScheduleType.IN
+0001a600: 4352 454d 454e 5441 4c5f 4150 5045 4e44  CREMENTAL_APPEND
+0001a610: 2c0a 2020 2020 2020 2020 2020 2020 7b22  ,.            {"
+0001a620: 7761 7465 726d 6172 6b5f 6b65 7922 3a20  watermark_key": 
+0001a630: 2275 7064 6174 6564 5f61 7422 7d2c 0a20  "updated_at"},. 
+0001a640: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+0001a650: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
+0001a660: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+0001a670: 652e 7574 636e 6f77 2829 2c0a 2020 2020  e.utcnow(),.    
+0001a680: 2020 2020 2020 2020 5363 6865 6475 6c65          Schedule
+0001a690: 4672 6571 7565 6e63 792e 4556 4552 595f  Frequency.EVERY_
+0001a6a0: 345f 484f 5552 532c 0a20 2020 2020 2020  4_HOURS,.       
+0001a6b0: 2020 2020 2053 6368 6564 756c 6554 7970       ScheduleTyp
+0001a6c0: 652e 494e 4352 454d 454e 5441 4c5f 4150  e.INCREMENTAL_AP
+0001a6d0: 5045 4e44 2c0a 2020 2020 2020 2020 2020  PEND,.          
+0001a6e0: 2020 7b22 6465 6c61 795f 7469 6d65 223a    {"delay_time":
+0001a6f0: 2033 3030 2c20 2277 6174 6572 6d61 726b   300, "watermark
+0001a700: 5f6b 6579 223a 2022 7570 6461 7465 645f  _key": "updated_
+0001a710: 6174 227d 2c0a 2020 2020 2020 2020 292c  at"},.        ),
+0001a720: 0a20 2020 205d 2c0a 290a 6465 6620 7465  .    ],.).def te
+0001a730: 7374 5f6c 6f67 5f66 726f 6d5f 6461 7461  st_log_from_data
+0001a740: 5f63 6f6e 6e65 6374 6f72 5f77 6974 685f  _connector_with_
+0001a750: 7363 6865 6475 6c65 280a 2020 2020 7374  schedule(.    st
+0001a760: 6172 745f 6f6e 3a20 556e 696f 6e5b 6461  art_on: Union[da
+0001a770: 7465 7469 6d65 2e64 6174 6574 696d 652c  tetime.datetime,
+0001a780: 2073 7472 5d2c 0a20 2020 2066 7265 7175   str],.    frequ
+0001a790: 656e 6379 3a20 5363 6865 6475 6c65 4672  ency: ScheduleFr
+0001a7a0: 6571 7565 6e63 792c 0a20 2020 2074 7970  equency,.    typ
+0001a7b0: 653a 2053 6368 6564 756c 6554 7970 652c  e: ScheduleType,
+0001a7c0: 0a20 2020 206f 7074 696f 6e73 3a20 4469  .    options: Di
+0001a7d0: 6374 5b73 7472 2c20 7374 725d 2c0a 2020  ct[str, str],.  
+0001a7e0: 2020 636c 695f 6f62 6a2c 0a29 3a0a 2020    cli_obj,.):.  
+0001a7f0: 2020 2222 220a 2020 2020 5465 7374 7320    """.    Tests 
+0001a800: 7468 6174 2074 6865 206c 6f67 5f66 726f  that the log_fro
+0001a810: 6d5f 6461 7461 5f63 6f6e 6e65 6374 6f72  m_data_connector
+0001a820: 2066 756e 6374 696f 6e20 6361 6c6c 7320   function calls 
+0001a830: 7468 6520 6c6f 675f 6672 6f6d 5f64 6174  the log_from_dat
+0001a840: 615f 636f 6e6e 6563 746f 725f 6173 796e  a_connector_asyn
+0001a850: 630a 2020 2020 6675 6e63 7469 6f6e 2077  c.    function w
+0001a860: 6974 6820 636f 7272 6563 7420 7061 7261  ith correct para
+0001a870: 6d65 7465 7273 0a20 2020 2022 2222 0a20  meters.    """. 
+0001a880: 2020 2063 6c69 5f6f 626a 2e6c 6f67 5f73     cli_obj.log_s
+0001a890: 746f 7265 203d 206d 6f63 6b2e 4d6f 636b  tore = mock.Mock
+0001a8a0: 2829 0a20 2020 2063 6c69 5f6f 626a 2e6c  ().    cli_obj.l
+0001a8b0: 6f67 5f66 726f 6d5f 6461 7461 5f63 6f6e  og_from_data_con
+0001a8c0: 6e65 6374 6f72 280a 2020 2020 2020 2020  nector(.        
+0001a8d0: 6170 706c 6963 6174 696f 6e3d 2266 6f6f  application="foo
+0001a8e0: 6261 7222 2c0a 2020 2020 2020 2020 736f  bar",.        so
+0001a8f0: 7572 6365 5f64 6174 615f 636f 6e6e 6563  urce_data_connec
+0001a900: 746f 725f 6e61 6d65 3d22 7465 7374 2d63  tor_name="test-c
+0001a910: 6f6e 6e65 6374 6f72 222c 0a20 2020 2020  onnector",.     
+0001a920: 2020 2074 696d 6573 7461 6d70 3d22 5422     timestamp="T"
+0001a930: 2c0a 2020 2020 2020 2020 696e 7075 7473  ,.        inputs
+0001a940: 3d5b 2241 222c 2022 4222 5d2c 0a20 2020  =["A", "B"],.   
+0001a950: 2020 2020 206f 7574 7075 7473 3d5b 2243       outputs=["C
+0001a960: 222c 2022 4422 5d2c 0a20 2020 2020 2020  ", "D"],.       
+0001a970: 2066 6565 6462 6163 6b73 3d5b 2245 222c   feedbacks=["E",
+0001a980: 2022 4622 5d2c 0a20 2020 2020 2020 206a   "F"],.        j
+0001a990: 6f69 6e5f 6b65 793d 2248 222c 0a20 2020  oin_key="H",.   
+0001a9a0: 2020 2020 2072 6f77 5f74 6167 733d 5b22       row_tags=["
+0001a9b0: 4922 2c20 224a 225d 2c0a 2020 2020 2020  I", "J"],.      
+0001a9c0: 2020 676c 6f62 616c 5f74 6167 733d 7b22    global_tags={"
+0001a9d0: 7665 7273 696f 6e22 3a20 2274 6573 745f  version": "test_
+0001a9e0: 7665 7273 696f 6e22 7d2c 0a20 2020 2020  version"},.     
+0001a9f0: 2020 2073 6368 6564 756c 653d 5363 6865     schedule=Sche
+0001aa00: 6475 6c65 280a 2020 2020 2020 2020 2020  dule(.          
+0001aa10: 2020 7374 6172 745f 6f6e 3d73 7461 7274    start_on=start
+0001aa20: 5f6f 6e2c 0a20 2020 2020 2020 2020 2020  _on,.           
+0001aa30: 2066 7265 7175 656e 6379 3d66 7265 7175   frequency=frequ
+0001aa40: 656e 6379 2c0a 2020 2020 2020 2020 2020  ency,.          
+0001aa50: 2020 7479 7065 3d74 7970 652c 0a20 2020    type=type,.   
+0001aa60: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+0001aa70: 3d53 6368 6564 756c 654f 7074 696f 6e73  =ScheduleOptions
+0001aa80: 282a 2a6f 7074 696f 6e73 292c 2020 2320  (**options),  # 
+0001aa90: 7479 7065 3a20 6967 6e6f 7265 0a20 2020  type: ignore.   
+0001aaa0: 2020 2020 2029 2c0a 2020 2020 290a 0a20       ),.    ).. 
+0001aab0: 2020 2063 616c 6c5f 6172 6773 203d 2063     call_args = c
+0001aac0: 6c69 5f6f 626a 2e6c 6f67 5f73 746f 7265  li_obj.log_store
+0001aad0: 2e6c 6f67 5f66 726f 6d5f 6461 7461 5f63  .log_from_data_c
+0001aae0: 6f6e 6e65 6374 6f72 5f61 7379 6e63 2e63  onnector_async.c
+0001aaf0: 616c 6c5f 6172 6773 0a20 2020 2061 7373  all_args.    ass
+0001ab00: 6572 7420 6361 6c6c 5f61 7267 732e 6b77  ert call_args.kw
+0001ab10: 6172 6773 203d 3d20 7b0a 2020 2020 2020  args == {.      
+0001ab20: 2020 2272 6571 7565 7374 223a 2049 6e67    "request": Ing
+0001ab30: 6573 7446 726f 6d44 6174 6143 6f6e 6e65  estFromDataConne
+0001ab40: 6374 6f72 5265 7175 6573 7428 0a20 2020  ctorRequest(.   
+0001ab50: 2020 2020 2020 2020 2061 7070 6c69 6361           applica
+0001ab60: 7469 6f6e 3d22 666f 6f62 6172 222c 0a20  tion="foobar",. 
+0001ab70: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
+0001ab80: 655f 6461 7461 5f63 6f6e 6e65 6374 6f72  e_data_connector
+0001ab90: 5f6e 616d 653d 2274 6573 742d 636f 6e6e  _name="test-conn
+0001aba0: 6563 746f 7222 2c0a 2020 2020 2020 2020  ector",.        
+0001abb0: 2020 2020 7469 6d65 7374 616d 703d 2254      timestamp="T
+0001abc0: 222c 0a20 2020 2020 2020 2020 2020 2069  ",.            i
+0001abd0: 6e70 7574 733d 5b22 4122 2c20 2242 225d  nputs=["A", "B"]
+0001abe0: 2c0a 2020 2020 2020 2020 2020 2020 6f75  ,.            ou
+0001abf0: 7470 7574 733d 5b22 4322 2c20 2244 225d  tputs=["C", "D"]
+0001ac00: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
+0001ac10: 6564 6261 636b 733d 5b22 4522 2c20 2246  edbacks=["E", "F
+0001ac20: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+0001ac30: 6a6f 696e 5f6b 6579 3d22 4822 2c0a 2020  join_key="H",.  
+0001ac40: 2020 2020 2020 2020 2020 726f 775f 7461            row_ta
+0001ac50: 6773 3d5b 2249 222c 2022 4a22 5d2c 0a20  gs=["I", "J"],. 
+0001ac60: 2020 2020 2020 2020 2020 2067 6c6f 6261             globa
+0001ac70: 6c5f 7461 6773 3d7b 2276 6572 7369 6f6e  l_tags={"version
+0001ac80: 223a 2022 7465 7374 5f76 6572 7369 6f6e  ": "test_version
+0001ac90: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
+0001aca0: 7363 6865 6475 6c65 3d53 6368 6564 756c  schedule=Schedul
+0001acb0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+0001acc0: 2020 2073 7461 7274 5f6f 6e3d 7374 6172     start_on=star
+0001acd0: 745f 6f6e 2e69 736f 666f 726d 6174 2829  t_on.isoformat()
+0001ace0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001acf0: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
+0001ad00: 7461 7274 5f6f 6e2c 2064 6174 6574 696d  tart_on, datetim
+0001ad10: 652e 6461 7465 7469 6d65 290a 2020 2020  e.datetime).    
+0001ad20: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0001ad30: 2073 7461 7274 5f6f 6e2c 0a20 2020 2020   start_on,.     
+0001ad40: 2020 2020 2020 2020 2020 2066 7265 7175             frequ
+0001ad50: 656e 6379 3d66 7265 7175 656e 6379 2c0a  ency=frequency,.
+0001ad60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ad70: 7479 7065 3d74 7970 652c 0a20 2020 2020  type=type,.     
+0001ad80: 2020 2020 2020 2020 2020 206f 7074 696f             optio
+0001ad90: 6e73 3d53 6368 6564 756c 654f 7074 696f  ns=ScheduleOptio
+0001ada0: 6e73 282a 2a6f 7074 696f 6e73 292c 2020  ns(**options),  
+0001adb0: 2320 7479 7065 3a20 6967 6e6f 7265 0a20  # type: ignore. 
+0001adc0: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
+0001add0: 2020 2020 2020 2020 2020 7069 7065 6c69            pipeli
+0001ade0: 6e65 5f6e 616d 653d 4e6f 6e65 2c0a 2020  ne_name=None,.  
+0001adf0: 2020 2020 2020 290a 2020 2020 7d0a             ).    }.
```

### Comparing `gantry-0.6.4/tests/logger/test_consumer.py` & `gantry-0.6.5/tests/logger/test_consumer.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/logger/test_event_builder.py` & `gantry-0.6.5/tests/logger/test_event_builder.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/logger/test_main.py` & `gantry-0.6.5/tests/logger/test_main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/logger/test_stores.py` & `gantry-0.6.5/tests/logger/test_stores.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/logger/test_utils.py` & `gantry-0.6.5/tests/logger/test_utils.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/query/conftest.py` & `gantry-0.6.5/tests/query/conftest.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/query/core/test_dataframe.py` & `gantry-0.6.5/tests/query/core/test_dataframe.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/query/core/test_distance.py` & `gantry-0.6.5/tests/query/core/test_distance.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/query/core/test_filters.py` & `gantry-0.6.5/tests/query/core/test_filters.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/query/core/test_metric.py` & `gantry-0.6.5/tests/query/core/test_metric.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/query/core/test_queryframe.py` & `gantry-0.6.5/tests/query/core/test_queryframe.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/query/core/test_series.py` & `gantry-0.6.5/tests/query/core/test_series.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/query/core/test_utils.py` & `gantry-0.6.5/tests/query/core/test_utils.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/query/distance/test_main.py` & `gantry-0.6.5/tests/query/distance/test_main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/query/metric/test_main.py` & `gantry-0.6.5/tests/query/metric/test_main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/query/test_client.py` & `gantry-0.6.5/tests/query/test_client.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/query/test_main.py` & `gantry-0.6.5/tests/query/test_main.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/test_api_client.py` & `gantry-0.6.5/tests/test_api_client.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/test_init.py` & `gantry-0.6.5/tests/test_init.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/test_utils.py` & `gantry-0.6.5/tests/test_utils.py`

 * *Files identical despite different names*

### Comparing `gantry-0.6.4/tests/test_validator.py` & `gantry-0.6.5/tests/test_validator.py`

 * *Files identical despite different names*

